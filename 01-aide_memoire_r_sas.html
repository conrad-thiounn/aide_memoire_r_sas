<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nassab ABDALLAH">
<meta name="author" content="Damien EUZENAT">
<meta name="author" content="Sébastien LI-THIAO-TE">
<meta name="description" content="Un aide-mémoire pour les statisticiens traduisant des codes standards en SAS et en R, suivant 4 environnements (R-Base, Tidyverse, data.table, Arrow / DuckDb).">

<title>Aide-mémoire SAS - R - Aide-mémoire SAS - R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Aide-mémoire <code>SAS</code> - <code>R</code></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Aide-mémoire SAS - R</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-aide_memoire_r_sas.html" class="sidebar-item-text sidebar-link active">Aide-mémoire</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-mise_en_garde.html" class="sidebar-item-text sidebar-link">Mise en garde</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Trucs et astuces en R.html" class="sidebar-item-text sidebar-link">Trucs et astuces</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-specificites_sas_r.html" class="sidebar-item-text sidebar-link">Spécificités de SAS et R</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-avantages_inconvenients_env_R.html" class="sidebar-item-text sidebar-link">Avantages et inconvénients des environnements R</a>
  </div>
</li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Sur cette page</h2>
   
  <ul>
  <li><a href="#importation-des-packages" id="toc-importation-des-packages" class="nav-link active" data-scroll-target="#importation-des-packages"><span class="toc-section-number">1</span>  Importation des packages</a>
  <ul class="collapse">
  <li><a href="#importation-des-packages-1" id="toc-importation-des-packages-1" class="nav-link" data-scroll-target="#importation-des-packages-1"><span class="toc-section-number">1.1</span>  Importation des packages</a></li>
  </ul></li>
  <li><a href="#importation-des-données" id="toc-importation-des-données" class="nav-link" data-scroll-target="#importation-des-données"><span class="toc-section-number">2</span>  Importation des données</a>
  <ul class="collapse">
  <li><a href="#mode-demploi-de-laide-mémoire" id="toc-mode-demploi-de-laide-mémoire" class="nav-link" data-scroll-target="#mode-demploi-de-laide-mémoire"><span class="toc-section-number">2.1</span>  Mode d’emploi de l’aide-mémoire</a></li>
  <li><a href="#création-dune-base-de-données-sas-dexemple" id="toc-création-dune-base-de-données-sas-dexemple" class="nav-link" data-scroll-target="#création-dune-base-de-données-sas-dexemple"><span class="toc-section-number">2.2</span>  Création d’une base de données SAS d’exemple</a></li>
  </ul></li>
  <li><a href="#préambule" id="toc-préambule" class="nav-link" data-scroll-target="#préambule"><span class="toc-section-number">3</span>  Préambule</a>
  <ul class="collapse">
  <li><a href="#chemin-du-bureau-de-lutilisateur" id="toc-chemin-du-bureau-de-lutilisateur" class="nav-link" data-scroll-target="#chemin-du-bureau-de-lutilisateur"><span class="toc-section-number">3.1</span>  Chemin du bureau de l’utilisateur</a></li>
  <li><a href="#affichage-de-lannée" id="toc-affichage-de-lannée" class="nav-link" data-scroll-target="#affichage-de-lannée"><span class="toc-section-number">3.2</span>  Affichage de l’année</a></li>
  <li><a href="#construction-des-instructions-if-else" id="toc-construction-des-instructions-if-else" class="nav-link" data-scroll-target="#construction-des-instructions-if-else"><span class="toc-section-number">3.3</span>  Construction des instructions if / else</a></li>
  <li><a href="#répertoire-de-travail" id="toc-répertoire-de-travail" class="nav-link" data-scroll-target="#répertoire-de-travail"><span class="toc-section-number">3.4</span>  Répertoire de travail</a></li>
  <li><a href="#autres-points-à-connaître" id="toc-autres-points-à-connaître" class="nav-link" data-scroll-target="#autres-points-à-connaître"><span class="toc-section-number">3.5</span>  Autres points à connaître</a></li>
  </ul></li>
  <li><a href="#informations-sur-la-base-de-données" id="toc-informations-sur-la-base-de-données" class="nav-link" data-scroll-target="#informations-sur-la-base-de-données"><span class="toc-section-number">4</span>  Informations sur la base de données</a>
  <ul class="collapse">
  <li><a href="#avoir-une-vue-densemble-des-données" id="toc-avoir-une-vue-densemble-des-données" class="nav-link" data-scroll-target="#avoir-une-vue-densemble-des-données"><span class="toc-section-number">4.1</span>  Avoir une vue d’ensemble des données</a></li>
  <li><a href="#extraire-les-x-premières-lignes-de-la-base-10-par-défaut" id="toc-extraire-les-x-premières-lignes-de-la-base-10-par-défaut" class="nav-link" data-scroll-target="#extraire-les-x-premières-lignes-de-la-base-10-par-défaut"><span class="toc-section-number">4.2</span>  Extraire les x premières lignes de la base (10 par défaut)</a></li>
  <li><a href="#extraire-les-x-dernières-lignes-de-la-base-10-par-défaut" id="toc-extraire-les-x-dernières-lignes-de-la-base-10-par-défaut" class="nav-link" data-scroll-target="#extraire-les-x-dernières-lignes-de-la-base-10-par-défaut"><span class="toc-section-number">4.3</span>  Extraire les x dernières lignes de la base (10 par défaut)</a></li>
  <li><a href="#nombre-de-lignes-et-de-colonnes-dans-la-base" id="toc-nombre-de-lignes-et-de-colonnes-dans-la-base" class="nav-link" data-scroll-target="#nombre-de-lignes-et-de-colonnes-dans-la-base"><span class="toc-section-number">4.4</span>  Nombre de lignes et de colonnes dans la base</a></li>
  <li><a href="#liste-des-variables-de-la-base" id="toc-liste-des-variables-de-la-base" class="nav-link" data-scroll-target="#liste-des-variables-de-la-base"><span class="toc-section-number">4.5</span>  Liste des variables de la base</a></li>
  <li><a href="#nombre-didentifiants-uniques-et-nombre-de-lignes-dans-la-base" id="toc-nombre-didentifiants-uniques-et-nombre-de-lignes-dans-la-base" class="nav-link" data-scroll-target="#nombre-didentifiants-uniques-et-nombre-de-lignes-dans-la-base"><span class="toc-section-number">4.6</span>  Nombre d’identifiants uniques et nombre de lignes dans la base</a></li>
  <li><a href="#quelle-est-la-position-de-la-variable-date_entree" id="toc-quelle-est-la-position-de-la-variable-date_entree" class="nav-link" data-scroll-target="#quelle-est-la-position-de-la-variable-date_entree"><span class="toc-section-number">4.7</span>  Quelle est la position de la variable date_entree ?</a></li>
  <li><a href="#format-des-variables" id="toc-format-des-variables" class="nav-link" data-scroll-target="#format-des-variables"><span class="toc-section-number">4.8</span>  Format des variables</a></li>
  </ul></li>
  <li><a href="#sélectionner-des-lignes-et-des-colonnes" id="toc-sélectionner-des-lignes-et-des-colonnes" class="nav-link" data-scroll-target="#sélectionner-des-lignes-et-des-colonnes"><span class="toc-section-number">5</span>  Sélectionner des lignes et des colonnes</a>
  <ul class="collapse">
  <li><a href="#selection-de-colonnes-par-position" id="toc-selection-de-colonnes-par-position" class="nav-link" data-scroll-target="#selection-de-colonnes-par-position"><span class="toc-section-number">5.1</span>  Selection de colonnes par position</a></li>
  <li><a href="#selection-de-colonnes-par-nom" id="toc-selection-de-colonnes-par-nom" class="nav-link" data-scroll-target="#selection-de-colonnes-par-nom"><span class="toc-section-number">5.2</span>  Selection de colonnes par nom</a></li>
  <li><a href="#selection-de-colonnes-par-variable" id="toc-selection-de-colonnes-par-variable" class="nav-link" data-scroll-target="#selection-de-colonnes-par-variable"><span class="toc-section-number">5.3</span>  Selection de colonnes par variable</a></li>
  <li><a href="#sauf-certaines-variables" id="toc-sauf-certaines-variables" class="nav-link" data-scroll-target="#sauf-certaines-variables"><span class="toc-section-number">5.4</span>  Sauf certaines variables</a></li>
  <li><a href="#sélectionner-la-3e-colonne" id="toc-sélectionner-la-3e-colonne" class="nav-link" data-scroll-target="#sélectionner-la-3e-colonne"><span class="toc-section-number">5.5</span>  Sélectionner la 3e colonne</a></li>
  <li><a href="#sélectionner-plusieurs-colonnes" id="toc-sélectionner-plusieurs-colonnes" class="nav-link" data-scroll-target="#sélectionner-plusieurs-colonnes"><span class="toc-section-number">5.6</span>  Sélectionner plusieurs colonnes</a></li>
  <li><a href="#sélectionner-les-colonnes-qui-débutent-par-le-mot-note" id="toc-sélectionner-les-colonnes-qui-débutent-par-le-mot-note" class="nav-link" data-scroll-target="#sélectionner-les-colonnes-qui-débutent-par-le-mot-note"><span class="toc-section-number">5.7</span>  Sélectionner les colonnes qui débutent par le mot Note</a></li>
  <li><a href="#sélectionner-les-colonnes-qui-ne-débutent-pas-par-le-mot-note" id="toc-sélectionner-les-colonnes-qui-ne-débutent-pas-par-le-mot-note" class="nav-link" data-scroll-target="#sélectionner-les-colonnes-qui-ne-débutent-pas-par-le-mot-note"><span class="toc-section-number">5.8</span>  Sélectionner les colonnes qui ne débutent pas par le mot Note</a></li>
  <li><a href="#sélectionner-lensemble-des-variables-numériques-de-la-base" id="toc-sélectionner-lensemble-des-variables-numériques-de-la-base" class="nav-link" data-scroll-target="#sélectionner-lensemble-des-variables-numériques-de-la-base"><span class="toc-section-number">5.9</span>  Sélectionner l’ensemble des variables numériques de la base</a></li>
  <li><a href="#sélectionner-lensemble-des-variables-de-format-date" id="toc-sélectionner-lensemble-des-variables-de-format-date" class="nav-link" data-scroll-target="#sélectionner-lensemble-des-variables-de-format-date"><span class="toc-section-number">5.10</span>  Sélectionner l’ensemble des variables de format “Date”</a></li>
  <li><a href="#sélectionner-des-lignes" id="toc-sélectionner-des-lignes" class="nav-link" data-scroll-target="#sélectionner-des-lignes"><span class="toc-section-number">5.11</span>  Sélectionner des lignes</a></li>
  <li><a href="#sélection-sur-de-multiples-conditions" id="toc-sélection-sur-de-multiples-conditions" class="nav-link" data-scroll-target="#sélection-sur-de-multiples-conditions"><span class="toc-section-number">5.12</span>  Sélection sur de multiples conditions</a></li>
  <li><a href="#sélection-de-ligne-par-référence-lignes-de-lidentifiant-087" id="toc-sélection-de-ligne-par-référence-lignes-de-lidentifiant-087" class="nav-link" data-scroll-target="#sélection-de-ligne-par-référence-lignes-de-lidentifiant-087"><span class="toc-section-number">5.13</span>  Sélection de ligne par référence : lignes de l’identifiant 087</a></li>
  <li><a href="#sélection-de-lignes-et-de-variables" id="toc-sélection-de-lignes-et-de-variables" class="nav-link" data-scroll-target="#sélection-de-lignes-et-de-variables"><span class="toc-section-number">5.14</span>  Sélection de lignes et de variables</a></li>
  </ul></li>
  <li><a href="#manipuler-des-lignes-et-des-colonnes" id="toc-manipuler-des-lignes-et-des-colonnes" class="nav-link" data-scroll-target="#manipuler-des-lignes-et-des-colonnes"><span class="toc-section-number">6</span>  Manipuler des lignes et des colonnes</a>
  <ul class="collapse">
  <li><a href="#renommer-des-variables" id="toc-renommer-des-variables" class="nav-link" data-scroll-target="#renommer-des-variables"><span class="toc-section-number">6.1</span>  Renommer des variables</a></li>
  <li><a href="#formater-les-modalités-des-valeurs" id="toc-formater-les-modalités-des-valeurs" class="nav-link" data-scroll-target="#formater-les-modalités-des-valeurs"><span class="toc-section-number">6.2</span>  Formater les modalités des valeurs</a></li>
  <li><a href="#utiliser-les-formats" id="toc-utiliser-les-formats" class="nav-link" data-scroll-target="#utiliser-les-formats"><span class="toc-section-number">6.3</span>  Utiliser les formats</a></li>
  <li><a href="#transformer-le-format-dune-variable" id="toc-transformer-le-format-dune-variable" class="nav-link" data-scroll-target="#transformer-le-format-dune-variable"><span class="toc-section-number">6.4</span>  Transformer le format d’une variable</a></li>
  <li><a href="#création-et-suppressions-de-plusieurs-variables" id="toc-création-et-suppressions-de-plusieurs-variables" class="nav-link" data-scroll-target="#création-et-suppressions-de-plusieurs-variables"><span class="toc-section-number">6.5</span>  Création et suppressions de plusieurs variables</a></li>
  <li><a href="#on-souhaite-réexprimer-toutes-les-notes-sur-100-et-non-sur-20" id="toc-on-souhaite-réexprimer-toutes-les-notes-sur-100-et-non-sur-20" class="nav-link" data-scroll-target="#on-souhaite-réexprimer-toutes-les-notes-sur-100-et-non-sur-20"><span class="toc-section-number">6.6</span>  On souhaite réexprimer toutes les notes sur 100 et non sur 20</a></li>
  <li><a href="#création-de-variables-avec-des-conditions" id="toc-création-de-variables-avec-des-conditions" class="nav-link" data-scroll-target="#création-de-variables-avec-des-conditions"><span class="toc-section-number">6.7</span>  Création de variables avec des conditions</a></li>
  <li><a href="#manipuler-les-dates" id="toc-manipuler-les-dates" class="nav-link" data-scroll-target="#manipuler-les-dates"><span class="toc-section-number">6.8</span>  Manipuler les dates</a></li>
  <li><a href="#mettre-un-0-devant-un-nombre" id="toc-mettre-un-0-devant-un-nombre" class="nav-link" data-scroll-target="#mettre-un-0-devant-un-nombre"><span class="toc-section-number">6.9</span>  Mettre un 0 devant un nombre</a></li>
  <li><a href="#arrondir-une-valeur-numérique" id="toc-arrondir-une-valeur-numérique" class="nav-link" data-scroll-target="#arrondir-une-valeur-numérique"><span class="toc-section-number">6.10</span>  Arrondir une valeur numérique</a></li>
  </ul></li>
  <li><a href="#les-tris" id="toc-les-tris" class="nav-link" data-scroll-target="#les-tris"><span class="toc-section-number">7</span>  Les tris</a>
  <ul class="collapse">
  <li><a href="#trier-les-colonnes-de-la-base" id="toc-trier-les-colonnes-de-la-base" class="nav-link" data-scroll-target="#trier-les-colonnes-de-la-base"><span class="toc-section-number">7.1</span>  Trier les colonnes de la base</a></li>
  <li><a href="#trier-les-lignes-par-ordre-décroissant" id="toc-trier-les-lignes-par-ordre-décroissant" class="nav-link" data-scroll-target="#trier-les-lignes-par-ordre-décroissant"><span class="toc-section-number">7.2</span>  Trier les lignes (par ordre décroissant</a></li>
  <li><a href="#incidence-des-valeurs-manquantes-dans-les-tris" id="toc-incidence-des-valeurs-manquantes-dans-les-tris" class="nav-link" data-scroll-target="#incidence-des-valeurs-manquantes-dans-les-tris"><span class="toc-section-number">7.3</span>  Incidence des valeurs manquantes dans les tris</a></li>
  <li><a href="#trier-par-ordre-croissant-par-toutes-les-variables-de-la-base" id="toc-trier-par-ordre-croissant-par-toutes-les-variables-de-la-base" class="nav-link" data-scroll-target="#trier-par-ordre-croissant-par-toutes-les-variables-de-la-base"><span class="toc-section-number">7.4</span>  Trier par ordre croissant par toutes les variables de la base</a></li>
  </ul></li>
  <li><a href="#manipuler-des-chaînes-de-caractères" id="toc-manipuler-des-chaînes-de-caractères" class="nav-link" data-scroll-target="#manipuler-des-chaînes-de-caractères"><span class="toc-section-number">8</span>  Manipuler des chaînes de caractères</a>
  <ul class="collapse">
  <li><a href="#majuscule-minuscule" id="toc-majuscule-minuscule" class="nav-link" data-scroll-target="#majuscule-minuscule"><span class="toc-section-number">8.1</span>  Majuscule, minuscule</a></li>
  <li><a href="#remplacer-une-chaîne-de-caractères-par-une-autre" id="toc-remplacer-une-chaîne-de-caractères-par-une-autre" class="nav-link" data-scroll-target="#remplacer-une-chaîne-de-caractères-par-une-autre"><span class="toc-section-number">8.2</span>  Remplacer une chaîne de caractères par une autre</a></li>
  <li><a href="#manipuler-des-chaînes-de-caractères-1" id="toc-manipuler-des-chaînes-de-caractères-1" class="nav-link" data-scroll-target="#manipuler-des-chaînes-de-caractères-1"><span class="toc-section-number">8.3</span>  Manipuler des chaînes de caractères</a></li>
  <li><a href="#découper-une-chaîne-de-caractères-selon-un-caractère-donné" id="toc-découper-une-chaîne-de-caractères-selon-un-caractère-donné" class="nav-link" data-scroll-target="#découper-une-chaîne-de-caractères-selon-un-caractère-donné"><span class="toc-section-number">8.4</span>  Découper une chaîne de caractères selon un caractère donné</a></li>
  <li><a href="#inverser-une-chaîne-de-caractères" id="toc-inverser-une-chaîne-de-caractères" class="nav-link" data-scroll-target="#inverser-une-chaîne-de-caractères"><span class="toc-section-number">8.5</span>  Inverser une chaîne de caractères</a></li>
  </ul></li>
  <li><a href="#gestion-par-groupe" id="toc-gestion-par-groupe" class="nav-link" data-scroll-target="#gestion-par-groupe"><span class="toc-section-number">9</span>  Gestion par groupe</a>
  <ul class="collapse">
  <li><a href="#numéroter-les-lignes" id="toc-numéroter-les-lignes" class="nav-link" data-scroll-target="#numéroter-les-lignes"><span class="toc-section-number">9.1</span>  Numéroter les lignes</a></li>
  <li><a href="#numéro-de-contrat-par-individu" id="toc-numéro-de-contrat-par-individu" class="nav-link" data-scroll-target="#numéro-de-contrat-par-individu"><span class="toc-section-number">9.2</span>  Numéro de contrat par individu</a></li>
  <li><a href="#le-premier-contrat-le-dernier-contrat-ni-le-premier-ni-le-dernier-contrat-de-chaque-individu" id="toc-le-premier-contrat-le-dernier-contrat-ni-le-premier-ni-le-dernier-contrat-de-chaque-individu" class="nav-link" data-scroll-target="#le-premier-contrat-le-dernier-contrat-ni-le-premier-ni-le-dernier-contrat-de-chaque-individu"><span class="toc-section-number">9.3</span>  Le premier contrat, le dernier contrat, ni le premier ni le dernier contrat de chaque individu …</a></li>
  <li><a href="#les-2-premières-dernières-lignes-de-chaque-identifiant" id="toc-les-2-premières-dernières-lignes-de-chaque-identifiant" class="nav-link" data-scroll-target="#les-2-premières-dernières-lignes-de-chaque-identifiant"><span class="toc-section-number">9.4</span>  Les 2 premières / dernières lignes de chaque identifiant</a></li>
  <li><a href="#e-ligne-de-lindividu-et-rien-si-lindividu-a-1-seule-ligne" id="toc-e-ligne-de-lindividu-et-rien-si-lindividu-a-1-seule-ligne" class="nav-link" data-scroll-target="#e-ligne-de-lindividu-et-rien-si-lindividu-a-1-seule-ligne"><span class="toc-section-number">9.5</span>  2e ligne de l’individu (et rien si l’individu a 1 seule ligne)</a></li>
  <li><a href="#lavant-dernière-ligne-de-lindividu-et-rien-si-lindividu-a-1-seul-contrat" id="toc-lavant-dernière-ligne-de-lindividu-et-rien-si-lindividu-a-1-seul-contrat" class="nav-link" data-scroll-target="#lavant-dernière-ligne-de-lindividu-et-rien-si-lindividu-a-1-seul-contrat"><span class="toc-section-number">9.6</span>  L’avant-dernière ligne de l’individu (et rien si l’individu a 1 seul contrat)</a></li>
  <li><a href="#sélection-par-groupement" id="toc-sélection-par-groupement" class="nav-link" data-scroll-target="#sélection-par-groupement"><span class="toc-section-number">9.7</span>  Sélection par groupement</a></li>
  <li><a href="#ajouter-une-colonne-désignant-la-note-moyenne-de-note_contenu-par-individu" id="toc-ajouter-une-colonne-désignant-la-note-moyenne-de-note_contenu-par-individu" class="nav-link" data-scroll-target="#ajouter-une-colonne-désignant-la-note-moyenne-de-note_contenu-par-individu"><span class="toc-section-number">9.8</span>  Ajouter une colonne désignant la note moyenne de Note_Contenu par individu</a></li>
  <li><a href="#variable-retardée-lag" id="toc-variable-retardée-lag" class="nav-link" data-scroll-target="#variable-retardée-lag"><span class="toc-section-number">9.9</span>  Variable retardée (lag)</a></li>
  <li><a href="#transposer-une-base" id="toc-transposer-une-base" class="nav-link" data-scroll-target="#transposer-une-base"><span class="toc-section-number">9.10</span>  Transposer une base</a></li>
  <li><a href="#passer-dune-base-en-largeur-wide-à-une-base-en-longueur-long" id="toc-passer-dune-base-en-largeur-wide-à-une-base-en-longueur-long" class="nav-link" data-scroll-target="#passer-dune-base-en-largeur-wide-à-une-base-en-longueur-long"><span class="toc-section-number">9.11</span>  Passer d’une base en largeur (wide) à une base en longueur (long)</a></li>
  <li><a href="#passer-base-en-longueur-long-à-une-base-en-largeur-wide" id="toc-passer-base-en-longueur-long-à-une-base-en-largeur-wide" class="nav-link" data-scroll-target="#passer-base-en-longueur-long-à-une-base-en-largeur-wide"><span class="toc-section-number">9.12</span>  Passer base en longueur (long) à une base en largeur (wide)</a></li>
  </ul></li>
  <li><a href="#gestion-par-rangées-de-lignes" id="toc-gestion-par-rangées-de-lignes" class="nav-link" data-scroll-target="#gestion-par-rangées-de-lignes"><span class="toc-section-number">10</span>  Gestion par rangées de lignes</a>
  <ul class="collapse">
  <li><a href="#sélectionner-les-lignes-avec-au-moins-une-note-10" id="toc-sélectionner-les-lignes-avec-au-moins-une-note-10" class="nav-link" data-scroll-target="#sélectionner-les-lignes-avec-au-moins-une-note-10"><span class="toc-section-number">10.1</span>  Sélectionner les lignes avec au moins une note &lt; 10</a></li>
  <li><a href="#sélectionner-les-lignes-avec-toutes-les-notes-supérieurs-à-10" id="toc-sélectionner-les-lignes-avec-toutes-les-notes-supérieurs-à-10" class="nav-link" data-scroll-target="#sélectionner-les-lignes-avec-toutes-les-notes-supérieurs-à-10"><span class="toc-section-number">10.2</span>  Sélectionner les lignes avec toutes les notes supérieurs à 10</a></li>
  <li><a href="#moyenne-par-ligne" id="toc-moyenne-par-ligne" class="nav-link" data-scroll-target="#moyenne-par-ligne"><span class="toc-section-number">10.3</span>  Moyenne par ligne</a></li>
  <li><a href="#la-note-donnée-est-elle-supérieure-à-la-moyenne" id="toc-la-note-donnée-est-elle-supérieure-à-la-moyenne" class="nav-link" data-scroll-target="#la-note-donnée-est-elle-supérieure-à-la-moyenne"><span class="toc-section-number">10.4</span>  La note donnée est-elle supérieure à la moyenne ?</a></li>
  <li><a href="#moyenne-par-ligne-1" id="toc-moyenne-par-ligne-1" class="nav-link" data-scroll-target="#moyenne-par-ligne-1"><span class="toc-section-number">10.5</span>  Moyenne par ligne</a></li>
  </ul></li>
  <li><a href="#les-valeurs-manquantes" id="toc-les-valeurs-manquantes" class="nav-link" data-scroll-target="#les-valeurs-manquantes"><span class="toc-section-number">11</span>  Les valeurs manquantes</a>
  <ul class="collapse">
  <li><a href="#repérer-les-valeurs-manquantes-variables-âge-et-niveau" id="toc-repérer-les-valeurs-manquantes-variables-âge-et-niveau" class="nav-link" data-scroll-target="#repérer-les-valeurs-manquantes-variables-âge-et-niveau"><span class="toc-section-number">11.1</span>  Repérer les valeurs manquantes (variables Âge et Niveau)</a></li>
  <li><a href="#nombre-et-proportion-de-valeurs-manquantes-par-variable" id="toc-nombre-et-proportion-de-valeurs-manquantes-par-variable" class="nav-link" data-scroll-target="#nombre-et-proportion-de-valeurs-manquantes-par-variable"><span class="toc-section-number">11.2</span>  Nombre et proportion de valeurs manquantes par variable</a></li>
  <li><a href="#incidence-des-valeurs-manquantes" id="toc-incidence-des-valeurs-manquantes" class="nav-link" data-scroll-target="#incidence-des-valeurs-manquantes"><span class="toc-section-number">11.3</span>  Incidence des valeurs manquantes</a></li>
  <li><a href="#remplacer-toutes-les-valeurs-numériques-manquantes-par-0" id="toc-remplacer-toutes-les-valeurs-numériques-manquantes-par-0" class="nav-link" data-scroll-target="#remplacer-toutes-les-valeurs-numériques-manquantes-par-0"><span class="toc-section-number">11.4</span>  Remplacer toutes les valeurs numériques manquantes par 0</a></li>
  <li><a href="#remplacer-les-valeurs-manquantes-dune-seule-variable-par-0" id="toc-remplacer-les-valeurs-manquantes-dune-seule-variable-par-0" class="nav-link" data-scroll-target="#remplacer-les-valeurs-manquantes-dune-seule-variable-par-0"><span class="toc-section-number">11.5</span>  Remplacer les valeurs manquantes d’une seule variable par 0</a></li>
  </ul></li>
  <li><a href="#les-doublons" id="toc-les-doublons" class="nav-link" data-scroll-target="#les-doublons"><span class="toc-section-number">12</span>  Les doublons</a>
  <ul class="collapse">
  <li><a href="#doublons-pour-toutes-les-colonnes" id="toc-doublons-pour-toutes-les-colonnes" class="nav-link" data-scroll-target="#doublons-pour-toutes-les-colonnes"><span class="toc-section-number">12.1</span>  Doublons pour toutes les colonnes</a></li>
  <li><a href="#doublons-pour-une-ou-plusieurs-colonnes" id="toc-doublons-pour-une-ou-plusieurs-colonnes" class="nav-link" data-scroll-target="#doublons-pour-une-ou-plusieurs-colonnes"><span class="toc-section-number">12.2</span>  Doublons pour une ou plusieurs colonnes</a></li>
  <li><a href="#récupérer-toutes-les-lignes-pour-les-identifiants-en-doublon" id="toc-récupérer-toutes-les-lignes-pour-les-identifiants-en-doublon" class="nav-link" data-scroll-target="#récupérer-toutes-les-lignes-pour-les-identifiants-en-doublon"><span class="toc-section-number">12.3</span>  Récupérer toutes les lignes pour les identifiants en doublon</a></li>
  <li><a href="#récupérer-toutes-les-lignes-pour-les-identifiants-sans-doublon" id="toc-récupérer-toutes-les-lignes-pour-les-identifiants-sans-doublon" class="nav-link" data-scroll-target="#récupérer-toutes-les-lignes-pour-les-identifiants-sans-doublon"><span class="toc-section-number">12.4</span>  Récupérer toutes les lignes pour les identifiants sans doublon</a></li>
  <li><a href="#suppression-des-doublons-pour-lensemble-des-variables" id="toc-suppression-des-doublons-pour-lensemble-des-variables" class="nav-link" data-scroll-target="#suppression-des-doublons-pour-lensemble-des-variables"><span class="toc-section-number">12.5</span>  Suppression des doublons pour l’ensemble des variables</a></li>
  <li><a href="#suppression-des-doublons-pour-une-seule-variable" id="toc-suppression-des-doublons-pour-une-seule-variable" class="nav-link" data-scroll-target="#suppression-des-doublons-pour-une-seule-variable"><span class="toc-section-number">12.6</span>  Suppression des doublons pour une seule variable</a></li>
  <li><a href="#identifiants-uniques" id="toc-identifiants-uniques" class="nav-link" data-scroll-target="#identifiants-uniques"><span class="toc-section-number">12.7</span>  Identifiants uniques</a></li>
  <li><a href="#nombre-de-lignes-uniques-sans-doublon" id="toc-nombre-de-lignes-uniques-sans-doublon" class="nav-link" data-scroll-target="#nombre-de-lignes-uniques-sans-doublon"><span class="toc-section-number">12.8</span>  Nombre de lignes uniques, sans doublon</a></li>
  </ul></li>
  <li><a href="#les-jointures-de-bases" id="toc-les-jointures-de-bases" class="nav-link" data-scroll-target="#les-jointures-de-bases"><span class="toc-section-number">13</span>  Les jointures de bases</a>
  <ul class="collapse">
  <li><a href="#importation-de-bases-pour-les-jointures" id="toc-importation-de-bases-pour-les-jointures" class="nav-link" data-scroll-target="#importation-de-bases-pour-les-jointures"><span class="toc-section-number">13.1</span>  Importation de bases pour les jointures</a></li>
  <li><a href="#inner-join-les-seuls-identifiants-communs-aux-deux-bases" id="toc-inner-join-les-seuls-identifiants-communs-aux-deux-bases" class="nav-link" data-scroll-target="#inner-join-les-seuls-identifiants-communs-aux-deux-bases"><span class="toc-section-number">13.2</span>  Inner join : les seuls identifiants communs aux deux bases</a></li>
  <li><a href="#left-join-les-identifiants-de-la-base-de-gauche" id="toc-left-join-les-identifiants-de-la-base-de-gauche" class="nav-link" data-scroll-target="#left-join-les-identifiants-de-la-base-de-gauche"><span class="toc-section-number">13.3</span>  Left join : les identifiants de la base de gauche</a></li>
  <li><a href="#right-join-les-identifiants-de-la-base-de-droite" id="toc-right-join-les-identifiants-de-la-base-de-droite" class="nav-link" data-scroll-target="#right-join-les-identifiants-de-la-base-de-droite"><span class="toc-section-number">13.4</span>  Right join : les identifiants de la base de droite</a></li>
  <li><a href="#full-join-les-identifiants-des-deux-bases" id="toc-full-join-les-identifiants-des-deux-bases" class="nav-link" data-scroll-target="#full-join-les-identifiants-des-deux-bases"><span class="toc-section-number">13.5</span>  Full join : les identifiants des deux bases</a></li>
  <li><a href="#jointure-de-3-bases-ou-plus-en-une-seule-opération-inner-join" id="toc-jointure-de-3-bases-ou-plus-en-une-seule-opération-inner-join" class="nav-link" data-scroll-target="#jointure-de-3-bases-ou-plus-en-une-seule-opération-inner-join"><span class="toc-section-number">13.6</span>  Jointure de 3 bases ou plus en une seule opération (inner join)</a></li>
  <li><a href="#jointure-sur-inégalités" id="toc-jointure-sur-inégalités" class="nav-link" data-scroll-target="#jointure-sur-inégalités"><span class="toc-section-number">13.7</span>  Jointure sur inégalités</a></li>
  <li><a href="#cross-join-toutes-les-combinaisons-possibles-de-csp-sexe-et-diplome" id="toc-cross-join-toutes-les-combinaisons-possibles-de-csp-sexe-et-diplome" class="nav-link" data-scroll-target="#cross-join-toutes-les-combinaisons-possibles-de-csp-sexe-et-diplome"><span class="toc-section-number">13.8</span>  Cross join : toutes les combinaisons possibles de CSP, sexe et Diplome</a></li>
  <li><a href="#juxtaposer-côte-à-côte-deux-bases-de-données" id="toc-juxtaposer-côte-à-côte-deux-bases-de-données" class="nav-link" data-scroll-target="#juxtaposer-côte-à-côte-deux-bases-de-données"><span class="toc-section-number">13.9</span>  Juxtaposer côte à côte deux bases de données</a></li>
  <li><a href="#empiler-deux-bases-de-données" id="toc-empiler-deux-bases-de-données" class="nav-link" data-scroll-target="#empiler-deux-bases-de-données"><span class="toc-section-number">13.10</span>  Empiler deux bases de données</a></li>
  <li><a href="#ajouter-une-ligne-de-valeurs-manquantes-à-une-base-de-données" id="toc-ajouter-une-ligne-de-valeurs-manquantes-à-une-base-de-données" class="nav-link" data-scroll-target="#ajouter-une-ligne-de-valeurs-manquantes-à-une-base-de-données"><span class="toc-section-number">13.11</span>  Ajouter une ligne de valeurs manquantes à une base de données</a></li>
  <li><a href="#semi-join" id="toc-semi-join" class="nav-link" data-scroll-target="#semi-join"><span class="toc-section-number">13.12</span>  Semi join</a></li>
  <li><a href="#anti-join" id="toc-anti-join" class="nav-link" data-scroll-target="#anti-join"><span class="toc-section-number">13.13</span>  Anti join</a></li>
  <li><a href="#autres-fonctions-utiles" id="toc-autres-fonctions-utiles" class="nav-link" data-scroll-target="#autres-fonctions-utiles"><span class="toc-section-number">13.14</span>  Autres fonctions utiles</a></li>
  </ul></li>
  <li><a href="#statistiques-descriptives" id="toc-statistiques-descriptives" class="nav-link" data-scroll-target="#statistiques-descriptives"><span class="toc-section-number">14</span>  Statistiques descriptives</a>
  <ul class="collapse">
  <li><a href="#moyenne" id="toc-moyenne" class="nav-link" data-scroll-target="#moyenne"><span class="toc-section-number">14.1</span>  Moyenne</a></li>
  <li><a href="#moyenne-par-sélection" id="toc-moyenne-par-sélection" class="nav-link" data-scroll-target="#moyenne-par-sélection"><span class="toc-section-number">14.2</span>  Moyenne par sélection</a></li>
  <li><a href="#moyenne-pondérée" id="toc-moyenne-pondérée" class="nav-link" data-scroll-target="#moyenne-pondérée"><span class="toc-section-number">14.3</span>  Moyenne pondérée</a></li>
  <li><a href="#moyenne-de-plusieurs-variables" id="toc-moyenne-de-plusieurs-variables" class="nav-link" data-scroll-target="#moyenne-de-plusieurs-variables"><span class="toc-section-number">14.4</span>  Moyenne de plusieurs variables</a></li>
  <li><a href="#moyenne-pondérée-de-plusieurs-variables" id="toc-moyenne-pondérée-de-plusieurs-variables" class="nav-link" data-scroll-target="#moyenne-pondérée-de-plusieurs-variables"><span class="toc-section-number">14.5</span>  Moyenne pondérée de plusieurs variables</a></li>
  <li><a href="#nombreuses-statistiques-somme-moyenne-médiane-mode-etc." id="toc-nombreuses-statistiques-somme-moyenne-médiane-mode-etc." class="nav-link" data-scroll-target="#nombreuses-statistiques-somme-moyenne-médiane-mode-etc."><span class="toc-section-number">14.6</span>  Nombreuses statistiques (somme, moyenne, médiane, mode, etc.)</a></li>
  <li><a href="#nombreuses-statistiques-pondérées-somme-moyenne-médiane-mode-etc." id="toc-nombreuses-statistiques-pondérées-somme-moyenne-médiane-mode-etc." class="nav-link" data-scroll-target="#nombreuses-statistiques-pondérées-somme-moyenne-médiane-mode-etc."><span class="toc-section-number">14.7</span>  Nombreuses statistiques pondérées (somme, moyenne, médiane, mode, etc.)</a></li>
  <li><a href="#calcul-dune-variance-pondérée" id="toc-calcul-dune-variance-pondérée" class="nav-link" data-scroll-target="#calcul-dune-variance-pondérée"><span class="toc-section-number">14.8</span>  Calcul d’une variance pondérée</a></li>
  <li><a href="#déciles-et-quartiles" id="toc-déciles-et-quartiles" class="nav-link" data-scroll-target="#déciles-et-quartiles"><span class="toc-section-number">14.9</span>  Déciles et quartiles</a></li>
  <li><a href="#déciles-et-quartiles-pondérés" id="toc-déciles-et-quartiles-pondérés" class="nav-link" data-scroll-target="#déciles-et-quartiles-pondérés"><span class="toc-section-number">14.10</span>  Déciles et quartiles pondérés</a></li>
  <li><a href="#rang-de-la-note" id="toc-rang-de-la-note" class="nav-link" data-scroll-target="#rang-de-la-note"><span class="toc-section-number">14.11</span>  Rang de la note</a></li>
  <li><a href="#corrélation-linéaire-entre-deux-notes" id="toc-corrélation-linéaire-entre-deux-notes" class="nav-link" data-scroll-target="#corrélation-linéaire-entre-deux-notes"><span class="toc-section-number">14.12</span>  Corrélation linéaire entre deux notes</a></li>
  </ul></li>
  <li><a href="#tableaux-de-fréquence" id="toc-tableaux-de-fréquence" class="nav-link" data-scroll-target="#tableaux-de-fréquence"><span class="toc-section-number">15</span>  Tableaux de fréquence</a>
  <ul class="collapse">
  <li><a href="#tableaux-de-fréquence-proc-freq-pour-1-variable" id="toc-tableaux-de-fréquence-proc-freq-pour-1-variable" class="nav-link" data-scroll-target="#tableaux-de-fréquence-proc-freq-pour-1-variable"><span class="toc-section-number">15.1</span>  Tableaux de fréquence (proc freq) pour 1 variable</a></li>
  <li><a href="#tableaux-de-fréquence-avec-les-valeurs-manquantes" id="toc-tableaux-de-fréquence-avec-les-valeurs-manquantes" class="nav-link" data-scroll-target="#tableaux-de-fréquence-avec-les-valeurs-manquantes"><span class="toc-section-number">15.2</span>  Tableaux de fréquence avec les valeurs manquantes</a></li>
  <li><a href="#tableaux-de-fréquence-trié-par-modalité-la-plus-courante" id="toc-tableaux-de-fréquence-trié-par-modalité-la-plus-courante" class="nav-link" data-scroll-target="#tableaux-de-fréquence-trié-par-modalité-la-plus-courante"><span class="toc-section-number">15.3</span>  Tableaux de fréquence trié par modalité la plus courante</a></li>
  <li><a href="#tableaux-de-fréquence-avec-la-pondération" id="toc-tableaux-de-fréquence-avec-la-pondération" class="nav-link" data-scroll-target="#tableaux-de-fréquence-avec-la-pondération"><span class="toc-section-number">15.4</span>  Tableaux de fréquence avec la pondération</a></li>
  <li><a href="#tableaux-de-contingence-proc-freq-pour-2-variables" id="toc-tableaux-de-contingence-proc-freq-pour-2-variables" class="nav-link" data-scroll-target="#tableaux-de-contingence-proc-freq-pour-2-variables"><span class="toc-section-number">15.5</span>  Tableaux de contingence (proc freq) pour 2 variables</a></li>
  <li><a href="#tableau-de-contingence-avec-pondération" id="toc-tableau-de-contingence-avec-pondération" class="nav-link" data-scroll-target="#tableau-de-contingence-avec-pondération"><span class="toc-section-number">15.6</span>  Tableau de contingence avec pondération</a></li>
  <li><a href="#copier-coller-le-tableau-dans-un-tableur-excel-etc." id="toc-copier-coller-le-tableau-dans-un-tableur-excel-etc." class="nav-link" data-scroll-target="#copier-coller-le-tableau-dans-un-tableur-excel-etc."><span class="toc-section-number">15.7</span>  Copier-coller le tableau dans un tableur (Excel, etc.)</a></li>
  <li><a href="#tests-dassociaton-chi-deux-etc." id="toc-tests-dassociaton-chi-deux-etc." class="nav-link" data-scroll-target="#tests-dassociaton-chi-deux-etc."><span class="toc-section-number">15.8</span>  Tests d’associaton (Chi-Deux, etc.)</a></li>
  <li><a href="#solutions-avec-package-r-permettant-de-pondérer" id="toc-solutions-avec-package-r-permettant-de-pondérer" class="nav-link" data-scroll-target="#solutions-avec-package-r-permettant-de-pondérer"><span class="toc-section-number">15.9</span>  Solutions avec package R permettant de pondérer</a></li>
  <li><a href="#package-descr" id="toc-package-descr" class="nav-link" data-scroll-target="#package-descr"><span class="toc-section-number">15.10</span>  Package descr</a></li>
  <li><a href="#package-flextable" id="toc-package-flextable" class="nav-link" data-scroll-target="#package-flextable"><span class="toc-section-number">15.11</span>  Package flextable</a></li>
  <li><a href="#package-questionr" id="toc-package-questionr" class="nav-link" data-scroll-target="#package-questionr"><span class="toc-section-number">15.12</span>  Package questionr</a></li>
  <li><a href="#package-survey" id="toc-package-survey" class="nav-link" data-scroll-target="#package-survey"><span class="toc-section-number">15.13</span>  Package survey</a></li>
  <li><a href="#package-procs" id="toc-package-procs" class="nav-link" data-scroll-target="#package-procs"><span class="toc-section-number">15.14</span>  Package procs</a></li>
  <li><a href="#solutions-avec-package-r-ne-permettant-apparemment-pas-de-pondérer" id="toc-solutions-avec-package-r-ne-permettant-apparemment-pas-de-pondérer" class="nav-link" data-scroll-target="#solutions-avec-package-r-ne-permettant-apparemment-pas-de-pondérer"><span class="toc-section-number">15.15</span>  Solutions avec package R ne permettant apparemment pas de pondérer</a></li>
  </ul></li>
  <li><a href="#statistiques-agrégées-par-groupe" id="toc-statistiques-agrégées-par-groupe" class="nav-link" data-scroll-target="#statistiques-agrégées-par-groupe"><span class="toc-section-number">16</span>  Statistiques agrégées par groupe</a>
  <ul class="collapse">
  <li><a href="#une-seule-variable-de-groupement-une-seule-variable" id="toc-une-seule-variable-de-groupement-une-seule-variable" class="nav-link" data-scroll-target="#une-seule-variable-de-groupement-une-seule-variable"><span class="toc-section-number">16.1</span>  Une seule variable de groupement, une seule variable</a></li>
  <li><a href="#plusieurs-variables" id="toc-plusieurs-variables" class="nav-link" data-scroll-target="#plusieurs-variables"><span class="toc-section-number">16.2</span>  Plusieurs variables</a></li>
  <li><a href="#tableaux-croisés-à-2-variables-de-groupement" id="toc-tableaux-croisés-à-2-variables-de-groupement" class="nav-link" data-scroll-target="#tableaux-croisés-à-2-variables-de-groupement"><span class="toc-section-number">16.3</span>  Tableaux croisés à 2 variables de groupement</a></li>
  <li><a href="#tableaux-croisés-à-3-variables-de-groupement-ou-plus-1-variable-en-ligne-2-en-colonne" id="toc-tableaux-croisés-à-3-variables-de-groupement-ou-plus-1-variable-en-ligne-2-en-colonne" class="nav-link" data-scroll-target="#tableaux-croisés-à-3-variables-de-groupement-ou-plus-1-variable-en-ligne-2-en-colonne"><span class="toc-section-number">16.4</span>  Tableaux croisés à 3 variables de groupement ou plus : 1 variable en ligne, 2 en colonne</a></li>
  </ul></li>
  <li><a href="#boucles" id="toc-boucles" class="nav-link" data-scroll-target="#boucles"><span class="toc-section-number">17</span>  Boucles</a>
  <ul class="collapse">
  <li><a href="#boucles-imbriquées" id="toc-boucles-imbriquées" class="nav-link" data-scroll-target="#boucles-imbriquées"><span class="toc-section-number">17.1</span>  Boucles imbriquées</a></li>
  <li><a href="#boucles-imbriquées-second-exemple" id="toc-boucles-imbriquées-second-exemple" class="nav-link" data-scroll-target="#boucles-imbriquées-second-exemple"><span class="toc-section-number">17.2</span>  Boucles imbriquées (second exemple)</a></li>
  <li><a href="#boucles-for" id="toc-boucles-for" class="nav-link" data-scroll-target="#boucles-for"><span class="toc-section-number">17.3</span>  Boucles for</a></li>
  <li><a href="#boucles-for-second-exemple" id="toc-boucles-for-second-exemple" class="nav-link" data-scroll-target="#boucles-for-second-exemple"><span class="toc-section-number">17.4</span>  Boucles for (second exemple)</a></li>
  <li><a href="#autres-transcriptions-de-fonctions-sas-vers-r" id="toc-autres-transcriptions-de-fonctions-sas-vers-r" class="nav-link" data-scroll-target="#autres-transcriptions-de-fonctions-sas-vers-r"><span class="toc-section-number">17.5</span>  Autres transcriptions de fonctions SAS vers R</a></li>
  </ul></li>
  <li><a href="#débogage" id="toc-débogage" class="nav-link" data-scroll-target="#débogage"><span class="toc-section-number">18</span>  Débogage</a>
  <ul class="collapse">
  <li><a href="#outils-daide-au-débogage" id="toc-outils-daide-au-débogage" class="nav-link" data-scroll-target="#outils-daide-au-débogage"><span class="toc-section-number">18.1</span>  Outils d’aide au débogage</a></li>
  </ul></li>
  <li><a href="#points-de-vigilance-en-sas" id="toc-points-de-vigilance-en-sas" class="nav-link" data-scroll-target="#points-de-vigilance-en-sas"><span class="toc-section-number">19</span>  Points de vigilance en SAS</a>
  <ul class="collapse">
  <li><a href="#emploi-des-guillemets-et-double-guillemets" id="toc-emploi-des-guillemets-et-double-guillemets" class="nav-link" data-scroll-target="#emploi-des-guillemets-et-double-guillemets"><span class="toc-section-number">19.1</span>  Emploi des guillemets et double guillemets</a></li>
  <li><a href="#macro-variable-définie-avec-un-statut-global-avant-son-appel-dans-le-cadre-dun-statut-local" id="toc-macro-variable-définie-avec-un-statut-global-avant-son-appel-dans-le-cadre-dun-statut-local" class="nav-link" data-scroll-target="#macro-variable-définie-avec-un-statut-global-avant-son-appel-dans-le-cadre-dun-statut-local"><span class="toc-section-number">19.2</span>  Macro-variable définie avec un statut global avant son appel dans le cadre d’un statut local</a></li>
  </ul></li>
  <li><a href="#fin-du-programme" id="toc-fin-du-programme" class="nav-link" data-scroll-target="#fin-du-programme"><span class="toc-section-number">20</span>  Fin du programme</a>
  <ul class="collapse">
  <li><a href="#taille-des-objets-en-mémoire" id="toc-taille-des-objets-en-mémoire" class="nav-link" data-scroll-target="#taille-des-objets-en-mémoire"><span class="toc-section-number">20.1</span>  Taille des objets en mémoire</a></li>
  <li><a href="#supprimer-des-bases" id="toc-supprimer-des-bases" class="nav-link" data-scroll-target="#supprimer-des-bases"><span class="toc-section-number">20.2</span>  Supprimer des bases</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Aide-mémoire <code>SAS</code> - <code>R</code></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">SAS</div>
    <div class="quarto-category">R</div>
  </div>
  </div>

<div>
  <div class="description">
    <p>Un aide-mémoire pour les statisticiens traduisant des codes standards en <code>SAS</code> et en <code>R</code>, suivant 4 environnements (<code>R-Base</code>, <code>Tidyverse</code>, <code>data.table</code>, <code>Arrow / DuckDb</code>).</p>
  </div>
</div>

<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Auteur·rice·s</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    Nassab ABDALLAH 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Dares/SCS, <a href="mailto:nassab.abdallah@travail.gouv.fr" class="email">nassab.abdallah@travail.gouv.fr</a>
          </p>
      </div>
      <div class="quarto-title-meta-contents">
    Damien EUZENAT 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Dares/DIP, <a href="mailto:damien.euzenat@travail.gouv.fr" class="email">damien.euzenat@travail.gouv.fr</a>
          </p>
      </div>
      <div class="quarto-title-meta-contents">
    Sébastien LI-THIAO-TE 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Dares/DFA, <a href="mailto:sebastien.li-thiao-te@travail.gouv.fr" class="email">sebastien.li-thiao-te@travail.gouv.fr</a>
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Date de publication</div>
    <div class="quarto-title-meta-contents">
      <p class="date">28 mai 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modifié</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">24 mai 2024</p>
    </div>
  </div>
    
  </div>
  

</header>

<p>L’aide-mémoire a pour but de fournir des codes écrits en <code>SAS</code> et d’en donner la traduction en <code>R</code> de différentes manières possibles :</p>
<ul>
<li><p><code>base R</code></p></li>
<li><p><code>tidyverse</code></p></li>
<li><p><code>data.table</code></p></li>
<li><p><code>arrow/duckdb</code></p></li>
</ul>
<p>Les codes traduits sont typiques de la production statistique ou la réalisation d’études descriptives.</p>
<p>Ce document s’adresse notamment aux utilisateurs de <code>SAS</code> qui veulent connaître la traduction du code <code>SAS</code> en <code>R</code>, aux utilisateurs de <code>R</code> qui ont besoin de comprendre le code <code>SAS</code>, ainsi qu’aux utilisateurs d’un environnement <code>R</code> qui sont intéressés par la traduction dans un autre environnement <code>R</code>.</p>
<p>Il se veut complémentaire de la documentation en ligne en français Utilit’R, née à l’Insee (<a href="https://www.book.utilitr.org/" class="uri">https://www.book.utilitr.org/</a>). Le lecteur est invité à s’y référer pour obtenir des informations importantes sur l’utilisation de <code>R</code> et qui ne sont pas discutées dans ce document, comme l’importation de données en <code>R</code> (<a href="https://www.book.utilitr.org/03_fiches_thematiques/fiche_import_fichiers_plats" class="uri">https://www.book.utilitr.org/03_fiches_thematiques/fiche_import_fichiers_plats</a>).</p>
<p>Enfin, si vous souhaitez collaborer à cet aide-mémoire ou nous faire part de votre avis, n’hésitez pas à nous contacter via nos adresses email.</p>
<section id="importation-des-packages" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Importation des packages</h1>
<section id="importation-des-packages-1" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="importation-des-packages-1"><span class="header-section-number">1.1</span> Importation des packages</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-1-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="sourceCode" id="cb1"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Sans objet pour SAS */</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-1-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sans objet pour R-Base</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Cependant, on importe le package lubridate pour faciliter la gestion des dates</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Les packages doivent au préalable être installés sur le disque dur</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour installer un package :</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("nom_du_package")</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour manipuler les dates</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Les packages doivent au préalable être installés sur le disque dur</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour installer un package :</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("nom_du_package")</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Chargement des packages</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour manipuler les dates</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour utiliser le pipe %&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Le tidyverse proprement dit</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Les packages importés par le tidyverse sont :</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># - dplyr (manipulation de données)</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co"># - tidyr (réorganisation de bases de données)</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># - readr (importation de données)</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># - purrr (permet de réaliser des boucles)</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co"># - tibble (format de données tibble, complémentaire du data.frame)</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># - stringr (manipulation de chaînes de caractères)</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co"># - ggplot2 (création de graphiques)</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co"># - forcats (gestion des formats "factors")</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Documentation de tidyverse</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="fu">vignette</span>(<span class="st">"dplyr"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Les packages doivent au préalable être installés sur le disque dur</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour installer un package :</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("nom_du_package")</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Documentation de data.table</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>?<span class="st">'[.data.table'</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour manipuler les dates</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(duckdb)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(arrow)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="importation-des-données" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Importation des données</h1>
<section id="mode-demploi-de-laide-mémoire" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="mode-demploi-de-laide-mémoire"><span class="header-section-number">2.1</span> Mode d’emploi de l’aide-mémoire</h2>
<p>Les codes informatiques sont appliqués sur une base de données illustrative fictive. Cette base est importée à cette étape. Aussi, pour répliquer les codes sur sa machine, le lecteur doit d’abord exécuter le code d’importation de la base de données ci-dessous.</p>
<p>Les codes sont majoritairement exécutables indépendamment les uns des autres.</p>
</section>
<section id="création-dune-base-de-données-sas-dexemple" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="création-dune-base-de-données-sas-dexemple"><span class="header-section-number">2.2</span> Création d’une base de données SAS d’exemple</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-2-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="sourceCode" id="cb6"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Données fictives sur des formations */</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">infile</span> <span class="kw">cards</span> dsd dlm=<span class="st">'|'</span>;</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Identifiant $<span class="dv">3</span>. Sexe <span class="dv">1</span>. CSP $<span class="dv">1</span>. Niveau $<span class="dv">30</span>. Date_naissance ddmmyy10. Date_entree ddmmyy10. Duree Note_Contenu Note_Formateur Note_Moyens</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>         Note_Accompagnement Note_Materiel poids_sondage <span class="dv">4.1</span> CSPF $<span class="dv">25</span>. Sexef $<span class="dv">5</span>.;</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">input</span> Identifiant $ Sexe CSP $ Niveau $ Date_naissance :ddmmyy10. Date_entree :ddmmyy10. Duree Note_Contenu Note_Formateur Note_Moyens</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        Note_Accompagnement Note_Materiel poids_sondage CSPF $ Sexef $;</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">cards</span>;</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="dv">173</span>|<span class="dv">2</span>|<span class="dv">1</span>|Qualifié|<span class="dv">17</span>/<span class="dv">06</span>/<span class="dv">1998</span>|<span class="dv">01</span>/<span class="dv">01</span>/<span class="dv">2021</span>|<span class="dv">308</span>|<span class="dv">12</span>|<span class="dv">6</span>|<span class="dv">17</span>|<span class="dv">4</span>|<span class="dv">19</span>|<span class="dv">117.1</span>|Cadre|Femme</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="dv">173</span>|<span class="dv">2</span>|<span class="dv">1</span>|Qualifié|<span class="dv">17</span>/<span class="dv">06</span>/<span class="dv">1998</span>|<span class="dv">01</span>/<span class="dv">01</span>/<span class="dv">2022</span>|<span class="dv">365</span>|<span class="dv">6</span>||<span class="dv">12</span>|<span class="dv">7</span>|<span class="dv">14</span>|<span class="dv">98.3</span>|Cadre|Femme</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="dv">173</span>|<span class="dv">2</span>|<span class="dv">1</span>|Qualifié|<span class="dv">17</span>/<span class="dv">06</span>/<span class="dv">1998</span>|<span class="dv">06</span>/<span class="dv">01</span>/<span class="dv">2022</span>|<span class="dv">185</span>|<span class="dv">8</span>|<span class="dv">10</span>|<span class="dv">11</span>|<span class="dv">1</span>|<span class="dv">9</span>|<span class="dv">214.6</span>|Cadre|Femme</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="dv">173</span>|<span class="dv">2</span>|<span class="dv">1</span>|Non qualifié|<span class="dv">17</span>/<span class="dv">06</span>/<span class="dv">1998</span>|<span class="dv">02</span>/<span class="dv">01</span>/<span class="dv">2023</span>|<span class="dv">365</span>|<span class="dv">14</span>|<span class="dv">15</span>|<span class="dv">15</span>|<span class="dv">10</span>|<span class="dv">8</span>|<span class="dv">84.7</span>|Cadre|Femme</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="dv">174</span>|<span class="dv">1</span>|<span class="dv">1</span>|Qualifié|<span class="dv">08</span>/<span class="dv">12</span>/<span class="dv">1984</span>|<span class="dv">17</span>/<span class="dv">08</span>/<span class="dv">2021</span>|<span class="dv">183</span>|<span class="dv">17</span>|<span class="dv">18</span>|<span class="dv">20</span>|<span class="dv">15</span>|<span class="dv">12</span>|<span class="dv">65.9</span>|Cadre|Homme</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="dv">175</span>|<span class="dv">1</span>|<span class="dv">1</span>|Qualifié|<span class="dv">16</span>/<span class="dv">09</span>/<span class="dv">1989</span>|<span class="dv">21</span>/<span class="dv">12</span>/<span class="dv">2022</span>|<span class="dv">730</span>|<span class="dv">5</span>|<span class="dv">5</span>|<span class="dv">8</span>|<span class="dv">4</span>|<span class="dv">9</span>|<span class="dv">148.2</span>|Cadre|Homme</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="dv">198</span>|<span class="dv">2</span>|<span class="dv">3</span>|Non qualifié|<span class="dv">17</span>/<span class="dv">03</span>/<span class="dv">1987</span>|<span class="dv">28</span>/<span class="dv">07</span>/<span class="dv">2022</span>|<span class="dv">30</span>|<span class="dv">10</span>|<span class="dv">10</span>|<span class="dv">10</span>|<span class="dv">16</span>|<span class="dv">8</span>|<span class="dv">89.6</span>|Employé|Femme</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="dv">198</span>|<span class="dv">2</span>|<span class="dv">3</span>|Qualifié|<span class="dv">17</span>/<span class="dv">03</span>/<span class="dv">1987</span>|<span class="dv">17</span>/<span class="dv">11</span>/<span class="dv">2022</span>|<span class="dv">164</span>|<span class="dv">11</span>|<span class="dv">7</span>|<span class="dv">6</span>|<span class="dv">14</span>|<span class="dv">13</span>|<span class="dv">100.3</span>|Employé|Femme</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="dv">198</span>|<span class="dv">2</span>|<span class="dv">3</span>|Qualifié|<span class="dv">17</span>/<span class="dv">03</span>/<span class="dv">1987</span>|<span class="dv">21</span>/<span class="dv">02</span>/<span class="dv">2023</span>|<span class="dv">365</span>|<span class="dv">9</span>|<span class="dv">20</span>|<span class="dv">3</span>|<span class="dv">4</span>|<span class="dv">17</span>|<span class="dv">49.3</span>|Employé|Femme</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="dv">168</span>|<span class="dv">1</span>|<span class="dv">2</span>|Qualifié|<span class="dv">30</span>/<span class="dv">07</span>/<span class="dv">2002</span>|<span class="dv">04</span>/<span class="dv">09</span>/<span class="dv">2019</span>|<span class="dv">365</span>|<span class="dv">18</span>|<span class="dv">11</span>|<span class="dv">20</span>|<span class="dv">13</span>|<span class="dv">15</span>|<span class="dv">148.2</span>|Profession intermédiaire|Homme</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="dv">211</span>|<span class="dv">2</span>|<span class="dv">3</span>|Non qualifié||<span class="dv">17</span>/<span class="dv">12</span>/<span class="dv">2021</span>|<span class="dv">135</span>|<span class="dv">16</span>|<span class="dv">16</span>|<span class="dv">15</span>|<span class="dv">12</span>|<span class="dv">9</span>|<span class="dv">86.4</span>|Employé|Femme</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="dv">278</span>|<span class="dv">1</span>|<span class="dv">5</span>|Qualifié|<span class="dv">10</span>/<span class="dv">08</span>/<span class="dv">1948</span>|<span class="dv">07</span>/<span class="dv">06</span>/<span class="dv">2018</span>|<span class="dv">365</span>|<span class="dv">14</span>|<span class="dv">10</span>|<span class="dv">6</span>|<span class="dv">8</span>|<span class="dv">12</span>|<span class="dv">99.2</span>|Retraité|Homme</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="dv">347</span>|<span class="dv">2</span>|<span class="dv">5</span>|Qualifié|<span class="dv">13</span>/<span class="dv">09</span>/<span class="dv">1955</span>||<span class="dv">180</span>|<span class="dv">12</span>|<span class="dv">5</span>|<span class="dv">7</span>|<span class="dv">11</span>|<span class="dv">12</span>|<span class="dv">105.6</span>|Retraité|Femme</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="dv">112</span>|<span class="dv">1</span>|<span class="dv">3</span>|Non qualifié|<span class="dv">13</span>/<span class="dv">09</span>/<span class="dv">2001</span>|<span class="dv">02</span>/<span class="dv">03</span>/<span class="dv">2022</span>|<span class="dv">212</span>|<span class="dv">3</span>|<span class="dv">10</span>|<span class="dv">11</span>|<span class="dv">9</span>|<span class="dv">8</span>|<span class="dv">123.1</span>|Employé|Homme</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="dv">112</span>|<span class="dv">1</span>|<span class="dv">3</span>|Non qualifié|<span class="dv">13</span>/<span class="dv">09</span>/<span class="dv">2001</span>|<span class="dv">01</span>/<span class="dv">03</span>/<span class="dv">2021</span>|<span class="dv">365</span>|<span class="dv">7</span>|<span class="dv">13</span>|<span class="dv">8</span>|<span class="dv">19</span>|<span class="dv">2</span>|<span class="dv">137.4</span>|Employé|Homme</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  <span class="dv">112</span>|<span class="dv">1</span>|<span class="dv">3</span>|Qualifié|<span class="dv">13</span>/<span class="dv">09</span>/<span class="dv">2001</span>|<span class="dv">01</span>/<span class="dv">12</span>/<span class="dv">2023</span>|<span class="dv">365</span>|<span class="dv">9</span>|||||<span class="dv">187.6</span>|Employé|Homme</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  <span class="dv">087</span>|<span class="dv">2</span>|<span class="dv">4</span>|Non qualifié|||<span class="dv">365</span>||<span class="dv">10</span>||||<span class="dv">87.3</span>|Ouvrier|Femme</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="dv">087</span>|<span class="dv">2</span>|<span class="dv">4</span>|Non qualifié||<span class="dv">31</span>/<span class="dv">10</span>/<span class="dv">2020</span>|<span class="dv">365</span>|||<span class="dv">11</span>|||<span class="dv">87.3</span>|Ouvrier|Femme</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="dv">099</span>|<span class="dv">1</span>|<span class="dv">4</span>|Qualifié|<span class="dv">06</span>/<span class="dv">06</span>/<span class="dv">1998</span>|<span class="dv">01</span>/<span class="dv">03</span>/<span class="dv">2021</span>|<span class="dv">364</span>|<span class="dv">12</span>|<span class="dv">11</span>|<span class="dv">10</span>|<span class="dv">12</span>|<span class="dv">13</span>|<span class="dv">169.3</span>|Ouvrier|Homme</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="dv">099</span>|<span class="dv">1</span>|<span class="dv">4</span>|Qualifié|<span class="dv">06</span>/<span class="dv">06</span>/<span class="dv">1998</span>|<span class="dv">01</span>/<span class="dv">03</span>/<span class="dv">2022</span>|<span class="dv">364</span>|<span class="dv">12</span>|<span class="dv">11</span>|<span class="dv">10</span>|<span class="dv">12</span>|<span class="dv">13</span>|<span class="dv">169.3</span>|Ouvrier|Homme</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  <span class="dv">099</span>|<span class="dv">1</span>|<span class="dv">4</span>|Qualifié|<span class="dv">06</span>/<span class="dv">06</span>/<span class="dv">1998</span>|<span class="dv">01</span>/<span class="dv">03</span>/<span class="dv">2023</span>|<span class="dv">364</span>|<span class="dv">12</span>|<span class="dv">11</span>|<span class="dv">10</span>|<span class="dv">12</span>|<span class="dv">13</span>|<span class="dv">169.3</span>|Ouvrier|Homme</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  <span class="dv">187</span>|<span class="dv">2</span>|<span class="dv">2</span>|Qualifié|<span class="dv">05</span>/<span class="dv">12</span>/<span class="dv">1986</span>|<span class="dv">01</span>/<span class="dv">01</span>/<span class="dv">2022</span>|<span class="dv">364</span>|<span class="dv">10</span>|<span class="dv">10</span>|<span class="dv">10</span>|<span class="dv">10</span>|<span class="dv">10</span>|<span class="dv">169.3</span>|Profession intermédiaire|Femme</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  <span class="dv">187</span>|<span class="dv">2</span>|<span class="dv">2</span>|Qualifié|<span class="dv">05</span>/<span class="dv">12</span>/<span class="dv">1986</span>|<span class="dv">01</span>/<span class="dv">01</span>/<span class="dv">2023</span>|<span class="dv">364</span>|<span class="dv">10</span>|<span class="dv">10</span>|<span class="dv">10</span>|<span class="dv">10</span>|<span class="dv">10</span>|<span class="dv">234.1</span>|Profession intermédiaire|Femme</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  <span class="dv">689</span>|<span class="dv">1</span>|<span class="dv">1</span>||<span class="dv">01</span>/<span class="dv">12</span>/<span class="dv">2000</span>|<span class="dv">06</span>/<span class="dv">11</span>/<span class="dv">2017</span>|<span class="dv">123</span>|<span class="dv">9</span>|<span class="dv">7</span>|<span class="dv">8</span>|<span class="dv">13</span>|<span class="dv">16</span>|<span class="dv">189.3</span>|Cadre|Homme</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  <span class="dv">765</span>|<span class="dv">1</span>|<span class="dv">4</span>|Non qualifié|<span class="dv">26</span>/<span class="dv">12</span>/<span class="dv">1995</span>|<span class="dv">17</span>/<span class="dv">04</span>/<span class="dv">2020</span>|<span class="dv">160</span>|<span class="dv">13</span>|<span class="dv">10</span>|<span class="dv">12</span>|<span class="dv">18</span>|<span class="dv">10</span>|<span class="dv">45.9</span>|Ouvrier|Homme</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  <span class="dv">765</span>|<span class="dv">1</span>|<span class="dv">4</span>|Non qualifié|<span class="dv">26</span>/<span class="dv">12</span>/<span class="dv">1995</span>|<span class="dv">17</span>/<span class="dv">04</span>/<span class="dv">2020</span>|<span class="dv">160</span>|<span class="dv">13</span>|<span class="dv">10</span>|<span class="dv">12</span>|<span class="dv">18</span>|<span class="dv">10</span>|<span class="dv">45.9</span>|Ouvrier|Homme</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>  <span class="dv">765</span>|<span class="dv">1</span>|<span class="dv">4</span>|Non qualifié|<span class="dv">26</span>/<span class="dv">12</span>/<span class="dv">1995</span>|<span class="dv">17</span>/<span class="dv">04</span>/<span class="dv">2020</span>|<span class="dv">160</span>|<span class="dv">13</span>|<span class="dv">10</span>|<span class="dv">12</span>|<span class="dv">18</span>|<span class="dv">10</span>|<span class="dv">45.9</span>|Ouvrier|Homme</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  ;</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="co">/* Date de sortie du dispositif : ajout de la durée à la date d'entrée */</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> date_sortie ddmmyy10.;</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>  date_sortie = <span class="fu">intnx</span>(<span class="st">'day'</span>, date_entree, duree);</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-2-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Données fictives sur des formations</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Identifiant =</span> <span class="fu">c</span>(<span class="st">"173"</span>, <span class="st">"173"</span>, <span class="st">"173"</span>, <span class="st">"173"</span>, <span class="st">"174"</span>, <span class="st">"175"</span>, <span class="st">"198"</span>, <span class="st">"198"</span>, <span class="st">"198"</span>, <span class="st">"168"</span>, <span class="st">"211"</span>, <span class="st">"278"</span>, <span class="st">"347"</span>, <span class="st">"112"</span>, <span class="st">"112"</span>, <span class="st">"112"</span>, <span class="st">"087"</span>, <span class="st">"087"</span>, <span class="st">"099"</span>, <span class="st">"099"</span>, <span class="st">"099"</span>, <span class="st">"187"</span>, <span class="st">"187"</span>, <span class="st">"689"</span>, <span class="st">"765"</span>, <span class="st">"765"</span>, <span class="st">"765"</span>),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sexe =</span> <span class="fu">c</span>(<span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">CSP =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"3"</span>, <span class="st">"3"</span>, <span class="st">"3"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"5"</span>, <span class="st">"5"</span>, <span class="st">"3"</span>, <span class="st">"3"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"4"</span>, <span class="st">"4"</span>, <span class="st">"4"</span>, <span class="st">"4"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"4"</span>, <span class="st">"4"</span>, <span class="st">"4"</span>),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Niveau =</span> <span class="fu">c</span>(<span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Non qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Non qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Non qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Non qualifié"</span>, </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Non qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Non qualifié"</span>, <span class="st">"Non qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="cn">NA</span>, <span class="st">"Non qualifié"</span>, <span class="st">"Non qualifié"</span>, <span class="st">"Non qualifié"</span>),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date_naissance =</span> <span class="fu">c</span>(<span class="st">"17/06/1998"</span>, <span class="st">"17/06/1998"</span>, <span class="st">"17/06/1998"</span>, <span class="st">"17/06/1998"</span>, <span class="st">"08/12/1984"</span>, <span class="st">"16/09/1989"</span>, <span class="st">"17/03/1987"</span>, <span class="st">"17/03/1987"</span>, <span class="st">"17/03/1987"</span>, <span class="st">"30/07/2002"</span>, <span class="cn">NA</span>, <span class="st">"10/08/1948"</span>, </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"13/09/1955"</span>, <span class="st">"13/09/2001"</span>, <span class="st">"13/09/2001"</span>, <span class="st">"13/09/2001"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"06/06/1998"</span>, <span class="st">"06/06/1998"</span>, <span class="st">"06/06/1998"</span>, <span class="st">"05/12/1986"</span>, <span class="st">"05/12/1986"</span>, <span class="st">"01/12/2000"</span>, <span class="st">"26/12/1995"</span>, <span class="st">"26/12/1995"</span>, <span class="st">"26/12/1995"</span>),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date_entree =</span> <span class="fu">c</span>(<span class="st">"01/01/2021"</span>, <span class="st">"01/01/2022"</span>, <span class="st">"06/01/2022"</span>, <span class="st">"02/01/2023"</span>, <span class="st">"17/08/2021"</span>, <span class="st">"21/12/2022"</span>, <span class="st">"28/07/2022"</span>, <span class="st">"17/11/2022"</span>, <span class="st">"21/02/2023"</span>, <span class="st">"04/09/2019"</span>, <span class="st">"17/12/2021"</span>, <span class="st">"07/06/2018"</span>, <span class="cn">NA</span>, <span class="st">"02/03/2022"</span>, <span class="st">"01/03/2021"</span>, <span class="st">"01/12/2023"</span>, <span class="cn">NA</span>, </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"31/10/2020"</span>, <span class="st">"01/03/2021"</span>, <span class="st">"01/03/2022"</span>, <span class="st">"01/03/2023"</span>, <span class="st">"01/01/2022"</span>, <span class="st">"01/01/2023"</span>, <span class="st">"06/11/2017"</span>, <span class="st">"17/04/2020"</span>, <span class="st">"17/04/2020"</span>, <span class="st">"17/04/2020"</span>),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Duree =</span> <span class="fu">c</span>(<span class="st">"308"</span>, <span class="st">"365"</span>, <span class="st">"185"</span>, <span class="st">"365"</span>, <span class="st">"183"</span>, <span class="st">"730"</span>, <span class="st">"30"</span>, <span class="st">"164"</span>, <span class="st">"365"</span>, <span class="st">"365"</span>, <span class="st">"135"</span>, <span class="st">"365"</span>, <span class="st">"180"</span>, <span class="st">"212"</span>, <span class="st">"365"</span>, <span class="st">"365"</span>, <span class="st">"365"</span>, <span class="st">"365"</span>, <span class="st">"364"</span>, <span class="st">"364"</span>, <span class="st">"364"</span>, <span class="st">"364"</span>, <span class="st">"364"</span>, <span class="st">"123"</span>, <span class="st">"160"</span>, <span class="st">"160"</span>, <span class="st">"160"</span>),</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Note_Contenu =</span> <span class="fu">c</span>(<span class="st">"12"</span>, <span class="st">"6"</span>, <span class="st">"8"</span>, <span class="st">"14"</span>, <span class="st">"17"</span>, <span class="st">"5"</span>, <span class="st">"10"</span>, <span class="st">"11"</span>, <span class="st">"9"</span>, <span class="st">"18"</span>, <span class="st">"16"</span>, <span class="st">"14"</span>, <span class="st">"12"</span>, <span class="st">"3"</span>, <span class="st">"7"</span>, <span class="st">"9"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"12"</span>, <span class="st">"12"</span>, <span class="st">"12"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"9"</span>, <span class="st">"13"</span>, <span class="st">"13"</span>, <span class="st">"13"</span>),</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Note_Formateur =</span> <span class="fu">c</span>(<span class="st">"6"</span>, <span class="cn">NA</span>, <span class="st">"10"</span>, <span class="st">"15"</span>, <span class="st">"18"</span>, <span class="st">"5"</span>, <span class="st">"10"</span>, <span class="st">"7"</span>, <span class="st">"20"</span>, <span class="st">"11"</span>, <span class="st">"16"</span>, <span class="st">"10"</span>, <span class="st">"5"</span>, <span class="st">"10"</span>, <span class="st">"13"</span>, <span class="cn">NA</span>, <span class="st">"10"</span>, <span class="cn">NA</span>, <span class="st">"11"</span>, <span class="st">"11"</span>, <span class="st">"11"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"7"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>),</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Note_Moyens =</span> <span class="fu">c</span>(<span class="st">"17"</span>, <span class="st">"12"</span>, <span class="st">"11"</span>, <span class="st">"15"</span>, <span class="st">"20"</span>, <span class="st">"8"</span>, <span class="st">"10"</span>, <span class="st">"6"</span>, <span class="st">"3"</span>, <span class="st">"20"</span>, <span class="st">"15"</span>, <span class="st">"6"</span>, <span class="st">"7"</span>, <span class="st">"11"</span>, <span class="st">"8"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"11"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"8"</span>, <span class="st">"12"</span>, <span class="st">"12"</span>, <span class="st">"12"</span>),</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Note_Accompagnement =</span> <span class="fu">c</span>(<span class="st">"4"</span>, <span class="st">"7"</span>, <span class="st">"1"</span>, <span class="st">"10"</span>, <span class="st">"15"</span>, <span class="st">"4"</span>, <span class="st">"16"</span>, <span class="st">"14"</span>, <span class="st">"4"</span>, <span class="st">"13"</span>, <span class="st">"12"</span>, <span class="st">"8"</span>, <span class="st">"11"</span>, <span class="st">"9"</span>, <span class="st">"19"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"12"</span>, <span class="st">"12"</span>, <span class="st">"12"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"13"</span>, <span class="st">"18"</span>, <span class="st">"18"</span>, <span class="st">"18"</span>),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Note_Materiel =</span> <span class="fu">c</span>(<span class="st">"19"</span>, <span class="st">"14"</span>, <span class="st">"9"</span>, <span class="st">"8"</span>, <span class="st">"12"</span>, <span class="st">"9"</span>, <span class="st">"8"</span>, <span class="st">"13"</span>, <span class="st">"17"</span>, <span class="st">"15"</span>, <span class="st">"9"</span>, <span class="st">"12"</span>, <span class="st">"12"</span>, <span class="st">"8"</span>, <span class="st">"2"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"13"</span>, <span class="st">"13"</span>, <span class="st">"13"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"16"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>),</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">poids_sondage =</span> <span class="fu">c</span>(<span class="st">"117.1"</span>, <span class="st">"98.3"</span>, <span class="st">"214.6"</span>, <span class="st">"84.7"</span>, <span class="st">"65.9"</span>, <span class="st">"148.2"</span>, <span class="st">"89.6"</span>, <span class="st">"100.3"</span>, <span class="st">"49.3"</span>, <span class="st">"148.2"</span>, <span class="st">"86.4"</span>, <span class="st">"99.2"</span>, <span class="st">"105.6"</span>, <span class="st">"123.1"</span>, <span class="st">"137.4"</span>, <span class="st">"187.6"</span>, <span class="st">"87.3"</span>, <span class="st">"87.3"</span>,</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"169.3"</span>, <span class="st">"169.3"</span>, <span class="st">"169.3"</span>, <span class="st">"169.3"</span>, <span class="st">"234.1"</span>, <span class="st">"189.3"</span>, <span class="st">"45.9"</span>, <span class="st">"45.9"</span>, <span class="st">"45.9"</span>),</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">CSPF =</span> <span class="fu">c</span>(<span class="st">"Cadre"</span>, <span class="st">"Cadre"</span>, <span class="st">"Cadre"</span>, <span class="st">"Cadre"</span>, <span class="st">"Cadre"</span>,<span class="st">"Cadre"</span>, <span class="st">"Employé"</span>, <span class="st">"Employé"</span>, <span class="st">"Employé"</span>, <span class="st">"Profession intermédiaire"</span>, <span class="st">"Employé"</span>, <span class="st">"Retraité"</span>, <span class="st">"Retraité"</span>, <span class="st">"Employé"</span>,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Employé"</span>, <span class="st">"Employé"</span>, <span class="st">"Ouvrier"</span>, <span class="st">"Ouvrier"</span>, <span class="st">"Ouvrier"</span>, <span class="st">"Ouvrier"</span>, <span class="st">"Ouvrier"</span>, <span class="st">"Profession intermédiaire"</span>, <span class="st">"Profession intermédiaire"</span>, <span class="st">"Cadre"</span>, <span class="st">"Ouvrier"</span>, <span class="st">"Ouvrier"</span>,</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Ouvrier"</span>),</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sexef =</span> <span class="fu">c</span>(<span class="st">"Femme"</span>, <span class="st">"Femme"</span>, <span class="st">"Femme"</span>, <span class="st">"Femme"</span>, <span class="st">"Homme"</span>, <span class="st">"Homme"</span>, <span class="st">"Femme"</span>, <span class="st">"Femme"</span>, <span class="st">"Femme"</span>, <span class="st">"Homme"</span>, <span class="st">"Femme"</span>, <span class="st">"Homme"</span>, <span class="st">"Femme"</span>, <span class="st">"Homme"</span>, <span class="st">"Homme"</span>, <span class="st">"Homme"</span>, <span class="st">"Femme"</span>, <span class="st">"Femme"</span>,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Homme"</span>, <span class="st">"Homme"</span>, <span class="st">"Homme"</span>, <span class="st">"Femme"</span>, <span class="st">"Femme"</span>, <span class="st">"Homme"</span>, <span class="st">"Homme"</span>, <span class="st">"Homme"</span>, <span class="st">"Homme"</span>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Mise en forme des données</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="co"># On vérifie que la base importée est bien un data.frame</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="fu">is.data.frame</span>(donnees_rbase)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="co"># R est sensible à la casse, il est pertinent d'harmoniser les noms des variables en minuscule</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Renommer les colonnes de la base</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(donnees_rbase) <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">colnames</span>(donnees_rbase))</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre possibilité</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="fu">setNames</span>(donnees_rbase, <span class="fu">tolower</span>(<span class="fu">names</span>(donnees_rbase)))</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="co"># On a importé toutes les variables en format caractère</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="co"># On convertit certaines variables en format numérique</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>enNumerique <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"duree"</span>, <span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>donnees_rbase[, enNumerique] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(donnees_rbase[, enNumerique], as.integer)</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>poids_sondage <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(donnees_rbase<span class="sc">$</span>poids_sondage)</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a><span class="co"># On récupère les variables dont le nom débute par le mot "date"</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>enDate <span class="ot">&lt;-</span> <span class="fu">names</span>(donnees_rbase)[<span class="fu">grepl</span>(<span class="st">"date"</span>, <span class="fu">tolower</span>(<span class="fu">names</span>(donnees_rbase)))]</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a><span class="co"># On remplace / par - dans les dates</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>donnees_rbase[, enDate] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(donnees_rbase[, enDate], <span class="cf">function</span>(x) <span class="fu">gsub</span>(<span class="st">"/"</span>, <span class="st">"-"</span>, x))</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a><span class="co"># On exprime les dates en format Date</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>donnees_rbase[, enDate] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(donnees_rbase[, enDate], lubridate<span class="sc">::</span>dmy)</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Date de sortie du dispositif</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>date_sortie <span class="ot">&lt;-</span> donnees_rbase<span class="sc">$</span>date_entree <span class="sc">+</span> lubridate<span class="sc">::</span><span class="fu">days</span>(donnees_rbase<span class="sc">$</span>duree)</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Format de la base</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(donnees_rbase)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Données fictives sur des formations</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution !</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Identifiant =</span> <span class="fu">c</span>(<span class="st">"173"</span>, <span class="st">"173"</span>, <span class="st">"173"</span>, <span class="st">"173"</span>, <span class="st">"174"</span>, <span class="st">"175"</span>, <span class="st">"198"</span>, <span class="st">"198"</span>, <span class="st">"198"</span>, <span class="st">"168"</span>, <span class="st">"211"</span>, <span class="st">"278"</span>, <span class="st">"347"</span>, <span class="st">"112"</span>, <span class="st">"112"</span>, <span class="st">"112"</span>, <span class="st">"087"</span>, <span class="st">"087"</span>, <span class="st">"099"</span>, <span class="st">"099"</span>, <span class="st">"099"</span>, <span class="st">"187"</span>, <span class="st">"187"</span>, <span class="st">"689"</span>, <span class="st">"765"</span>, <span class="st">"765"</span>, <span class="st">"765"</span>),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sexe =</span> <span class="fu">c</span>(<span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">CSP =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"3"</span>, <span class="st">"3"</span>, <span class="st">"3"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"5"</span>, <span class="st">"5"</span>, <span class="st">"3"</span>, <span class="st">"3"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"4"</span>, <span class="st">"4"</span>, <span class="st">"4"</span>, <span class="st">"4"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"4"</span>, <span class="st">"4"</span>, <span class="st">"4"</span>),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Niveau =</span> <span class="fu">c</span>(<span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Non qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Non qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Non qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Non qualifié"</span>, </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Non qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Non qualifié"</span>, <span class="st">"Non qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="cn">NA</span>, <span class="st">"Non qualifié"</span>, <span class="st">"Non qualifié"</span>, <span class="st">"Non qualifié"</span>),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date_naissance =</span> <span class="fu">c</span>(<span class="st">"17/06/1998"</span>, <span class="st">"17/06/1998"</span>, <span class="st">"17/06/1998"</span>, <span class="st">"17/06/1998"</span>, <span class="st">"08/12/1984"</span>, <span class="st">"16/09/1989"</span>, <span class="st">"17/03/1987"</span>, <span class="st">"17/03/1987"</span>, <span class="st">"17/03/1987"</span>, <span class="st">"30/07/2002"</span>, <span class="cn">NA</span>, <span class="st">"10/08/1948"</span>, </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"13/09/1955"</span>, <span class="st">"13/09/2001"</span>, <span class="st">"13/09/2001"</span>, <span class="st">"13/09/2001"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"06/06/1998"</span>, <span class="st">"06/06/1998"</span>, <span class="st">"06/06/1998"</span>, <span class="st">"05/12/1986"</span>, <span class="st">"05/12/1986"</span>, <span class="st">"01/12/2000"</span>, <span class="st">"26/12/1995"</span>, <span class="st">"26/12/1995"</span>, <span class="st">"26/12/1995"</span>),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date_entree =</span> <span class="fu">c</span>(<span class="st">"01/01/2021"</span>, <span class="st">"01/01/2022"</span>, <span class="st">"06/01/2022"</span>, <span class="st">"02/01/2023"</span>, <span class="st">"17/08/2021"</span>, <span class="st">"21/12/2022"</span>, <span class="st">"28/07/2022"</span>, <span class="st">"17/11/2022"</span>, <span class="st">"21/02/2023"</span>, <span class="st">"04/09/2019"</span>, <span class="st">"17/12/2021"</span>, <span class="st">"07/06/2018"</span>, <span class="cn">NA</span>, <span class="st">"02/03/2022"</span>, <span class="st">"01/03/2021"</span>, <span class="st">"01/12/2023"</span>, <span class="cn">NA</span>, </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"31/10/2020"</span>, <span class="st">"01/03/2021"</span>, <span class="st">"01/03/2022"</span>, <span class="st">"01/03/2023"</span>, <span class="st">"01/01/2022"</span>, <span class="st">"01/01/2023"</span>, <span class="st">"06/11/2017"</span>, <span class="st">"17/04/2020"</span>, <span class="st">"17/04/2020"</span>, <span class="st">"17/04/2020"</span>),</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Duree =</span> <span class="fu">c</span>(<span class="st">"308"</span>, <span class="st">"365"</span>, <span class="st">"185"</span>, <span class="st">"365"</span>, <span class="st">"183"</span>, <span class="st">"730"</span>, <span class="st">"30"</span>, <span class="st">"164"</span>, <span class="st">"365"</span>, <span class="st">"365"</span>, <span class="st">"135"</span>, <span class="st">"365"</span>, <span class="st">"180"</span>, <span class="st">"212"</span>, <span class="st">"365"</span>, <span class="st">"365"</span>, <span class="st">"365"</span>, <span class="st">"365"</span>, <span class="st">"364"</span>, <span class="st">"364"</span>, <span class="st">"364"</span>, <span class="st">"364"</span>, <span class="st">"364"</span>, <span class="st">"123"</span>, <span class="st">"160"</span>, <span class="st">"160"</span>, <span class="st">"160"</span>),</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Note_Contenu =</span> <span class="fu">c</span>(<span class="st">"12"</span>, <span class="st">"6"</span>, <span class="st">"8"</span>, <span class="st">"14"</span>, <span class="st">"17"</span>, <span class="st">"5"</span>, <span class="st">"10"</span>, <span class="st">"11"</span>, <span class="st">"9"</span>, <span class="st">"18"</span>, <span class="st">"16"</span>, <span class="st">"14"</span>, <span class="st">"12"</span>, <span class="st">"3"</span>, <span class="st">"7"</span>, <span class="st">"9"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"12"</span>, <span class="st">"12"</span>, <span class="st">"12"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"9"</span>, <span class="st">"13"</span>, <span class="st">"13"</span>, <span class="st">"13"</span>),</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Note_Formateur =</span> <span class="fu">c</span>(<span class="st">"6"</span>, <span class="cn">NA</span>, <span class="st">"10"</span>, <span class="st">"15"</span>, <span class="st">"18"</span>, <span class="st">"5"</span>, <span class="st">"10"</span>, <span class="st">"7"</span>, <span class="st">"20"</span>, <span class="st">"11"</span>, <span class="st">"16"</span>, <span class="st">"10"</span>, <span class="st">"5"</span>, <span class="st">"10"</span>, <span class="st">"13"</span>, <span class="cn">NA</span>, <span class="st">"10"</span>, <span class="cn">NA</span>, <span class="st">"11"</span>, <span class="st">"11"</span>, <span class="st">"11"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"7"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>),</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Note_Moyens =</span> <span class="fu">c</span>(<span class="st">"17"</span>, <span class="st">"12"</span>, <span class="st">"11"</span>, <span class="st">"15"</span>, <span class="st">"20"</span>, <span class="st">"8"</span>, <span class="st">"10"</span>, <span class="st">"6"</span>, <span class="st">"3"</span>, <span class="st">"20"</span>, <span class="st">"15"</span>, <span class="st">"6"</span>, <span class="st">"7"</span>, <span class="st">"11"</span>, <span class="st">"8"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"11"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"8"</span>, <span class="st">"12"</span>, <span class="st">"12"</span>, <span class="st">"12"</span>),</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Note_Accompagnement =</span> <span class="fu">c</span>(<span class="st">"4"</span>, <span class="st">"7"</span>, <span class="st">"1"</span>, <span class="st">"10"</span>, <span class="st">"15"</span>, <span class="st">"4"</span>, <span class="st">"16"</span>, <span class="st">"14"</span>, <span class="st">"4"</span>, <span class="st">"13"</span>, <span class="st">"12"</span>, <span class="st">"8"</span>, <span class="st">"11"</span>, <span class="st">"9"</span>, <span class="st">"19"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"12"</span>, <span class="st">"12"</span>, <span class="st">"12"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"13"</span>, <span class="st">"18"</span>, <span class="st">"18"</span>, <span class="st">"18"</span>),</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Note_Materiel =</span> <span class="fu">c</span>(<span class="st">"19"</span>, <span class="st">"14"</span>, <span class="st">"9"</span>, <span class="st">"8"</span>, <span class="st">"12"</span>, <span class="st">"9"</span>, <span class="st">"8"</span>, <span class="st">"13"</span>, <span class="st">"17"</span>, <span class="st">"15"</span>, <span class="st">"9"</span>, <span class="st">"12"</span>, <span class="st">"12"</span>, <span class="st">"8"</span>, <span class="st">"2"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"13"</span>, <span class="st">"13"</span>, <span class="st">"13"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"16"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>),</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">poids_sondage =</span> <span class="fu">c</span>(<span class="st">"117.1"</span>, <span class="st">"98.3"</span>, <span class="st">"214.6"</span>, <span class="st">"84.7"</span>, <span class="st">"65.9"</span>, <span class="st">"148.2"</span>, <span class="st">"89.6"</span>, <span class="st">"100.3"</span>, <span class="st">"49.3"</span>, <span class="st">"148.2"</span>, <span class="st">"86.4"</span>, <span class="st">"99.2"</span>, <span class="st">"105.6"</span>, <span class="st">"123.1"</span>, <span class="st">"137.4"</span>, <span class="st">"187.6"</span>, <span class="st">"87.3"</span>, <span class="st">"87.3"</span>,</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"169.3"</span>, <span class="st">"169.3"</span>, <span class="st">"169.3"</span>, <span class="st">"169.3"</span>, <span class="st">"234.1"</span>, <span class="st">"189.3"</span>, <span class="st">"45.9"</span>, <span class="st">"45.9"</span>, <span class="st">"45.9"</span>),</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">CSPF =</span> <span class="fu">c</span>(<span class="st">"Cadre"</span>, <span class="st">"Cadre"</span>, <span class="st">"Cadre"</span>, <span class="st">"Cadre"</span>, <span class="st">"Cadre"</span>,<span class="st">"Cadre"</span>, <span class="st">"Employé"</span>, <span class="st">"Employé"</span>, <span class="st">"Employé"</span>, <span class="st">"Profession intermédiaire"</span>, <span class="st">"Employé"</span>, <span class="st">"Retraité"</span>, <span class="st">"Retraité"</span>, <span class="st">"Employé"</span>,</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Employé"</span>, <span class="st">"Employé"</span>, <span class="st">"Ouvrier"</span>, <span class="st">"Ouvrier"</span>, <span class="st">"Ouvrier"</span>, <span class="st">"Ouvrier"</span>, <span class="st">"Ouvrier"</span>, <span class="st">"Profession intermédiaire"</span>, <span class="st">"Profession intermédiaire"</span>, <span class="st">"Cadre"</span>, <span class="st">"Ouvrier"</span>, <span class="st">"Ouvrier"</span>,</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Ouvrier"</span>),</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sexef =</span> <span class="fu">c</span>(<span class="st">"Femme"</span>, <span class="st">"Femme"</span>, <span class="st">"Femme"</span>, <span class="st">"Femme"</span>, <span class="st">"Homme"</span>, <span class="st">"Homme"</span>, <span class="st">"Femme"</span>, <span class="st">"Femme"</span>, <span class="st">"Femme"</span>, <span class="st">"Homme"</span>, <span class="st">"Femme"</span>, <span class="st">"Homme"</span>, <span class="st">"Femme"</span>, <span class="st">"Homme"</span>, <span class="st">"Homme"</span>, <span class="st">"Homme"</span>, <span class="st">"Femme"</span>, <span class="st">"Femme"</span>,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Homme"</span>, <span class="st">"Homme"</span>, <span class="st">"Homme"</span>, <span class="st">"Femme"</span>, <span class="st">"Femme"</span>, <span class="st">"Homme"</span>, <span class="st">"Homme"</span>, <span class="st">"Homme"</span>, <span class="st">"Homme"</span>)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Mise en forme des données</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="co"># On vérifie que la base importée est bien un tibble</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="fu">is_tibble</span>(donnees_tidyverse)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformation en tibble, le format de Tidyverse</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">as_tibble</span>(donnees_tidyverse)</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="co"># R est sensible à la casse, il est pertinent d'harmoniser les noms des variables en minuscule</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Renommer les colonnes de la base en minuscule</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">rename_with</span>(tolower)</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">set_colnames</span>(<span class="at">value =</span> <span class="fu">casefold</span>(<span class="fu">colnames</span>(.), <span class="at">upper =</span> <span class="cn">FALSE</span>))</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="co"># On a importé toutes les variables en format caractère</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a><span class="co"># On convertit certaines variables en format numérique</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>enNumerique <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"duree"</span>, <span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a><span class="co"># On convertit certaines variables au format date</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a><span class="co"># On récupère d'abord les variables dont le nom débute par le mot "date"</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>enDate <span class="ot">&lt;-</span> <span class="fu">names</span>(donnees_tidyverse)[<span class="fu">grepl</span>(<span class="st">"date"</span>, <span class="fu">tolower</span>(<span class="fu">names</span>(donnees_tidyverse)))]</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span>  </span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(enNumerique, as.integer) <span class="sc">%&gt;%</span> </span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">poids_sondage =</span> <span class="fu">as.numeric</span>(poids_sondage)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(enDate, lubridate<span class="sc">::</span>dmy)</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Date de sortie du dispositif</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date_sortie =</span> date_entree <span class="sc">+</span> lubridate<span class="sc">::</span><span class="fu">days</span>(duree))</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Format de la base</span></span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(donnees_tidyverse)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Données fictives sur des formations</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Identifiant =</span> <span class="fu">c</span>(<span class="st">"173"</span>, <span class="st">"173"</span>, <span class="st">"173"</span>, <span class="st">"173"</span>, <span class="st">"174"</span>, <span class="st">"175"</span>, <span class="st">"198"</span>, <span class="st">"198"</span>, <span class="st">"198"</span>, <span class="st">"168"</span>, <span class="st">"211"</span>, <span class="st">"278"</span>, <span class="st">"347"</span>, <span class="st">"112"</span>, <span class="st">"112"</span>, <span class="st">"112"</span>, <span class="st">"087"</span>, <span class="st">"087"</span>, <span class="st">"099"</span>, <span class="st">"099"</span>, <span class="st">"099"</span>, <span class="st">"187"</span>, <span class="st">"187"</span>, <span class="st">"689"</span>, <span class="st">"765"</span>, <span class="st">"765"</span>, <span class="st">"765"</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sexe =</span> <span class="fu">c</span>(<span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">CSP =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"3"</span>, <span class="st">"3"</span>, <span class="st">"3"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"5"</span>, <span class="st">"5"</span>, <span class="st">"3"</span>, <span class="st">"3"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"4"</span>, <span class="st">"4"</span>, <span class="st">"4"</span>, <span class="st">"4"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"4"</span>, <span class="st">"4"</span>, <span class="st">"4"</span>),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Niveau =</span> <span class="fu">c</span>(<span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Non qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Non qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Non qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Non qualifié"</span>, </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Non qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Non qualifié"</span>, <span class="st">"Non qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="st">"Qualifié"</span>, <span class="cn">NA</span>, <span class="st">"Non qualifié"</span>, <span class="st">"Non qualifié"</span>, <span class="st">"Non qualifié"</span>),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date_naissance =</span> <span class="fu">c</span>(<span class="st">"17/06/1998"</span>, <span class="st">"17/06/1998"</span>, <span class="st">"17/06/1998"</span>, <span class="st">"17/06/1998"</span>, <span class="st">"08/12/1984"</span>, <span class="st">"16/09/1989"</span>, <span class="st">"17/03/1987"</span>, <span class="st">"17/03/1987"</span>, <span class="st">"17/03/1987"</span>, <span class="st">"30/07/2002"</span>, <span class="cn">NA</span>, <span class="st">"10/08/1948"</span>, </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"13/09/1955"</span>, <span class="st">"13/09/2001"</span>, <span class="st">"13/09/2001"</span>, <span class="st">"13/09/2001"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"06/06/1998"</span>, <span class="st">"06/06/1998"</span>, <span class="st">"06/06/1998"</span>, <span class="st">"05/12/1986"</span>, <span class="st">"05/12/1986"</span>, <span class="st">"01/12/2000"</span>, <span class="st">"26/12/1995"</span>, <span class="st">"26/12/1995"</span>, <span class="st">"26/12/1995"</span>),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date_entree =</span> <span class="fu">c</span>(<span class="st">"01/01/2021"</span>, <span class="st">"01/01/2022"</span>, <span class="st">"06/01/2022"</span>, <span class="st">"02/01/2023"</span>, <span class="st">"17/08/2021"</span>, <span class="st">"21/12/2022"</span>, <span class="st">"28/07/2022"</span>, <span class="st">"17/11/2022"</span>, <span class="st">"21/02/2023"</span>, <span class="st">"04/09/2019"</span>, <span class="st">"17/12/2021"</span>, <span class="st">"07/06/2018"</span>, <span class="cn">NA</span>, <span class="st">"02/03/2022"</span>, <span class="st">"01/03/2021"</span>, <span class="st">"01/12/2023"</span>, <span class="cn">NA</span>, </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"31/10/2020"</span>, <span class="st">"01/03/2021"</span>, <span class="st">"01/03/2022"</span>, <span class="st">"01/03/2023"</span>, <span class="st">"01/01/2022"</span>, <span class="st">"01/01/2023"</span>, <span class="st">"06/11/2017"</span>, <span class="st">"17/04/2020"</span>, <span class="st">"17/04/2020"</span>, <span class="st">"17/04/2020"</span>),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Duree =</span> <span class="fu">c</span>(<span class="st">"308"</span>, <span class="st">"365"</span>, <span class="st">"185"</span>, <span class="st">"365"</span>, <span class="st">"183"</span>, <span class="st">"730"</span>, <span class="st">"30"</span>, <span class="st">"164"</span>, <span class="st">"365"</span>, <span class="st">"365"</span>, <span class="st">"135"</span>, <span class="st">"365"</span>, <span class="st">"180"</span>, <span class="st">"212"</span>, <span class="st">"365"</span>, <span class="st">"365"</span>, <span class="st">"365"</span>, <span class="st">"365"</span>, <span class="st">"364"</span>, <span class="st">"364"</span>, <span class="st">"364"</span>, <span class="st">"364"</span>, <span class="st">"364"</span>, <span class="st">"123"</span>, <span class="st">"160"</span>, <span class="st">"160"</span>, <span class="st">"160"</span>),</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Note_Contenu =</span> <span class="fu">c</span>(<span class="st">"12"</span>, <span class="st">"6"</span>, <span class="st">"8"</span>, <span class="st">"14"</span>, <span class="st">"17"</span>, <span class="st">"5"</span>, <span class="st">"10"</span>, <span class="st">"11"</span>, <span class="st">"9"</span>, <span class="st">"18"</span>, <span class="st">"16"</span>, <span class="st">"14"</span>, <span class="st">"12"</span>, <span class="st">"3"</span>, <span class="st">"7"</span>, <span class="st">"9"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"12"</span>, <span class="st">"12"</span>, <span class="st">"12"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"9"</span>, <span class="st">"13"</span>, <span class="st">"13"</span>, <span class="st">"13"</span>),</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Note_Formateur =</span> <span class="fu">c</span>(<span class="st">"6"</span>, <span class="cn">NA</span>, <span class="st">"10"</span>, <span class="st">"15"</span>, <span class="st">"18"</span>, <span class="st">"5"</span>, <span class="st">"10"</span>, <span class="st">"7"</span>, <span class="st">"20"</span>, <span class="st">"11"</span>, <span class="st">"16"</span>, <span class="st">"10"</span>, <span class="st">"5"</span>, <span class="st">"10"</span>, <span class="st">"13"</span>, <span class="cn">NA</span>, <span class="st">"10"</span>, <span class="cn">NA</span>, <span class="st">"11"</span>, <span class="st">"11"</span>, <span class="st">"11"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"7"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>),</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Note_Moyens =</span> <span class="fu">c</span>(<span class="st">"17"</span>, <span class="st">"12"</span>, <span class="st">"11"</span>, <span class="st">"15"</span>, <span class="st">"20"</span>, <span class="st">"8"</span>, <span class="st">"10"</span>, <span class="st">"6"</span>, <span class="st">"3"</span>, <span class="st">"20"</span>, <span class="st">"15"</span>, <span class="st">"6"</span>, <span class="st">"7"</span>, <span class="st">"11"</span>, <span class="st">"8"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"11"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"8"</span>, <span class="st">"12"</span>, <span class="st">"12"</span>, <span class="st">"12"</span>),</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Note_Accompagnement =</span> <span class="fu">c</span>(<span class="st">"4"</span>, <span class="st">"7"</span>, <span class="st">"1"</span>, <span class="st">"10"</span>, <span class="st">"15"</span>, <span class="st">"4"</span>, <span class="st">"16"</span>, <span class="st">"14"</span>, <span class="st">"4"</span>, <span class="st">"13"</span>, <span class="st">"12"</span>, <span class="st">"8"</span>, <span class="st">"11"</span>, <span class="st">"9"</span>, <span class="st">"19"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"12"</span>, <span class="st">"12"</span>, <span class="st">"12"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"13"</span>, <span class="st">"18"</span>, <span class="st">"18"</span>, <span class="st">"18"</span>),</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Note_Materiel =</span> <span class="fu">c</span>(<span class="st">"19"</span>, <span class="st">"14"</span>, <span class="st">"9"</span>, <span class="st">"8"</span>, <span class="st">"12"</span>, <span class="st">"9"</span>, <span class="st">"8"</span>, <span class="st">"13"</span>, <span class="st">"17"</span>, <span class="st">"15"</span>, <span class="st">"9"</span>, <span class="st">"12"</span>, <span class="st">"12"</span>, <span class="st">"8"</span>, <span class="st">"2"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"13"</span>, <span class="st">"13"</span>, <span class="st">"13"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"16"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>),</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">poids_sondage =</span> <span class="fu">c</span>(<span class="st">"117.1"</span>, <span class="st">"98.3"</span>, <span class="st">"214.6"</span>, <span class="st">"84.7"</span>, <span class="st">"65.9"</span>, <span class="st">"148.2"</span>, <span class="st">"89.6"</span>, <span class="st">"100.3"</span>, <span class="st">"49.3"</span>, <span class="st">"148.2"</span>, <span class="st">"86.4"</span>, <span class="st">"99.2"</span>, <span class="st">"105.6"</span>, <span class="st">"123.1"</span>, <span class="st">"137.4"</span>, <span class="st">"187.6"</span>, <span class="st">"87.3"</span>, <span class="st">"87.3"</span>,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"169.3"</span>, <span class="st">"169.3"</span>, <span class="st">"169.3"</span>, <span class="st">"169.3"</span>, <span class="st">"234.1"</span>, <span class="st">"189.3"</span>, <span class="st">"45.9"</span>, <span class="st">"45.9"</span>, <span class="st">"45.9"</span>),</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">CSPF =</span> <span class="fu">c</span>(<span class="st">"Cadre"</span>, <span class="st">"Cadre"</span>, <span class="st">"Cadre"</span>, <span class="st">"Cadre"</span>, <span class="st">"Cadre"</span>,<span class="st">"Cadre"</span>, <span class="st">"Employé"</span>, <span class="st">"Employé"</span>, <span class="st">"Employé"</span>, <span class="st">"Profession intermédiaire"</span>, <span class="st">"Employé"</span>, <span class="st">"Retraité"</span>, <span class="st">"Retraité"</span>, <span class="st">"Employé"</span>,</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Employé"</span>, <span class="st">"Employé"</span>, <span class="st">"Ouvrier"</span>, <span class="st">"Ouvrier"</span>, <span class="st">"Ouvrier"</span>, <span class="st">"Ouvrier"</span>, <span class="st">"Ouvrier"</span>, <span class="st">"Profession intermédiaire"</span>, <span class="st">"Profession intermédiaire"</span>, <span class="st">"Cadre"</span>, <span class="st">"Ouvrier"</span>, <span class="st">"Ouvrier"</span>,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Ouvrier"</span>),</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sexef =</span> <span class="fu">c</span>(<span class="st">"Femme"</span>, <span class="st">"Femme"</span>, <span class="st">"Femme"</span>, <span class="st">"Femme"</span>, <span class="st">"Homme"</span>, <span class="st">"Homme"</span>, <span class="st">"Femme"</span>, <span class="st">"Femme"</span>, <span class="st">"Femme"</span>, <span class="st">"Homme"</span>, <span class="st">"Femme"</span>, <span class="st">"Homme"</span>, <span class="st">"Femme"</span>, <span class="st">"Homme"</span>, <span class="st">"Homme"</span>, <span class="st">"Homme"</span>, <span class="st">"Femme"</span>, <span class="st">"Femme"</span>,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Homme"</span>, <span class="st">"Homme"</span>, <span class="st">"Homme"</span>, <span class="st">"Femme"</span>, <span class="st">"Femme"</span>, <span class="st">"Homme"</span>, <span class="st">"Homme"</span>, <span class="st">"Homme"</span>, <span class="st">"Homme"</span>)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Mise en forme des données</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="co"># On vérifie que la base est bien un data.table</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="fu">is.data.table</span>(donnees_datatable)</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformation en data.frame</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="fu">setDF</span>(donnees_datatable)</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="fu">is.data.frame</span>(donnees_datatable)</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformation en data.table</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a><span class="co"># En data.table, les instructions débutant par set modifient les éléments par référence, c'est-à-dire sans copie.</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Ceci est plus efficace pour manipuler des données volumineuses.</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a><span class="fu">setDT</span>(donnees_datatable)</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a><span class="fu">is.data.table</span>(donnees_datatable)</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre possibilité</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>donnees_datatable <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(donnees_datatable)</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Est-ce une liste ?</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a><span class="fu">is.list</span>(donnees_datatable)</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire les noms des variables de la base</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a><span class="co"># R est sensible à la casse, il est pertinent d'harmoniser les noms des variables en minuscule</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>nomCol <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">colnames</span>(donnees_datatable))</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Renommer les colonnes de la base</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(donnees_datatable) <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">colnames</span>(donnees_datatable))</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a><span class="co"># On convertit certaines variables en format 'numeric'</span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>enNumerique <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"duree"</span>, <span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Ne pas oublier le . devant SDcols !!!!</span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">lapply</span>(.SD, as.integer), .SDcols <span class="ot">=</span> enNumerique]</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a><span class="co"># En data.table, les instructions débutant par set modifient les éléments par référence, c'est-à-dire sans copie.</span></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Ceci est plus efficace pour manipuler des données volumineuses.</span></span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> enNumerique) {</span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set</span>(donnees_datatable, <span class="at">j =</span> j, <span class="at">value =</span> <span class="fu">as.numeric</span>(donnees_datatable[[j]]))</span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, poids_sondage <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(poids_sondage)]</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a><span class="co"># On récupère les variables dont le nom débute par le mot "date"</span></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>varDates <span class="ot">&lt;-</span> <span class="fu">names</span>(donnees_datatable)[<span class="fu">grepl</span>(<span class="st">"date"</span>, <span class="fu">tolower</span>(<span class="fu">names</span>(donnees_datatable)))]</span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a><span class="co"># On remplace / par - dans les dates</span></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, (varDates) <span class="sc">:</span><span class="er">=</span> <span class="fu">lapply</span>(.SD, <span class="cf">function</span>(x) <span class="fu">gsub</span>(<span class="st">"/"</span>, <span class="st">"-"</span>, x)), .SDcols <span class="ot">=</span> varDates]</span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a><span class="co"># On exprime les dates en format Date</span></span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, (varDates) <span class="sc">:</span><span class="er">=</span> <span class="fu">lapply</span>(.SD, lubridate<span class="sc">::</span>dmy), .SDcols <span class="ot">=</span> varDates]</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Date de sortie du dispositif</span></span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, date_sortie <span class="sc">:</span><span class="er">=</span> date_entree <span class="sc">+</span> lubridate<span class="sc">::</span><span class="fu">days</span>(duree)]</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Format de la base</span></span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(donnees_datatable)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<p>Duckdb fonctionne comme un serveur SQL. Il faut transférer les données vers le serveur SQL.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ouvrir une connexion au serveur duckdb</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(duckdb<span class="sc">::</span><span class="fu">duckdb</span>()); </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># On "copie" les données dans une table du nom table_duckdb</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>con <span class="sc">%&gt;%</span> duckdb<span class="sc">::</span><span class="fu">duckdb_register</span>(<span class="at">name =</span> <span class="st">"table_duckdb"</span>, <span class="at">df =</span> donnees_tidyverse)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>con <span class="sc">%&gt;%</span> <span class="fu">tbl</span>(<span class="st">"table_duckdb"</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fermer la connexion au serveur duckdb</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>DBI<span class="sc">::</span><span class="fu">dbDisconnect</span>(con, <span class="at">shutdown =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pour la suite, on suppose que la connexion est ouverte sous le nom <code>con</code>, et que les données sont accessibles par la requête <code>requete_duckdb</code>. Le code modifiera la requête, mais pas la table dans le serveur SQL.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(duckdb<span class="sc">::</span><span class="fu">duckdb</span>()); </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>con <span class="sc">%&gt;%</span> duckdb<span class="sc">::</span><span class="fu">duckdb_register</span>(<span class="at">name =</span> <span class="st">"table_duckdb"</span>, <span class="at">df =</span> donnees_tidyverse)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="ot">&lt;-</span> con <span class="sc">%&gt;%</span> <span class="fu">tbl</span>(<span class="st">"table_duckdb"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>N.B. Duckdb est envisagé pour des traitements sans charger des données en mémoire, par exemple en lisant directement un fichier <code>.parquet</code> sur le disque dur. Dans ce cas, les opérations sont effectuées à la volée, mais n’affectent pas les fichiers source.</p>
</div>
</div>
</div>
</section>
</section>
<section id="préambule" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Préambule</h1>
<section id="chemin-du-bureau-de-lutilisateur" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="chemin-du-bureau-de-lutilisateur"><span class="header-section-number">3.1</span> Chemin du bureau de l’utilisateur</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-3-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="sourceCode" id="cb12"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* On vide la log */</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">dm</span> <span class="st">"log; clear; "</span>;</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">/* On récupère déjà l'identifiant de l'utilisateur (systèmes Windows) */</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> user = <span class="kw">&amp;sysuserid;</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">/* Chemin proprement dit */</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> bureau = C:\Users\<span class="kw">&amp;user.</span>\Desktop;</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="kw">libname</span> bur <span class="st">"&amp;bureau."</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-3-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On récupère déjà l'identifiant de l'utilisateur</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>user <span class="ot">&lt;-</span> <span class="fu">Sys.getenv</span>(<span class="st">"USERNAME"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>chemin <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"C:/Users"</span>, user, <span class="st">"Desktop"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On récupère déjà l'identifiant de l'utilisateur</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>user <span class="ot">&lt;-</span> <span class="fu">Sys.getenv</span>(<span class="st">"USERNAME"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>chemin <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"C:/Users"</span>, user, <span class="st">"Desktop"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On récupère déjà l'identifiant de l'utilisateur</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>user <span class="ot">&lt;-</span> <span class="fu">Sys.getenv</span>(<span class="st">"USERNAME"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>chemin <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"C:/Users"</span>, user, <span class="st">"Desktop"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="affichage-de-lannée" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="affichage-de-lannée"><span class="header-section-number">3.2</span> Affichage de l’année</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-5" role="tab" aria-controls="tabset-4-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-4-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="sourceCode" id="cb16"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Année courante */</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> an = <span class="kw">%sysfunc</span>(<span class="fu">year</span>(<span class="kw">%sysfunc</span>(<span class="fu">today</span>())));</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">/* &amp; (esperluette) indique à SAS qu'il doit remplacer an par sa valeur définie par le %let */</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="kw">%put</span> Année : <span class="kw">&amp;an.</span>;</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">/* Autre possibilité */</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> _null_;<span class="kw">call</span> symput(<span class="st">'annee'</span>, strip(<span class="fu">year</span>(<span class="fu">today</span>())))<span class="kw">;run</span>;</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="kw">%put</span> Année (autre méthode) : <span class="kw">&amp;annee.</span>;</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">/* Année passée */</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="kw">%put</span> Année passée : <span class="kw">%eval</span>(<span class="kw">&amp;an.</span> - <span class="dv">1</span>);</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-4-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Année courante</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>annee <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">year</span>(<span class="fu">Sys.Date</span>())</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Année : %04d"</span>, annee)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Année : "</span>, annee))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Année passée</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>annee_1 <span class="ot">&lt;-</span> annee <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"Année passée: "</span>, annee_1)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Année courante</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>annee <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">year</span>(<span class="fu">Sys.Date</span>())</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Année : %04d"</span>, annee)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Année : "</span>, annee))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Année passée</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>annee_1 <span class="ot">&lt;-</span> annee <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"Année passée: "</span>, annee_1)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Année courante</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>annee <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">year</span>(<span class="fu">Sys.Date</span>())</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Année : %04d"</span>, annee)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Année : "</span>, annee))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Année passée</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>annee_1 <span class="ot">&lt;-</span> annee <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"Année passée: "</span>, annee_1)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-4-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="construction-des-instructions-if-else" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="construction-des-instructions-if-else"><span class="header-section-number">3.3</span> Construction des instructions if / else</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-5" role="tab" aria-controls="tabset-5-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-5-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="sourceCode" id="cb20"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">%macro</span> Annee(an);</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%if</span> <span class="kw">&amp;an.</span> &gt;= <span class="dv">2024</span> <span class="kw">%then</span> <span class="kw">%put</span> Nous sommes en <span class="dv">2024</span> ou après !;</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%else</span> <span class="kw">%put</span> Nous sommes avant <span class="dv">2024</span> !;</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="kw">%mend</span> Annee;</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>%Annee(&amp;an.);</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-5-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Construction incorrecte ! Le else doit être sur la même ligne que le {</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co">#if (annee &gt;= 2024) {</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  print("Nous sommes en 2024 ou après")</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">#else {</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  print("Nous sommes en 2023 ou avant")</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Construction correcte ! Le else doit être sur la même ligne que le {</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (annee <span class="sc">&gt;=</span> <span class="dv">2024</span>) {</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Nous sommes en 2024 ou après"</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Nous sommes avant 2024 !"</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Construction incorrecte ! Le else doit être sur la même ligne que le {</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">#if (annee &gt;= 2024) {</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  print("Nous sommes en 2024 ou après")</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">#else {</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  print("Nous sommes en 2024 ou avant")</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Construction correcte ! Le else doit être sur la même ligne que le {</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (annee <span class="sc">&gt;=</span> <span class="dv">2024</span>) {</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Nous sommes en 2024 ou après"</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Nous sommes avant 2024 !"</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Construction incorrecte ! Le else doit être sur la même ligne que le {</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">#if (annee &gt;= 2024) {</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  print("Nous sommes en 2024 ou après")</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">#else {</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  print("Nous sommes avant 2024")</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Construction correcte ! Le else doit être sur la même ligne que le {</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (annee <span class="sc">&gt;=</span> <span class="dv">2024</span>) {</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Nous sommes en 2024 ou après"</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Nous sommes avant 2024 !"</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-5-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="répertoire-de-travail" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="répertoire-de-travail"><span class="header-section-number">3.4</span> Répertoire de travail</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-5" role="tab" aria-controls="tabset-6-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-6-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="sourceCode" id="cb24"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Afficher le répertoire de travail par défaut (la Work) */</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> chemin_work = <span class="kw">%sysfunc</span>(<span class="fu">pathname</span>(work));</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="kw">%put</span> <span class="kw">&amp;chemin_work.</span>;</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> path <span class="kw">from</span> dictionary.libnames <span class="kw">where</span> <span class="kw">libname</span> = <span class="st">"WORK"</span>;</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">/* Définir le répertoire de travail, si besoin */</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">/* libname "nom du répertoire";</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-6-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le répertoire de travail</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Définir le répertoire de travail, si besoin</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co">#setwd(dir="nom du répertoire")</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le répertoire de travail</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Définir le répertoire de travail, si besoin</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co">#setwd(dir="nom du répertoire")</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le répertoire de travail</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Définir le répertoire de travail, si besoin</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co">#setwd(dir="nom du répertoire")</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-6-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="autres-points-à-connaître" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="autres-points-à-connaître"><span class="header-section-number">3.5</span> Autres points à connaître</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-5" role="tab" aria-controls="tabset-7-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-7-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="sourceCode" id="cb28"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Mise en garde : certains codes SAS pourraient aussi avec profit être écrits en langage SAS IML (Interactive Matrix Language).</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co">   Cet aide-mémoire n'ayant pas vocation à être un dictionnaire SAS, cette méthode d'écriture n'est pas proposée ici. */</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-7-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Le pipe peut aussi être utilisé avec R-Base et data.table</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Le pipe permet d'enchaîner des opérations sur une même base</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># R-Base est réputé plus lent que ses concurrents, ce qui est souvent vrai.</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Mais certaines fonctions en R-Base être très rapides (rowsum, rowSums, tapply, etc.)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidyverse promeut l'utilisation du pipe (%&gt;%), qui permet d'enchaîner des opérations sur une même base modifiée successivement.</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 types de pipes existent, le pipe de magrittr (%&gt;%) et le pipe de R-Base (|&gt;, à partir de la version 4.1)</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Les fonctionnalités simples des deux opérateurs sont identiques, mais il existe des différences.</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Le tidyverse peut s'utiliser sans pipe, mais le pipe simplifie la gestion des programmes.</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Les autres environnements (R-Base, data.table) peuvent aussi se présenter avec le pipe</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Dans cet aide-mémoire, le pipe de magrittr (%&gt;%) est privilégié.</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE :</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co"># - expliquer les différences entre le pipe de magrittr et de R-Base</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Documentation de tidyverse (dplyr et tidyr)</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="fu">vignette</span>(<span class="st">"dplyr"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Principe de base de data.table</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co">#dt[i, j, by]</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># i : sélection de lignes (instructions )</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># j : sélection et manipulation de colonnes</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># by : groupements</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-7-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
</section>
<section id="informations-sur-la-base-de-données" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Informations sur la base de données</h1>
<section id="avoir-une-vue-densemble-des-données" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="avoir-une-vue-densemble-des-données"><span class="header-section-number">4.1</span> Avoir une vue d’ensemble des données</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-4" role="tab" aria-controls="tabset-8-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-5" role="tab" aria-controls="tabset-8-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-8-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="sourceCode" id="cb32"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Statistiques globales sur les variables numériques */</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> means<span class="kw"> data</span> = donnees_sas <span class="fu">n</span> <span class="fu">mean</span> median <span class="fu">min</span> p10 p25 median p75 p90 <span class="fu">max</span>;<span class="fu">var</span> _numeric_<span class="kw">;run</span>;</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">/* Statistiques globales sur les variables caractères */</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> freq<span class="kw"> data</span> = donnees_sas;tables _character_ / missing<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-8-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Informations sur les variables</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(donnees_rbase)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistiques descriptives des variables de la base</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(donnees_rbase)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>Hmisc<span class="sc">::</span><span class="fu">describe</span>(donnees_rbase)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualiser la base de données</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(donnees_rbase)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-8-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Informations sur les variables</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(donnees_tidyverse)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">str</span>()</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistiques descriptives des variables de la base</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualiser la base de données</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">View</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-8-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-8-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Informations sur les variables</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(donnees_datatable)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistiques descriptives des variables de la base</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(donnees_datatable)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualiser la base de données</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(donnees_datatable)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-8-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-8-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="extraire-les-x-premières-lignes-de-la-base-10-par-défaut" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="extraire-les-x-premières-lignes-de-la-base-10-par-défaut"><span class="header-section-number">4.2</span> Extraire les x premières lignes de la base (10 par défaut)</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-4" role="tab" aria-controls="tabset-9-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-5" role="tab" aria-controls="tabset-9-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-9-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="sourceCode" id="cb36"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> <span class="kw">x</span> = <span class="dv">10</span>;</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> print<span class="kw"> data</span> = donnees_sas (firstobs = <span class="dv">1</span> obs = <span class="kw">&amp;x.</span>)<span class="kw">;run</span>;</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co">/* Ou alors */</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Lignes<span class="kw">&amp;x.</span>;<span class="kw">set</span> donnees_sas (firstobs = <span class="dv">1</span> obs = <span class="kw">&amp;x.</span>)<span class="kw">;proc</span> print<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-9-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase[<span class="dv">1</span><span class="sc">:</span>x, ]</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(donnees_rbase, x)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-9-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span>x)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-9-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-9-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">head</span>(.SD, <span class="dv">10</span>)]</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, .SD[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]]</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(donnees_datatable, <span class="dv">10</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-9-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-9-5-tab">
<p>En duckdb, les dix premières lignes sont affichées par défaut. Si on veut les récupérer, par exemple dans une autre variable, il faut faire <code>collect()</code>. Attention, comme il n’y a pas d’ordre en SQL, il faut ordonner les lignes si on veut un résultat reproductible. C’est une opération qui peut être couteuse en temps CPU.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">collect</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="extraire-les-x-dernières-lignes-de-la-base-10-par-défaut" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="extraire-les-x-dernières-lignes-de-la-base-10-par-défaut"><span class="header-section-number">4.3</span> Extraire les x dernières lignes de la base (10 par défaut)</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-4" role="tab" aria-controls="tabset-10-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-5" role="tab" aria-controls="tabset-10-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-10-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="sourceCode" id="cb41"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> <span class="kw">x</span> = <span class="dv">10</span>;</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql noprint;<span class="kw">select</span> count(*) <span class="kw">into</span> :total_lignes <span class="kw">from</span> donnees_sas;<span class="kw">quit</span>;</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> deb = <span class="kw">%eval</span>(<span class="kw">&amp;total_lignes.</span> - <span class="kw">&amp;x.</span> + <span class="dv">1</span>);</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Lignes_<span class="kw">&amp;x.</span>;<span class="kw">set</span> donnees_sas (firstobs = <span class="kw">&amp;deb.</span> obs = <span class="kw">&amp;total_lignes.</span>)<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-10-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(donnees_rbase, x)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>donnees_rbase[ ( <span class="fu">nrow</span>(donnees_rbase) <span class="sc">-</span> x ) <span class="sc">:</span> <span class="fu">nrow</span>(donnees_rbase), ]</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Les parenthèses sont importantes. Comparer les deux expressions ! Bon exemple du recycling</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>( <span class="fu">nrow</span>(donnees_rbase) <span class="sc">-</span> x ) <span class="sc">:</span> <span class="fu">nrow</span>(donnees_rbase)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(donnees_rbase) <span class="sc">-</span> x <span class="sc">:</span> <span class="fu">nrow</span>(donnees_rbase)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-10-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>( (<span class="fu">n</span>()<span class="sc">-</span><span class="dv">10</span>) <span class="sc">:</span> <span class="fu">n</span>())</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-10-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-10-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">tail</span>(.SD, <span class="dv">10</span>)]</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(donnees_datatable, <span class="dv">10</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-10-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-10-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="nombre-de-lignes-et-de-colonnes-dans-la-base" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="nombre-de-lignes-et-de-colonnes-dans-la-base"><span class="header-section-number">4.4</span> Nombre de lignes et de colonnes dans la base</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-4" role="tab" aria-controls="tabset-11-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-5" role="tab" aria-controls="tabset-11-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-11-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="sourceCode" id="cb45"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Nombre de lignes */</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;<span class="kw">select</span> count(*) <span class="kw">as</span> Nb_Lignes <span class="kw">from</span> donnees_sas;<span class="kw">quit</span>;</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> count(*) <span class="kw">as</span> Nb_Lignes, count(<span class="kw">distinct</span> identifiant) <span class="kw">as</span> Nb_Identifiants</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> donnees_sas;</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co">/* Liste des variables de la base dans la base Var */</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> contents<span class="kw"> data</span> = donnees_sas out = <span class="fu">Var</span> noprint<span class="kw">;run</span>;</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co">/* Nombre de colonnes */</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;<span class="kw">select</span> count(*) <span class="kw">as</span> Nb_Colonnes <span class="kw">from</span> <span class="fu">Var</span><span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-11-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Nombre de lignes : %d | Nombre de colonnes : %d"</span>, <span class="fu">dim</span>(donnees_rbase)[<span class="dv">1</span>], <span class="fu">dim</span>(donnees_rbase)[<span class="dv">2</span>])</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Nombre de lignes : %d | Nombre de colonnes : %d"</span>, <span class="fu">nrow</span>(donnees_rbase), <span class="fu">ncol</span>(donnees_rbase))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-11-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Nombre de lignes : %d | Nombre de colonnes : %d"</span>,</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>        donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">nrow</span>(),</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>        donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">ncol</span>())</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombre de lignes</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombre de colonnes</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">ncol</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-11-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-11-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(donnees_datatable) ; <span class="fu">dim</span>(donnees_datatable)[<span class="dv">1</span>] ; <span class="fu">dim</span>(donnees_datatable)[<span class="dv">2</span>]</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(donnees_datatable) ; <span class="fu">nrow</span>(donnees_datatable) ; <span class="fu">ncol</span>(donnees_datatable)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Nombre de lignes : %d | Nombre de colonnes : %d"</span>, <span class="fu">dim</span>(donnees_datatable)[<span class="dv">1</span>], <span class="fu">dim</span>(donnees_datatable)[<span class="dv">2</span>])</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-11-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-11-5-tab">
<p>Duckdb/SQL ne connaît pas le nombre de lignes sans un calcul. Il faut faire <code>count()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Nombre de lignes</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> <span class="fu">nrow</span>() <span class="co"># retourne NA</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> <span class="fu">count</span>() <span class="co"># correct</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Nombre de colonnes</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span>  <span class="fu">ncol</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="liste-des-variables-de-la-base" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="liste-des-variables-de-la-base"><span class="header-section-number">4.5</span> Liste des variables de la base</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-4" role="tab" aria-controls="tabset-12-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-5" role="tab" aria-controls="tabset-12-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-12-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="sourceCode" id="cb50"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Par ordre d'apparition dans la base */</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> contents<span class="kw"> data</span> = donnees_sas out = <span class="fu">Var</span> noprint<span class="kw">;run</span>;</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;<span class="kw">select</span> name <span class="kw">into</span> :nom_col separated <span class="kw">by</span> <span class="st">" "</span> <span class="kw">from</span> <span class="fu">Var</span> <span class="kw">order</span> <span class="kw">by</span> <span class="fu">varnum</span><span class="kw">;run</span>;</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co">/* On affiche les noms des variables */</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="kw">%put</span> Liste des variables : <span class="kw">&amp;nom_col.</span>;</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co">/* Par ordre alphabétique */</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> contents<span class="kw"> data</span> = donnees_sas out = <span class="fu">Var</span> noprint<span class="kw">;run</span>;</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;<span class="kw">select</span> name <span class="kw">into</span> :nom_col separated <span class="kw">by</span> <span class="st">" "</span> <span class="kw">from</span> <span class="fu">Var</span><span class="kw">;run</span>;</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="co">/* On affiche les noms des variables */</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="kw">%put</span> Liste des variables : <span class="kw">&amp;nom_col.</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-12-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Liste des variables par ordre d'apparition dans la base</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(donnees_rbase)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(donnees_rbase)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Liste des variables par ordre alphabétique</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>(donnees_rbase)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">colnames</span>(donnees_rbase))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-12-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Liste des variables par ordre d'apparition dans la base</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">colnames</span>()</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Liste des variables par ordre alphabétique</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">colnames</span>() <span class="sc">%&gt;%</span> <span class="fu">sort</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-12-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-12-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Liste des variables par ordre d'apparition dans la base</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(donnees_datatable)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Liste des variables par ordre alphabétique</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">colnames</span>(donnees_datatable))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-12-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-12-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> <span class="fu">colnames</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="nombre-didentifiants-uniques-et-nombre-de-lignes-dans-la-base" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="nombre-didentifiants-uniques-et-nombre-de-lignes-dans-la-base"><span class="header-section-number">4.6</span> Nombre d’identifiants uniques et nombre de lignes dans la base</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-4" role="tab" aria-controls="tabset-13-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-5" role="tab" aria-controls="tabset-13-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-13-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="sourceCode" id="cb55"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> count(*) <span class="kw">as</span> Nb_Lignes, count(<span class="kw">distinct</span> identifiant) <span class="kw">as</span> Nb_Identifiants_Uniques</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> donnees_sas;</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-13-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"La base de données contient %d lignes et %d identifiants uniques !"</span>,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>(donnees_rbase),</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">length</span>(<span class="fu">unique</span>(donnees_rbase<span class="sc">$</span>identifiant)))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-13-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"La base de données contient %d lignes et %d identifiants uniques !"</span>,</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>        donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">nrow</span>(),</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>        donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select</span>(identifiant) <span class="sc">%&gt;%</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">n_distinct</span>()</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution pour le nombre d'identifiants uniques</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select</span>(identifiant) <span class="sc">%&gt;%</span> <span class="fu">n_distinct</span>()</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(identifiant) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-13-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-13-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"La base de données contient %d lignes et %d identifiants uniques !"</span>,</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>(donnees_datatable),</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>        donnees_datatable[, <span class="fu">uniqueN</span>(identifiant)])</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifiants uniques</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">uniqueN</span>(identifiant)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-13-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-13-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="quelle-est-la-position-de-la-variable-date_entree" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="quelle-est-la-position-de-la-variable-date_entree"><span class="header-section-number">4.7</span> Quelle est la position de la variable date_entree ?</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-4" role="tab" aria-controls="tabset-14-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-5" role="tab" aria-controls="tabset-14-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-14-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="sourceCode" id="cb59"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> <span class="fu">var</span> = date_entree;</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> contents<span class="kw"> data</span> = donnees_sas out = <span class="fu">Var</span> noprint<span class="kw">;run</span>;</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> <span class="fu">varnum</span> <span class="kw">as</span> Position <span class="kw">from</span> <span class="fu">Var</span> <span class="kw">where</span> <span class="fu">lowcase</span>(NAME) = <span class="st">"&amp;var."</span>;</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-14-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"date_entree"</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>pos <span class="ot">&lt;-</span> <span class="fu">match</span>(variable, <span class="fu">names</span>(donnees_rbase))</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"La variable %s se trouve en colonne n°%s !"</span>, variable, pos)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-14-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"date_entree"</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>pos <span class="ot">&lt;-</span> <span class="fu">match</span>(variable, donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">colnames</span>())</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"La variable %s se trouve en colonne n°%s !"</span>, variable, pos)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-14-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-14-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"date_entree"</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>pos <span class="ot">&lt;-</span> <span class="fu">match</span>(variable, <span class="fu">names</span>(donnees_datatable))</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"La variable %s se trouve en colonne n°%s !"</span>, variable, pos)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-14-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-14-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="format-des-variables" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="format-des-variables"><span class="header-section-number">4.8</span> Format des variables</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-4" role="tab" aria-controls="tabset-15-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-5" role="tab" aria-controls="tabset-15-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-15-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="sourceCode" id="cb63"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> contents<span class="kw"> data</span> = donnees_sas<span class="kw">;run</span>;</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co">/* On supprime la base Var temporaire */</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> datasets lib = Work nolist;<span class="kw">delete</span> <span class="fu">Var</span><span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-15-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(donnees_rbase, class)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-15-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>purrr<span class="sc">::</span><span class="fu">map</span>(donnees_tidyverse, class)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(donnees_tidyverse)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-15-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-15-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">lapply</span>(.SD, class)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-15-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-15-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
</section>
<section id="sélectionner-des-lignes-et-des-colonnes" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Sélectionner des lignes et des colonnes</h1>
<section id="selection-de-colonnes-par-position" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="selection-de-colonnes-par-position"><span class="header-section-number">5.1</span> Selection de colonnes par position</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-3" role="tab" aria-controls="tabset-16-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-4" role="tab" aria-controls="tabset-16-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-5" role="tab" aria-controls="tabset-16-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-16-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="sourceCode" id="cb67"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> pos = <span class="dv">1</span>;</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> contents<span class="kw"> data</span> = donnees_sas out = <span class="fu">Var</span> noprint<span class="kw">;run</span>;</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql noprint;</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> name <span class="kw">into</span> :nom_col separated <span class="kw">by</span> <span class="st">" "</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> <span class="fu">Var</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">where</span> <span class="fu">varnum</span> = <span class="kw">&amp;pos.</span>;</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Colonnes;<span class="kw">set</span> donnees_sas (<span class="kw">keep</span> = <span class="kw">&amp;nom_col.</span>)<span class="kw">;run</span>;</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> datasets lib = Work nolist;<span class="kw">delete</span> <span class="fu">Var</span><span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-16-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>pos <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Résultat sous forme de vecteur caractère</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_rbase[[pos]] ; <span class="fu">class</span>(id)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_rbase[, pos] ; <span class="fu">class</span>(id)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Résultat sous forme de data.frame</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_rbase[pos] ; <span class="fu">class</span>(id)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_rbase[, pos, drop <span class="ot">=</span> <span class="cn">FALSE</span>] ; <span class="fu">class</span>(id)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-16-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-16-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sous forme de vecteur</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">pull</span>(<span class="dv">1</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(id)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>pos <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">pull</span>(<span class="fu">all_of</span>(pos))</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(id)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Sous forme de tibble</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span>)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(id)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>pos <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">all_of</span>(pos))</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(id)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-16-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-16-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>pos <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Résultat sous forme de vecteur caractère</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_datatable[[pos]] ; <span class="fu">class</span>(id)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Résultat sous forme de data.table</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_datatable[pos] ; <span class="fu">class</span>(id)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-16-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-16-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="selection-de-colonnes-par-nom" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="selection-de-colonnes-par-nom"><span class="header-section-number">5.2</span> Selection de colonnes par nom</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-4" role="tab" aria-controls="tabset-17-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-5" role="tab" aria-controls="tabset-17-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-17-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="sourceCode" id="cb71"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Colonnes;<span class="kw">set</span> donnees_sas (<span class="kw">keep</span> = identifiant)<span class="kw">;run</span>;</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Colonnes;<span class="kw">set</span> donnees_sas;<span class="kw">keep</span> identifiant<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-17-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Résultat sous forme de vecteur caractère</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_rbase<span class="sc">$</span>identifiant ; <span class="fu">class</span>(id)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_rbase[[<span class="st">"identifiant"</span>]] ; <span class="fu">class</span>(id)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_rbase[, <span class="st">"identifiant"</span>] ; <span class="fu">class</span>(id)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Résultat sous forme de data.frame</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(donnees_rbase[, <span class="st">"identifiant"</span>])</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Attention, utilisation du drop = FALSE étrange</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="co"># En fait, l'affectation par [] a pour option par défaut drop = TRUE. Ce qui implique que si l'affectation renvoie</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="co"># un data.frame d'1 seule colonne, l'objet sera transformé en objet plus simple (vecteur en l'occurrence)</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(donnees_rbase[, <span class="st">"identifiant"</span>, <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_rbase[<span class="st">"identifiant"</span>] ; <span class="fu">class</span>(id)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_rbase[, <span class="st">"identifiant"</span>, drop <span class="ot">=</span> <span class="cn">FALSE</span>] ; <span class="fu">class</span>(id)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-17-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sous forme de vecteur</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">pull</span>(identifiant)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">pull</span>(<span class="st">"identifiant"</span>)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sous forme de tibble</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select</span>(identifiant)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">"identifiant"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-17-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-17-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Résultat sous forme de vecteur caractère</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_datatable<span class="sc">$</span>identifiant ; <span class="fu">class</span>(id)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_datatable[[<span class="st">"identifiant"</span>]] ; <span class="fu">class</span>(id)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_datatable[, identifiant] ; <span class="fu">class</span>(id)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Résultat sous forme de data.table</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_datatable[, <span class="st">"identifiant"</span>] ; <span class="fu">class</span>(id)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_datatable[, .(<span class="st">"identifiant"</span>)] ; <span class="fu">class</span>(id)</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_datatable[, <span class="fu">list</span>(<span class="st">"identifiant"</span>)] ; <span class="fu">class</span>(id)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-17-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-17-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="selection-de-colonnes-par-variable" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="selection-de-colonnes-par-variable"><span class="header-section-number">5.3</span> Selection de colonnes par variable</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-3" role="tab" aria-controls="tabset-18-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-4" role="tab" aria-controls="tabset-18-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-5" role="tab" aria-controls="tabset-18-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-18-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div class="sourceCode" id="cb75"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> <span class="fu">var</span> = identifiant Sexe note_contenu;</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Colonnes;</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Sélection de colonnes */</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas (<span class="kw">keep</span> = <span class="kw">&amp;var.</span>);</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Selection de colonnes */</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">keep</span> <span class="kw">&amp;var.</span>;</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-18-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"identifiant"</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Résultat sous forme de vecteur caractère</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_rbase[, variable] ; <span class="fu">class</span>(id)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_rbase[[variable]] ; <span class="fu">class</span>(id)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Résultat sous forme de data.frame</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_rbase[variable] ; <span class="fu">class</span>(id)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_rbase[, variable, drop <span class="ot">=</span> <span class="cn">FALSE</span>] ; <span class="fu">class</span>(id)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-18-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-18-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"identifiant"</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Sous forme de vecteur</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">pull</span>(<span class="fu">all_of</span>(variable))</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sous forme de tibble</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">all_of</span>(variable))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-18-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-18-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Résultat sous forme de vecteur caractère</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"identifiant"</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_datatable[[variable]] ; <span class="fu">class</span>(id)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Résultat sous forme de data.table</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_datatable[, .(variable)] ; <span class="fu">class</span>(id)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> donnees_datatable[, <span class="fu">list</span>(variable)] ; <span class="fu">class</span>(id)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-18-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-18-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="sauf-certaines-variables" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="sauf-certaines-variables"><span class="header-section-number">5.4</span> Sauf certaines variables</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-3" role="tab" aria-controls="tabset-19-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-4" role="tab" aria-controls="tabset-19-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-5" role="tab" aria-controls="tabset-19-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-19-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<div class="sourceCode" id="cb79"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> <span class="fu">var</span> = identifiant Sexe note_contenu;</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Colonnes;<span class="kw">set</span> donnees_sas (<span class="kw">drop</span> = <span class="kw">&amp;var.</span>)<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-19-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ne fonctionne pas !</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"identifiant"</span>, <span class="st">"sexe"</span>, <span class="st">"note_contenu"</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co">#exclusion_var &lt;- donnees_rbase[, -c(variable)]</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>exclusion_var <span class="ot">&lt;-</span> donnees_rbase[, <span class="fu">setdiff</span>(<span class="fu">names</span>(donnees_rbase), variable)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-19-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-19-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"identifiant"</span>, <span class="st">"sexe"</span>, <span class="st">"note_contenu"</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>exclusion_var <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!</span><span class="fu">all_of</span>(variable))</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>exclusion_var <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">all_of</span>(variable))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-19-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-19-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"identifiant"</span>, <span class="st">"sexe"</span>, <span class="st">"note_contenu"</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Ne fonctionne pas !</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="co">#exclusion_var &lt;- donnees_datatable[, -c(variable)]</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>exclusion_var <span class="ot">&lt;-</span> donnees_datatable[, <span class="fu">setdiff</span>(<span class="fu">names</span>(donnees_datatable), variable)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-19-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-19-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="sélectionner-la-3e-colonne" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="sélectionner-la-3e-colonne"><span class="header-section-number">5.5</span> Sélectionner la 3e colonne</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-3" role="tab" aria-controls="tabset-20-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-4" role="tab" aria-controls="tabset-20-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-5" role="tab" aria-controls="tabset-20-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-20-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<div class="sourceCode" id="cb83"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> contents<span class="kw"> data</span> = donnees_sas out = <span class="fu">Var</span> noprint<span class="kw">;run</span>;</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql noprint;</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> name <span class="kw">into</span> :nom_col separated <span class="kw">by</span> <span class="st">" "</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> <span class="fu">Var</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">where</span> <span class="fu">varnum</span> = <span class="dv">3</span>;</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Col3;<span class="kw">set</span> donnees_sas (<span class="kw">keep</span> = <span class="kw">&amp;nom_col.</span>)<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-20-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>col3 <span class="ot">&lt;-</span> donnees_rbase[, <span class="dv">3</span>]</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>col3 <span class="ot">&lt;-</span> donnees_rbase[<span class="dv">3</span>]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-20-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-20-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>col3 <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">pull</span>(<span class="dv">3</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>col3 <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">3</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-20-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-20-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>col3 <span class="ot">&lt;-</span> donnees_datatable[, <span class="dv">3</span>]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-20-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-20-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="sélectionner-plusieurs-colonnes" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="sélectionner-plusieurs-colonnes"><span class="header-section-number">5.6</span> Sélectionner plusieurs colonnes</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-3" role="tab" aria-controls="tabset-21-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-4" role="tab" aria-controls="tabset-21-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-5" role="tab" aria-controls="tabset-21-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-21-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<div class="sourceCode" id="cb87"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> <span class="fu">var</span> = identifiant note_contenu sexe;</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Colonnes;<span class="kw">set</span> donnees_sas (<span class="kw">keep</span> = <span class="kw">&amp;var.</span>)<span class="kw">;run</span>;</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">table</span> Colonnes <span class="kw">as</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> <span class="kw">%sysfunc</span>(<span class="fu">tranwrd</span>(<span class="kw">&amp;var.</span>, <span class="kw">%str</span>( ), <span class="kw">%str</span>(, )))</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> donnees_sas;</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-21-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"note_contenu"</span>, <span class="st">"sexe"</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>colonnes <span class="ot">&lt;-</span> donnees_rbase[, cols]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-21-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-21-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"note_contenu"</span>, <span class="st">"sexe"</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Plusieurs possibilités</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>colonnes <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">all_of</span>(cols))</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>colonnes <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">any_of</span>(cols))</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>colonnes <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select</span>({{cols}})</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>colonnes <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!!</span>cols)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-21-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-21-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"note_contenu"</span>, <span class="st">"sexe"</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Plusieurs écritures possibles</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Peut-être l'écriture la plus simple, à privilégier</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>colonnes <span class="ot">&lt;-</span> donnees_datatable[, <span class="fu">mget</span>(cols)]</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ecriture cohérente avec la logique data.table</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>colonnes <span class="ot">&lt;-</span> donnees_datatable[, .SD, .SDcols <span class="ot">=</span> cols]</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ecriture un peu contre-intuitve. Attention ! L'écriture est bien ..cols, et non ..(cols) !!</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Les syntaxes donnees_datatable[, ..(cols)] et donnees_datatable[, .(cols)] ne fonctionnent pas</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>colonnes <span class="ot">&lt;-</span> donnees_datatable[, ..cols]</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Ecriture avec with = FALSE : désactive la possibilité de se référer à des colonnes sans les guillemets</span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec with = FALSE : désactive la possibilité de se référer à des colonnes sans les guillemets</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>colonnes <span class="ot">&lt;-</span> donnees_datatable[, cols, with <span class="ot">=</span> <span class="cn">FALSE</span>]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-21-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-21-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="sélectionner-les-colonnes-qui-débutent-par-le-mot-note" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="sélectionner-les-colonnes-qui-débutent-par-le-mot-note"><span class="header-section-number">5.7</span> Sélectionner les colonnes qui débutent par le mot Note</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-3" role="tab" aria-controls="tabset-22-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-4" role="tab" aria-controls="tabset-22-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-5" role="tab" aria-controls="tabset-22-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-22-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<div class="sourceCode" id="cb91"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* 1ère solution */</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Selection_Variables;<span class="kw">set</span> donnees_sas (<span class="kw">keep</span> = <span class="fu">Note</span>:)<span class="kw">;run</span>;</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co">/* 2e solution */</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> contents<span class="kw"> data</span> = donnees_sas out = <span class="fu">Var</span> noprint<span class="kw">;run</span>;</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> name <span class="kw">into</span> :var_notes separated <span class="kw">by</span> <span class="st">" "</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> <span class="fu">Var</span> <span class="kw">where</span> <span class="fu">substr</span>(<span class="fu">upcase</span>(name), <span class="dv">1</span>, <span class="dv">4</span>) = <span class="st">"NOTE"</span> <span class="kw">order</span> <span class="kw">by</span> <span class="fu">varnum</span>;</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> datasets lib = Work nolist;<span class="kw">delete</span> <span class="fu">Var</span><span class="kw">;run</span>;</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas_Notes;<span class="kw">set</span> donnees_sas (<span class="kw">keep</span> = <span class="kw">&amp;var_notes.</span>)<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-22-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">grepl</span>(<span class="st">"^note"</span>, <span class="fu">names</span>(donnees_rbase))]</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">substr</span>(<span class="fu">tolower</span>(<span class="fu">names</span>(donnees_rbase)), <span class="dv">1</span>, <span class="dv">4</span>) <span class="sc">==</span> <span class="st">"note"</span>]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-22-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-22-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"note"</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-22-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-22-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1ère méthode</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">names</span>(donnees_datatable)[<span class="fu">substr</span>(<span class="fu">names</span>(donnees_datatable), <span class="dv">1</span>, <span class="dv">4</span>) <span class="sc">==</span> <span class="st">"note"</span>]</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>sel <span class="ot">&lt;-</span> donnees_datatable[, .SD, .SDcols <span class="ot">=</span> cols]</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2e méthode</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>sel <span class="ot">&lt;-</span> donnees_datatable[, .SD, .SDcols <span class="ot">=</span> <span class="fu">patterns</span>(<span class="st">"^note"</span>)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-22-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-22-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="sélectionner-les-colonnes-qui-ne-débutent-pas-par-le-mot-note" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="sélectionner-les-colonnes-qui-ne-débutent-pas-par-le-mot-note"><span class="header-section-number">5.8</span> Sélectionner les colonnes qui ne débutent pas par le mot Note</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-2" role="tab" aria-controls="tabset-23-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-3" role="tab" aria-controls="tabset-23-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-4" role="tab" aria-controls="tabset-23-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-5" role="tab" aria-controls="tabset-23-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-23-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">
<div class="sourceCode" id="cb95"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Selection_Variables;<span class="kw">set</span> donnees_sas (<span class="kw">drop</span> = <span class="fu">Note</span>:)<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-23-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-23-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> donnees_rbase[<span class="sc">!</span> <span class="fu">grepl</span>(<span class="st">"^note"</span>, <span class="fu">names</span>(donnees_rbase))]</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">substr</span>(<span class="fu">tolower</span>(<span class="fu">names</span>(donnees_rbase)), <span class="dv">1</span>, <span class="dv">4</span>) <span class="sc">!=</span> <span class="st">"note"</span>]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-23-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-23-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">"note"</span>))</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">"note"</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-23-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-23-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">names</span>(donnees_datatable)[<span class="fu">substr</span>(<span class="fu">names</span>(donnees_datatable), <span class="dv">1</span>, <span class="dv">4</span>) <span class="sc">==</span> <span class="st">"note"</span>]</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>sel <span class="ot">&lt;-</span> donnees_datatable[, .SD, .SDcols <span class="ot">=</span> <span class="sc">-</span>cols]</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>sel <span class="ot">&lt;-</span> donnees_datatable[, .SD, .SDcols <span class="ot">=</span> <span class="sc">-</span><span class="fu">patterns</span>(<span class="st">"^note"</span>)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-23-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-23-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="sélectionner-lensemble-des-variables-numériques-de-la-base" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="sélectionner-lensemble-des-variables-numériques-de-la-base"><span class="header-section-number">5.9</span> Sélectionner l’ensemble des variables numériques de la base</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-24-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-1" role="tab" aria-controls="tabset-24-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-2" role="tab" aria-controls="tabset-24-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-3" role="tab" aria-controls="tabset-24-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-4" role="tab" aria-controls="tabset-24-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-5" role="tab" aria-controls="tabset-24-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-24-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-24-1-tab">
<div class="sourceCode" id="cb99"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Colonnes;<span class="kw">set</span> donnees_sas (<span class="kw">keep</span> = _numeric_)<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-24-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-24-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>varNumeriques <span class="ot">&lt;-</span> donnees_rbase[, <span class="fu">sapply</span>(donnees_rbase, is.numeric), drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-24-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-24-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>varNumeriques <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select_if</span>(is.numeric)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>varNumeriques <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-24-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-24-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>sel <span class="ot">&lt;-</span> donnees_datatable[, .SD, .SDcols <span class="ot">=</span> is.numeric]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-24-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-24-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="sélectionner-lensemble-des-variables-de-format-date" class="level2" data-number="5.10">
<h2 data-number="5.10" class="anchored" data-anchor-id="sélectionner-lensemble-des-variables-de-format-date"><span class="header-section-number">5.10</span> Sélectionner l’ensemble des variables de format “Date”</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-25-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-1" role="tab" aria-controls="tabset-25-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-2" role="tab" aria-controls="tabset-25-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-3" role="tab" aria-controls="tabset-25-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-4" role="tab" aria-controls="tabset-25-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-5" role="tab" aria-controls="tabset-25-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-25-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-25-1-tab">
<div class="sourceCode" id="cb103"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> contents<span class="kw"> data</span> = donnees_sas out = <span class="fu">Var</span> noprint<span class="kw">;run</span>;</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql noprint;</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> name <span class="kw">into</span> :nom_col separated <span class="kw">by</span> <span class="st">" "</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> <span class="fu">Var</span> <span class="kw">where</span> <span class="kw">format</span> <span class="kw">not</span> <span class="kw">in</span> (<span class="st">"$"</span>, <span class="st">""</span>);</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Colonnes;<span class="kw">set</span> donnees_sas (<span class="kw">keep</span> = <span class="kw">&amp;nom_col.</span>)<span class="kw">;run</span>;</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> datasets lib = Work nolist;<span class="kw">delete</span> <span class="fu">Var</span><span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-25-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-25-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>varDates <span class="ot">&lt;-</span> donnees_rbase[, <span class="fu">sapply</span>(donnees_rbase, is.Date), drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>varDates <span class="ot">&lt;-</span> <span class="fu">Filter</span>(is.Date, donnees_rbase)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-25-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-25-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>varDates <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select_if</span>(is.Date)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>varDates <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">where</span>(is.Date))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-25-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-25-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>var_dates <span class="ot">&lt;-</span> donnees_datatable[, .SD, .SDcols <span class="ot">=</span> is.Date]</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sélection de lignes</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-25-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-25-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="sélectionner-des-lignes" class="level2" data-number="5.11">
<h2 data-number="5.11" class="anchored" data-anchor-id="sélectionner-des-lignes"><span class="header-section-number">5.11</span> Sélectionner des lignes</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-26-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-1" role="tab" aria-controls="tabset-26-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-2" role="tab" aria-controls="tabset-26-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-3" role="tab" aria-controls="tabset-26-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-4" role="tab" aria-controls="tabset-26-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-5" role="tab" aria-controls="tabset-26-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-26-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-26-1-tab">
<div class="sourceCode" id="cb107"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* 3e ligne */</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Ligne3;<span class="kw">set</span> donnees_sas (firstobs = <span class="dv">3</span> obs = <span class="dv">3</span>)<span class="kw">;run</span>;</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="co">/* Sélection des 3 premières lignes et des 3 premières colonnes de la base */</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> contents<span class="kw"> data</span> = donnees_sas out = <span class="fu">Var</span> noprint<span class="kw">;run</span>;</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql noprint;</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> name <span class="kw">into</span> :nom_col separated <span class="kw">by</span> <span class="st">" "</span> <span class="kw">from</span> <span class="fu">Var</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">where</span> <span class="dv">1</span> &lt;= <span class="fu">varnum</span> &lt;= <span class="dv">3</span>;</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Top3;</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas (firstobs = <span class="dv">1</span> obs = <span class="dv">3</span> <span class="kw">keep</span> = <span class="kw">&amp;nom_col.</span>);</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> datasets lib = Work nolist;<span class="kw">delete</span> <span class="fu">Var</span><span class="kw">;run</span>;</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a><span class="co">/* Sélection de lignes */</span></span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a><span class="co">/* Entrées en 2023 */</span></span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> En2023;</span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas (<span class="kw">where</span> = (<span class="fu">year</span>(date_entree) = <span class="dv">2023</span>));</span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Avant2023_femme;</span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas (<span class="kw">where</span> = (<span class="fu">year</span>(date_entree) &lt; <span class="dv">2023</span> <span class="kw">and</span> sexe = <span class="dv">2</span>));</span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-26-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-26-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sélection des 3 premières lignes et des 3 premières colonnes de la base</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>top3 <span class="ot">&lt;-</span> donnees_rbase[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 3e ligne</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>ligne3 <span class="ot">&lt;-</span> donnees_rbase[<span class="dv">3</span>, ]</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Sélection de lignes</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Entrées en 2023</span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">ATTENTION</span><span class="co">, solution qui ne fonctionne pas toujours bien ! En effet, les valeurs manquantes sont sélectionnées !</span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>en2023 <span class="ot">&lt;-</span> donnees_rbase[lubridate<span class="sc">::</span><span class="fu">year</span>(donnees_rbase<span class="sc">$</span>date_entree) <span class="sc">==</span> <span class="dv">2023</span>, ]</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Bonnes écritures, qui excluent les valeurs manquantes</span></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>en2023 <span class="ot">&lt;-</span> donnees_rbase[lubridate<span class="sc">::</span><span class="fu">year</span>(donnees_rbase<span class="sc">$</span>date_entree) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2023</span>), ]</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>en2023 <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">which</span>(lubridate<span class="sc">::</span><span class="fu">year</span>(donnees_rbase<span class="sc">$</span>date_entree) <span class="sc">==</span> <span class="dv">2023</span>), ]</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>en2023 <span class="ot">&lt;-</span> <span class="fu">subset</span>(donnees_rbase, lubridate<span class="sc">::</span><span class="fu">year</span>(donnees_rbase<span class="sc">$</span>date_entree) <span class="sc">==</span> <span class="dv">2023</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-26-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-26-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sélection des 3 premières lignes et des 3 premières colonnes de la base</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>top3 <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 3e ligne</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>ligne3 <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">3</span>)</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Sélection de lignes</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Entrées en 2023</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>en2023 <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">filter</span>(lubridate<span class="sc">::</span><span class="fu">year</span>(date_entree) <span class="sc">==</span> <span class="dv">2023</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-26-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-26-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>top3 <span class="ot">&lt;-</span> donnees_datatable[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 3e ligne</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>ligne3 <span class="ot">&lt;-</span> donnees_datatable[<span class="dv">3</span>, ]</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>ligne3 <span class="ot">&lt;-</span> donnees_datatable[<span class="dv">3</span>]</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Sélection de lignes</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Entrées en 2023</span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Pas de problème avec les valeurs manquantes comme pour la syntaxe en R-Base</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>en2023 <span class="ot">&lt;-</span> donnees_datatable[lubridate<span class="sc">::</span><span class="fu">year</span>(date_entree) <span class="sc">==</span> <span class="dv">2023</span>, ]</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>en2023 <span class="ot">&lt;-</span> donnees_datatable[lubridate<span class="sc">::</span><span class="fu">year</span>(date_entree) <span class="sc">==</span> <span class="dv">2023</span>]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-26-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-26-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="sélection-sur-de-multiples-conditions" class="level2" data-number="5.12">
<h2 data-number="5.12" class="anchored" data-anchor-id="sélection-sur-de-multiples-conditions"><span class="header-section-number">5.12</span> Sélection sur de multiples conditions</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-27-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-1" role="tab" aria-controls="tabset-27-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-2" role="tab" aria-controls="tabset-27-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-3" role="tab" aria-controls="tabset-27-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-4" role="tab" aria-controls="tabset-27-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-5" role="tab" aria-controls="tabset-27-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-27-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-27-1-tab">
<div class="sourceCode" id="cb111"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Ecriture incorrecte. Les valeurs manquantes sont considérées comme des nombres négatifs faibles, et inférieurs à 2023. */</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="co">/* Ils sont sélectionnés dans le code suivant : */</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Avant2023_Femme;</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas (<span class="kw">where</span> = (<span class="fu">year</span>(date_entree) &lt; <span class="dv">2023</span> <span class="kw">and</span> sexe = <span class="dv">2</span>));</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a><span class="co">/* Ecriture correcte */</span></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Avant2023_Femme;</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas (<span class="kw">where</span> = (<span class="fu">year</span>(date_entree) &lt; <span class="dv">2023</span> <span class="kw">and</span> <span class="kw">not</span> missing(date_entree) <span class="kw">and</span> sexe = <span class="dv">2</span>));</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-27-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-27-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>avant2023_femme <span class="ot">&lt;-</span> <span class="fu">subset</span>(donnees_rbase, lubridate<span class="sc">::</span><span class="fu">year</span>(date_entree) <span class="sc">&lt;</span> <span class="dv">2023</span> <span class="sc">&amp;</span> sexe <span class="sc">==</span> <span class="st">"2"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-27-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-27-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>avant2023_femme <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(lubridate<span class="sc">::</span><span class="fu">year</span>(date_entree) <span class="sc">&lt;</span> <span class="dv">2023</span> <span class="sc">&amp;</span> sexe <span class="sc">==</span> <span class="st">"2"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-27-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-27-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>avant2023_femme <span class="ot">&lt;-</span> donnees_datatable[lubridate<span class="sc">::</span><span class="fu">year</span>(date_entree) <span class="sc">&lt;</span> <span class="dv">2023</span> <span class="sc">&amp;</span> sexe <span class="sc">==</span> <span class="st">"2"</span>]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-27-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-27-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="sélection-de-ligne-par-référence-lignes-de-lidentifiant-087" class="level2" data-number="5.13">
<h2 data-number="5.13" class="anchored" data-anchor-id="sélection-de-ligne-par-référence-lignes-de-lidentifiant-087"><span class="header-section-number">5.13</span> Sélection de ligne par référence : lignes de l’identifiant 087</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-28-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-1" role="tab" aria-controls="tabset-28-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-28-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-2" role="tab" aria-controls="tabset-28-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-28-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-3" role="tab" aria-controls="tabset-28-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-28-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-4" role="tab" aria-controls="tabset-28-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-28-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-5" role="tab" aria-controls="tabset-28-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-28-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-28-1-tab">
<div class="sourceCode" id="cb115"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> <span class="fu">var</span> = identifiant;</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> sel = <span class="dv">087</span>;</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Selection;</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> <span class="kw">&amp;var.</span> <span class="kw">in</span> (<span class="st">"&amp;sel."</span>);</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-28-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-28-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"identifiant"</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>sel <span class="ot">&lt;-</span> <span class="st">"087"</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>donnees_rbase[donnees_rbase[, variable] <span class="sc">%in%</span> sel, ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-28-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-28-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">filter</span>(identifiant <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"087"</span>)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(identifiant)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">filter</span>(identifiant <span class="sc">==</span> <span class="st">"087"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(identifiant)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Essayons désormais par variables</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"identifiant"</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>sel <span class="ot">&lt;-</span> <span class="st">"087"</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : peut-on faire plus simplement ?</span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">get</span>(variable) <span class="sc">%in%</span> sel) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">all_of</span>(variable))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-28-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-28-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"identifiant"</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>sel <span class="ot">&lt;-</span> <span class="st">"087"</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>donnees_datatable[donnees_datatable[[variable]] <span class="sc">%chin%</span> sel, ]</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>donnees_datatable[donnees_datatable[[variable]] <span class="sc">%chin%</span> sel, ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-28-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-28-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="sélection-de-lignes-et-de-variables" class="level2" data-number="5.14">
<h2 data-number="5.14" class="anchored" data-anchor-id="sélection-de-lignes-et-de-variables"><span class="header-section-number">5.14</span> Sélection de lignes et de variables</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-29-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-1" role="tab" aria-controls="tabset-29-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-29-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-2" role="tab" aria-controls="tabset-29-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-29-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-3" role="tab" aria-controls="tabset-29-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-29-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-4" role="tab" aria-controls="tabset-29-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-29-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-5" role="tab" aria-controls="tabset-29-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-29-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-29-1-tab">
<div class="sourceCode" id="cb119"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> cols = identifiant note_contenu sexe;</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Femmes;</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas (<span class="kw">where</span> = (Sexe = <span class="dv">2</span>) <span class="kw">keep</span> = <span class="kw">&amp;cols.</span>);</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Femmes;</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> Sexe = <span class="dv">2</span>;</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">keep</span> <span class="kw">&amp;cols.</span>;</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a><span class="co">/* Par nom ou par variable */</span></span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> <span class="fu">var</span> = identifiant Sexe note_contenu;</span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Femmes;</span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Sélection de colonnes */</span></span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas (<span class="kw">keep</span> = <span class="kw">&amp;var.</span>);</span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Sélection de lignes respectant une certaine condition */</span></span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> Sexe = <span class="st">"2"</span>;</span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Création de colonne */</span></span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>  note2 = note_contenu / <span class="dv">20</span> * <span class="dv">5</span>;</span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Suppression de colonnes */</span></span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">drop</span> Sexe;</span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Selection de colonnes */</span></span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a>  <span class="kw">keep</span> identifiant Sexe note_contenu;</span>
<span id="cb119-24"><a href="#cb119-24" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-29-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-29-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"note_contenu"</span>, <span class="st">"sexe"</span>, <span class="st">"date_naissance"</span>)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>femmes <span class="ot">&lt;-</span> donnees_rbase[donnees_rbase<span class="sc">$</span>sexe <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"2"</span>), cols]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-29-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-29-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"note_contenu"</span>, <span class="st">"sexe"</span>, <span class="st">"date_naissance"</span>)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>femmes <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sexe <span class="sc">==</span> <span class="st">"2"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">all_of</span>(cols))</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>femmes <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sexe <span class="sc">==</span> <span class="st">"2"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>({{cols}})</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-29-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-29-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"note_contenu"</span>, <span class="st">"sexe"</span>, <span class="st">"date_naissance"</span>)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>femmes <span class="ot">&lt;-</span> donnees_datatable[sexe <span class="sc">==</span> <span class="st">"2"</span>, ..cols]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-29-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-29-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : compléter</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="co">#requete_duckdb %&gt;% filter(sexe == "2")</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="manipuler-des-lignes-et-des-colonnes" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Manipuler des lignes et des colonnes</h1>
<section id="renommer-des-variables" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="renommer-des-variables"><span class="header-section-number">6.1</span> Renommer des variables</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-30-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-1" role="tab" aria-controls="tabset-30-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-2" role="tab" aria-controls="tabset-30-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-3" role="tab" aria-controls="tabset-30-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-4" role="tab" aria-controls="tabset-30-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-5" role="tab" aria-controls="tabset-30-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-30-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-30-1-tab">
<div class="sourceCode" id="cb124"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas (<span class="kw">rename</span> = (sexe = sexe2));</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">rename</span> sexe2 = sexe;</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-30-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-30-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On renomme la variable sexe en sexe_red</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(donnees_rbase)[<span class="fu">names</span>(donnees_rbase) <span class="sc">==</span> <span class="st">"sexe"</span>] <span class="ot">&lt;-</span> <span class="st">"sexe_red"</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="co"># On la renomme en sexe</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(donnees_rbase)[<span class="fu">names</span>(donnees_rbase) <span class="sc">==</span> <span class="st">"sexe_red"</span>] <span class="ot">&lt;-</span> <span class="st">"sexe"</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-30-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-30-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On renomme la variable sexe en sexe_red</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sexe_red =</span> sexe)</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="co"># On la renomme en sexe</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sexe =</span> sexe_red)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-30-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-30-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On renomme la variable sexe en sexe_red</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(donnees_datatable)[<span class="fu">names</span>(donnees_datatable) <span class="sc">==</span> <span class="st">"sexe"</span>] <span class="ot">&lt;-</span> <span class="st">"sexe_red"</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="co"># On la renomme en sexe</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(donnees_datatable)[<span class="fu">names</span>(donnees_datatable) <span class="sc">==</span> <span class="st">"sexe_red"</span>] <span class="ot">&lt;-</span> <span class="st">"sexe"</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="co"># En data.table, les instructions débutant par set modifient les éléments par référence, c'est-à-dire sans copie.</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ceci est plus efficace pour manipuler des données volumineuses.</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(donnees_datatable, <span class="st">"sexe"</span>, <span class="st">"sexe_red"</span>)</span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(donnees_datatable, <span class="st">"sexe_red"</span>, <span class="st">"sexe"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-30-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-30-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On renomme la variable sexe en sexe_red</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">sexe_red =</span> sexe)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="co"># On la renomme en sexe</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">sexe =</span> sexe_red)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="formater-les-modalités-des-valeurs" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="formater-les-modalités-des-valeurs"><span class="header-section-number">6.2</span> Formater les modalités des valeurs</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-31-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-1" role="tab" aria-controls="tabset-31-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-31-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-2" role="tab" aria-controls="tabset-31-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-31-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-3" role="tab" aria-controls="tabset-31-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-31-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-4" role="tab" aria-controls="tabset-31-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-31-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-5" role="tab" aria-controls="tabset-31-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-31-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-31-1-tab">
<div class="sourceCode" id="cb129"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Utilisation des formats */</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> <span class="kw">format</span>;</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Variable discrète */</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  value sexef</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> = <span class="st">"Homme"</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span> = <span class="st">"Femme"</span>;</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Variable continue */</span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>  value agef</span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>  low-&lt;<span class="dv">26</span> = <span class="st">"1. De 15 à 25 ans"</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>  <span class="dv">26</span>&lt;-&lt;<span class="dv">50</span> = <span class="st">"2. De 26 à 49 ans"</span></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>  <span class="dv">50</span>-high = <span class="st">"3. 50 ans ou plus"</span>;</span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Variable caractère */</span></span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>  value $ cspf</span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">'1'</span> = <span class="st">"Cadre"</span></span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">'2'</span> = <span class="st">"Profession intermédiaire"</span></span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">'3'</span> = <span class="st">"Employé"</span></span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">'4'</span> = <span class="st">"Ouvrier"</span></span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">'5'</span> = <span class="st">"Retraité"</span>;</span>
<span id="cb129-21"><a href="#cb129-21" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-31-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-31-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>sexef <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Homme"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"Femme"</span>)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>cspf <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Cadre"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"Profession intermédiaire"</span>, <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"Employé"</span>, <span class="st">"4"</span> <span class="ot">=</span> <span class="st">"Ouvrier"</span>, <span class="st">"5"</span> <span class="ot">=</span> <span class="st">"Retraité"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-31-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-31-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>sexef_format <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Homme"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"Femme"</span>)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>cspf_format <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Cadre"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"Profession intermédiaire"</span>, <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"Employé"</span>, <span class="st">"4"</span> <span class="ot">=</span> <span class="st">"Ouvrier"</span>, <span class="st">"5"</span> <span class="ot">=</span> <span class="st">"Retraité"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-31-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-31-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>sexeform <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Homme"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"Femme"</span>)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>cspform <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Cadre"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"Profession intermédiaire"</span>, <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"Employé"</span>, <span class="st">"4"</span> <span class="ot">=</span> <span class="st">"Ouvrier"</span>, <span class="st">"5"</span> <span class="ot">=</span> <span class="st">"Retraité"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-31-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-31-5-tab">
<p>Préférer <code>case_match</code> quand il s’agit de valeurs déterminées.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> </span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sexef =</span> <span class="fu">case_when</span>(</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>    sexef<span class="sc">==</span><span class="st">"1"</span> <span class="sc">~</span> <span class="st">"Homme"</span>,</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>    sexef<span class="sc">==</span><span class="st">"2"</span> <span class="sc">~</span> <span class="st">"Femme"</span>,</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">.default =</span> sexef),</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">cspf =</span> <span class="fu">case_match</span>(csp,</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1"</span> <span class="sc">~</span> <span class="st">"Cadre"</span>,</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2"</span> <span class="sc">~</span> <span class="st">"Profession intermédiaire"</span>,</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"3"</span> <span class="sc">~</span> <span class="st">"Employé"</span>,</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"4"</span> <span class="sc">~</span> <span class="st">"Ouvrier"</span>,</span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"5"</span> <span class="sc">~</span> <span class="st">"Retraité"</span>,</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">.default =</span> csp)) <span class="sc">%&gt;%</span> </span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Sexe, sexef, csp, cspf)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="utiliser-les-formats" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="utiliser-les-formats"><span class="header-section-number">6.3</span> Utiliser les formats</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-32-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-1" role="tab" aria-controls="tabset-32-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-2" role="tab" aria-controls="tabset-32-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-3" role="tab" aria-controls="tabset-32-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-4" role="tab" aria-controls="tabset-32-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-5" role="tab" aria-controls="tabset-32-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-32-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-32-1-tab">
<div class="sourceCode" id="cb134"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Exprimer dans le format sexef (Hommes / Femmes) */</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Sexef $<span class="dv">25</span>.;</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>  Sexef = <span class="kw">put</span>(Sexe, sexef.);</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* On exprime la CSP en texte dans une variable CSPF avec le format */</span></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> CSPF $<span class="dv">25</span>.;</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>  CSPF = <span class="kw">put</span>(CSP, $cspf.);</span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-32-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-32-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On exprime CSP et sexe en formaté</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>cspf <span class="ot">&lt;-</span> cspf[donnees_rbase<span class="sc">$</span>csp]</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>sexef <span class="ot">&lt;-</span> sexef[donnees_rbase<span class="sc">$</span>sexe]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-32-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-32-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On exprime CSP et sexe en formaté</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sexef =</span> sexef_format[sexe],</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">cspf =</span> cspf_format[csp])</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Les éventuelles valeurs manquantes sont conservées en NA</span></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">sexef =</span> <span class="fu">case_when</span>(</span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>      sexe <span class="sc">==</span> <span class="st">"1"</span> <span class="sc">~</span> <span class="st">"Homme"</span>,</span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>      sexe <span class="sc">==</span> <span class="st">"2"</span> <span class="sc">~</span> <span class="st">"Femme"</span>,</span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span>        <span class="sc">~</span> sexe),</span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">cspf =</span> <span class="fu">case_when</span>(</span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a>      csp <span class="sc">==</span> <span class="st">"1"</span> <span class="sc">~</span> <span class="st">"Cadre"</span>,</span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a>      csp <span class="sc">==</span> <span class="st">"2"</span> <span class="sc">~</span> <span class="st">"Profession intermédiaire"</span>,</span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a>      csp <span class="sc">==</span> <span class="st">"3"</span> <span class="sc">~</span> <span class="st">"Employé"</span>,</span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a>      csp <span class="sc">==</span> <span class="st">"4"</span> <span class="sc">~</span> <span class="st">"Ouvrier"</span>,</span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a>      csp <span class="sc">==</span> <span class="st">"5"</span> <span class="sc">~</span> <span class="st">"Retraité"</span>,</span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span>       <span class="sc">~</span> csp)</span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Syntaxe pour attribuer une valeur aux NA</span></span>
<span id="cb136-23"><a href="#cb136-23" aria-hidden="true" tabindex="-1"></a>valeurAuxNA <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb136-24"><a href="#cb136-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sexef =</span> <span class="fu">case_when</span>(</span>
<span id="cb136-25"><a href="#cb136-25" aria-hidden="true" tabindex="-1"></a>    sexe <span class="sc">==</span> <span class="st">"1"</span> <span class="sc">~</span> <span class="st">"Homme"</span>,</span>
<span id="cb136-26"><a href="#cb136-26" aria-hidden="true" tabindex="-1"></a>    sexe <span class="sc">==</span> <span class="st">"2"</span> <span class="sc">~</span> <span class="st">"Femme"</span>,</span>
<span id="cb136-27"><a href="#cb136-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(x)    <span class="sc">~</span> <span class="st">"Inconnu"</span>,</span>
<span id="cb136-28"><a href="#cb136-28" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span>        <span class="sc">~</span> sexe))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-32-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-32-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On exprime CSP et sexe en formaté</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="st">`</span><span class="at">:=</span><span class="st">`</span> (<span class="at">cspf =</span> cspform[csp], <span class="at">sexef =</span> sexeform[sexe])]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-32-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-32-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="transformer-le-format-dune-variable" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="transformer-le-format-dune-variable"><span class="header-section-number">6.4</span> Transformer le format d’une variable</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-33-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-1" role="tab" aria-controls="tabset-33-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-33-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-2" role="tab" aria-controls="tabset-33-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-33-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-3" role="tab" aria-controls="tabset-33-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-33-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-4" role="tab" aria-controls="tabset-33-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-33-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-5" role="tab" aria-controls="tabset-33-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-33-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-33-1-tab">
<div class="sourceCode" id="cb138"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Transformer la variable Sexe en caractère */</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>  Sexe_car = <span class="kw">put</span>(Sexe, $<span class="dv">1</span>.);</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Transformer la variable Sexe_car en numérique */</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>  Sexe_num = <span class="kw">input</span>(Sexe_car, <span class="dv">1</span>.);</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Transformer une date d'un format caractère à un format Date */</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> <span class="fu">date</span> $<span class="dv">10</span>.;</span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">date</span> = <span class="st">"01/01/2000"</span>;</span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> date_sas yymmdd10.;</span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a>  date_sas = <span class="kw">input</span>(<span class="fu">date</span>, ddmmyy10.);</span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-33-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-33-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformer la variable sexe en numérique</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>sexe_numerique <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(donnees_rbase<span class="sc">$</span>sexe)</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformer la variable sexe_numerique en caractère</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>sexe_caractere <span class="ot">&lt;-</span> <span class="fu">as.character</span>(donnees_rbase<span class="sc">$</span>sexe_numerique)</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformer une date d'un format caractère à un format Date</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>date_r <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">dmy</span>(<span class="st">"01/01/2000"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-33-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-33-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformer la variable sexe en numérique</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span>  </span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sexe_numerique =</span> <span class="fu">as.numeric</span>(sexe))</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformer la variable sexe_numerique en caractère</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sexe_caractere =</span> <span class="fu">as.character</span>(sexe_numerique))</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformer une date d'un format caractère à un format Date</span></span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span>  </span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date_r =</span> lubridate<span class="sc">::</span><span class="fu">dmy</span>(<span class="st">"01/01/2000"</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-33-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-33-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformer la variable sexe en numérique</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, sexe_numerique <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(sexe)]</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformer la variable sexe_numerique en caractère</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, sexe_caractere <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(sexe_numerique)]</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformer une date d'un format caractère à un format Date</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, date_r <span class="sc">:</span><span class="er">=</span> lubridate<span class="sc">::</span><span class="fu">dmy</span>(<span class="st">"01/01/2000"</span>)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-33-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-33-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="co">#enNumerique &lt;- c("Duree", "Note_Contenu", "Note_Formateur", "Note_Moyens", "Note_Accompagnement", "Note_Materiel")</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="co">#enDate &lt;- c('Date_naissance', 'Date_entree')</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="co">#requete_duckdb %&gt;%  </span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  mutate_at(enNumerique, as.integer) %&gt;% </span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  mutate(poids_sondage=as.numeric(poids_sondage)) %&gt;%</span></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  mutate_at(enDate, ~ as.Date(strptime(.,'%d/%m/%Y'))) %&gt;% # strptime est une fonction duckdb</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  select(enDate, Duree, Note_Contenu)</span></span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note : <code>duckdb</code> fait des conversions de type implicitement, mais seulement les conversions incontestables. Il faudra souvent préciser le type des variables.</p>
</div>
</div>
</div>
</section>
<section id="création-et-suppressions-de-plusieurs-variables" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="création-et-suppressions-de-plusieurs-variables"><span class="header-section-number">6.5</span> Création et suppressions de plusieurs variables</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-34-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-1" role="tab" aria-controls="tabset-34-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-2" role="tab" aria-controls="tabset-34-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-3" role="tab" aria-controls="tabset-34-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-4" role="tab" aria-controls="tabset-34-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-5" role="tab" aria-controls="tabset-34-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-34-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-34-1-tab">
<div class="sourceCode" id="cb143"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Manipulation de colonnes par référence */</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Creation;</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  note_contenu2 = note_contenu / <span class="dv">20</span> * <span class="dv">5</span>;</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>  note_formateur2 = note_formateur / <span class="dv">20</span> * <span class="dv">5</span>;</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Suppression des variables créées */</span></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">drop</span> note_contenu2 note_formateur2;</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a><span class="co">/* Par nom ou par variable */</span></span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> <span class="fu">var</span> = identifiant Sexe note_contenu;</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Femmes;</span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Sélection de colonnes */</span></span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas (<span class="kw">keep</span> = <span class="kw">&amp;var.</span>);</span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Sélection de lignes respectant une certaine condition */</span></span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> Sexe = <span class="st">"2"</span>;</span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Création de colonne */</span></span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a>  note2 = note_contenu / <span class="dv">20</span> * <span class="dv">5</span>;</span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Suppression de colonnes */</span></span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">drop</span> note2;</span>
<span id="cb143-21"><a href="#cb143-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Selection de colonnes */</span></span>
<span id="cb143-22"><a href="#cb143-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">keep</span> identifiant Sexe note_contenu;</span>
<span id="cb143-23"><a href="#cb143-23" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-34-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-34-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>note2 <span class="ot">&lt;-</span> donnees_rbase<span class="sc">$</span>note_contenu <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">5</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Le with permet de s'affranchir des expressions "donnees_rbase$"</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(donnees_rbase, note2 <span class="ot">&lt;-</span> note_contenu <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">5</span>)</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> <span class="fu">transform</span>(donnees_rbase, <span class="at">note2 =</span> note_contenu <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">5</span>)</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="co"># On ne peut pas utiliser transform pour des variables récemment créées</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a><span class="co">#donnees_rbase &lt;- transform(donnees_rbase, note3 = note_contenu ** 2, note3 = log(note3))</span></span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppression de variables</span></span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>note2 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Création et suppressions de plusieurs variables</span></span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> <span class="fu">transform</span>(donnees_rbase, <span class="at">note_contenu2 =</span> note_contenu <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">5</span>, <span class="at">note_formateur2 =</span> note_formateur <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">5</span>)</span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppression des variables créées</span></span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu2"</span>, <span class="st">"note_formateur2"</span>)</span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a>donnees_rbase[, variable] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-34-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-34-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">note2 =</span> note_contenu <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">5</span>)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppression de variables</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>note2)</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Création et suppressions de plusieurs variables</span></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">note_contenu2 =</span> note_contenu <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">5</span>,</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">note_formateur2 =</span> note_formateur <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">5</span>)</span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppression des variables créées</span></span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu2"</span>, <span class="st">"note_formateur2"</span>)</span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">all_of</span>(variable))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-34-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-34-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création de variables</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, note2 <span class="sc">:</span><span class="er">=</span> note_contenu <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">5</span>]</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppression de variables</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, note2 <span class="sc">:</span><span class="er">=</span> <span class="cn">NULL</span>]</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Création et suppressions de plusieurs variables</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">c</span>(<span class="st">"note_contenu2"</span>, <span class="st">"note_formateur2"</span>) <span class="sc">:</span><span class="er">=</span> <span class="fu">list</span>(note_contenu <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">5</span>, note_formateur <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">5</span>)]</span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="st">`</span><span class="at">:=</span><span class="st">`</span> (<span class="at">note_contenu2 =</span> note_contenu <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">5</span>, <span class="at">note_formateur2 =</span> note_formateur <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">5</span>)]</span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppression des variables créées</span></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">c</span>(<span class="st">"note_contenu2"</span>, <span class="st">"note_formateur2"</span>) <span class="sc">:</span><span class="er">=</span> <span class="cn">NULL</span>]</span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Ou par référence extérieure</span></span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu2"</span>, <span class="st">"note_formateur2"</span>)</span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="st">`</span><span class="at">:=</span><span class="st">`</span> (<span class="at">note_contenu2 =</span> note_contenu <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">5</span>, <span class="at">note_formateur2 =</span> note_formateur <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">5</span>)]</span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, (variable) <span class="sc">:</span><span class="er">=</span> <span class="cn">NULL</span>]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-34-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-34-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : à compléter !</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Création de la colonne note2</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> </span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">note2 =</span> <span class="fu">as.integer</span>(Note_Contenu) <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(note2)</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppression de colonnes</span></span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a><span class="co">#requete_duckdb %&gt;% select(- CSP, -contains("Date"), -starts_with("Note"))</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="on-souhaite-réexprimer-toutes-les-notes-sur-100-et-non-sur-20" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="on-souhaite-réexprimer-toutes-les-notes-sur-100-et-non-sur-20"><span class="header-section-number">6.6</span> On souhaite réexprimer toutes les notes sur 100 et non sur 20</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-35-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-35-1" role="tab" aria-controls="tabset-35-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-35-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-35-2" role="tab" aria-controls="tabset-35-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-35-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-35-3" role="tab" aria-controls="tabset-35-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-35-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-35-4" role="tab" aria-controls="tabset-35-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-35-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-35-5" role="tab" aria-controls="tabset-35-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-35-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-35-1-tab">
<div class="sourceCode" id="cb148"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> notes = Note_Contenu   Note_Formateur Note_Moyens     Note_Accompagnement     Note_Materiel;</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="co">/* On supprime d'abord les doubles blancs entre les variables */</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> notes = <span class="kw">%sysfunc</span>(<span class="fu">compbl</span>(<span class="kw">&amp;notes.</span>));</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="co">/* on affiche les notes dans la log de SAS */</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a><span class="kw">%put</span> <span class="kw">&amp;notes;</span></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a><span class="co">/* 1ère solution : avec les array */</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a><span class="co">/* Les variables sont modifiées dans cet exemple */</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Sur100_1;</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">array</span> variables (*) <span class="kw">&amp;notes.</span>;</span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a><span class="kw">  do</span> increment = <span class="dv">1</span> <span class="kw">to</span> <span class="fu">dim</span>(variables);</span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a>    variables[increment] = variables[increment] / <span class="dv">20</span> * <span class="dv">100</span>;</span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a><span class="kw">  end</span>; </span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">drop</span> increment;</span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true" tabindex="-1"></a><span class="co">/* 2e solution : avec une macro */</span></span>
<span id="cb148-17"><a href="#cb148-17" aria-hidden="true" tabindex="-1"></a><span class="co">/* De nouvelles variables sont ajoutées dans cet exemple */</span></span>
<span id="cb148-18"><a href="#cb148-18" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb148-19"><a href="#cb148-19" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb148-20"><a href="#cb148-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%macro</span> Sur100;</span>
<span id="cb148-21"><a href="#cb148-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%do</span> i = <span class="dv">1</span> <span class="kw">%to</span> <span class="kw">%sysfunc</span>(countw(<span class="kw">&amp;notes.</span>));</span>
<span id="cb148-22"><a href="#cb148-22" aria-hidden="true" tabindex="-1"></a>      <span class="kw">%let</span> <span class="fu">note</span> = <span class="kw">%scan</span>(<span class="kw">&amp;notes.</span>, <span class="kw">&amp;i.</span>);</span>
<span id="cb148-23"><a href="#cb148-23" aria-hidden="true" tabindex="-1"></a>      <span class="kw">&amp;note.</span>_100 = <span class="kw">&amp;note.</span> / <span class="dv">20</span> * <span class="dv">100</span>;</span>
<span id="cb148-24"><a href="#cb148-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%end</span>;</span>
<span id="cb148-25"><a href="#cb148-25" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%mend</span> Sur100;</span>
<span id="cb148-26"><a href="#cb148-26" aria-hidden="true" tabindex="-1"></a>  %Sur100;</span>
<span id="cb148-27"><a href="#cb148-27" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-35-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-35-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">names</span>(donnees_rbase)[<span class="fu">grepl</span>(<span class="st">"^note"</span>, <span class="fu">names</span>(donnees_rbase))]</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Les variables sont modifiées dans cet exemple</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>sur100 <span class="ot">&lt;-</span> donnees_rbase[, notes] <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="co"># On  souhaite conserver les notes sur 100 dans d'autres variables, suffixées par _100</span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>donnees_rbase[, <span class="fu">paste0</span>(notes, <span class="st">"_100"</span>)] <span class="ot">&lt;-</span> donnees_rbase[, notes] <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-35-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-35-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Les variables sont modifiées dans cet exemple</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>sur100 <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"note"</span>), <span class="sc">~</span> .x <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">100</span>))</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a><span class="co"># On  souhaite conserver les notes sur 100 dans d'autres variables, suffixées par _100</span></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">names</span>(donnees_tidyverse)[<span class="fu">grepl</span>(<span class="st">"^note"</span>, <span class="fu">names</span>(donnees_tidyverse))]</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"note"</span>), <span class="sc">~</span> .x <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">100</span>, <span class="at">.names =</span> <span class="st">"{.col}_100"</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-35-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-35-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">names</span>(donnees_datatable)[<span class="fu">grepl</span>(<span class="st">"^note"</span>, <span class="fu">names</span>(donnees_datatable))]</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Les variables sont modifiées dans cet exemple</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>sur100 <span class="ot">&lt;-</span> <span class="fu">copy</span>(donnees_datatable)</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>sur100 <span class="ot">&lt;-</span> sur100[, (notes) <span class="sc">:</span><span class="er">=</span> <span class="fu">lapply</span>(.SD, <span class="cf">function</span>(x) x <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">100</span>), .SDcols <span class="ot">=</span> notes]</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>sur100 <span class="ot">&lt;-</span> sur100[, (notes) <span class="sc">:</span><span class="er">=</span> <span class="fu">lapply</span>(.SD, <span class="cf">function</span>(x) x <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">100</span>), .SD <span class="ot">=</span> notes]</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ou encore, plus simple</span></span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Dans cet exemple, les notes dans la base donnees_datatable ne sont pas changées</span></span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>sur100 <span class="ot">&lt;-</span> sur100[, <span class="fu">lapply</span>(.SD, <span class="cf">function</span>(x) x <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">100</span>), .SDcols <span class="ot">=</span> <span class="fu">patterns</span>(<span class="st">"^note"</span>)]</span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a><span class="co"># On  souhaite conserver les notes sur 20 dans d'autres variables, suffixées par _20</span></span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, (<span class="fu">paste0</span>(notes, <span class="st">"_100"</span>)) <span class="sc">:</span><span class="er">=</span> <span class="fu">lapply</span>(.SD, <span class="cf">function</span>(x) x <span class="sc">/</span> <span class="dv">20</span> <span class="sc">*</span> <span class="dv">100</span>), .SDcols <span class="ot">=</span> notes]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-35-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-35-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> </span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"note"</span>), <span class="sc">~</span> <span class="fu">as.numeric</span>(.x)<span class="sc">/</span><span class="dv">20</span><span class="sc">*</span><span class="dv">100</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"note"</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="création-de-variables-avec-des-conditions" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="création-de-variables-avec-des-conditions"><span class="header-section-number">6.7</span> Création de variables avec des conditions</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-36-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-1" role="tab" aria-controls="tabset-36-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-36-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-2" role="tab" aria-controls="tabset-36-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-36-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-3" role="tab" aria-controls="tabset-36-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-36-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-4" role="tab" aria-controls="tabset-36-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-36-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-5" role="tab" aria-controls="tabset-36-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-36-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-36-1-tab">
<div class="sourceCode" id="cb153"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Civilite;</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* 1ère solution */</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Civilite $<span class="dv">20</span>.;</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span>      Sexe = <span class="dv">2</span> <span class="kw">then</span> Civilite = <span class="st">"Mme"</span>;</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">else</span> <span class="kw">if</span> Sexe = <span class="dv">1</span> <span class="kw">then</span> Civilite = <span class="st">"Mr"</span>;</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">else</span>                  Civilite = <span class="st">"Inconnu"</span>;</span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* 2e solution (do - end) */</span></span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span>      Sexe = <span class="dv">2</span> <span class="kw">then do</span>;</span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>    Civilite2 = <span class="st">"Femme"</span>;</span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a><span class="kw">  end</span>;</span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">else</span> <span class="kw">if</span> Sexe = <span class="dv">1</span> <span class="kw">then do</span>;</span>
<span id="cb153-13"><a href="#cb153-13" aria-hidden="true" tabindex="-1"></a>    Civilite2 = <span class="st">"Homme"</span>;</span>
<span id="cb153-14"><a href="#cb153-14" aria-hidden="true" tabindex="-1"></a><span class="kw">  end</span>;</span>
<span id="cb153-15"><a href="#cb153-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">else do</span>;</span>
<span id="cb153-16"><a href="#cb153-16" aria-hidden="true" tabindex="-1"></a>    Civilite2 = <span class="st">"Inconnu"</span>;</span>
<span id="cb153-17"><a href="#cb153-17" aria-hidden="true" tabindex="-1"></a><span class="kw">  end</span>;</span>
<span id="cb153-18"><a href="#cb153-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* 3e solution */</span></span>
<span id="cb153-19"><a href="#cb153-19" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Civilite3 $<span class="dv">20</span>.;</span>
<span id="cb153-20"><a href="#cb153-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span>;</span>
<span id="cb153-21"><a href="#cb153-21" aria-hidden="true" tabindex="-1"></a>    when      (Sexe = <span class="dv">2</span>) Civilite3 = <span class="st">"Femme"</span>;</span>
<span id="cb153-22"><a href="#cb153-22" aria-hidden="true" tabindex="-1"></a>    when      (Sexe = <span class="dv">1</span>) Civilite3 = <span class="st">"Homme"</span>;</span>
<span id="cb153-23"><a href="#cb153-23" aria-hidden="true" tabindex="-1"></a>    otherwise            Civilite3 = <span class="st">"Inconnu"</span>;</span>
<span id="cb153-24"><a href="#cb153-24" aria-hidden="true" tabindex="-1"></a><span class="kw">  end</span>;</span>
<span id="cb153-25"><a href="#cb153-25" aria-hidden="true" tabindex="-1"></a>  <span class="kw">keep</span> Sexe Civilite Civilite2 Civilite3<span class="kw">;run</span>;</span>
<span id="cb153-26"><a href="#cb153-26" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-36-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-36-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>civilite <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(donnees_rbase<span class="sc">$</span>sexe <span class="sc">==</span> <span class="st">"2"</span>, <span class="st">"Mme"</span>, </span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(donnees_rbase<span class="sc">$</span>sexe <span class="sc">==</span> <span class="st">"1"</span>, <span class="st">"M"</span>, </span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Inconnu"</span>))</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>civilite <span class="ot">&lt;-</span> <span class="st">"Inconnu"</span></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>civilite[donnees_rbase<span class="sc">$</span>sexe <span class="sc">==</span> <span class="st">"1"</span>] <span class="ot">&lt;-</span> <span class="st">"M"</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>civilite[donnees_rbase<span class="sc">$</span>sexe <span class="sc">==</span> <span class="st">"2"</span>] <span class="ot">&lt;-</span> <span class="st">"Mme"</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-36-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-36-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">civilite =</span> <span class="fu">case_when</span>(sexe <span class="sc">==</span> <span class="st">"2"</span> <span class="sc">~</span> <span class="st">"Mme"</span>,</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>                              sexe <span class="sc">==</span> <span class="st">"1"</span> <span class="sc">~</span> <span class="st">"M"</span>,</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>                              <span class="cn">TRUE</span>        <span class="sc">~</span> <span class="st">"Inconnu"</span>)</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-36-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-36-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, civilite <span class="sc">:</span><span class="er">=</span> <span class="fu">fcase</span>(sexe <span class="sc">==</span> <span class="st">"2"</span>, <span class="st">"Mme"</span>,</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>                                      sexe <span class="sc">==</span> <span class="st">"1"</span>, <span class="st">"M."</span>,</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">is.na</span>(sexe), <span class="st">"Inconnu"</span>)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-36-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-36-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="manipuler-les-dates" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="manipuler-les-dates"><span class="header-section-number">6.8</span> Manipuler les dates</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-37-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-37-1" role="tab" aria-controls="tabset-37-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-37-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-37-2" role="tab" aria-controls="tabset-37-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-37-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-37-3" role="tab" aria-controls="tabset-37-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-37-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-37-4" role="tab" aria-controls="tabset-37-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-37-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-37-5" role="tab" aria-controls="tabset-37-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-37-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-37-1-tab">
<div class="sourceCode" id="cb157"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* On utilise ici %sysevalf et non %eval pour des calculs avec des macro-variables non entières */</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> sixmois = <span class="kw">%sysevalf</span>(<span class="dv">365.25</span>/<span class="dv">2</span>);</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="kw">%put</span> sixmois : <span class="kw">&amp;sixmois.</span>;</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Âge à l'entrée dans le dispositif */</span></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>  Age = <span class="fu">intck</span>(<span class="st">'year'</span>, date_naissance, date_entree);</span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Âge formaté */</span></span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>  Agef = <span class="kw">put</span>(Age, agef.);</span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Date de sortie du dispositif : ajout de la durée à la date d'entrée */</span></span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> date_sortie ddmmyy10.;</span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a>  date_sortie = <span class="fu">intnx</span>(<span class="st">'day'</span>, date_entree, duree);  </span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* La durée du contrat est-elle inférieure à 6 mois ? */</span></span>
<span id="cb157-14"><a href="#cb157-14" aria-hidden="true" tabindex="-1"></a>  Duree_Inf_6_mois = (Duree &lt; <span class="kw">&amp;sixmois.</span> <span class="kw">&amp; </span>Duree ne .);</span>
<span id="cb157-15"><a href="#cb157-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Deux manières de créer une date */</span></span>
<span id="cb157-16"><a href="#cb157-16" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Decembre_31_<span class="kw">&amp;an.</span>_a Decembre_31_<span class="kw">&amp;an.</span>_b ddmmyy10.;</span>
<span id="cb157-17"><a href="#cb157-17" aria-hidden="true" tabindex="-1"></a>  Decembre_31_<span class="kw">&amp;an.</span>_a = <span class="st">"31dec&amp;an."</span>d;</span>
<span id="cb157-18"><a href="#cb157-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* mdy pour month, day, year (pas d'autre alternative, ymd par exemple n'existe pas) */</span></span>
<span id="cb157-19"><a href="#cb157-19" aria-hidden="true" tabindex="-1"></a>  Decembre_31_<span class="kw">&amp;an.</span>_b = <span class="fu">mdy</span>(<span class="dv">12</span>, <span class="dv">31</span>, <span class="kw">&amp;an.</span>); </span>
<span id="cb157-20"><a href="#cb157-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Date 6 mois après la sortie */</span></span>
<span id="cb157-21"><a href="#cb157-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Date_6mois ddmmyy10.;</span>
<span id="cb157-22"><a href="#cb157-22" aria-hidden="true" tabindex="-1"></a>  Date_6mois = <span class="fu">intnx</span>(<span class="st">'month'</span>, date_sortie, <span class="dv">6</span>);</span>
<span id="cb157-23"><a href="#cb157-23" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb157-24"><a href="#cb157-24" aria-hidden="true" tabindex="-1"></a><span class="co">/* Ventilation pondérée (cf. infra) */</span></span>
<span id="cb157-25"><a href="#cb157-25" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> freq<span class="kw"> data</span> = donnees_sas;tables apres_31_decembre;weight poids_sondage<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-37-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-37-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Âge à l'entrée dans le dispositif</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>age <span class="ot">&lt;-</span> <span class="fu">floor</span>(lubridate<span class="sc">::</span><span class="fu">time_length</span>(<span class="fu">difftime</span>(donnees_rbase<span class="sc">$</span>date_entree, donnees_rbase<span class="sc">$</span>date_naissance), <span class="st">"years"</span>))</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Âge formaté</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>agef[donnees_rbase<span class="sc">$</span>age <span class="sc">&lt;</span> <span class="dv">26</span>]                           <span class="ot">&lt;-</span> <span class="st">"1. De 15 à 25 ans"</span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 26 &lt;= donnees_rbase$age &lt; 50 ne fonctionne pas, il faut passer en 2 étapes</span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>agef[<span class="dv">26</span> <span class="sc">&lt;=</span> donnees_rbase<span class="sc">$</span>age <span class="sc">&amp;</span> donnees_rbase<span class="sc">$</span>age <span class="sc">&lt;</span> <span class="dv">50</span>] <span class="ot">&lt;-</span> <span class="st">"2. De 26 à 49 ans"</span></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>agef[donnees_rbase<span class="sc">$</span>age <span class="sc">&gt;=</span> <span class="dv">50</span>]                          <span class="ot">&lt;-</span> <span class="st">"3. 50 ans ou plus"</span></span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a><span class="co"># L'option right = TRUE implique que les bornes sont ]0; 25] / ]25; 49] / ]49; Infini[</span></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>agef <span class="ot">&lt;-</span> <span class="fu">cut</span>(donnees_rbase<span class="sc">$</span>age, </span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>, <span class="dv">49</span>, <span class="cn">Inf</span>),</span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">right =</span> <span class="cn">TRUE</span>,</span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1. De 15 à 25 ans"</span>, <span class="st">"2. De 26 à 49 ans"</span>, <span class="st">"3. 50 ans ou plus"</span>), </span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">ordered_result =</span> <span class="cn">TRUE</span>)</span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Manipuler les dates</span></span>
<span id="cb158-17"><a href="#cb158-17" aria-hidden="true" tabindex="-1"></a>sixmois <span class="ot">&lt;-</span> <span class="fl">365.25</span><span class="sc">/</span><span class="dv">2</span></span>
<span id="cb158-18"><a href="#cb158-18" aria-hidden="true" tabindex="-1"></a><span class="co"># La durée du contrat est-elle inférieure à 6 mois ?</span></span>
<span id="cb158-19"><a href="#cb158-19" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>duree_inf_6_mois <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(donnees_rbase<span class="sc">$</span>duree <span class="sc">&lt;</span> sixmois, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb158-20"><a href="#cb158-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Date de sortie du dispositif</span></span>
<span id="cb158-21"><a href="#cb158-21" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>date_sortie <span class="ot">&lt;-</span> donnees_rbase<span class="sc">$</span>date_entree <span class="sc">+</span> lubridate<span class="sc">::</span><span class="fu">days</span>(donnees_rbase<span class="sc">$</span>duree)</span>
<span id="cb158-22"><a href="#cb158-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-23"><a href="#cb158-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour créer une date</span></span>
<span id="cb158-24"><a href="#cb158-24" aria-hidden="true" tabindex="-1"></a><span class="fu">as.Date</span>(<span class="fu">paste0</span>(annee,<span class="st">"-12-31"</span>), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>)</span>
<span id="cb158-25"><a href="#cb158-25" aria-hidden="true" tabindex="-1"></a>lubridate<span class="sc">::</span><span class="fu">ymd</span>(<span class="fu">paste0</span>(annee,<span class="st">"-12-31"</span>))</span>
<span id="cb158-26"><a href="#cb158-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-27"><a href="#cb158-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Date 6 mois après la sortie</span></span>
<span id="cb158-28"><a href="#cb158-28" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>date_6mois <span class="ot">&lt;-</span> donnees_rbase<span class="sc">$</span>date_sortie <span class="sc">+</span> lubridate<span class="sc">::</span><span class="fu">month</span>(<span class="dv">6</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-37-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-37-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Âge à l'entrée dans le dispositif</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> <span class="fu">as.period</span>(<span class="fu">interval</span>(<span class="at">start =</span> date_naissance, <span class="at">end =</span> date_entree))<span class="sc">$</span>year)</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Âge formaté</span></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">agef =</span> <span class="fu">case_when</span>(</span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&lt;</span> <span class="dv">26</span>             <span class="sc">~</span> <span class="st">"1. De 15 à 25 ans"</span>,</span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&gt;=</span> <span class="dv">26</span> <span class="sc">&amp;</span> age <span class="sc">&lt;</span> <span class="dv">50</span> <span class="sc">~</span> <span class="st">"2. De 26 à 49 ans"</span>,</span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&gt;=</span> <span class="dv">50</span>            <span class="sc">~</span> <span class="st">"3. 50 ans ou plus"</span>)</span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Manipuler les dates</span></span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a>sixmois <span class="ot">&lt;-</span> <span class="fl">365.25</span><span class="sc">/</span><span class="dv">2</span></span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a><span class="co"># La durée du contrat est-elle inférieure à 6 mois ?</span></span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">duree_inf_6_mois =</span> <span class="fu">case_when</span>(duree <span class="sc">&lt;</span>  sixmois <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true" tabindex="-1"></a>                                      duree <span class="sc">&gt;=</span> sixmois <span class="sc">~</span> <span class="dv">0</span>))</span>
<span id="cb159-19"><a href="#cb159-19" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">pull</span>(duree_inf_6_mois) <span class="sc">%&gt;%</span> <span class="fu">table</span>()</span>
<span id="cb159-20"><a href="#cb159-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-21"><a href="#cb159-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Date de sortie du dispositif</span></span>
<span id="cb159-22"><a href="#cb159-22" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb159-23"><a href="#cb159-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date_sortie =</span> date_entree <span class="sc">+</span> lubridate<span class="sc">::</span><span class="fu">days</span>(duree))</span>
<span id="cb159-24"><a href="#cb159-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-25"><a href="#cb159-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour créer une date</span></span>
<span id="cb159-26"><a href="#cb159-26" aria-hidden="true" tabindex="-1"></a><span class="fu">as.Date</span>(<span class="fu">paste0</span>(annee,<span class="st">"-12-31"</span>))</span>
<span id="cb159-27"><a href="#cb159-27" aria-hidden="true" tabindex="-1"></a>lubridate<span class="sc">::</span><span class="fu">ymd</span>(<span class="fu">paste0</span>(annee,<span class="st">"-12-31"</span>))</span>
<span id="cb159-28"><a href="#cb159-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-29"><a href="#cb159-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Date 6 mois après la sortie</span></span>
<span id="cb159-30"><a href="#cb159-30" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb159-31"><a href="#cb159-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date_6mois =</span> date_sortie <span class="sc">+</span> lubridate<span class="sc">::</span><span class="fu">month</span>(<span class="dv">6</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-37-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-37-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Âge à l'entrée dans le dispositif</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, age <span class="sc">:</span><span class="er">=</span> <span class="fu">floor</span>(lubridate<span class="sc">::</span><span class="fu">time_length</span>(<span class="fu">difftime</span>(donnees_datatable<span class="sc">$</span>date_entree, donnees_datatable<span class="sc">$</span>date_naissance), <span class="st">"years"</span>))]</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Âge formaté</span></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, agef <span class="sc">:</span><span class="er">=</span> <span class="fu">fcase</span>(age <span class="sc">&lt;</span> <span class="dv">26</span>,             <span class="st">"1. De 15 à 25 ans"</span>,</span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">26</span> <span class="sc">&lt;=</span> age <span class="sc">&amp;</span> age <span class="sc">&lt;</span> <span class="dv">50</span>, <span class="st">"2. De 26 à 49 ans"</span>,</span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>                                  age <span class="sc">&gt;=</span> <span class="dv">50</span>,            <span class="st">"3. 50 ans ou plus"</span>)]</span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Manipuler les dates</span></span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a>sixmois <span class="ot">&lt;-</span> <span class="fl">365.25</span><span class="sc">/</span><span class="dv">2</span></span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a><span class="co"># La durée du contrat est-elle inférieure à 6 mois ?</span></span>
<span id="cb160-12"><a href="#cb160-12" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, duree_inf_6_mois <span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(duree <span class="sc">&gt;=</span> sixmois, <span class="dv">1</span>, <span class="dv">0</span>)]</span>
<span id="cb160-13"><a href="#cb160-13" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, duree_inf_6_mois <span class="sc">:</span><span class="er">=</span> <span class="fu">fifelse</span>(duree <span class="sc">&gt;=</span> sixmois, <span class="dv">1</span>, <span class="dv">0</span>)]</span>
<span id="cb160-14"><a href="#cb160-14" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, duree_inf_6_mois <span class="sc">:</span><span class="er">=</span> <span class="fu">fcase</span>(duree <span class="sc">&gt;=</span> sixmois, <span class="dv">1</span>,</span>
<span id="cb160-15"><a href="#cb160-15" aria-hidden="true" tabindex="-1"></a>                                              duree <span class="sc">&lt;</span>  sixmois, <span class="dv">0</span>)]</span>
<span id="cb160-16"><a href="#cb160-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Date de sortie du dispositif</span></span>
<span id="cb160-17"><a href="#cb160-17" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, date_sortie <span class="sc">:</span><span class="er">=</span> date_entree <span class="sc">+</span> lubridate<span class="sc">::</span><span class="fu">days</span>(duree)]</span>
<span id="cb160-18"><a href="#cb160-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-19"><a href="#cb160-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour créer une date</span></span>
<span id="cb160-20"><a href="#cb160-20" aria-hidden="true" tabindex="-1"></a><span class="fu">as.Date</span>(<span class="fu">paste0</span>(annee,<span class="st">"-12-31"</span>))</span>
<span id="cb160-21"><a href="#cb160-21" aria-hidden="true" tabindex="-1"></a>lubridate<span class="sc">::</span><span class="fu">ymd</span>(<span class="fu">paste0</span>(annee,<span class="st">"-12-31"</span>))</span>
<span id="cb160-22"><a href="#cb160-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-23"><a href="#cb160-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Date 6 mois après la sortie</span></span>
<span id="cb160-24"><a href="#cb160-24" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, date_6mois <span class="sc">:</span><span class="er">=</span> date_sortie <span class="sc">+</span> lubridate<span class="sc">::</span><span class="fu">month</span>(<span class="dv">6</span>)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-37-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-37-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création de la colonne age </span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> </span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(enDate, <span class="sc">~</span> <span class="fu">as.Date</span>(<span class="fu">strptime</span>(.,<span class="st">'%d/%m/%Y'</span>))) <span class="sc">%&gt;%</span> <span class="co"># strptime est une fonction duckdb</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> <span class="fu">year</span>(<span class="fu">age</span>(Date_entree,Date_naissance))) <span class="sc">%&gt;%</span> </span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age)</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Âge formaté</span></span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span></span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(enDate, <span class="sc">~</span> <span class="fu">as.Date</span>(<span class="fu">strptime</span>(.,<span class="st">'%d/%m/%Y'</span>))) <span class="sc">%&gt;%</span> <span class="co"># strptime est une fonction duckdb</span></span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> <span class="fu">year</span>(<span class="fu">age</span>(Date_entree,Date_naissance))) <span class="sc">%&gt;%</span> </span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">agef =</span> <span class="fu">case_when</span>(</span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&lt;</span> <span class="dv">26</span> <span class="sc">~</span> <span class="st">"1. De 15 à 25 ans"</span>,</span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&gt;=</span> <span class="dv">26</span> <span class="sc">|</span> age <span class="sc">&lt;</span> <span class="dv">50</span> <span class="sc">~</span>  <span class="st">"2. De 26 à 49 ans"</span>,</span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&gt;=</span> <span class="dv">50</span> <span class="sc">~</span> <span class="st">"3. 50 ans ou plus"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, agef)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="mettre-un-0-devant-un-nombre" class="level2" data-number="6.9">
<h2 data-number="6.9" class="anchored" data-anchor-id="mettre-un-0-devant-un-nombre"><span class="header-section-number">6.9</span> Mettre un 0 devant un nombre</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-38-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-38-1" role="tab" aria-controls="tabset-38-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-38-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-38-2" role="tab" aria-controls="tabset-38-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-38-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-38-3" role="tab" aria-controls="tabset-38-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-38-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-38-4" role="tab" aria-controls="tabset-38-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-38-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-38-5" role="tab" aria-controls="tabset-38-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-38-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-38-1-tab">
<div class="sourceCode" id="cb162"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Zero_devant;</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas (<span class="kw">keep</span> = date_entree);</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Obtenir le mois et la date */</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>  Mois = <span class="fu">month</span>(date_entree);</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>  Annee = <span class="fu">year</span>(date_entree);</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Mettre le mois sur 2 positions (avec un 0 devant si le mois &lt;= 9) : format prédéfini z2. */</span></span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>  Mois_a = <span class="kw">put</span>(Mois, z2.);</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">drop</span> Mois;</span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">rename</span> Mois_a = Mois;</span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-38-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-38-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtenir le mois et la date</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>mois <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">month</span>(donnees_rbase<span class="sc">$</span>date_entree)</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>annee <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">year</span>(donnees_rbase<span class="sc">$</span>date_entree)</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Mettre le numéro du mois sur 2 positions (avec un 0 devant si le mois &lt;= 9)</span></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>mois <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%02d"</span>, donnees_rbase<span class="sc">$</span>mois)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-38-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-38-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mois =</span> <span class="fu">sprintf</span>(<span class="st">"%02d"</span>, lubridate<span class="sc">::</span><span class="fu">month</span>(date_entree)))</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mois =</span> lubridate<span class="sc">::</span><span class="fu">month</span>(date_entree),</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">mois =</span> <span class="fu">ifelse</span>(<span class="fu">str_length</span>(mois) <span class="sc">&lt;</span> <span class="dv">2</span>, <span class="fu">paste0</span>(<span class="st">"0"</span>, mois), mois))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-38-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-38-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtenir le mois et la date</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="at">mois =</span> lubridate<span class="sc">::</span><span class="fu">month</span>(date_entree), <span class="at">annee =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(donnees_datatable<span class="sc">$</span>date_entree))]</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Mettre le numéro du mois sur 2 positions (avec un 0 devant si le mois &lt;= 9)</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, mois <span class="sc">:</span><span class="er">=</span> <span class="fu">sprintf</span>(<span class="st">"%02d"</span>, mois)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-38-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-38-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : pas exactement au bon endroit</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="co">#requete_duckdb %&gt;% </span></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  mutate_at(enDate, ~ as.Date(strptime(.,'%d/%m/%Y'))) %&gt;% # strptime est une fonction duckdb</span></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  mutate(mois=lubridate::month(Date_entree),</span></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="co">#         mois=ifelse(str_length(mois)&lt;2, paste0("0", mois), mois)) %&gt;% </span></span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  select(mois, Date_entree)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="arrondir-une-valeur-numérique" class="level2" data-number="6.10">
<h2 data-number="6.10" class="anchored" data-anchor-id="arrondir-une-valeur-numérique"><span class="header-section-number">6.10</span> Arrondir une valeur numérique</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-39-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-1" role="tab" aria-controls="tabset-39-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-39-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-2" role="tab" aria-controls="tabset-39-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-39-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-3" role="tab" aria-controls="tabset-39-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-39-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-4" role="tab" aria-controls="tabset-39-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-39-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-5" role="tab" aria-controls="tabset-39-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-39-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-39-1-tab">
<div class="sourceCode" id="cb167"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Arrondis;</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas (<span class="kw">keep</span> = poids_sondage);</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Arrondi à l'entier le plus proche */</span></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>  poids_arrondi_0 = <span class="fu">round</span>(poids_sondage);</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Arrondi à 1 chiffre après la virgule */</span></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>  poids_arrondi_1 = <span class="fu">round</span>(poids_sondage, <span class="dv">0.1</span>);</span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Arrondi à 2 chiffre après la virgule */</span></span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>  poids_arrondi_2 = <span class="fu">round</span>(poids_sondage, <span class="dv">0.2</span>);</span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Arrondi à l'entier inférieur */</span></span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>  poids_inf = <span class="fu">floor</span>(poids_sondage);</span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Arrondi à l'entier supérieur */</span></span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a>  poids_sup = <span class="fu">ceil</span>(poids_sondage);  </span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-39-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-39-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrondi à l'entier le plus proche</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>poids_arrondi_0 <span class="ot">&lt;-</span> <span class="fu">round</span>(donnees_rbase<span class="sc">$</span>poids_sondage, <span class="dv">0</span>)</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrondi à 1 chiffre après la virgule</span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>poids_arrondi_1 <span class="ot">&lt;-</span> <span class="fu">round</span>(donnees_rbase<span class="sc">$</span>poids_sondage, <span class="dv">1</span>)</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrondi à 2 chiffre après la virgule</span></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>poids_arrondi_2 <span class="ot">&lt;-</span> <span class="fu">round</span>(donnees_rbase<span class="sc">$</span>poids_sondage, <span class="dv">2</span>)</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrondi à l'entier inférieur</span></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>poids_inf <span class="ot">&lt;-</span> <span class="fu">floor</span>(donnees_rbase<span class="sc">$</span>poids_sondage)</span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrondi à l'entier supérieur</span></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>poids_sup <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(donnees_rbase<span class="sc">$</span>poids_sondage)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-39-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-39-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arrondi à l'entier le plus proche</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">poids_arrondi_0 =</span> <span class="fu">round</span>(poids_sondage, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arrondi à 1 chiffre après la virgule</span></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">poids_arrondi_1 =</span> <span class="fu">round</span>(poids_sondage, <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arrondi à 2 chiffre après la virgule</span></span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">poids_arrondi_2 =</span> <span class="fu">round</span>(poids_sondage, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arrondi à l'entier inférieur</span></span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">poids_inf =</span> <span class="fu">floor</span>(poids_sondage)) <span class="sc">%&gt;%</span> </span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arrondi à l'entier supérieur</span></span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">poids_sup =</span> <span class="fu">ceiling</span>(poids_sondage))</span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"poids"</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-39-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-39-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrondi à l'entier le plus proche</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, poids_arrondi_0 <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(poids_sondage, <span class="dv">0</span>)]</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrondi à 1 chiffre après la virgule</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, poids_arrondi_1 <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(poids_sondage, <span class="dv">1</span>)]</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrondi à 2 chiffre après la virgule</span></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, poids_arrondi_2 <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(poids_sondage, <span class="dv">2</span>)]</span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrondi à l'entier inférieur</span></span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, poids_inf <span class="sc">:</span><span class="er">=</span> <span class="fu">floor</span>(poids_sondage)]</span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrondi à l'entier supérieur</span></span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, poids_sup <span class="sc">:</span><span class="er">=</span> <span class="fu">ceiling</span>(poids_sondage)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-39-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-39-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> </span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="co"># la fonction round de duckdb ne prend pas l'argument digits, mais la traduction fonctionne</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">poids_arrondi_0 =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(poids_sondage),<span class="dv">0</span>),</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">poids_arrondi_1 =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(poids_sondage),<span class="dv">1</span>),</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">poids_arrondi_2 =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(poids_sondage),<span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">poids_floor =</span> <span class="fu">floor</span>(<span class="fu">as.numeric</span>(poids_sondage)),</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">poids_ceiling =</span> <span class="fu">ceiling</span>(<span class="fu">as.numeric</span>(poids_sondage)),</span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"poids"</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="les-tris" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Les tris</h1>
<section id="trier-les-colonnes-de-la-base" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="trier-les-colonnes-de-la-base"><span class="header-section-number">7.1</span> Trier les colonnes de la base</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-40-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-1" role="tab" aria-controls="tabset-40-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-40-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-2" role="tab" aria-controls="tabset-40-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-40-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-3" role="tab" aria-controls="tabset-40-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-40-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-4" role="tab" aria-controls="tabset-40-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-40-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-5" role="tab" aria-controls="tabset-40-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-40-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-40-1-tab">
<div class="sourceCode" id="cb172"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* On met identifiant, date_entree au début de la base */</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> colTri = identifiant date_entree;</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">retain</span> <span class="kw">&amp;colTri.</span>;</span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a><span class="co">/* Autre solution */</span></span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">table</span> donnees_sas <span class="kw">as</span></span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Dans la proc SQL, les variables doivent être séparées par des virgules */</span></span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* On remplace les blancs entre les mots par des virgules pour la proc SQL */</span></span>
<span id="cb172-12"><a href="#cb172-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> <span class="kw">%sysfunc</span>(<span class="fu">tranwrd</span>(<span class="kw">&amp;colTri.</span>, <span class="kw">%str</span>( ), <span class="kw">%str</span>(, ))), * <span class="kw">from</span> donnees_sas;</span>
<span id="cb172-13"><a href="#cb172-13" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span>
<span id="cb172-14"><a href="#cb172-14" aria-hidden="true" tabindex="-1"></a><span class="co">/* Mettre la variable poids_sondage au début de la base */</span></span>
<span id="cb172-15"><a href="#cb172-15" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb172-16"><a href="#cb172-16" aria-hidden="true" tabindex="-1"></a>  <span class="kw">retain</span> poids_sondage;</span>
<span id="cb172-17"><a href="#cb172-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb172-18"><a href="#cb172-18" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb172-19"><a href="#cb172-19" aria-hidden="true" tabindex="-1"></a><span class="co">/* Mettre la variable poids_sondage à la fin de la base */</span></span>
<span id="cb172-20"><a href="#cb172-20" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> contents<span class="kw"> data</span> = donnees_sas out = <span class="fu">var</span><span class="kw">;run</span>;</span>
<span id="cb172-21"><a href="#cb172-21" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql noprint;</span>
<span id="cb172-22"><a href="#cb172-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> name <span class="kw">into</span> :<span class="fu">var</span> separated <span class="kw">by</span> <span class="st">" "</span> <span class="kw">from</span> <span class="fu">var</span></span>
<span id="cb172-23"><a href="#cb172-23" aria-hidden="true" tabindex="-1"></a>  <span class="kw">where</span> <span class="fu">lowcase</span>(name) ne <span class="st">"poids_sondage"</span> <span class="kw">order</span> <span class="kw">by</span> <span class="fu">varnum</span>;</span>
<span id="cb172-24"><a href="#cb172-24" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span>
<span id="cb172-25"><a href="#cb172-25" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb172-26"><a href="#cb172-26" aria-hidden="true" tabindex="-1"></a>  <span class="kw">retain</span> <span class="kw">&amp;var.</span> poids_sondage;</span>
<span id="cb172-27"><a href="#cb172-27" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb172-28"><a href="#cb172-28" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-40-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-40-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mettre les variables identifiant, date_entree au début de la base</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>colTri <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"date_entree"</span>)</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[, <span class="fu">union</span>(colTri, <span class="fu">colnames</span>(donnees_rbase))]</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre possibilité, plus longue !</span></span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[, <span class="fu">c</span>(colTri, <span class="fu">setdiff</span>(<span class="fu">colnames</span>(donnees_rbase), colTri))]</span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[, <span class="fu">c</span>(colTri, <span class="fu">colnames</span>(donnees_rbase)[<span class="sc">!</span> <span class="fu">colnames</span>(donnees_rbase) <span class="sc">%in%</span> colTri])]</span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Mettre la variable poids_sondage au début de la base</span></span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[, <span class="fu">c</span>(<span class="st">"poids_sondage"</span>, <span class="fu">setdiff</span>(<span class="fu">colnames</span>(donnees_rbase), <span class="st">"poids_sondage"</span>))]</span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Mettre la variable poids_sondage à la fin de la base</span></span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[, <span class="fu">c</span>(<span class="fu">setdiff</span>(<span class="fu">colnames</span>(donnees_rbase), <span class="st">"poids_sondage"</span>), <span class="st">"poids_sondage"</span>)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-40-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-40-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mettre les variables identifiant, date_entree et date_sortie au début de la base</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(identifiant, date_entree)</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Autres solutions</span></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>colTri <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"date_entree"</span>)</span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="fu">all_of</span>(colTri))</span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse_tri <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(colTri), <span class="fu">everything</span>())</span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-12"><a href="#cb174-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Mettre la variable poids_sondage au début de la base</span></span>
<span id="cb174-13"><a href="#cb174-13" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb174-14"><a href="#cb174-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(poids_sondage)</span>
<span id="cb174-15"><a href="#cb174-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Mettre la variable poids_sondage à la fin de la base</span></span>
<span id="cb174-16"><a href="#cb174-16" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb174-17"><a href="#cb174-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(poids_sondage, <span class="at">.after =</span> <span class="fu">last_col</span>())</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-40-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-40-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On met identifiant, date_entree au début</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>colTri <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"date_entree"</span>)</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>tri <span class="ot">&lt;-</span> <span class="fu">union</span>(colTri, <span class="fu">colnames</span>(donnees_datatable))</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>donnees_datatable <span class="ot">&lt;-</span> donnees_datatable[, ..tri]</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a><span class="co"># En data.table, les instructions débutant par set modifient les éléments par référence, c'est-à-dire sans copie.</span></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Ceci est plus efficace pour manipuler des données volumineuses.</span></span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a><span class="fu">setcolorder</span>(donnees_datatable, colTri)</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Mettre la variable poids_sondage au début de la base</span></span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a><span class="fu">setcolorder</span>(donnees_datatable, <span class="fu">union</span>(<span class="st">"poids_sondage"</span>, <span class="fu">colnames</span>(donnees_datatable)))</span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Mettre la variable poids_sondage à la fin de la base</span></span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a><span class="fu">setcolorder</span>(donnees_datatable, <span class="fu">c</span>(<span class="fu">setdiff</span>(<span class="fu">colnames</span>(donnees_datatable), <span class="st">"poids_sondage"</span>), <span class="st">"poids_sondage"</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-40-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-40-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On met identifiant date_entree au début</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> </span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(enDate, <span class="sc">~</span> <span class="fu">as.Date</span>(<span class="fu">strptime</span>(.,<span class="st">'%d/%m/%Y'</span>))) <span class="sc">%&gt;%</span> <span class="co"># strptime est une fonction duckdb</span></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(identifiant, date_entree, <span class="fu">everything</span>())</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> </span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(enDate, <span class="sc">~</span> <span class="fu">as.Date</span>(<span class="fu">strptime</span>(.,<span class="st">'%d/%m/%Y'</span>))) <span class="sc">%&gt;%</span> <span class="co"># strptime est une fonction duckdb</span></span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(identifiant, date_entree)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="trier-les-lignes-par-ordre-décroissant" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="trier-les-lignes-par-ordre-décroissant"><span class="header-section-number">7.2</span> Trier les lignes (par ordre décroissant</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-41-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-41-1" role="tab" aria-controls="tabset-41-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-41-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-41-2" role="tab" aria-controls="tabset-41-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-41-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-41-3" role="tab" aria-controls="tabset-41-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-41-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-41-4" role="tab" aria-controls="tabset-41-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-41-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-41-5" role="tab" aria-controls="tabset-41-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-41-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-41-1-tab">
<div class="sourceCode" id="cb177"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* 1ère possibilité */</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas;<span class="kw">by</span> Identifiant Date_entree<span class="kw">;run</span>;</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="co">/* 2e possibilité */</span></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">table</span> Donnes <span class="kw">as</span> <span class="kw">select</span> * <span class="kw">from</span> donnees_sas</span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">order</span> <span class="kw">by</span> Identifiant, Date_entree;</span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a><span class="co">/* Idem par ordre croissant d'identifiant et ordre décroissant de date d'entrée */</span></span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas;<span class="kw">by</span> Identifiant descending Date_entree<span class="kw">;run</span>;</span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">table</span> Donnes <span class="kw">as</span> <span class="kw">select</span> * <span class="kw">from</span> donnees_sas</span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">order</span> <span class="kw">by</span> Identifiant, Date_entree desc;</span>
<span id="cb177-13"><a href="#cb177-13" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-41-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-41-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tri par ordre croissant</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="co"># L'option na.last = FALSE (resp. TRUE) indique que les valeurs manquantes doivent figurer à la fin (resp. au début) du tri, que le tri</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="co"># soit croissant ou décroissant</span></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>identifiant, donnees_rbase<span class="sc">$</span>date_entree, <span class="at">na.last =</span> <span class="cn">FALSE</span>), ]</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Tri par ordre croissant de identifiant et décroissant de date_entree (- avant le nom de la variable)</span></span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>identifiant, donnees_rbase<span class="sc">$</span>date_entree, <span class="at">na.last =</span> <span class="cn">FALSE</span>, <span class="at">decreasing =</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>), <span class="at">method =</span> <span class="st">"radix"</span>), ]</span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre possibilité : - devant la variable (uniquement pour les variables numériques)</span></span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>identifiant, <span class="sc">-</span>donnees_rbase<span class="sc">$</span>duree, <span class="at">na.last =</span> <span class="cn">FALSE</span>), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-41-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-41-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tri par ordre croissant</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, date_entree)</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Tri par ordre croissant de identifiant et décroissant de date_entree</span></span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="fu">desc</span>(date_entree))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-41-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-41-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tri par ordre croissant</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="co"># L'option na.last = FALSE (resp. TRUE) indique que les valeurs manquantes doivent figurer à la fin (resp. au début) du tri, que le tri</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="co"># soit croissant ou décroissant</span></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>donnees_datatable <span class="ot">&lt;-</span> donnees_datatable[<span class="fu">order</span>(identifiant, date_entree, <span class="at">na.last =</span> <span class="cn">FALSE</span>)]</span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a><span class="co"># En data.table, les instructions débutant par set modifient les éléments par référence, c'est-à-dire sans copie.</span></span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Ceci est plus efficace pour manipuler des données volumineuses.</span></span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a><span class="fu">setorder</span>(donnees_datatable, <span class="st">"identifiant"</span>, <span class="st">"date_entree"</span>, <span class="at">na.last =</span> <span class="cn">FALSE</span>)</span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a><span class="fu">setorderv</span>(donnees_datatable, <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"date_entree"</span>), <span class="at">order =</span> <span class="fu">c</span>(1L, 1L), <span class="at">na.last =</span> <span class="cn">FALSE</span>)</span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Tri par ordre croissant de identifiant et décroissant de date_entree (- avant le nom de la variable)</span></span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a>donnees_datatable <span class="ot">&lt;-</span> donnees_datatable[<span class="fu">order</span>(identifiant, <span class="sc">-</span>date_entree, <span class="at">na.last =</span> <span class="cn">FALSE</span>)]</span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a><span class="fu">setorder</span>(donnees_datatable, <span class="st">"identifiant"</span>, <span class="sc">-</span><span class="st">"date_entree"</span>, <span class="at">na.last =</span> <span class="cn">FALSE</span>)</span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a><span class="fu">setorderv</span>(donnees_datatable, <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"date_entree"</span>), <span class="at">order =</span> <span class="fu">c</span>(1L, <span class="sc">-</span>1L), <span class="at">na.last =</span> <span class="cn">FALSE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-41-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-41-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="incidence-des-valeurs-manquantes-dans-les-tris" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="incidence-des-valeurs-manquantes-dans-les-tris"><span class="header-section-number">7.3</span> Incidence des valeurs manquantes dans les tris</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-42-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-42-1" role="tab" aria-controls="tabset-42-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-42-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-42-2" role="tab" aria-controls="tabset-42-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-42-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-42-3" role="tab" aria-controls="tabset-42-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-42-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-42-4" role="tab" aria-controls="tabset-42-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-42-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-42-5" role="tab" aria-controls="tabset-42-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-42-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-42-1-tab">
<div class="sourceCode" id="cb181"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Dans SAS, les valeurs manquantes sont considérées comme des valeurs négatives */</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="co">/* Elles sont donc situées en premier dans un tri par ordre croissant ... */</span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas;<span class="kw">by</span> identifiant date_entree<span class="kw">;run;proc</span> print<span class="kw">;run</span>;</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a><span class="co">/* ... et en dernier dans un tri par ordre décroissant */</span></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas;<span class="kw">by</span> identifiant descending date_entree<span class="kw">;run</span>;</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> print<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-42-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-42-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Les valeurs manquantes sont situées en dernier dans un tri par ordre croissant ou décroissant (car par défaut l'option na.last = TRUE) ...</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>identifiant, donnees_rbase<span class="sc">$</span>date_entree), ]</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="co"># SAS considère les valeurs manquantes comme des nombres négatifs faibles.</span></span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour mimer le tri par ordre croissant en SAS :</span></span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>identifiant, donnees_rbase<span class="sc">$</span>date_entree, <span class="at">na.last =</span> <span class="cn">FALSE</span>), ]</span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour mimer le tri par ordre décroissant en SAS :</span></span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>identifiant, donnees_rbase<span class="sc">$</span>date_entree,</span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">na.last =</span> <span class="cn">FALSE</span>,</span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">decreasing =</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>),</span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">method =</span> <span class="st">"radix"</span>), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-42-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-42-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Attention, avec arrange, les variables manquantes (NA) sont toujours classées en dernier, même avec desc()</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, date_entree)</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="fu">desc</span>(date_entree))</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Or, SAS considère les valeurs manquantes comme des nombres négatifs faibles.</span></span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Elles sont donc classées en premier dans un tri par ordre croissant, et en dernier dans un tri par ordre décroissant</span></span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour mimer le tri par ordre croissant en SAS : les valeurs manquantes de date_entree sont classées en premier</span></span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="sc">!</span><span class="fu">is.na</span>(date_entree), date_entree)</span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour mimer le tri par ordre décroissant en SAS</span></span>
<span id="cb183-14"><a href="#cb183-14" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb183-15"><a href="#cb183-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="fu">desc</span>(date_entree))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-42-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-42-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Les valeurs manquantes sont situées en dernier dans un tri par ordre croissant ou décroissant (car par défaut l'option na.last = TRUE) ...</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable <span class="ot">&lt;-</span> donnees_datatable[<span class="fu">order</span>(identifiant, date_entree)]</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="co"># SAS considère les valeurs manquantes comme des nombres négatifs faibles.</span></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour mimer le tri par ordre croissant en SAS :</span></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a><span class="fu">setorderv</span>(donnees_datatable, <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"date_entree"</span>), <span class="at">order =</span> <span class="fu">c</span>(1L, 1L), <span class="at">na.last =</span> <span class="cn">FALSE</span>)</span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour mimer le tri par ordre décroissant en SAS :</span></span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a><span class="fu">setorderv</span>(donnees_datatable, <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"date_entree"</span>), <span class="at">order =</span> <span class="fu">c</span>(1L, <span class="sc">-</span>1L), <span class="at">na.last =</span> <span class="cn">FALSE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-42-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-42-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Les valeurs manquantes sont situées en dernier dans un tri par ordre croissant ou décroissant (car par défaut l'option na.last = TRUE) ...</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Identifiant, Note_Contenu) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Identifiant, Note_Contenu)</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour mimer le tri SAS, il faut écrire :</span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Note : il faut faire select d'abord, sinon il y a une erreur quand "! is.na()" est dans la liste des colonnes</span></span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>requete_duckdb <span class="sc">%&gt;%</span> <span class="fu">select</span>(Identifiant, Note_Contenu) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Identifiant, <span class="sc">!</span> <span class="fu">is.na</span>(Note_Contenu), Note_Contenu)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="trier-par-ordre-croissant-par-toutes-les-variables-de-la-base" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="trier-par-ordre-croissant-par-toutes-les-variables-de-la-base"><span class="header-section-number">7.4</span> Trier par ordre croissant par toutes les variables de la base</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-43-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-43-1" role="tab" aria-controls="tabset-43-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-43-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-43-2" role="tab" aria-controls="tabset-43-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-43-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-43-3" role="tab" aria-controls="tabset-43-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-43-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-43-4" role="tab" aria-controls="tabset-43-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-43-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-43-5" role="tab" aria-controls="tabset-43-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-43-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-43-1-tab">
<div class="sourceCode" id="cb186"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas;<span class="kw">by</span> _all_<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-43-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-43-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>tri_toutes_variables <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(<span class="fu">colnames</span>(donnees_rbase), <span class="at">na.last =</span> <span class="cn">FALSE</span>)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-43-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-43-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>tri_toutes_variables <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">pick</span>(<span class="fu">everything</span>()))</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>tri_toutes_variables <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">across</span>(<span class="fu">everything</span>()))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-43-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-43-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>tri_toutes_variables <span class="ot">&lt;-</span> <span class="fu">setorderv</span>(donnees_datatable, <span class="at">na.last =</span> <span class="cn">FALSE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-43-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-43-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
</section>
<section id="manipuler-des-chaînes-de-caractères" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Manipuler des chaînes de caractères</h1>
<section id="majuscule-minuscule" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="majuscule-minuscule"><span class="header-section-number">8.1</span> Majuscule, minuscule</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-44-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-44-1" role="tab" aria-controls="tabset-44-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-44-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-44-2" role="tab" aria-controls="tabset-44-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-44-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-44-3" role="tab" aria-controls="tabset-44-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-44-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-44-4" role="tab" aria-controls="tabset-44-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-44-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-44-5" role="tab" aria-controls="tabset-44-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-44-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-44-1-tab">
<div class="sourceCode" id="cb190"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Fonction tranwrd (TRANslate WoRD) */</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Première lettre en majuscule */</span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>  Niveau = propcase(Niveau);</span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* En majuscule */</span></span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>  CSP_majuscule = <span class="fu">upcase</span>(CSPF);</span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* En minuscule */</span></span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>  CSP_minuscule = <span class="fu">lowcase</span>(CSPF);</span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Nombre de caractères dans une chaîne de caractères */</span></span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>  taille_id = <span class="kw">length</span>(identifiant);</span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-44-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-44-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1ère lettre en majuscule, autres lettres en minuscule</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>niveau <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">toupper</span>(<span class="fu">substr</span>(donnees_rbase<span class="sc">$</span>niveau, <span class="dv">1</span>, <span class="dv">1</span>)), <span class="fu">tolower</span>(<span class="fu">substr</span>(donnees_rbase<span class="sc">$</span>niveau, <span class="dv">2</span>, <span class="fu">length</span>(donnees_rbase<span class="sc">$</span>niveau))))</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a><span class="co"># En majuscule</span></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>csp_maj <span class="ot">&lt;-</span> <span class="fu">toupper</span>(donnees_rbase<span class="sc">$</span>cspf)</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a><span class="co"># En minuscule</span></span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>csp_min <span class="ot">&lt;-</span> <span class="fu">tolower</span>(donnees_rbase<span class="sc">$</span>cspf)</span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombre de caractères dans une chaîne de caractères</span></span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>taille_id <span class="ot">&lt;-</span> <span class="fu">nchar</span>(donnees_rbase<span class="sc">$</span>identifiant)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-44-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-44-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1ère lettre en majuscule, autres lettres en minuscule</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span>  </span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">niveau =</span> <span class="fu">str_to_title</span>(niveau))</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a><span class="co"># En majuscule</span></span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">csp_maj =</span> <span class="fu">toupper</span>(cspf))</span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a><span class="co"># En minuscule</span></span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">csp_maj =</span> <span class="fu">tolower</span>(cspf))</span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombre de caractères dans une chaîne de caractères</span></span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb192-13"><a href="#cb192-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">taille_id =</span> <span class="fu">nchar</span>(identifiant))</span>
<span id="cb192-14"><a href="#cb192-14" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb192-15"><a href="#cb192-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">taille_id =</span> <span class="fu">str_split</span>(identifiant, <span class="st">''</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb192-16"><a href="#cb192-16" aria-hidden="true" tabindex="-1"></a>           lengths)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-44-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-44-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1ère lettre en majuscule, autres lettres en minuscule</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, niveau <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="fu">toupper</span>(<span class="fu">substr</span>(niveau, <span class="dv">1</span>, <span class="dv">1</span>)), <span class="fu">tolower</span>(<span class="fu">substr</span>(niveau, <span class="dv">2</span>, <span class="fu">length</span>(niveau))))]</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="co"># En majuscule</span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, csp_maj <span class="sc">:</span><span class="er">=</span> <span class="fu">toupper</span>(cspf)]</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a><span class="co"># En minuscule</span></span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, csp_min <span class="sc">:</span><span class="er">=</span> <span class="fu">tolower</span>(cspf)]</span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombre de caractères dans une chaîne de caractères</span></span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, taille_id <span class="sc">:</span><span class="er">=</span> <span class="fu">nchar</span>(identifiant)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-44-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-44-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="remplacer-une-chaîne-de-caractères-par-une-autre" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="remplacer-une-chaîne-de-caractères-par-une-autre"><span class="header-section-number">8.2</span> Remplacer une chaîne de caractères par une autre</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-45-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-45-1" role="tab" aria-controls="tabset-45-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-45-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-45-2" role="tab" aria-controls="tabset-45-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-45-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-45-3" role="tab" aria-controls="tabset-45-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-45-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-45-4" role="tab" aria-controls="tabset-45-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-45-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-45-5" role="tab" aria-controls="tabset-45-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-45-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-45-1-tab">
<div class="sourceCode" id="cb194"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> A_Corriger;</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">infile</span> <span class="kw">cards</span> dsd dlm=<span class="st">'|'</span>;</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> A_corriger $<span class="dv">8</span>.;</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">input</span> A_corriger $;</span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">cards</span>;</span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>  Qualifie</span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>  qualifie</span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a>  Qualifie</span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a>  QUALIFIE</span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a>;</span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> A_Corriger;</span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> A_Corriger;</span>
<span id="cb194-14"><a href="#cb194-14" aria-hidden="true" tabindex="-1"></a>  Corrige = <span class="fu">lowcase</span>(A_corriger);</span>
<span id="cb194-15"><a href="#cb194-15" aria-hidden="true" tabindex="-1"></a>  Corrige = <span class="fu">tranwrd</span>(Corrige, <span class="st">"qualifie"</span>, <span class="st">"Qualifié"</span>);</span>
<span id="cb194-16"><a href="#cb194-16" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-45-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-45-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Le mot Qualifié n'a pas d'accent : on le corrige</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>aCorriger <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Qualifie"</span>, <span class="st">"qualifie"</span>, <span class="st">"Qualifie"</span>, <span class="st">"QUALIFIE"</span>)</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="co"># [Q-q] permet de représenter Q ou q, et donc de prendre en compte Qualifie et qualifie</span></span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span>(<span class="st">"[Q-q]ualifie"</span>, <span class="st">"Qualifié"</span>, <span class="fu">tolower</span>(aCorriger))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-45-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-45-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Le mot Qualifié n'a pas d'accent : on le corrige</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>aCorriger <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Qualifie"</span>, <span class="st">"qualifie"</span>, <span class="st">"Qualifie"</span>, <span class="st">"QUALIFIE"</span>)</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="co"># [Q-q] permet de représenter Q ou q, et donc de prendre en compte Qualifie et qualifie</span></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>aCorriger <span class="sc">%&gt;%</span> <span class="fu">tolower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_replace_all</span>(<span class="st">"[Q-q]ualifie"</span>, <span class="st">"Qualifié"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-45-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-45-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Le mot Qualifié n'a pas d'accent : on le corrige</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>aCorriger <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Qualifie"</span>, <span class="st">"qualifie"</span>, <span class="st">"Qualifie"</span>, <span class="st">"QUALIFIE"</span>)</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="co"># [Q-q] permet de représenter Q ou q, et donc de prendre en compte Qualifie et qualifie</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span>(<span class="st">"[Q-q]ualifie"</span>, <span class="st">"Qualifié"</span>, <span class="fu">tolower</span>(aCorriger))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-45-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-45-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="manipuler-des-chaînes-de-caractères-1" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="manipuler-des-chaînes-de-caractères-1"><span class="header-section-number">8.3</span> Manipuler des chaînes de caractères</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-46-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-46-1" role="tab" aria-controls="tabset-46-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-46-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-46-2" role="tab" aria-controls="tabset-46-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-46-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-46-3" role="tab" aria-controls="tabset-46-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-46-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-46-4" role="tab" aria-controls="tabset-46-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-46-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-46-5" role="tab" aria-controls="tabset-46-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-46-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-46-1-tab">
<div class="sourceCode" id="cb198"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Exemple_chaines;</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>  Texte = <span class="st">"              Ce   Texte   mériterait   d être   corrigé                  "</span>;</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>  Texte1 = <span class="st">"Je m'appelle"</span>;</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>  Texte2 = <span class="st">"SAS"</span>;</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>  Texte3 = <span class="st">"Phrase à découper"</span>;</span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Valeur manquante sous forme caractère */</span></span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>  Texte4 = <span class="st">""</span>;</span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Exemple_chaines;</span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> Exemple_chaines;</span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Enlever les blancs au début et à la fin de la chaîne de caractère */</span></span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a>  Enlever_Blancs_Initiaux = strip(Texte);</span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Enlever les doubles blancs dans la chaîne de caractères */</span></span>
<span id="cb198-14"><a href="#cb198-14" aria-hidden="true" tabindex="-1"></a>  Enlever_Blancs_Entre = <span class="fu">compbl</span>(Enlever_Blancs_Initiaux);</span>
<span id="cb198-15"><a href="#cb198-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Enlever doubles blancs */</span></span>
<span id="cb198-16"><a href="#cb198-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* REVOIR !!!!! */</span></span>
<span id="cb198-17"><a href="#cb198-17" aria-hidden="true" tabindex="-1"></a>  Enlever_Doubles_Blancs = <span class="fu">compress</span>(Texte, <span class="st">"  "</span>, <span class="st">"t"</span>);</span>
<span id="cb198-18"><a href="#cb198-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Trois méthodes pour concaténer des chaînes de caractères */</span></span>
<span id="cb198-19"><a href="#cb198-19" aria-hidden="true" tabindex="-1"></a>  Concatener  = Texte1||<span class="st">" "</span>||Texte2;</span>
<span id="cb198-20"><a href="#cb198-20" aria-hidden="true" tabindex="-1"></a>  Concatener2 = Texte1!!<span class="st">" "</span>!!Texte2;</span>
<span id="cb198-21"><a href="#cb198-21" aria-hidden="true" tabindex="-1"></a>  Concatener3 = catx(<span class="st">" "</span>, Texte1, Texte2);</span>
<span id="cb198-22"><a href="#cb198-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Effet des valeurs manquantes */</span></span>
<span id="cb198-23"><a href="#cb198-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Le séparateur est enlevé lors d'une concaténation avec une chaîne de caractère vide */</span></span>
<span id="cb198-24"><a href="#cb198-24" aria-hidden="true" tabindex="-1"></a>  Concatener4 = catx(<span class="st">"-"</span>, Texte4, Texte3);</span>
<span id="cb198-25"><a href="#cb198-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Extraire les 2e, 3e et 4e caractère de Concatener */</span></span>
<span id="cb198-26"><a href="#cb198-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* 2 correspond à la position du 1er caractère à récupérer, 3 le nombre total de caractères à partir du point de départ */</span></span>
<span id="cb198-27"><a href="#cb198-27" aria-hidden="true" tabindex="-1"></a>  extrait = <span class="fu">substr</span>(Concatener, <span class="dv">2</span>, <span class="dv">3</span>);</span>
<span id="cb198-28"><a href="#cb198-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Transformer plusieurs caractères différents */</span></span>
<span id="cb198-29"><a href="#cb198-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* On transforme le é en e, le â en a, le î en i, ... */</span></span>
<span id="cb198-30"><a href="#cb198-30" aria-hidden="true" tabindex="-1"></a>  chaine = <span class="st">"éèêëàâçîô"</span>;</span>
<span id="cb198-31"><a href="#cb198-31" aria-hidden="true" tabindex="-1"></a>  chaine_sans_accent = <span class="fu">translate</span>(chaine, <span class="st">"eeeeaacio"</span>, <span class="st">"éèêëàâçîô"</span>);</span>
<span id="cb198-32"><a href="#cb198-32" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb198-33"><a href="#cb198-33" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> print<span class="kw"> data</span> = Exemple_chaines<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-46-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-46-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>texte  <span class="ot">&lt;-</span> <span class="st">"              Ce   Texte   mériterait   d être   corrigé                  "</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>texte1 <span class="ot">&lt;-</span> <span class="st">"Ce texte"</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>texte2 <span class="ot">&lt;-</span> <span class="st">"va être"</span></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>texte3 <span class="ot">&lt;-</span> <span class="st">"concaténé"</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Valeur manquante sous forme caractère</span></span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>texte4 <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Enlever les blancs au début et à la fin de la chaîne de caractère</span></span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a><span class="co"># "\\s+" est une expression régulière indiquant 1 ou plusieurs espaces successifs</span></span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Le gsub remplace 1 ou plusieurs espaces successifs par un seul espace</span></span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a><span class="co"># trimws enlève les espaces au début et à la fin d'une chaîne de caractère </span></span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true" tabindex="-1"></a>texte <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">s+"</span>, <span class="st">" "</span>, <span class="fu">trimws</span>(texte))</span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-14"><a href="#cb199-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-15"><a href="#cb199-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Concaténer des chaînes de caractères</span></span>
<span id="cb199-16"><a href="#cb199-16" aria-hidden="true" tabindex="-1"></a>concatene <span class="ot">&lt;-</span> <span class="fu">paste</span>(texte1, texte2, texte3, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb199-17"><a href="#cb199-17" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(texte1, texte2, texte3)</span>
<span id="cb199-18"><a href="#cb199-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-19"><a href="#cb199-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Effet des valeurs manquantes : le délimiteur (ici -) apparaît avec la concaténation avec le caractère manquant</span></span>
<span id="cb199-20"><a href="#cb199-20" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(texte4, texte3, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb199-21"><a href="#cb199-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-22"><a href="#cb199-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire les 2e, 3e et 4e caractères de Concatener</span></span>
<span id="cb199-23"><a href="#cb199-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 correspond à la position du 1er caractère à récupérer, 5 la position du dernier caractère</span></span>
<span id="cb199-24"><a href="#cb199-24" aria-hidden="true" tabindex="-1"></a>extrait <span class="ot">&lt;-</span> <span class="fu">substr</span>(concatene, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb199-25"><a href="#cb199-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-26"><a href="#cb199-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformer plusieurs caractères différents</span></span>
<span id="cb199-27"><a href="#cb199-27" aria-hidden="true" tabindex="-1"></a>chaine <span class="ot">&lt;-</span> <span class="st">"éèêëàâçîô"</span></span>
<span id="cb199-28"><a href="#cb199-28" aria-hidden="true" tabindex="-1"></a><span class="fu">chartr</span>(<span class="st">"éèêëàâçîô"</span>, <span class="st">"eeeeaacio"</span>, chaine)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-46-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-46-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>texte  <span class="ot">&lt;-</span> <span class="st">"              Ce   Texte   mériterait   d être   corrigé                  "</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>texte1 <span class="ot">&lt;-</span> <span class="st">"Ce texte"</span></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>texte2 <span class="ot">&lt;-</span> <span class="st">"va être"</span></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>texte3 <span class="ot">&lt;-</span> <span class="st">"concaténé"</span></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Valeur manquante sous forme caractère</span></span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>texte4 <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Enlever les blancs au début et à la fin de la chaîne de caractère</span></span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a><span class="co"># str_squish() supprime les espaces blancs au début et à la fin, et remplace tous les espaces blancs internes par un seul espace</span></span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a>texte <span class="ot">&lt;-</span> <span class="fu">str_squish</span>(texte)</span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-12"><a href="#cb200-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Concaténer des chaînes de caractères</span></span>
<span id="cb200-13"><a href="#cb200-13" aria-hidden="true" tabindex="-1"></a>concatene <span class="ot">&lt;-</span> <span class="fu">str_flatten</span>(<span class="fu">c</span>(texte1, texte2, texte3), <span class="at">collapse =</span> <span class="st">" "</span>)</span>
<span id="cb200-14"><a href="#cb200-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-15"><a href="#cb200-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Effet des valeurs manquantes : le délimiteur (ici -) apparaît avec la concaténation avec le caractère manquant</span></span>
<span id="cb200-16"><a href="#cb200-16" aria-hidden="true" tabindex="-1"></a><span class="fu">str_flatten</span>(<span class="fu">c</span>(texte4, texte3), <span class="at">collapse =</span> <span class="st">"-"</span>)</span>
<span id="cb200-17"><a href="#cb200-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-18"><a href="#cb200-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire les 2e, 3e et 4e caractères de Concatener</span></span>
<span id="cb200-19"><a href="#cb200-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 correspond à la position du 1er caractère à récupérer, 5 la position du dernier caractère</span></span>
<span id="cb200-20"><a href="#cb200-20" aria-hidden="true" tabindex="-1"></a>extrait <span class="ot">&lt;-</span> <span class="fu">str_sub</span>(concatene, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb200-21"><a href="#cb200-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-22"><a href="#cb200-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformer plusieurs caractères différents</span></span>
<span id="cb200-23"><a href="#cb200-23" aria-hidden="true" tabindex="-1"></a>chaine <span class="ot">&lt;-</span> <span class="st">"éèêëàâçîô"</span></span>
<span id="cb200-24"><a href="#cb200-24" aria-hidden="true" tabindex="-1"></a><span class="fu">chartr</span>(<span class="st">"éèêëàâçîô"</span>, <span class="st">"eeeeaacio"</span>, chaine)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-46-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-46-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>texte  <span class="ot">&lt;-</span> <span class="st">"              Ce   Texte   mériterait   d être   corrigé                  "</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>texte1 <span class="ot">&lt;-</span> <span class="st">"Je m'appelle"</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>texte2 <span class="ot">&lt;-</span> <span class="st">"R"</span></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Enlever les blancs au début et à la fin de la chaîne de caractère</span></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a><span class="co"># "\\s+" est une expression régulière indiquant 1 ou plusieurs espaces successifs</span></span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Le gsub remplace 1 ou plusieurs espaces successifs par un seul espace</span></span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a><span class="co"># trimws enlève les espaces au début et à la fin d'une chaîne de caractère </span></span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a>texte <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">s+"</span>, <span class="st">" "</span>, <span class="fu">trimws</span>(texte))</span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Concaténer des chaînes de caractères</span></span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(texte1, texte2, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb201-11"><a href="#cb201-11" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(texte1, texte2)</span>
<span id="cb201-12"><a href="#cb201-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-13"><a href="#cb201-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-14"><a href="#cb201-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire les 2e, 3e et 4e caractères de texte</span></span>
<span id="cb201-15"><a href="#cb201-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 correspond à la position du 1er caractère à récupérer, 5 la position du dernier caractère</span></span>
<span id="cb201-16"><a href="#cb201-16" aria-hidden="true" tabindex="-1"></a>extrait <span class="ot">&lt;-</span> <span class="fu">substr</span>(texte, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb201-17"><a href="#cb201-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-18"><a href="#cb201-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformer plusieurs caractères différents</span></span>
<span id="cb201-19"><a href="#cb201-19" aria-hidden="true" tabindex="-1"></a>chaine <span class="ot">&lt;-</span> <span class="st">"éèêëàâçîô"</span></span>
<span id="cb201-20"><a href="#cb201-20" aria-hidden="true" tabindex="-1"></a><span class="fu">chartr</span>(<span class="st">"éèêëàâçîô"</span>, <span class="st">"eeeeaacio"</span>, chaine)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-46-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-46-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="découper-une-chaîne-de-caractères-selon-un-caractère-donné" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="découper-une-chaîne-de-caractères-selon-un-caractère-donné"><span class="header-section-number">8.4</span> Découper une chaîne de caractères selon un caractère donné</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-47-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-47-1" role="tab" aria-controls="tabset-47-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-47-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-47-2" role="tab" aria-controls="tabset-47-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-47-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-47-3" role="tab" aria-controls="tabset-47-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-47-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-47-4" role="tab" aria-controls="tabset-47-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-47-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-47-5" role="tab" aria-controls="tabset-47-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-47-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-47-1-tab">
<div class="sourceCode" id="cb202"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Afficher tous les mots d'une phrase : découper une phrase selon les espaces pour isoler les mots */</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Mots;</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>  delim = <span class="st">" "</span>;</span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>  Texte = <span class="st">"Mon texte va être coupé !"</span>;</span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Chaque mot dans une variable */</span></span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%macro</span> Decouper;</span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%do</span> i = <span class="dv">1</span> <span class="kw">%to</span> <span class="kw">%sysfunc</span>(countw(Texte, delim));</span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true" tabindex="-1"></a>      Mot<span class="kw">&amp;i.</span> = <span class="fu">scan</span>(Texte, <span class="kw">&amp;i.</span>, delim);</span>
<span id="cb202-9"><a href="#cb202-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%end</span>;</span>
<span id="cb202-10"><a href="#cb202-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%mend</span> Decouper;</span>
<span id="cb202-11"><a href="#cb202-11" aria-hidden="true" tabindex="-1"></a>  %Decouper;</span>
<span id="cb202-12"><a href="#cb202-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Les mots empilés */</span></span>
<span id="cb202-13"><a href="#cb202-13" aria-hidden="true" tabindex="-1"></a>  nb_mots = countw(Texte, delim);</span>
<span id="cb202-14"><a href="#cb202-14" aria-hidden="true" tabindex="-1"></a><span class="kw">  do</span> nb = <span class="dv">1</span> <span class="kw">to</span> nb_mots;</span>
<span id="cb202-15"><a href="#cb202-15" aria-hidden="true" tabindex="-1"></a>    mots = <span class="fu">scan</span>(Texte, nb, delim);</span>
<span id="cb202-16"><a href="#cb202-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">output</span>;</span>
<span id="cb202-17"><a href="#cb202-17" aria-hidden="true" tabindex="-1"></a><span class="kw">  end</span>;</span>
<span id="cb202-18"><a href="#cb202-18" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb202-19"><a href="#cb202-19" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> print<span class="kw"> data</span> = Mots<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-47-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-47-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Découper uen chaîne de caractères selon un caractère donné</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher tous les mots d'une phrase : découper une phrase selon les espaces pour isoler les mots</span></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>chaine  <span class="ot">&lt;-</span> <span class="st">"Mon texte va être coupé !"</span></span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">strsplit</span>(chaine, <span class="at">split =</span> <span class="st">" "</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-47-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-47-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Découper une chaîne de caractères selon un caractère donné</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher tous les mots d'une phrase : découper une phrase selon les espaces pour isoler les mots</span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>chaine  <span class="ot">&lt;-</span> <span class="st">"Mon texte va être coupé !"</span></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str_split</span>(chaine, <span class="at">pattern =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-47-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-47-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Découper uen chaîne de caractères selon un caractère donné</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher tous les mots d'une phrase : découper une phrase selon les espaces pour isoler les mots</span></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>chaine  <span class="ot">&lt;-</span> <span class="st">"Mon texte va être coupé !"</span></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">strsplit</span>(chaine, <span class="at">split =</span> <span class="st">" "</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-47-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-47-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="inverser-une-chaîne-de-caractères" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="inverser-une-chaîne-de-caractères"><span class="header-section-number">8.5</span> Inverser une chaîne de caractères</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-48-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-48-1" role="tab" aria-controls="tabset-48-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-48-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-48-2" role="tab" aria-controls="tabset-48-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-48-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-48-3" role="tab" aria-controls="tabset-48-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-48-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-48-4" role="tab" aria-controls="tabset-48-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-48-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-48-5" role="tab" aria-controls="tabset-48-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-48-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-48-1-tab">
<div class="sourceCode" id="cb206"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Mots;</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>  Texte = <span class="st">"Mon texte va être coupé !"</span>;</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">x</span> = <span class="fu">left</span>(<span class="fu">reverse</span>(Texte));</span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> print<span class="kw"> data</span> = Mots<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-48-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-48-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>inverserTexte <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lapply</span>(<span class="fu">strsplit</span>(x, <span class="cn">NULL</span>), rev),</span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>    paste, <span class="at">collapse =</span> <span class="st">""</span>)</span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a><span class="fu">inverserTexte</span>(chaine)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-48-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-48-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringi)</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>stringi<span class="sc">::</span><span class="fu">stri_reverse</span>(chaine)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-48-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-48-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>inverserTexte <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lapply</span>(<span class="fu">strsplit</span>(x, <span class="cn">NULL</span>), rev),</span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>    paste, <span class="at">collapse =</span> <span class="st">""</span>)</span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a><span class="fu">inverserTexte</span>(chaine)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-48-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-48-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
</section>
<section id="gestion-par-groupe" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Gestion par groupe</h1>
<section id="numéroter-les-lignes" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="numéroter-les-lignes"><span class="header-section-number">9.1</span> Numéroter les lignes</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-49-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-49-1" role="tab" aria-controls="tabset-49-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-49-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-49-2" role="tab" aria-controls="tabset-49-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-49-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-49-3" role="tab" aria-controls="tabset-49-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-49-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-49-4" role="tab" aria-controls="tabset-49-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-49-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-49-5" role="tab" aria-controls="tabset-49-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-49-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-49-1-tab">
<div class="sourceCode" id="cb210"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>  Num_observation = _n_;</span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a><span class="co">/* Autre solution */</span></span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql noprint;<span class="kw">select</span> count(*) <span class="kw">into</span> :nbLignes <span class="kw">from</span> donnees_sas;<span class="kw">quit</span>;</span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> numLigne<span class="kw">;do</span> Num_observation = <span class="dv">1</span> <span class="kw">to</span> <span class="kw">&amp;nbLignes.</span>;<span class="kw">output;end;run</span>;</span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> _NULL_;</span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas nobs = <span class="fu">n</span>;</span>
<span id="cb210-10"><a href="#cb210-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">call</span> symputx(<span class="st">'nbLignes'</span>, <span class="fu">n</span>);</span>
<span id="cb210-11"><a href="#cb210-11" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb210-12"><a href="#cb210-12" aria-hidden="true" tabindex="-1"></a><span class="kw">%put</span> Nombre de lignes : <span class="kw">&amp;nbLignes.</span>;</span>
<span id="cb210-13"><a href="#cb210-13" aria-hidden="true" tabindex="-1"></a><span class="co">/* Le merge "simple" (sans by) va seulement concaténer les deux bases l'une à côté de l'autre */</span></span>
<span id="cb210-14"><a href="#cb210-14" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb210-15"><a href="#cb210-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">merge</span> donnees_sas numLigne;</span>
<span id="cb210-16"><a href="#cb210-16" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-49-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-49-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Numéro de l'observation : 2 manières différentes</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>num_observation <span class="ot">&lt;-</span> <span class="fu">row.names</span>(donnees_rbase)</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>num_observation <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span> <span class="sc">:</span> <span class="fu">nrow</span>(donnees_rbase))</span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Numéro du contrat de chaque individu, contrat trié par date de survenue</span></span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>identifiant, donnees_rbase<span class="sc">$</span>date_entre, <span class="at">na.last =</span> <span class="cn">FALSE</span>), ]</span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>un <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>numero_contrat <span class="ot">&lt;-</span> <span class="fu">ave</span>(donnees_rbase<span class="sc">$</span>un, donnees_rbase<span class="sc">$</span>identifiant, <span class="at">FUN =</span> cumsum)</span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>un <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb211-10"><a href="#cb211-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb211-11"><a href="#cb211-11" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>identifiant, donnees_rbase<span class="sc">$</span>date_entre, <span class="at">na.last =</span> <span class="cn">FALSE</span>), ]</span>
<span id="cb211-12"><a href="#cb211-12" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>numero_contrat <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">ave</span>(donnees_rbase<span class="sc">$</span>identifiant, donnees_rbase<span class="sc">$</span>identifiant, <span class="at">FUN =</span> seq_along))</span>
<span id="cb211-13"><a href="#cb211-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution : order pour éviter le as.numeric</span></span>
<span id="cb211-14"><a href="#cb211-14" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>identifiant, donnees_rbase<span class="sc">$</span>date_entre, <span class="at">na.last =</span> <span class="cn">FALSE</span>), ]</span>
<span id="cb211-15"><a href="#cb211-15" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>numero_contrat <span class="ot">&lt;-</span> <span class="fu">ave</span>(<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>date_entree), donnees_rbase<span class="sc">$</span>identifiant, <span class="at">FUN =</span> seq_along)</span>
<span id="cb211-16"><a href="#cb211-16" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/11996135/create-a-sequential-number-counter-for-rows-within-each-group-of-a-dataframe</span></span>
<span id="cb211-17"><a href="#cb211-17" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/13732062/what-are-examples-of-when-seq-along-works-but-seq-produces-unintended-results</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-49-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-49-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Numéro de l'observation</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pour trier les données de la même façon que SAS</span></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="sc">!</span><span class="fu">is.na</span>(date_entree), date_entree) <span class="sc">%&gt;%</span> </span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">num_observation =</span> <span class="fu">row_number</span>())</span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Numéro du contrat de chaque individu, contrat trié par date de survenue</span></span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a><span class="co"># arrange() va permettre de trier les observations par identifiant et date d'entrée </span></span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pour trier les données de la même façon que SAS</span></span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="sc">!</span><span class="fu">is.na</span>(date_entree), date_entree) <span class="sc">%&gt;%</span> </span>
<span id="cb212-13"><a href="#cb212-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">numero_contrat =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb212-14"><a href="#cb212-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb212-15"><a href="#cb212-15" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : Dans group_by, à quoi sert le drop ?</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-49-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-49-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Numéro de l'observation : 2 manières différentes</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, num_observation <span class="sc">:</span><span class="er">=</span> .I]</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, num_observation <span class="sc">:</span><span class="er">=</span> <span class="fu">seq_len</span>(.N)]</span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Numéro du contrat de chaque individu, contrat trié par date de survenue</span></span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a><span class="fu">setorder</span>(donnees_datatable, <span class="st">"identifiant"</span>, <span class="st">"date_entree"</span>, <span class="at">na.last =</span> <span class="cn">FALSE</span>)</span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, numero_contrat <span class="sc">:</span><span class="er">=</span> <span class="fu">rowid</span>(identifiant)]</span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, numero_contrat <span class="sc">:</span><span class="er">=</span> <span class="fu">seq_len</span>(.N), by <span class="ot">=</span> identifiant]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-49-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-49-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="numéro-de-contrat-par-individu" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="numéro-de-contrat-par-individu"><span class="header-section-number">9.2</span> Numéro de contrat par individu</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-50-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-50-1" role="tab" aria-controls="tabset-50-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-50-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-50-2" role="tab" aria-controls="tabset-50-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-50-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-50-3" role="tab" aria-controls="tabset-50-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-50-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-50-4" role="tab" aria-controls="tabset-50-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-50-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-50-5" role="tab" aria-controls="tabset-50-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-50-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-50-1-tab">
<div class="sourceCode" id="cb214"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas;<span class="kw">by</span> identifiant date_entree<span class="kw">;run</span>;</span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="co">/* L'instruction options permet de ne pas afficher d'erreur si la variable numero_contrat n'existe pas */</span></span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a><span class="kw">options</span> dkricond=nowarn dkrocond=nowarn;</span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas (<span class="kw">drop</span> = numero_contrat);</span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">by</span> identifiant date_entree;</span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">retain</span> numero_contrat <span class="dv">0</span>;</span>
<span id="cb214-8"><a href="#cb214-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> first.identifiant <span class="kw">then</span> numero_contrat = <span class="dv">1</span>;</span>
<span id="cb214-9"><a href="#cb214-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">else</span>                      numero_contrat = numero_contrat + <span class="dv">1</span>;</span>
<span id="cb214-10"><a href="#cb214-10" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb214-11"><a href="#cb214-11" aria-hidden="true" tabindex="-1"></a><span class="kw">options</span> dkricond=warn dkrocond=warn;</span>
<span id="cb214-12"><a href="#cb214-12" aria-hidden="true" tabindex="-1"></a><span class="co">/* Pour trier les colonnes */</span></span>
<span id="cb214-13"><a href="#cb214-13" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb214-14"><a href="#cb214-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">retain</span> identifiant date_entree numero_contrat numero_contrat;</span>
<span id="cb214-15"><a href="#cb214-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb214-16"><a href="#cb214-16" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-50-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-50-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1ère ligne par identifiant</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase[<span class="sc">!</span><span class="fu">duplicated</span>(donnees_rbase<span class="sc">$</span>identifiant), , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Dernière ligne par identifiant</span></span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>donnees_rbase[<span class="sc">!</span><span class="fu">duplicated</span>(donnees_rbase<span class="sc">$</span>identifiant, <span class="at">fromLast =</span> <span class="cn">TRUE</span>), , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-50-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-50-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1ère ligne par identifiant</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pour trier les données de la même façon que SAS</span></span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="sc">!</span><span class="fu">is.na</span>(date_entree), date_entree) <span class="sc">%&gt;%</span></span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Autres solutions</span></span>
<span id="cb216-9"><a href="#cb216-9" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb216-10"><a href="#cb216-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb216-11"><a href="#cb216-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pour trier les données de la même façon que SAS</span></span>
<span id="cb216-12"><a href="#cb216-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="sc">!</span><span class="fu">is.na</span>(date_entree), date_entree) <span class="sc">%&gt;%</span></span>
<span id="cb216-13"><a href="#cb216-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb216-14"><a href="#cb216-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb216-15"><a href="#cb216-15" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span>  </span>
<span id="cb216-16"><a href="#cb216-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb216-17"><a href="#cb216-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pour trier les données de la même façon que SAS</span></span>
<span id="cb216-18"><a href="#cb216-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="sc">!</span><span class="fu">is.na</span>(date_entree), date_entree) <span class="sc">%&gt;%</span></span>
<span id="cb216-19"><a href="#cb216-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb216-20"><a href="#cb216-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb216-21"><a href="#cb216-21" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span>  </span>
<span id="cb216-22"><a href="#cb216-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb216-23"><a href="#cb216-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pour trier les données de la même façon que SAS</span></span>
<span id="cb216-24"><a href="#cb216-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="sc">!</span><span class="fu">is.na</span>(date_entree), date_entree) <span class="sc">%&gt;%</span></span>
<span id="cb216-25"><a href="#cb216-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="fu">nth</span>(<span class="fu">row_number</span>(), <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb216-26"><a href="#cb216-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb216-27"><a href="#cb216-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-28"><a href="#cb216-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Dernière ligne par identifiant</span></span>
<span id="cb216-29"><a href="#cb216-29" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb216-30"><a href="#cb216-30" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb216-31"><a href="#cb216-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pour trier les données de la même façon que SAS</span></span>
<span id="cb216-32"><a href="#cb216-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="sc">!</span><span class="fu">is.na</span>(date_entree), date_entree) <span class="sc">%&gt;%</span></span>
<span id="cb216-33"><a href="#cb216-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb216-34"><a href="#cb216-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb216-35"><a href="#cb216-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Autres solutions</span></span>
<span id="cb216-36"><a href="#cb216-36" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span>  </span>
<span id="cb216-37"><a href="#cb216-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb216-38"><a href="#cb216-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pour trier les données de la même façon que SAS</span></span>
<span id="cb216-39"><a href="#cb216-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="sc">!</span><span class="fu">is.na</span>(date_entree), date_entree) <span class="sc">%&gt;%</span></span>
<span id="cb216-40"><a href="#cb216-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb216-41"><a href="#cb216-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb216-42"><a href="#cb216-42" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span>  </span>
<span id="cb216-43"><a href="#cb216-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb216-44"><a href="#cb216-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pour trier les données de la même façon que SAS</span></span>
<span id="cb216-45"><a href="#cb216-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="sc">!</span><span class="fu">is.na</span>(date_entree), date_entree) <span class="sc">%&gt;%</span></span>
<span id="cb216-46"><a href="#cb216-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="fu">nth</span>(<span class="fu">row_number</span>(), <span class="sc">-</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb216-47"><a href="#cb216-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-50-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-50-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire la 1ère ligne par identifiant</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, .SD[<span class="dv">1</span>], by <span class="ot">=</span> identifiant]</span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire la dernière ligne par identifiant</span></span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, .SD[.N], by <span class="ot">=</span> identifiant]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-50-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-50-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="le-premier-contrat-le-dernier-contrat-ni-le-premier-ni-le-dernier-contrat-de-chaque-individu" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="le-premier-contrat-le-dernier-contrat-ni-le-premier-ni-le-dernier-contrat-de-chaque-individu"><span class="header-section-number">9.3</span> Le premier contrat, le dernier contrat, ni le premier ni le dernier contrat de chaque individu …</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-51-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-51-1" role="tab" aria-controls="tabset-51-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-51-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-51-2" role="tab" aria-controls="tabset-51-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-51-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-51-3" role="tab" aria-controls="tabset-51-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-51-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-51-4" role="tab" aria-controls="tabset-51-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-51-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-51-5" role="tab" aria-controls="tabset-51-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-51-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-51-1-tab">
<div class="sourceCode" id="cb218"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas;<span class="kw">by</span> identifiant date_entree<span class="kw">;run</span>;</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">by</span> identifiant date_entree;</span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a>  Premier_Contrat = (first.identifiant = <span class="dv">1</span>);</span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a>  Dernier_Contrat = (last.identifiant = <span class="dv">1</span>);</span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a>  Ni_Prem_Ni_Der  = (first.identifiant = <span class="dv">0</span> <span class="kw">and</span> last.identifiant = <span class="dv">0</span>);</span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true" tabindex="-1"></a><span class="co">/* Créer une base avec les seuls premiers contrats, et une base avec les seuls derniers contrats */</span></span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas;<span class="kw">by</span> identifiant date_entree<span class="kw">;run</span>;</span>
<span id="cb218-12"><a href="#cb218-12" aria-hidden="true" tabindex="-1"></a><span class="co">/* Création de 2 bases en une seule étape */</span></span>
<span id="cb218-13"><a href="#cb218-13" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Premier_Contrat Dernier_Contrat;</span>
<span id="cb218-14"><a href="#cb218-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb218-15"><a href="#cb218-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">by</span> identifiant date_entree;</span>
<span id="cb218-16"><a href="#cb218-16" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> first.identifiant <span class="kw">then</span> <span class="kw">output</span> Premier_Contrat;</span>
<span id="cb218-17"><a href="#cb218-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> last.identifiant <span class="kw">then</span> <span class="kw">output</span> Dernier_Contrat;</span>
<span id="cb218-18"><a href="#cb218-18" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-51-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-51-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>identifiant, donnees_rbase<span class="sc">$</span>date_entre, <span class="at">na.last =</span> <span class="cn">FALSE</span>), ]</span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>premier_contrat <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">duplicated</span>(donnees_rbase<span class="sc">$</span>identifiant, <span class="at">fromLast =</span> <span class="cn">FALSE</span>), <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>dernier_contrat <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">duplicated</span>(donnees_rbase<span class="sc">$</span>identifiant, <span class="at">fromLast =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>ni_prem_ni_der  <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="sc">!</span> <span class="fu">c</span>(<span class="sc">!</span><span class="fu">duplicated</span>(donnees_rbase<span class="sc">$</span>identifiant, <span class="at">fromLast =</span> <span class="cn">FALSE</span>) <span class="sc">|</span> <span class="sc">!</span><span class="fu">duplicated</span>(donnees_rbase<span class="sc">$</span>identifiant, <span class="at">fromLast =</span> <span class="cn">TRUE</span>)), <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer une base avec les seuls premiers contrats, et une base avec les seuls derniers contrats</span></span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>identifiant, donnees_rbase<span class="sc">$</span>date_entre, <span class="at">na.last =</span> <span class="cn">FALSE</span>), ]</span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a>premier_contrat <span class="ot">&lt;-</span> donnees_rbase[<span class="sc">!</span><span class="fu">duplicated</span>(donnees_rbase<span class="sc">$</span>identifiant, <span class="at">fromLast =</span> <span class="cn">FALSE</span>), ]</span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true" tabindex="-1"></a>dernier_contrat <span class="ot">&lt;-</span> donnees_rbase[<span class="sc">!</span><span class="fu">duplicated</span>(donnees_rbase<span class="sc">$</span>identifiant, <span class="at">fromLast =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb219-10"><a href="#cb219-10" aria-hidden="true" tabindex="-1"></a>ni_prem_ni_der  <span class="ot">&lt;-</span> donnees_rbase[<span class="sc">!</span> (<span class="sc">!</span><span class="fu">duplicated</span>(donnees_rbase<span class="sc">$</span>identifiant, <span class="at">fromLast =</span> <span class="cn">FALSE</span>) <span class="sc">|</span> <span class="sc">!</span><span class="fu">duplicated</span>(donnees_rbase<span class="sc">$</span>identifiant, <span class="at">fromLast =</span> <span class="cn">TRUE</span>)), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-51-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-51-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Premier contrat</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pour trier les données de la même façon que SAS</span></span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="sc">!</span><span class="fu">is.na</span>(date_entree), date_entree) <span class="sc">%&gt;%</span> </span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">premier_contrat =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Dernier contrat</span></span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pour trier les données de la même façon que SAS</span></span>
<span id="cb220-11"><a href="#cb220-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="sc">!</span><span class="fu">is.na</span>(date_entree), date_entree) <span class="sc">%&gt;%</span> </span>
<span id="cb220-12"><a href="#cb220-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb220-13"><a href="#cb220-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dernier_contrat =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="fu">n</span>(), <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb220-14"><a href="#cb220-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb220-15"><a href="#cb220-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Ni le premier, ni le dernier contrat</span></span>
<span id="cb220-16"><a href="#cb220-16" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb220-17"><a href="#cb220-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pour trier les données de la même façon que SAS</span></span>
<span id="cb220-18"><a href="#cb220-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="sc">!</span><span class="fu">is.na</span>(date_entree), date_entree) <span class="sc">%&gt;%</span> </span>
<span id="cb220-19"><a href="#cb220-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb220-20"><a href="#cb220-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ni_prem_ni_der =</span> <span class="fu">ifelse</span>( <span class="sc">!</span> (<span class="fu">row_number</span>() <span class="sc">==</span> <span class="fu">n</span>() <span class="sc">|</span> <span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>), <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb220-21"><a href="#cb220-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb220-22"><a href="#cb220-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-23"><a href="#cb220-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer une base avec les seuls premiers contrats, et une base avec les seuls derniers contrats</span></span>
<span id="cb220-24"><a href="#cb220-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Premier contrat</span></span>
<span id="cb220-25"><a href="#cb220-25" aria-hidden="true" tabindex="-1"></a>premier_contrat <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb220-26"><a href="#cb220-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pour trier les données de la même façon que SAS</span></span>
<span id="cb220-27"><a href="#cb220-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="sc">!</span><span class="fu">is.na</span>(date_entree), date_entree) <span class="sc">%&gt;%</span> </span>
<span id="cb220-28"><a href="#cb220-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb220-29"><a href="#cb220-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">premier_contrat =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb220-30"><a href="#cb220-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb220-31"><a href="#cb220-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Dernier contrat</span></span>
<span id="cb220-32"><a href="#cb220-32" aria-hidden="true" tabindex="-1"></a>dernier_contrat <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb220-33"><a href="#cb220-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pour trier les données de la même façon que SAS</span></span>
<span id="cb220-34"><a href="#cb220-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="sc">!</span><span class="fu">is.na</span>(date_entree), date_entree) <span class="sc">%&gt;%</span> </span>
<span id="cb220-35"><a href="#cb220-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb220-36"><a href="#cb220-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dernier_contrat =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="fu">n</span>(), <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb220-37"><a href="#cb220-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb220-38"><a href="#cb220-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Ni le premier, ni le dernier contrat</span></span>
<span id="cb220-39"><a href="#cb220-39" aria-hidden="true" tabindex="-1"></a>ni_prem_ni_der <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb220-40"><a href="#cb220-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pour trier les données de la même façon que SAS</span></span>
<span id="cb220-41"><a href="#cb220-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="sc">!</span><span class="fu">is.na</span>(date_entree), date_entree) <span class="sc">%&gt;%</span> </span>
<span id="cb220-42"><a href="#cb220-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb220-43"><a href="#cb220-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ni_prem_ni_der =</span> <span class="fu">ifelse</span>( <span class="sc">!</span> (<span class="fu">row_number</span>() <span class="sc">==</span> <span class="fu">n</span>() <span class="sc">|</span> <span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>), <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb220-44"><a href="#cb220-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-51-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-51-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>donnees_datatable <span class="ot">&lt;-</span> donnees_datatable[<span class="fu">order</span>(identifiant, date_entree, <span class="at">na.last =</span> <span class="cn">FALSE</span>)]</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, premier_contrat <span class="sc">:</span><span class="er">=</span> <span class="fu">fifelse</span>(<span class="sc">!</span><span class="fu">duplicated</span>(identifiant, <span class="at">fromLast =</span> <span class="cn">FALSE</span>), <span class="dv">1</span>, <span class="dv">0</span>)]</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, dernier_contrat <span class="sc">:</span><span class="er">=</span> <span class="fu">fifelse</span>(<span class="sc">!</span><span class="fu">duplicated</span>(identifiant, <span class="at">fromLast =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>, <span class="dv">0</span>)]</span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, ni_prem_ni_der <span class="sc">:</span><span class="er">=</span> <span class="fu">fifelse</span>(<span class="sc">!</span> <span class="fu">c</span>(<span class="sc">!</span><span class="fu">duplicated</span>(identifiant, <span class="at">fromLast =</span> <span class="cn">FALSE</span>) <span class="sc">|</span> <span class="sc">!</span><span class="fu">duplicated</span>(identifiant, <span class="at">fromLast =</span> <span class="cn">TRUE</span>)), <span class="dv">1</span>, <span class="dv">0</span>)]</span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer une base avec les seuls premiers contrats, et une base avec les seuls derniers contrats</span></span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true" tabindex="-1"></a>donnees_datatable <span class="ot">&lt;-</span> donnees_datatable[<span class="fu">order</span>(identifiant, date_entree, <span class="at">na.last =</span> <span class="cn">FALSE</span>)]</span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true" tabindex="-1"></a>premier_contrat <span class="ot">&lt;-</span> donnees_datatable[<span class="sc">!</span><span class="fu">duplicated</span>(identifiant, <span class="at">fromLast =</span> <span class="cn">FALSE</span>), ]</span>
<span id="cb221-9"><a href="#cb221-9" aria-hidden="true" tabindex="-1"></a>dernier_contrat <span class="ot">&lt;-</span> donnees_datatable[<span class="sc">!</span><span class="fu">duplicated</span>(identifiant, <span class="at">fromLast =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb221-10"><a href="#cb221-10" aria-hidden="true" tabindex="-1"></a>ni_prem_ni_der  <span class="ot">&lt;-</span> donnees_datatable[<span class="sc">!</span> (<span class="sc">!</span><span class="fu">duplicated</span>(identifiant, <span class="at">fromLast =</span> <span class="cn">FALSE</span>) <span class="sc">|</span> <span class="sc">!</span><span class="fu">duplicated</span>(identifiant, <span class="at">fromLast =</span> <span class="cn">TRUE</span>)), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-51-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-51-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="les-2-premières-dernières-lignes-de-chaque-identifiant" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="les-2-premières-dernières-lignes-de-chaque-identifiant"><span class="header-section-number">9.4</span> Les 2 premières / dernières lignes de chaque identifiant</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-52-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-52-1" role="tab" aria-controls="tabset-52-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-52-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-52-2" role="tab" aria-controls="tabset-52-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-52-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-52-3" role="tab" aria-controls="tabset-52-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-52-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-52-4" role="tab" aria-controls="tabset-52-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-52-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-52-5" role="tab" aria-controls="tabset-52-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-52-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-52-1-tab">
<div class="sourceCode" id="cb222"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Les 2 premières lignes de chaque identifiant */</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas;<span class="kw">by</span> identifiant numero_contrat<span class="kw">;run</span>;</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> * <span class="kw">from</span> donnees_sas <span class="kw">group</span> <span class="kw">by</span> identifiant</span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">having</span> numero_contrat &lt;= <span class="dv">2</span>;</span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a><span class="co">/* Les 2 dernières lignes de chaque identifiant */</span></span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas;<span class="kw">by</span> identifiant numero_contrat<span class="kw">;run</span>;</span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> * <span class="kw">from</span> donnees_sas <span class="kw">group</span> <span class="kw">by</span> identifiant</span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">having</span> numero_contrat &gt;= count(*) - <span class="dv">1</span>;</span>
<span id="cb222-12"><a href="#cb222-12" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-52-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-52-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 premières lignes par identifiant (le premier si une seule ligne)</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Peut-on le faire en moins d'étapes ??? Avec head ?</span></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>numero_contrat <span class="ot">&lt;-</span> <span class="fu">ave</span>(donnees_rbase<span class="sc">$</span>a, donnees_rbase<span class="sc">$</span>identifiant, <span class="at">FUN =</span> cumsum)</span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>deux_premieres_lignes <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">which</span>(donnees_rbase<span class="sc">$</span>numero_contrat <span class="sc">&lt;=</span> <span class="dv">2</span>), ]</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>a <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a><span class="co"># REVOIR</span></span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a><span class="co">#donnees_rbase[ave(rep(TRUE, nrow(donnees_rbase)), donnees_rbase$identifiant, FUN = function(z) seq_along(z) == 2L)]</span></span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a><span class="co">#ind &lt;- donnees_rbase[ave(rep(TRUE, nrow(donnees_rbase)), donnees_rbase$identifiant, FUN = function(z) length(z) == 1L | seq_along(z) == 2L)]</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-52-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-52-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Les deux premières lignes</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>deux_premieres_lignes <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pour trier les données de la même façon que SAS</span></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="sc">!</span><span class="fu">is.na</span>(date_entree), date_entree) <span class="sc">%&gt;%</span> </span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Les deux dernières lignes</span></span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a>deux_dernieres_lignes <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pour trier les données de la même façon que SAS</span></span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="sc">!</span><span class="fu">is.na</span>(date_entree), date_entree) <span class="sc">%&gt;%</span> </span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">n</span>() <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb224-14"><a href="#cb224-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-52-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-52-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>deux_premieres_lignes <span class="ot">&lt;-</span> donnees_datatable[, .SD[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], by <span class="ot">=</span> identifiant]</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>deux_dernieres_lignes <span class="ot">&lt;-</span> donnees_datatable[, .SD[.N<span class="dv">-2</span><span class="sc">:</span>.N], by <span class="ot">=</span> identifiant]</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Version en R Base</span></span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/14800161/select-the-top-n-values-by-group</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-52-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-52-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="e-ligne-de-lindividu-et-rien-si-lindividu-a-1-seule-ligne" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="e-ligne-de-lindividu-et-rien-si-lindividu-a-1-seule-ligne"><span class="header-section-number">9.5</span> 2e ligne de l’individu (et rien si l’individu a 1 seule ligne)</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-53-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-53-1" role="tab" aria-controls="tabset-53-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-53-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-53-2" role="tab" aria-controls="tabset-53-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-53-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-53-3" role="tab" aria-controls="tabset-53-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-53-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-53-4" role="tab" aria-controls="tabset-53-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-53-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-53-5" role="tab" aria-controls="tabset-53-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-53-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-53-1-tab">
<div class="sourceCode" id="cb226"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas;<span class="kw">by</span> identifiant date_entree<span class="kw">;run</span>;</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">by</span> identifiant date_entree;</span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">retain</span> numero_contrat <span class="dv">0</span>;</span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> first.identifiant <span class="kw">then</span> numero_contrat = <span class="dv">1</span>;</span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">else</span>                      numero_contrat = numero_contrat + <span class="dv">1</span>;</span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Deuxieme_Contrat;</span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb226-11"><a href="#cb226-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> numero_contrat = <span class="dv">2</span>;</span>
<span id="cb226-12"><a href="#cb226-12" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb226-13"><a href="#cb226-13" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Deuxieme_Contrat;</span>
<span id="cb226-14"><a href="#cb226-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas (<span class="kw">where</span> = (numero_contrat = <span class="dv">2</span>));</span>
<span id="cb226-15"><a href="#cb226-15" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-53-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-53-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec le numéro de contrat</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>deuxieme_ligne <span class="ot">&lt;-</span> donnees_rbase[donnees_rbase<span class="sc">$</span>numero_contrat <span class="sc">==</span> <span class="dv">2</span>, ]</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>identifiant, donnees_rbase<span class="sc">$</span>date_entre, <span class="at">na.last =</span> <span class="cn">FALSE</span>), ]</span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>donnees_rbase[<span class="fu">unlist</span>(<span class="fu">tapply</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(donnees_rbase)), donnees_rbase<span class="sc">$</span>identifiant, <span class="cf">function</span>(x) x[<span class="fu">length</span>(x)<span class="sc">-</span>(<span class="fu">length</span>(x)<span class="sc">-</span><span class="dv">1</span>)])), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-53-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-53-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pour trier les données de la même façon que SAS</span></span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="sc">!</span><span class="fu">is.na</span>(date_entree), date_entree) <span class="sc">%&gt;%</span> </span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-53-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-53-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>deuxieme_ligne <span class="ot">&lt;-</span> donnees_datatable[, .SD[<span class="dv">2</span>], by <span class="ot">=</span> identifiant]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-53-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-53-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="lavant-dernière-ligne-de-lindividu-et-rien-si-lindividu-a-1-seul-contrat" class="level2" data-number="9.6">
<h2 data-number="9.6" class="anchored" data-anchor-id="lavant-dernière-ligne-de-lindividu-et-rien-si-lindividu-a-1-seul-contrat"><span class="header-section-number">9.6</span> L’avant-dernière ligne de l’individu (et rien si l’individu a 1 seul contrat)</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-54-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-54-1" role="tab" aria-controls="tabset-54-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-54-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-54-2" role="tab" aria-controls="tabset-54-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-54-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-54-3" role="tab" aria-controls="tabset-54-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-54-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-54-4" role="tab" aria-controls="tabset-54-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-54-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-54-5" role="tab" aria-controls="tabset-54-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-54-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-54-1-tab">
<div class="sourceCode" id="cb230"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Nécessite d'avoir le numéro du contrat */</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> * <span class="kw">from</span> donnees_sas <span class="kw">group</span> <span class="kw">by</span> identifiant</span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">having</span> numero_contrat = count(*) - <span class="dv">1</span>;</span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-54-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-54-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase[<span class="fu">unlist</span>(<span class="fu">tapply</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(donnees_rbase)), donnees_rbase<span class="sc">$</span>identifiant, <span class="cf">function</span>(x) x[<span class="fu">length</span>(x)<span class="sc">-</span><span class="dv">1</span>])), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-54-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-54-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pour trier les données de la même façon que SAS</span></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="sc">!</span><span class="fu">is.na</span>(date_entree), date_entree) <span class="sc">%&gt;%</span> </span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="fu">nth</span>(<span class="fu">row_number</span>(), <span class="sc">-</span><span class="dv">2</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-54-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-54-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, .SD[.N<span class="dv">-1</span>], by <span class="ot">=</span> identifiant]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-54-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-54-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="sélection-par-groupement" class="level2" data-number="9.7">
<h2 data-number="9.7" class="anchored" data-anchor-id="sélection-par-groupement"><span class="header-section-number">9.7</span> Sélection par groupement</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-55-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-55-1" role="tab" aria-controls="tabset-55-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-55-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-55-2" role="tab" aria-controls="tabset-55-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-55-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-55-3" role="tab" aria-controls="tabset-55-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-55-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-55-4" role="tab" aria-controls="tabset-55-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-55-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-55-5" role="tab" aria-controls="tabset-55-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-55-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-55-1-tab">
<div class="sourceCode" id="cb234"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Personnes qui ont eu au moins une entrée en 2022 */</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> *</span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> donnees_sas</span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">group</span> <span class="kw">by</span> identifiant</span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">having</span> <span class="fu">sum</span>(<span class="fu">year</span>(date_entree) = <span class="dv">2022</span>) &gt;= <span class="dv">1</span>;</span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-9"><a href="#cb234-9" aria-hidden="true" tabindex="-1"></a><span class="co">/* Personnes qui ont suivi à la fois une formation qualifiée et une formation non qualifiée */</span></span>
<span id="cb234-10"><a href="#cb234-10" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb234-11"><a href="#cb234-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">table</span> Qualif_Non_Qualif <span class="kw">as</span></span>
<span id="cb234-12"><a href="#cb234-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> *</span>
<span id="cb234-13"><a href="#cb234-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> donnees_sas</span>
<span id="cb234-14"><a href="#cb234-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">group</span> <span class="kw">by</span> identifiant</span>
<span id="cb234-15"><a href="#cb234-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">having</span> <span class="fu">sum</span>(Niveau = <span class="st">"Non qualifie"</span>) &gt;= <span class="dv">1</span> <span class="kw">and</span> <span class="fu">sum</span>(Niveau = <span class="st">"Non qualifie"</span>) &gt;= <span class="dv">1</span>;</span>
<span id="cb234-16"><a href="#cb234-16" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span>
<span id="cb234-17"><a href="#cb234-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-18"><a href="#cb234-18" aria-hidden="true" tabindex="-1"></a><span class="co">/* Personnes qui ont suivi deux contrats, et seulement deux, dont l'un au moins ayant débuté en 2022 */</span></span>
<span id="cb234-19"><a href="#cb234-19" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb234-20"><a href="#cb234-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">table</span> Deux_Contrats <span class="kw">as</span></span>
<span id="cb234-21"><a href="#cb234-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> *</span>
<span id="cb234-22"><a href="#cb234-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> donnees_sas</span>
<span id="cb234-23"><a href="#cb234-23" aria-hidden="true" tabindex="-1"></a>  <span class="kw">group</span> <span class="kw">by</span> identifiant</span>
<span id="cb234-24"><a href="#cb234-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">having</span> count(*) = <span class="dv">2</span> <span class="kw">and</span> <span class="fu">sum</span>(<span class="fu">year</span>(date_entree) = <span class="dv">2022</span>) &gt;= <span class="dv">1</span>;</span>
<span id="cb234-25"><a href="#cb234-25" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-55-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-55-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Personnes qui ont eu au moins une entrée en 2022</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>auMoins2022 <span class="ot">&lt;-</span> <span class="fu">subset</span>(donnees_rbase, identifiant <span class="sc">%in%</span> <span class="fu">unique</span>(identifiant[lubridate<span class="sc">::</span><span class="fu">year</span>(date_entree) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2022</span>)]))</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution : ne semble possible que pour une seule variable</span></span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>auMoins2022 <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">with</span>(donnees_rbase, <span class="fu">ave</span>(lubridate<span class="sc">::</span><span class="fu">year</span>(date_entree) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2022</span>), identifiant, <span class="at">FUN =</span> any)), ]</span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Personnes qui ont suivi à la fois une formation qualifiée et une formation non qualifiée</span></span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a>qualif_non_qualif <span class="ot">&lt;-</span> <span class="fu">subset</span>(</span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform</span>(donnees_rbase, </span>
<span id="cb235-9"><a href="#cb235-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">qualif     =</span> <span class="fu">ave</span>(niveau, identifiant, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">ifelse</span>(x <span class="sc">==</span> <span class="st">"Qualifié"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), </span>
<span id="cb235-10"><a href="#cb235-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">non_qualif =</span> <span class="fu">ave</span>(niveau, identifiant, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">ifelse</span>(x <span class="sc">==</span> <span class="st">"Non Qualifié"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))),</span>
<span id="cb235-11"><a href="#cb235-11" aria-hidden="true" tabindex="-1"></a>  qualif <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> non_qualif <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb235-12"><a href="#cb235-12" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stackoverflow.com/questions/49669862/how-to-group-by-in-base-r</span></span>
<span id="cb235-13"><a href="#cb235-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-14"><a href="#cb235-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Personnes qui ont suivi deux contrats, et seulement deux, dont l'un au moins ayant débuté en 2022</span></span>
<span id="cb235-15"><a href="#cb235-15" aria-hidden="true" tabindex="-1"></a>deux_contrats <span class="ot">&lt;-</span> <span class="fu">subset</span>(</span>
<span id="cb235-16"><a href="#cb235-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform</span>(donnees_rbase, </span>
<span id="cb235-17"><a href="#cb235-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">nb =</span> <span class="fu">ave</span>(identifiant, identifiant, <span class="at">FUN =</span> length), </span>
<span id="cb235-18"><a href="#cb235-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">an =</span> <span class="fu">ave</span>(date_entree, identifiant, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">ifelse</span>(lubridate<span class="sc">::</span><span class="fu">year</span>(x) <span class="sc">==</span> <span class="dv">2022</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))),</span>
<span id="cb235-19"><a href="#cb235-19" aria-hidden="true" tabindex="-1"></a>  nb <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> an <span class="sc">&gt;=</span> <span class="dv">1</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-55-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-55-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Personnes qui ont eu au moins une entrée en 2022</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>auMoins2022 <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">any</span>(lubridate<span class="sc">::</span><span class="fu">year</span>(date_entree) <span class="sc">==</span> <span class="dv">2022</span>))</span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Personnes qui ont suivi à la fois une formation qualifiée et une formation non qualifiée</span></span>
<span id="cb236-7"><a href="#cb236-7" aria-hidden="true" tabindex="-1"></a>qualif_non_qualif <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb236-8"><a href="#cb236-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span></span>
<span id="cb236-9"><a href="#cb236-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">any</span>(niveau <span class="sc">==</span> <span class="st">"Qualifié"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb236-10"><a href="#cb236-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">any</span>(niveau <span class="sc">==</span> <span class="st">"Non qualifié"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb236-11"><a href="#cb236-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb236-12"><a href="#cb236-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-13"><a href="#cb236-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Personnes qui ont suivi deux contrats, et seulement deux, dont l'un au moins ayant débuté en 2022</span></span>
<span id="cb236-14"><a href="#cb236-14" aria-hidden="true" tabindex="-1"></a>deux_contrats <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb236-15"><a href="#cb236-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span></span>
<span id="cb236-16"><a href="#cb236-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb236-17"><a href="#cb236-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">any</span>(lubridate<span class="sc">::</span><span class="fu">year</span>(date_entree) <span class="sc">==</span> <span class="dv">2022</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb236-18"><a href="#cb236-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-55-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-55-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Personnes qui ont eu au moins une entrée en 2022</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>auMoins2022 <span class="ot">&lt;-</span> donnees_datatable[, <span class="cf">if</span>(<span class="fu">any</span>(lubridate<span class="sc">::</span><span class="fu">year</span>(date_entree) <span class="sc">%in%</span> <span class="dv">2022</span>)) .SD, by <span class="ot">=</span> identifiant]</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a>auMoins2022 <span class="ot">&lt;-</span> donnees_datatable[, <span class="cf">if</span> (<span class="fu">sum</span>(lubridate<span class="sc">::</span><span class="fu">year</span>(date_entree) <span class="sc">==</span> <span class="dv">2022</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) .SD, by <span class="ot">=</span> identifiant]</span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Personnes qui ont suivi à la fois une formation qualifiée et une formation non qualifiée</span></span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by et Having de SQL</span></span>
<span id="cb237-9"><a href="#cb237-9" aria-hidden="true" tabindex="-1"></a><span class="co"># https://github.com/Rdatatable/data.table/issues/788</span></span>
<span id="cb237-10"><a href="#cb237-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 1ère méthode</span></span>
<span id="cb237-11"><a href="#cb237-11" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="st">`</span><span class="at">:=</span><span class="st">`</span> (<span class="at">qualif =</span> <span class="fu">sum</span>(<span class="fu">fifelse</span>(niveau <span class="sc">==</span> <span class="st">"Qualifié"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb237-12"><a href="#cb237-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">non_qualif =</span> <span class="fu">sum</span>(<span class="fu">fifelse</span>(niveau <span class="sc">==</span> <span class="st">"Non qualifié"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb237-13"><a href="#cb237-13" aria-hidden="true" tabindex="-1"></a>                by <span class="ot">=</span> identifiant][qualif <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> non_qualif <span class="sc">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb237-14"><a href="#cb237-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 2e méthode un peu plus simple</span></span>
<span id="cb237-15"><a href="#cb237-15" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="st">`</span><span class="at">:=</span><span class="st">`</span> (<span class="at">qualif =</span> <span class="fu">sum</span>(niveau <span class="sc">==</span> <span class="st">"Qualifié"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">non_qualif =</span> <span class="fu">sum</span>(niveau <span class="sc">==</span> <span class="st">"Non qualifié"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), by <span class="ot">=</span> identifiant][qualif <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> non_qualif <span class="sc">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb237-16"><a href="#cb237-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 3e méthode, plus simple !!</span></span>
<span id="cb237-17"><a href="#cb237-17" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="cf">if</span> (<span class="fu">sum</span>(niveau <span class="sc">==</span> <span class="st">"Qualifié"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="fu">sum</span>(niveau <span class="sc">==</span> <span class="st">"Non qualifié"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) .SD, by <span class="ot">=</span> identifiant]</span>
<span id="cb237-18"><a href="#cb237-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-19"><a href="#cb237-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Personnes qui ont suivi deux contrats, et seulement deux, dont l'un au moins ayant débuté en 2022</span></span>
<span id="cb237-20"><a href="#cb237-20" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="cf">if</span> (.N <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> <span class="fu">sum</span>(lubridate<span class="sc">::</span><span class="fu">year</span>(date_entree) <span class="sc">==</span> <span class="dv">2022</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&gt;=</span> <span class="dv">1</span>) .SD, by <span class="ot">=</span> identifiant]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-55-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-55-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="ajouter-une-colonne-désignant-la-note-moyenne-de-note_contenu-par-individu" class="level2" data-number="9.8">
<h2 data-number="9.8" class="anchored" data-anchor-id="ajouter-une-colonne-désignant-la-note-moyenne-de-note_contenu-par-individu"><span class="header-section-number">9.8</span> Ajouter une colonne désignant la note moyenne de Note_Contenu par individu</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-56-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-56-1" role="tab" aria-controls="tabset-56-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-56-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-56-2" role="tab" aria-controls="tabset-56-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-56-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-56-3" role="tab" aria-controls="tabset-56-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-56-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-56-4" role="tab" aria-controls="tabset-56-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-56-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-56-5" role="tab" aria-controls="tabset-56-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-56-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-56-1-tab">
<div class="sourceCode" id="cb238"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* 1ère solution */</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas;<span class="kw">by</span> identifiant<span class="kw">;run</span>;</span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> means<span class="kw"> data</span> = donnees_sas <span class="fu">mean</span> noprint;</span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> Note_Contenu;<span class="kw">by</span> identifiant;<span class="kw">output</span> out = Temp;</span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Temp;</span>
<span id="cb238-7"><a href="#cb238-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> Temp (<span class="kw">where</span> = (_STAT_ = <span class="st">"MEAN"</span>));</span>
<span id="cb238-8"><a href="#cb238-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">keep</span> identifiant Note_Contenu;</span>
<span id="cb238-9"><a href="#cb238-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">rename</span> Note_Contenu = Note_Contenu_Moyenne;</span>
<span id="cb238-10"><a href="#cb238-10" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb238-11"><a href="#cb238-11" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb238-12"><a href="#cb238-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">merge</span> donnees_sas (<span class="kw">in</span> = a) Temp (<span class="kw">in</span> = b);</span>
<span id="cb238-13"><a href="#cb238-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">by</span> identifiant;</span>
<span id="cb238-14"><a href="#cb238-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> a;</span>
<span id="cb238-15"><a href="#cb238-15" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb238-16"><a href="#cb238-16" aria-hidden="true" tabindex="-1"></a><span class="co">/* 2e solution : plus souple */</span></span>
<span id="cb238-17"><a href="#cb238-17" aria-hidden="true" tabindex="-1"></a><span class="co">/* Pour supprimer la variable ajoutée lors de la 1ère solution */</span></span>
<span id="cb238-18"><a href="#cb238-18" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb238-19"><a href="#cb238-19" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas (<span class="kw">drop</span> = Note_Contenu_Moyenne);</span>
<span id="cb238-20"><a href="#cb238-20" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb238-21"><a href="#cb238-21" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb238-22"><a href="#cb238-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">table</span> donnees_sas <span class="kw">as</span></span>
<span id="cb238-23"><a href="#cb238-23" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> *</span>
<span id="cb238-24"><a href="#cb238-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> donnees_sas a <span class="fu">left</span> join</span>
<span id="cb238-25"><a href="#cb238-25" aria-hidden="true" tabindex="-1"></a>       (<span class="kw">select</span> identifiant, <span class="fu">mean</span>(Note_Contenu) <span class="kw">as</span> Note_Contenu_Moyenne</span>
<span id="cb238-26"><a href="#cb238-26" aria-hidden="true" tabindex="-1"></a>        <span class="kw">from</span> donnees_sas <span class="kw">group</span> <span class="kw">by</span> identifiant) b</span>
<span id="cb238-27"><a href="#cb238-27" aria-hidden="true" tabindex="-1"></a>       <span class="kw">on</span> a.identifiant = b.identifiant</span>
<span id="cb238-28"><a href="#cb238-28" aria-hidden="true" tabindex="-1"></a>  <span class="kw">order</span> <span class="kw">by</span> identifiant;</span>
<span id="cb238-29"><a href="#cb238-29" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-56-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-56-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> <span class="fu">transform</span>(donnees_rbase, </span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">note_contenu_moyenne =</span> <span class="fu">ave</span>(note_contenu, identifiant, <span class="at">FUN =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">note_contenu_somme   =</span> <span class="fu">ave</span>(note_contenu, identifiant, <span class="at">FUN =</span> sum,  <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-56-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-56-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span></span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">note_contenu_moyenne =</span> <span class="fu">mean</span>(note_contenu, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">note_contenu_somme   =</span> <span class="fu">sum</span>(note_contenu, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-56-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-56-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="st">`</span><span class="at">:=</span><span class="st">`</span> (<span class="at">note_contenu_moyenne =</span> <span class="fu">mean</span>(note_contenu, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">note_contenu_somme =</span> <span class="fu">sum</span>(note_contenu, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), by <span class="ot">=</span> identifiant]</span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Moyenne de chaque note</span></span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">c</span>(<span class="st">"Note_Contenu"</span>, <span class="st">"Note_Formateur"</span>, <span class="st">"Note_Moyens"</span>, <span class="st">"Note_Accompagnement"</span>, <span class="st">"Note_Materiel"</span>))</span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">paste0</span>(notes, <span class="st">"_m"</span>) <span class="sc">:</span><span class="er">=</span> <span class="fu">lapply</span>(.SD, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), .SDcols <span class="ot">=</span> notes, keyby <span class="ot">=</span> identifiant]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-56-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-56-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="variable-retardée-lag" class="level2" data-number="9.9">
<h2 data-number="9.9" class="anchored" data-anchor-id="variable-retardée-lag"><span class="header-section-number">9.9</span> Variable retardée (lag)</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-57-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-57-1" role="tab" aria-controls="tabset-57-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-57-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-57-2" role="tab" aria-controls="tabset-57-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-57-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-57-3" role="tab" aria-controls="tabset-57-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-57-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-57-4" role="tab" aria-controls="tabset-57-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-57-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-57-5" role="tab" aria-controls="tabset-57-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-57-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-57-1-tab">
<div class="sourceCode" id="cb242"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* La date de fin du contrat précédent (lag) */</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas;<span class="kw">by</span> identifiant date_entree<span class="kw">;run</span>;</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sasBon;</span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">by</span> identifiant date_entree;  </span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Date_fin_1 ddmmyy10.;</span>
<span id="cb242-7"><a href="#cb242-7" aria-hidden="true" tabindex="-1"></a>  Date_fin_1 = <span class="fu">lag</span>(Date_sortie);</span>
<span id="cb242-8"><a href="#cb242-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> first.identifiant <span class="kw">then</span> Date_fin_1 = .;</span>
<span id="cb242-9"><a href="#cb242-9" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb242-10"><a href="#cb242-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-11"><a href="#cb242-11" aria-hidden="true" tabindex="-1"></a><span class="co">/* ATTENTION au lag DANS UNE CONDITION IF (cf. document) */</span></span>
<span id="cb242-12"><a href="#cb242-12" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas;<span class="kw">by</span> identifiant date_entree<span class="kw">;run</span>;</span>
<span id="cb242-13"><a href="#cb242-13" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Lag_Bon;</span>
<span id="cb242-14"><a href="#cb242-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas (<span class="kw">keep</span> = identifiant date_entree date_sortie);</span>
<span id="cb242-15"><a href="#cb242-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> date_sortie_1 lag_faux lag_bon ddmmyy10.;</span>
<span id="cb242-16"><a href="#cb242-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Erreur */</span></span>
<span id="cb242-17"><a href="#cb242-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> date_entree = <span class="fu">lag</span>(date_sortie) + <span class="dv">1</span> <span class="kw">then</span> lag_faux = <span class="fu">lag</span>(date_sortie) + <span class="dv">1</span>;</span>
<span id="cb242-18"><a href="#cb242-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Bonne écriture */</span></span>
<span id="cb242-19"><a href="#cb242-19" aria-hidden="true" tabindex="-1"></a>  date_sortie_1 = <span class="fu">lag</span>(date_sortie);</span>
<span id="cb242-20"><a href="#cb242-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> date_entree = date_sortie_1 + <span class="dv">1</span> <span class="kw">then</span> lag_bon = date_sortie_1 + <span class="dv">1</span>;</span>
<span id="cb242-21"><a href="#cb242-21" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-57-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-57-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># La date de fin du contrat précédent</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>identifiant, donnees_rbase<span class="sc">$</span>date_entre, <span class="at">na.last =</span> <span class="cn">FALSE</span>), ]</span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Il n'existe pas de fonction lag dans le R de base (à notre connaissance)</span></span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Il faut soit utiliser un package, soit utiliser cette astuce</span></span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>date_sortie_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">as.Date</span>(<span class="cn">NA</span>), donnees_rbase<span class="sc">$</span>date_sortie[ <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(donnees_rbase<span class="sc">$</span>date_sortie) <span class="sc">-</span> <span class="dv">1</span>)])</span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Peut-on aussi utiliser tail(..., -1) ?</span></span>
<span id="cb243-7"><a href="#cb243-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-8"><a href="#cb243-8" aria-hidden="true" tabindex="-1"></a><span class="co"># La date du contrat futur (lead)</span></span>
<span id="cb243-9"><a href="#cb243-9" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>date_sortie__1 <span class="ot">&lt;-</span> <span class="fu">c</span>(donnees_rbase<span class="sc">$</span>date_sortie[ <span class="dv">2</span><span class="sc">:</span>(<span class="fu">length</span>(donnees_rbase<span class="sc">$</span>date_sortie))], <span class="fu">as.Date</span>(<span class="cn">NA</span>))</span>
<span id="cb243-10"><a href="#cb243-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-11"><a href="#cb243-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Autres solutions</span></span>
<span id="cb243-12"><a href="#cb243-12" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/3558988/basic-lag-in-r-vector-dataframe</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-57-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-57-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># La date de fin du contrat précédent</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pour trier les données de la même façon que SAS</span></span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="sc">!</span><span class="fu">is.na</span>(date_entree), date_entree) <span class="sc">%&gt;%</span> </span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date_sortie_1 =</span> <span class="fu">lag</span>(date_sortie))</span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-7"><a href="#cb244-7" aria-hidden="true" tabindex="-1"></a><span class="co"># La date du contrat futur (lead)</span></span>
<span id="cb244-8"><a href="#cb244-8" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb244-9"><a href="#cb244-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pour trier les données de la même façon que SAS</span></span>
<span id="cb244-10"><a href="#cb244-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(identifiant, <span class="sc">!</span><span class="fu">is.na</span>(date_entree), date_entree) <span class="sc">%&gt;%</span> </span>
<span id="cb244-11"><a href="#cb244-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date_sortie__1 =</span> <span class="fu">lead</span>(date_sortie))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-57-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-57-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co"># La date de fin du contrat précédent</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setorderv</span>(donnees_datatable, <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"date_entree"</span>), <span class="at">order =</span> <span class="fu">c</span>(1L, 1L), <span class="at">na.last =</span> <span class="cn">FALSE</span>)</span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, date_sortie_1 <span class="sc">:</span><span class="er">=</span> <span class="fu">shift</span>(.SD, <span class="at">n =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="st">"lag"</span>), .SDcols <span class="ot">=</span> <span class="st">"date_sortie"</span>]</span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, .(date_sortie, date_sortie_1)]</span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a><span class="co"># La date du contrat futur (lead)</span></span>
<span id="cb245-7"><a href="#cb245-7" aria-hidden="true" tabindex="-1"></a><span class="fu">setorderv</span>(donnees_datatable, <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"date_entree"</span>), <span class="at">order =</span> <span class="fu">c</span>(1L, 1L), <span class="at">na.last =</span> <span class="cn">FALSE</span>)</span>
<span id="cb245-8"><a href="#cb245-8" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, date_sortie__1 <span class="sc">:</span><span class="er">=</span> <span class="fu">shift</span>(.SD, <span class="at">n =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="st">"lead"</span>), .SDcols <span class="ot">=</span> <span class="st">"date_sortie"</span>]</span>
<span id="cb245-9"><a href="#cb245-9" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, .(date_sortie, date_sortie__1)]</span>
<span id="cb245-10"><a href="#cb245-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-11"><a href="#cb245-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Autres solutions</span></span>
<span id="cb245-12"><a href="#cb245-12" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/3558988/basic-lag-in-r-vector-dataframe</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-57-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-57-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="transposer-une-base" class="level2" data-number="9.10">
<h2 data-number="9.10" class="anchored" data-anchor-id="transposer-une-base"><span class="header-section-number">9.10</span> Transposer une base</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-58-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-58-1" role="tab" aria-controls="tabset-58-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-58-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-58-2" role="tab" aria-controls="tabset-58-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-58-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-58-3" role="tab" aria-controls="tabset-58-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-58-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-58-4" role="tab" aria-controls="tabset-58-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-58-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-58-5" role="tab" aria-controls="tabset-58-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-58-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-58-1-tab">
<div class="sourceCode" id="cb246"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* On commence déjà par calculer un tableau croisé comptant les occurrences */</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> freq<span class="kw"> data</span> = donnees_sas;<span class="kw">table</span> Sexef * cspf / out = Nb<span class="kw">;run</span>;</span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = Nb;<span class="kw">by</span> cspf Sexef<span class="kw">;run</span>;</span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> print<span class="kw"> data</span> = Nb<span class="kw">;run</span>;</span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true" tabindex="-1"></a><span class="co">/* On transpose le tableau */</span></span>
<span id="cb246-6"><a href="#cb246-6" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> transpose<span class="kw"> data</span> = Nb out = transpose;<span class="kw">by</span> cspf;<span class="fu">var</span> count;id Sexef<span class="kw">;run</span>;</span>
<span id="cb246-7"><a href="#cb246-7" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> transpose;<span class="kw">set</span> transpose (<span class="kw">drop</span> = _name_ _label_)<span class="kw">;run</span>;</span>
<span id="cb246-8"><a href="#cb246-8" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> print<span class="kw"> data</span> = transpose<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-58-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-58-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On commence déjà par calculer un tableau croisé comptant les occurrences</span></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a><span class="co"># as.data.frame.matrix est nécessaire, car le résultat de xtabs est un array</span></span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a>nb <span class="ot">&lt;-</span> <span class="fu">as.data.frame.matrix</span>(<span class="fu">xtabs</span>( <span class="sc">~</span> cspf <span class="sc">+</span> sexef, <span class="at">data =</span> donnees_rbase))</span>
<span id="cb247-4"><a href="#cb247-4" aria-hidden="true" tabindex="-1"></a><span class="co"># On transpose le tableau</span></span>
<span id="cb247-5"><a href="#cb247-5" aria-hidden="true" tabindex="-1"></a>nb_transpose <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(nb))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-58-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-58-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On commence déjà par calculer un tableau croisé comptant les occurrences</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>nb <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(cspf, sexef) <span class="sc">%&gt;%</span> </span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(sexef, n)</span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true" tabindex="-1"></a><span class="co"># On transpose le tableau</span></span>
<span id="cb248-6"><a href="#cb248-6" aria-hidden="true" tabindex="-1"></a>nb_transpose <span class="ot">&lt;-</span> nb <span class="sc">%&gt;%</span> </span>
<span id="cb248-7"><a href="#cb248-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb248-8"><a href="#cb248-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(variable, value, <span class="sc">-</span>rowname) <span class="sc">%&gt;%</span>  </span>
<span id="cb248-9"><a href="#cb248-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(rowname, value)</span>
<span id="cb248-10"><a href="#cb248-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution avec les packages janitor et sjmisc</span></span>
<span id="cb248-11"><a href="#cb248-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb248-12"><a href="#cb248-12" aria-hidden="true" tabindex="-1"></a>nb <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb248-13"><a href="#cb248-13" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">tabyl</span>(cspf, sexef) <span class="sc">%&gt;%</span> </span>
<span id="cb248-14"><a href="#cb248-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># colonne cspf comme nom de ligne</span></span>
<span id="cb248-15"><a href="#cb248-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="at">var=</span><span class="st">"cspf"</span>)</span>
<span id="cb248-16"><a href="#cb248-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-17"><a href="#cb248-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjmisc)</span>
<span id="cb248-18"><a href="#cb248-18" aria-hidden="true" tabindex="-1"></a>nb_transpose <span class="ot">&lt;-</span> nb <span class="sc">%&gt;%</span></span>
<span id="cb248-19"><a href="#cb248-19" aria-hidden="true" tabindex="-1"></a>  sjmisc<span class="sc">::</span><span class="fu">rotate_df</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-58-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-58-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Etablissement d'un tableau croisé comptant les occurrences</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>nb <span class="ot">&lt;-</span> donnees_datatable[, .N, by <span class="ot">=</span> <span class="fu">list</span>(cspf, sexef)]</span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a><span class="co"># On transpose le tableau</span></span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a>data.table<span class="sc">::</span><span class="fu">dcast</span>(nb, cspf <span class="sc">~</span> sexef, <span class="at">value.var =</span> <span class="st">"N"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-58-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-58-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="passer-dune-base-en-largeur-wide-à-une-base-en-longueur-long" class="level2" data-number="9.11">
<h2 data-number="9.11" class="anchored" data-anchor-id="passer-dune-base-en-largeur-wide-à-une-base-en-longueur-long"><span class="header-section-number">9.11</span> Passer d’une base en largeur (wide) à une base en longueur (long)</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-59-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-59-1" role="tab" aria-controls="tabset-59-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-59-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-59-2" role="tab" aria-controls="tabset-59-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-59-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-59-3" role="tab" aria-controls="tabset-59-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-59-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-59-4" role="tab" aria-controls="tabset-59-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-59-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-59-5" role="tab" aria-controls="tabset-59-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-59-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-59-1-tab">
<div class="sourceCode" id="cb250"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> notes = note_contenu note_formateur note_moyens note_accompagnement note_materiel;</span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas;<span class="kw">by</span> identifiant<span class="kw">;run</span>;</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> means<span class="kw"> data</span> = donnees_sas <span class="fu">mean</span> noprint;<span class="fu">var</span> <span class="kw">&amp;notes.</span>;<span class="kw">output</span> out = Temp;<span class="kw">by</span> identifiant<span class="kw">;run</span>;</span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Wide;</span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> Temp (<span class="kw">where</span> = (_STAT_ = <span class="st">"MEAN"</span>) <span class="kw">drop</span> = _TYPE_ _FREQ_);</span>
<span id="cb250-6"><a href="#cb250-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">keep</span> identifiant <span class="kw">&amp;notes.</span>;</span>
<span id="cb250-7"><a href="#cb250-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">drop</span> _STAT_;</span>
<span id="cb250-8"><a href="#cb250-8" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb250-9"><a href="#cb250-9" aria-hidden="true" tabindex="-1"></a><span class="co">/* On passe de Wide à Long */</span></span>
<span id="cb250-10"><a href="#cb250-10" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> transpose<span class="kw"> data</span> = Wide out = Long;<span class="kw">by</span> Identifiant;<span class="fu">var</span> <span class="kw">&amp;notes.;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-59-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-59-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On souhaite mettre les notes en ligne et non en colonne</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>wide_rbase <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(donnees_rbase[, varNotes], donnees_rbase[, <span class="st">"identifiant"</span>, <span class="at">drop =</span> <span class="cn">FALSE</span>], mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>long_rbase <span class="ot">&lt;-</span> <span class="fu">reshape</span>(<span class="at">data =</span> wide_rbase,</span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">varying =</span> varNotes, </span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">v.names =</span> <span class="st">"notes"</span>,</span>
<span id="cb251-7"><a href="#cb251-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">timevar =</span> <span class="st">"type_note"</span>, </span>
<span id="cb251-8"><a href="#cb251-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">times =</span> varNotes,</span>
<span id="cb251-9"><a href="#cb251-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">new.row.names =</span> <span class="cn">NULL</span>,</span>
<span id="cb251-10"><a href="#cb251-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">direction =</span> <span class="st">"long"</span>)</span>
<span id="cb251-11"><a href="#cb251-11" aria-hidden="true" tabindex="-1"></a>long_rbase <span class="ot">&lt;-</span> long_rbase[<span class="fu">order</span>(long_rbase<span class="sc">$</span>identifiant), ]</span>
<span id="cb251-12"><a href="#cb251-12" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(long_rbase) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-59-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-59-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On souhaite mettre les notes en ligne et non en colonne</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a>wide_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(varNotes), <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb252-6"><a href="#cb252-6" aria-hidden="true" tabindex="-1"></a><span class="co"># On l'exprime en format long</span></span>
<span id="cb252-7"><a href="#cb252-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Mise en garde : ne pas écrire value_to !</span></span>
<span id="cb252-8"><a href="#cb252-8" aria-hidden="true" tabindex="-1"></a>long_tidyverse <span class="ot">&lt;-</span> wide_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb252-9"><a href="#cb252-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">!</span>identifiant,</span>
<span id="cb252-10"><a href="#cb252-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"type_note"</span>,</span>
<span id="cb252-11"><a href="#cb252-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"note"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb252-12"><a href="#cb252-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(type_note, identifiant)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-59-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-59-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On souhaite mettre les notes en ligne et non en colonne</span></span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a>wide_datatable <span class="ot">&lt;-</span> donnees_datatable[, <span class="fu">lapply</span>(.SD, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), keyby <span class="ot">=</span> identifiant, .SDcols <span class="ot">=</span> varNotes]</span>
<span id="cb253-4"><a href="#cb253-4" aria-hidden="true" tabindex="-1"></a>long_datatable <span class="ot">&lt;-</span> <span class="fu">melt</span>(wide_datatable,</span>
<span id="cb253-5"><a href="#cb253-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">"identifiant"</span>),</span>
<span id="cb253-6"><a href="#cb253-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">measure.vars =</span> varNotes,</span>
<span id="cb253-7"><a href="#cb253-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">variable.name =</span> <span class="st">"type_note"</span>,</span>
<span id="cb253-8"><a href="#cb253-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">value.name =</span> <span class="st">"note"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-59-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-59-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="passer-base-en-longueur-long-à-une-base-en-largeur-wide" class="level2" data-number="9.12">
<h2 data-number="9.12" class="anchored" data-anchor-id="passer-base-en-longueur-long-à-une-base-en-largeur-wide"><span class="header-section-number">9.12</span> Passer base en longueur (long) à une base en largeur (wide)</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-60-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-60-1" role="tab" aria-controls="tabset-60-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-60-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-60-2" role="tab" aria-controls="tabset-60-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-60-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-60-3" role="tab" aria-controls="tabset-60-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-60-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-60-4" role="tab" aria-controls="tabset-60-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-60-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-60-5" role="tab" aria-controls="tabset-60-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-60-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-60-1-tab">
<div class="sourceCode" id="cb254"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* On souhaite mettre les notes en ligne et non en colonne */</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="co">/* On commence par calculer les notes moyennes par identifiant */</span></span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> notes = note_contenu note_formateur note_moyens note_accompagnement note_materiel;</span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas;<span class="kw">by</span> identifiant<span class="kw">;run</span>;</span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> means<span class="kw"> data</span> = donnees_sas <span class="fu">mean</span> noprint;<span class="fu">var</span> <span class="kw">&amp;notes.</span>;<span class="kw">output</span> out = Temp;<span class="kw">by</span> identifiant<span class="kw">;run</span>;</span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Wide;</span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> Temp (<span class="kw">where</span> = (_STAT_ = <span class="st">"MEAN"</span>) <span class="kw">drop</span> = _TYPE_ _FREQ_);</span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">keep</span> identifiant <span class="kw">&amp;notes.</span>;</span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">drop</span> _STAT_;</span>
<span id="cb254-10"><a href="#cb254-10" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb254-11"><a href="#cb254-11" aria-hidden="true" tabindex="-1"></a><span class="co">/* On passe de Wide à Long */</span></span>
<span id="cb254-12"><a href="#cb254-12" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> transpose<span class="kw"> data</span> = Wide out = Long;<span class="kw">by</span> Identifiant;<span class="fu">var</span> <span class="kw">&amp;notes.;run</span>;</span>
<span id="cb254-13"><a href="#cb254-13" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Long;<span class="kw">set</span> Long (<span class="kw">rename</span> = (_NAME_ = Type_Note COL1 = <span class="fu">Note</span>))<span class="kw">;run</span>;</span>
<span id="cb254-14"><a href="#cb254-14" aria-hidden="true" tabindex="-1"></a><span class="co">/* On passe de Long à Wide */</span></span>
<span id="cb254-15"><a href="#cb254-15" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> transpose<span class="kw"> data</span> = Long out = Wide;</span>
<span id="cb254-16"><a href="#cb254-16" aria-hidden="true" tabindex="-1"></a>  <span class="kw">by</span> Identifiant;</span>
<span id="cb254-17"><a href="#cb254-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> <span class="fu">Note</span>;</span>
<span id="cb254-18"><a href="#cb254-18" aria-hidden="true" tabindex="-1"></a>  id Type_Note;</span>
<span id="cb254-19"><a href="#cb254-19" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-60-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-60-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Passer de long à wide : on souhaite revenir à la situation initiale</span></span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>wide_rbase <span class="ot">&lt;-</span> <span class="fu">reshape</span>(long_rbase, </span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">timevar =</span> <span class="st">"type_note"</span>,</span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">idvar =</span> <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"id"</span>),</span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">direction =</span> <span class="st">"wide"</span>)</span>
<span id="cb255-6"><a href="#cb255-6" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stats.oarc.ucla.edu/r/faq/how-can-i-reshape-my-data-in-r/</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-60-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-60-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Passer de long à wide : on souhaite revenir à la situation initiale</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Mise en garde : ne pas écrire value_from !</span></span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a>wide_tidyverse <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(long_tidyverse, </span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">names_from =</span> type_note,</span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">values_from =</span> note)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-60-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-60-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>wide_datatable <span class="ot">&lt;-</span> <span class="fu">dcast</span>(long_datatable, identifiant <span class="sc">~</span> type_note, <span class="at">value.var =</span> <span class="st">"note"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-60-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-60-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
</section>
<section id="gestion-par-rangées-de-lignes" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Gestion par rangées de lignes</h1>
<section id="sélectionner-les-lignes-avec-au-moins-une-note-10" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="sélectionner-les-lignes-avec-au-moins-une-note-10"><span class="header-section-number">10.1</span> Sélectionner les lignes avec au moins une note &lt; 10</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-61-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-61-1" role="tab" aria-controls="tabset-61-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-61-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-61-2" role="tab" aria-controls="tabset-61-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-61-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-61-3" role="tab" aria-controls="tabset-61-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-61-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-61-4" role="tab" aria-controls="tabset-61-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-61-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-61-5" role="tab" aria-controls="tabset-61-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-61-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-61-1-tab">
<div class="sourceCode" id="cb258"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> notes = Note_Contenu Note_Formateur Note_Moyens Note_Accompagnement Note_Materiel;</span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Note_Inferieure_10;</span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%macro</span> Inf10;</span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%global</span> temp;</span>
<span id="cb258-6"><a href="#cb258-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%let</span> temp = ;</span>
<span id="cb258-7"><a href="#cb258-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%do</span> i = <span class="dv">1</span> <span class="kw">%to</span> <span class="kw">%sysfunc</span>(countw(<span class="kw">&amp;notes.</span>));</span>
<span id="cb258-8"><a href="#cb258-8" aria-hidden="true" tabindex="-1"></a>      <span class="kw">%let</span> j = <span class="kw">%scan</span>(<span class="kw">&amp;notes.</span>, <span class="kw">&amp;i.</span>);</span>
<span id="cb258-9"><a href="#cb258-9" aria-hidden="true" tabindex="-1"></a>      <span class="kw">&amp;j.</span>_inf_10 = (<span class="kw">&amp;j.</span> &lt; <span class="dv">10</span> <span class="kw">and</span> <span class="kw">not</span> missing(<span class="kw">&amp;j.</span>));</span>
<span id="cb258-10"><a href="#cb258-10" aria-hidden="true" tabindex="-1"></a>      <span class="kw">%let</span> temp = <span class="kw">&amp;temp.</span> <span class="kw">&amp;j.</span>_inf_10;</span>
<span id="cb258-11"><a href="#cb258-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%end</span>;</span>
<span id="cb258-12"><a href="#cb258-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%mend</span> Inf10;</span>
<span id="cb258-13"><a href="#cb258-13" aria-hidden="true" tabindex="-1"></a>  %Inf10;</span>
<span id="cb258-14"><a href="#cb258-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> <span class="fu">sum</span>(of <span class="kw">&amp;temp.</span>) &gt;= <span class="dv">1</span>;</span>
<span id="cb258-15"><a href="#cb258-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">drop</span> <span class="kw">&amp;temp.</span>;</span>
<span id="cb258-16"><a href="#cb258-16" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-61-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-61-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase[<span class="fu">apply</span>(donnees_rbase[, varNotes], <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">any</span>(x <span class="sc">&lt;</span> <span class="dv">10</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-61-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-61-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">if_any</span>(varNotes, <span class="sc">~</span> .x <span class="sc">&lt;</span> <span class="dv">10</span>))</span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_at</span>(varNotes, <span class="fu">any_vars</span>(. <span class="sc">&lt;</span> <span class="dv">10</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-61-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-61-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a>note_moins_10 <span class="ot">&lt;-</span> donnees_datatable[donnees_datatable[, .I[<span class="fu">rowSums</span>(.SD <span class="sc">&lt;</span> <span class="dv">10</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&gt;=</span> <span class="dv">1</span>], .SDcols <span class="ot">=</span> varNotes]]</span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Le Reduce(`|`, ...) permet d'appliquer la condition | (ou) à tous les élements de la ligne, qui sont une vérification d'un nb &lt; 10</span></span>
<span id="cb261-5"><a href="#cb261-5" aria-hidden="true" tabindex="-1"></a>note_moins_10 <span class="ot">&lt;-</span> donnees_datatable[donnees_datatable[, <span class="fu">Reduce</span>(<span class="st">`</span><span class="at">|</span><span class="st">`</span>, <span class="fu">lapply</span>(.SD, <span class="st">`</span><span class="at">&lt;</span><span class="st">`</span>, <span class="dv">10</span>)), .SDcols <span class="ot">=</span> varNotes]]</span>
<span id="cb261-6"><a href="#cb261-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-7"><a href="#cb261-7" aria-hidden="true" tabindex="-1"></a><span class="co"># https://arelbundock.com/posts/datatable_rowwise/</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-61-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-61-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="sélectionner-les-lignes-avec-toutes-les-notes-supérieurs-à-10" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="sélectionner-les-lignes-avec-toutes-les-notes-supérieurs-à-10"><span class="header-section-number">10.2</span> Sélectionner les lignes avec toutes les notes supérieurs à 10</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-62-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-62-1" role="tab" aria-controls="tabset-62-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-62-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-62-2" role="tab" aria-controls="tabset-62-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-62-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-62-3" role="tab" aria-controls="tabset-62-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-62-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-62-4" role="tab" aria-controls="tabset-62-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-62-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-62-5" role="tab" aria-controls="tabset-62-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-62-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-62-1-tab">
<div class="sourceCode" id="cb262"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> notes = Note_Contenu Note_Formateur Note_Moyens Note_Accompagnement Note_Materiel;</span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Note_Sup_10;</span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%macro</span> Inf10;</span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%global</span> temp;</span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%let</span> temp = ;</span>
<span id="cb262-7"><a href="#cb262-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%do</span> i = <span class="dv">1</span> <span class="kw">%to</span> <span class="kw">%sysfunc</span>(countw(<span class="kw">&amp;notes.</span>));</span>
<span id="cb262-8"><a href="#cb262-8" aria-hidden="true" tabindex="-1"></a>      <span class="kw">%let</span> j = <span class="kw">%scan</span>(<span class="kw">&amp;notes.</span>, <span class="kw">&amp;i.</span>);</span>
<span id="cb262-9"><a href="#cb262-9" aria-hidden="true" tabindex="-1"></a>      <span class="kw">&amp;j.</span>_sup_10 = (<span class="kw">&amp;j.</span> &gt;= <span class="dv">10</span>);</span>
<span id="cb262-10"><a href="#cb262-10" aria-hidden="true" tabindex="-1"></a>      <span class="kw">%let</span> temp = <span class="kw">&amp;temp.</span> <span class="kw">&amp;j.</span>_sup_10;</span>
<span id="cb262-11"><a href="#cb262-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%end</span>;</span>
<span id="cb262-12"><a href="#cb262-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%mend</span> Inf10;</span>
<span id="cb262-13"><a href="#cb262-13" aria-hidden="true" tabindex="-1"></a>  %Inf10;</span>
<span id="cb262-14"><a href="#cb262-14" aria-hidden="true" tabindex="-1"></a>  a = <span class="fu">sum</span>(of <span class="kw">&amp;temp.</span>);</span>
<span id="cb262-15"><a href="#cb262-15" aria-hidden="true" tabindex="-1"></a>  b = <span class="kw">%sysfunc</span>(countw(<span class="kw">&amp;notes.</span>));</span>
<span id="cb262-16"><a href="#cb262-16" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> <span class="fu">sum</span>(of <span class="kw">&amp;temp.</span>) = <span class="kw">%sysfunc</span>(countw(<span class="kw">&amp;notes.</span>));</span>
<span id="cb262-17"><a href="#cb262-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">drop</span> <span class="kw">&amp;temp.</span>;</span>
<span id="cb262-18"><a href="#cb262-18" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-62-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-62-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : REVOIR LE PB DES VALEURS MANQUANTES !!!!</span></span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a>donnees_rbase[<span class="fu">apply</span>(donnees_rbase[, varNotes], <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">all</span>(x <span class="sc">&gt;=</span> <span class="dv">10</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-62-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-62-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">if_all</span>(varNotes, <span class="sc">~</span> . <span class="sc">&gt;=</span> <span class="dv">10</span>))</span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_at</span>(varNotes, <span class="fu">all_vars</span>(. <span class="sc">&gt;=</span> <span class="dv">10</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-62-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-62-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a>note_sup_10 <span class="ot">&lt;-</span> donnees_datatable[</span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a>  donnees_datatable[, .I[<span class="fu">rowSums</span>(.SD <span class="sc">&gt;=</span> <span class="dv">10</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">==</span> <span class="fu">length</span>(varNotes)], .SDcols <span class="ot">=</span> varNotes]]</span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb265-5"><a href="#cb265-5" aria-hidden="true" tabindex="-1"></a>note_sup_10 <span class="ot">&lt;-</span> donnees_datatable[donnees_datatable[, <span class="fu">Reduce</span>(<span class="st">`</span><span class="at">&amp;</span><span class="st">`</span>, <span class="fu">lapply</span>(.SD, <span class="st">`</span><span class="at">&gt;=</span><span class="st">`</span>, <span class="dv">10</span>)), .SDcols <span class="ot">=</span> varNotes]]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-62-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-62-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="moyenne-par-ligne" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="moyenne-par-ligne"><span class="header-section-number">10.3</span> Moyenne par ligne</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-63-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-63-1" role="tab" aria-controls="tabset-63-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-63-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-63-2" role="tab" aria-controls="tabset-63-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-63-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-63-3" role="tab" aria-controls="tabset-63-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-63-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-63-4" role="tab" aria-controls="tabset-63-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-63-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-63-5" role="tab" aria-controls="tabset-63-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-63-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-63-1-tab">
<div class="sourceCode" id="cb266"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Pour chaque observation, 5 notes sont renseignées. On calcule la moyenne de ces 5 notes pour chaque ligne */</span></span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> notes = Note_Contenu Note_Formateur Note_Moyens Note_Accompagnement Note_Materiel;</span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* 1ère solution */</span></span>
<span id="cb266-6"><a href="#cb266-6" aria-hidden="true" tabindex="-1"></a>  Note_moyenne    = <span class="fu">mean</span>(of <span class="kw">&amp;notes.</span>);</span>
<span id="cb266-7"><a href="#cb266-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* 2e solution : l'équivalent des list-comprehension de Python en SAS */</span></span>
<span id="cb266-8"><a href="#cb266-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%macro</span> List_comprehension;</span>
<span id="cb266-9"><a href="#cb266-9" aria-hidden="true" tabindex="-1"></a>    Note_moyenne2 = <span class="fu">mean</span>(of <span class="kw">%do</span> i = <span class="dv">1</span> <span class="kw">%to</span> <span class="kw">%sysfunc</span>(countw(<span class="kw">&amp;notes.</span>));</span>
<span id="cb266-10"><a href="#cb266-10" aria-hidden="true" tabindex="-1"></a>                          <span class="kw">%let</span> j = <span class="kw">%scan</span>(<span class="kw">&amp;notes.</span>, <span class="kw">&amp;i.</span>);</span>
<span id="cb266-11"><a href="#cb266-11" aria-hidden="true" tabindex="-1"></a>                          <span class="kw">&amp;j.</span></span>
<span id="cb266-12"><a href="#cb266-12" aria-hidden="true" tabindex="-1"></a>                         <span class="kw">%end</span>;);;</span>
<span id="cb266-13"><a href="#cb266-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%mend</span> List_comprehension;</span>
<span id="cb266-14"><a href="#cb266-14" aria-hidden="true" tabindex="-1"></a>  %List_comprehension;</span>
<span id="cb266-15"><a href="#cb266-15" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb266-16"><a href="#cb266-16" aria-hidden="true" tabindex="-1"></a><span class="co">/* Note moyenne (moyenne des moyennes), non pondérée et pondérée */</span></span>
<span id="cb266-17"><a href="#cb266-17" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> means<span class="kw"> data</span> = donnees_sas <span class="fu">mean</span>;<span class="fu">var</span> Note_moyenne<span class="kw">;run</span>;</span>
<span id="cb266-18"><a href="#cb266-18" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> means<span class="kw"> data</span> = donnees_sas <span class="fu">mean</span>;<span class="fu">var</span> Note_moyenne;weight poids_sondage<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-63-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-63-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour chaque observation, 5 notes sont renseignées. On calcule la moyenne de ces 5 notes pour chaque ligne</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">c</span>(<span class="st">"Note_Contenu"</span>, <span class="st">"Note_Formateur"</span>, <span class="st">"Note_Moyens"</span>, <span class="st">"Note_Accompagnement"</span>, <span class="st">"Note_Materiel"</span>))</span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a><span class="co"># apply permet d'appliquer une fonctions aux lignes (1) ou colonnes (2) d'un data.frame</span></span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>note_moyenne <span class="ot">&lt;-</span> <span class="fu">apply</span>(donnees_rbase[, varNotes], <span class="dv">1</span>, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre possibilité</span></span>
<span id="cb267-6"><a href="#cb267-6" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>note_moyenne <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(donnees_rbase[, varNotes], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb267-7"><a href="#cb267-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Note moyenne (moyenne des moyennes), non pondérée et pondérée</span></span>
<span id="cb267-8"><a href="#cb267-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(donnees_rbase<span class="sc">$</span>note_moyenne, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb267-9"><a href="#cb267-9" aria-hidden="true" tabindex="-1"></a><span class="fu">weighted.mean</span>(donnees_rbase<span class="sc">$</span>note_moyenne, donnees_rbase<span class="sc">$</span>poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-63-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-63-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour chaque observation, 5 notes sont renseignées. On calcule la moyenne de ces 5 notes pour chaque ligne</span></span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">c</span>(<span class="st">"Note_Contenu"</span>, <span class="st">"Note_Formateur"</span>, <span class="st">"Note_Moyens"</span>, <span class="st">"Note_Accompagnement"</span>, <span class="st">"Note_Materiel"</span>))</span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Codes à privilégier</span></span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">note_moyenne =</span> <span class="fu">rowMeans</span>(<span class="fu">pick</span>(<span class="fu">all_of</span>(varNotes)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb268-6"><a href="#cb268-6" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb268-7"><a href="#cb268-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">note_moyenne =</span> <span class="fu">rowMeans</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(varNotes)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb268-8"><a href="#cb268-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative très lente !</span></span>
<span id="cb268-9"><a href="#cb268-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Noter l'utilisation de c_across pour traiter automatiquement plusieurs variables</span></span>
<span id="cb268-10"><a href="#cb268-10" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb268-11"><a href="#cb268-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb268-12"><a href="#cb268-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">note_moyenne =</span> <span class="fu">mean</span>(<span class="fu">c_across</span>(<span class="fu">all_of</span>(varNotes)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb268-13"><a href="#cb268-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb268-14"><a href="#cb268-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-15"><a href="#cb268-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-16"><a href="#cb268-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Note moyenne (moyenne des moyennes) non pondérée</span></span>
<span id="cb268-17"><a href="#cb268-17" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">pull</span>(note_moyenne) <span class="sc">%&gt;%</span> <span class="fu">mean</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb268-18"><a href="#cb268-18" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Moyenne =</span> <span class="fu">mean</span>(note_moyenne, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb268-19"><a href="#cb268-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Note moyenne (moyenne des moyennes) pondérée</span></span>
<span id="cb268-20"><a href="#cb268-20" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Moyenne_ponderee =</span> <span class="fu">weighted.mean</span>(note_moyenne, poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-63-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-63-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour chaque observation, 5 notes sont renseignées. On calcule la moyenne de ces 5 notes pour chaque ligne</span></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>,<span class="st">"note_formateur"</span>,<span class="st">"note_moyens"</span>,<span class="st">"note_accompagnement"</span>,<span class="st">"note_materiel"</span>)</span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a><span class="co"># On souhaite moyenner les notes par formation</span></span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, note_moyenne <span class="sc">:</span><span class="er">=</span> <span class="fu">rowMeans</span>(.SD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), .SDcols <span class="ot">=</span> varNotes]</span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Manière alternative, qui ne semble pas fonctionner</span></span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true" tabindex="-1"></a><span class="co">#donnees_datatable[, note_moyenne := Reduce(function(...) sum(..., na.rm = TRUE), .SD),</span></span>
<span id="cb269-7"><a href="#cb269-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                  .SDcols = varNotes,</span></span>
<span id="cb269-8"><a href="#cb269-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                  by = 1:nrow(donnees_datatable)]</span></span>
<span id="cb269-9"><a href="#cb269-9" aria-hidden="true" tabindex="-1"></a><span class="co">#donnees_datatable[, do.call(function(x, y) sum(x, y, na.rm = TRUE), .SD), .SDcols = varNotes, by = 1:nrow(donnees_datatable)]</span></span>
<span id="cb269-10"><a href="#cb269-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-11"><a href="#cb269-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Note moyenne (moyenne des moyennes), non pondérée et pondérée</span></span>
<span id="cb269-12"><a href="#cb269-12" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">mean</span>(note_moyenne, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)]</span>
<span id="cb269-13"><a href="#cb269-13" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">weighted.mean</span>(note_moyenne, poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-63-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-63-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="la-note-donnée-est-elle-supérieure-à-la-moyenne" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="la-note-donnée-est-elle-supérieure-à-la-moyenne"><span class="header-section-number">10.4</span> La note donnée est-elle supérieure à la moyenne ?</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-64-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-64-1" role="tab" aria-controls="tabset-64-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-64-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-64-2" role="tab" aria-controls="tabset-64-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-64-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-64-3" role="tab" aria-controls="tabset-64-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-64-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-64-4" role="tab" aria-controls="tabset-64-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-64-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-64-5" role="tab" aria-controls="tabset-64-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-64-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-64-1-tab">
<div class="sourceCode" id="cb270"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* On crée une macro-variable SAS à partir de la valeur de la moyenne */</span></span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql noprint;<span class="kw">select</span> <span class="fu">mean</span>(Note_moyenne) <span class="kw">into</span> :moyenne <span class="kw">from</span> donnees_sas;<span class="kw">quit</span>;</span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a>  Note_Superieure_Moyenne = (Note_moyenne &gt; <span class="kw">&amp;moyenne.</span>);</span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> freq<span class="kw"> data</span> = donnees_sas;tables Note_Superieure_Moyenne<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-64-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-64-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a>moyenne <span class="ot">&lt;-</span> <span class="fu">mean</span>(donnees_rbase<span class="sc">$</span>note_moyenne, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>note_superieure_moyenne <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(donnees_rbase<span class="sc">$</span>note_moyenne <span class="sc">&gt;</span> moyenne, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(donnees_rbase<span class="sc">$</span>note_superieure_moyenne, <span class="at">useNA =</span> <span class="st">"always"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-64-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-64-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>moyenne <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">pull</span>(note_moyenne) <span class="sc">%&gt;%</span> <span class="fu">mean</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">note_superieure_moyenne =</span> <span class="fu">ifelse</span>(note_moyenne <span class="sc">&gt;</span> moyenne, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">pull</span>(note_superieure_moyenne) <span class="sc">%&gt;%</span> <span class="fu">table</span>(<span class="at">useNA =</span> <span class="st">"always"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-64-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-64-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>moyenne <span class="ot">&lt;-</span> donnees_datatable[, <span class="fu">mean</span>(note_moyenne, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)]</span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, note_superieure_moyenne <span class="sc">:</span><span class="er">=</span> <span class="fu">fcase</span>(note_moyenne <span class="sc">&gt;=</span> moyenne, <span class="dv">1</span>,</span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a>                                                     note_moyenne <span class="sc">&lt;</span>  moyenne, <span class="dv">0</span>)]</span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(donnees_datatable<span class="sc">$</span>note_superieure_moyenne, <span class="at">useNA =</span> <span class="st">"always"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-64-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-64-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="moyenne-par-ligne-1" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="moyenne-par-ligne-1"><span class="header-section-number">10.5</span> Moyenne par ligne</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-65-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-65-1" role="tab" aria-controls="tabset-65-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-65-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-65-2" role="tab" aria-controls="tabset-65-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-65-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-65-3" role="tab" aria-controls="tabset-65-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-65-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-65-4" role="tab" aria-controls="tabset-65-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-65-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-65-5" role="tab" aria-controls="tabset-65-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-65-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-65-1-tab">
<div class="sourceCode" id="cb274"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* On souhaite affecter les pondérations suivantes aux notes :</span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a><span class="co">Note_Contenu : 30%, Note_Formateur : 20%, Note_Moyens : 25%, Note_Accompagnement : 15%, Note_Materiel : 10% */</span></span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a><span class="co">/* Voici une solution possible. Une alternative intéressante serait de passer par IML (non traité ici) */</span></span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> ponderation = <span class="dv">0.3</span> <span class="dv">0.2</span> <span class="dv">0.25</span> <span class="dv">0.15</span> <span class="dv">0.10</span>;</span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> notes = Note_Contenu Note_Formateur Note_Moyens Note_Accompagnement Note_Materiel;</span>
<span id="cb274-6"><a href="#cb274-6" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb274-7"><a href="#cb274-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb274-8"><a href="#cb274-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%macro</span> Somme_pond;</span>
<span id="cb274-9"><a href="#cb274-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%global</span> temp;</span>
<span id="cb274-10"><a href="#cb274-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%let</span> temp = ;</span>
<span id="cb274-11"><a href="#cb274-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%do</span> i = <span class="dv">1</span> <span class="kw">%to</span> <span class="kw">%sysfunc</span>(countw(<span class="kw">&amp;notes.</span>));</span>
<span id="cb274-12"><a href="#cb274-12" aria-hidden="true" tabindex="-1"></a>      <span class="kw">%let</span> k = <span class="kw">%scan</span>(<span class="kw">&amp;notes.</span>, <span class="kw">&amp;i.</span>);</span>
<span id="cb274-13"><a href="#cb274-13" aria-hidden="true" tabindex="-1"></a>      <span class="kw">%let</span> l = <span class="kw">%scan</span>(<span class="kw">&amp;ponderation.</span>, <span class="kw">&amp;i.</span>, <span class="kw">%str</span>( ));</span>
<span id="cb274-14"><a href="#cb274-14" aria-hidden="true" tabindex="-1"></a>      <span class="kw">&amp;k.</span>_pond = <span class="kw">&amp;k.</span> * <span class="kw">&amp;l.</span>;</span>
<span id="cb274-15"><a href="#cb274-15" aria-hidden="true" tabindex="-1"></a>      <span class="kw">%let</span> temp = <span class="kw">&amp;temp.</span> <span class="kw">&amp;k.</span>_pond;</span>
<span id="cb274-16"><a href="#cb274-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%end</span>;</span>
<span id="cb274-17"><a href="#cb274-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%mend</span> Somme_pond;</span>
<span id="cb274-18"><a href="#cb274-18" aria-hidden="true" tabindex="-1"></a>  %Somme_pond;</span>
<span id="cb274-19"><a href="#cb274-19" aria-hidden="true" tabindex="-1"></a>  Note_moyenne_pond = <span class="fu">sum</span>(of <span class="kw">&amp;temp.</span>);</span>
<span id="cb274-20"><a href="#cb274-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">drop</span> <span class="kw">&amp;temp.</span>;</span>
<span id="cb274-21"><a href="#cb274-21" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb274-22"><a href="#cb274-22" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> means<span class="kw"> data</span> = donnees_sas <span class="fu">mean</span>;<span class="fu">var</span> Note_moyenne_pond<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-65-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-65-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On calcule de nouveau cette moyenne, mais en pondérant</span></span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a><span class="co"># On souhaite affecter les pondérations suivantes aux notes :</span></span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a><span class="co"># note_contenu : 30%, note_formateur : 20%, note_moyens : 25%, note_accompagnement : 15%, note_materiel : 10%</span></span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true" tabindex="-1"></a>ponderation <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">note_contenu =</span> <span class="dv">30</span>, <span class="at">note_formateur =</span> <span class="dv">20</span>, <span class="at">note_moyens =</span> <span class="dv">25</span>, <span class="at">note_accompagnement =</span> <span class="dv">15</span>, <span class="at">note_materiel =</span> <span class="dv">10</span>) <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb275-6"><a href="#cb275-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(ponderation)</span>
<span id="cb275-7"><a href="#cb275-7" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>note_moyennepond <span class="ot">&lt;-</span> <span class="fu">apply</span>(donnees_rbase[, notes], <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">weighted.mean</span>(x, ponderation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb275-8"><a href="#cb275-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre manière, en exploitant le calcul matriciel</span></span>
<span id="cb275-9"><a href="#cb275-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Ne fonctionne pas, du fait des NA</span></span>
<span id="cb275-10"><a href="#cb275-10" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(donnees_rbase[, notes]) <span class="sc">%*%</span> <span class="fu">as.matrix</span>(ponderation)</span>
<span id="cb275-11"><a href="#cb275-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Produit élément par élément</span></span>
<span id="cb275-12"><a href="#cb275-12" aria-hidden="true" tabindex="-1"></a><span class="co"># On peut procéder par produit matriciel</span></span>
<span id="cb275-13"><a href="#cb275-13" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(donnees_rbase[, notes]) <span class="sc">*</span> <span class="fu">matrix</span>(<span class="fu">t</span>(<span class="fu">as.matrix</span>(ponderation)), <span class="fu">nrow</span>(donnees_rbase), <span class="dv">5</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-65-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-65-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On calcule de nouveau cette moyenne, mais en pondérant</span></span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a><span class="co"># On souhaite affecter les pondérations suivantes aux notes :</span></span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a><span class="co"># note_contenu : 30%, note_formateur : 20%, note_moyens : 25%, note_accompagnement : 15%, note_materiel : 10%</span></span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true" tabindex="-1"></a><span class="co"># La fonction RowMeans ne fonctionne plus, cette fois !</span></span>
<span id="cb276-5"><a href="#cb276-5" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb276-6"><a href="#cb276-6" aria-hidden="true" tabindex="-1"></a>ponderation <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">note_contenu =</span> <span class="dv">30</span>, <span class="at">note_formateur =</span> <span class="dv">20</span>, <span class="at">note_moyens =</span> <span class="dv">25</span>, <span class="at">note_accompagnement =</span> <span class="dv">15</span>, <span class="at">note_materiel =</span> <span class="dv">10</span>) <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb276-7"><a href="#cb276-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(ponderation)</span>
<span id="cb276-8"><a href="#cb276-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Noter l'utilisation de c_across pour traiter automatiquement plusieurs variables</span></span>
<span id="cb276-9"><a href="#cb276-9" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb276-10"><a href="#cb276-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb276-11"><a href="#cb276-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">note_moyenne =</span> <span class="fu">weighted.mean</span>(<span class="fu">c_across</span>(varNotes), ponderation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb276-12"><a href="#cb276-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-65-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-65-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="do">## On souhaite affecter les pondérations suivantes aux notes :</span></span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a><span class="do">## note_contenu : 30%, note_formateur : 20%, note_moyens : 25%, note_accompagnement : 15%, note_materiel : 10%</span></span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb277-4"><a href="#cb277-4" aria-hidden="true" tabindex="-1"></a>ponderation <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">note_contenu =</span> <span class="dv">30</span>, <span class="at">note_formateur =</span> <span class="dv">20</span>, <span class="at">note_moyens =</span> <span class="dv">25</span>, <span class="at">note_accompagnement =</span> <span class="dv">15</span>, <span class="at">note_materiel =</span> <span class="dv">10</span>) <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb277-5"><a href="#cb277-5" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, note_moyenne_pond <span class="sc">:</span><span class="er">=</span> <span class="fu">rowSums</span>(<span class="fu">mapply</span>(<span class="at">FUN =</span> <span class="st">`</span><span class="at">*</span><span class="st">`</span>, .SD, ponderation), <span class="at">na.rm =</span> <span class="cn">TRUE</span>), .SDcols <span class="ot">=</span> <span class="fu">names</span>(ponderation)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-65-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-65-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
</section>
<section id="les-valeurs-manquantes" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Les valeurs manquantes</h1>
<section id="repérer-les-valeurs-manquantes-variables-âge-et-niveau" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="repérer-les-valeurs-manquantes-variables-âge-et-niveau"><span class="header-section-number">11.1</span> Repérer les valeurs manquantes (variables Âge et Niveau)</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-66-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-66-1" role="tab" aria-controls="tabset-66-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-66-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-66-2" role="tab" aria-controls="tabset-66-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-66-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-66-3" role="tab" aria-controls="tabset-66-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-66-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-66-4" role="tab" aria-controls="tabset-66-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-66-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-66-5" role="tab" aria-controls="tabset-66-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-66-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-66-1-tab">
<div class="sourceCode" id="cb278"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Missing;</span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* 1ère solution */</span></span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> missing(age) <span class="kw">or</span> missing(Niveau) <span class="kw">then</span> missing1 = <span class="dv">1</span>;<span class="kw">else</span> missing1 = <span class="dv">0</span>;</span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* 2e solution */</span></span>
<span id="cb278-6"><a href="#cb278-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> age = . <span class="kw">or</span> Niveau = <span class="st">''</span> <span class="kw">then</span> missing2 = <span class="dv">1</span>;<span class="kw">else</span> missing2 = <span class="dv">0</span>;</span>
<span id="cb278-7"><a href="#cb278-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">keep</span> Age Niveau Missing1 Missing2;</span>
<span id="cb278-8"><a href="#cb278-8" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-66-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-66-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>manquant <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(donnees_rbase<span class="sc">$</span>age) <span class="sc">|</span> <span class="fu">is.na</span>(donnees_rbase<span class="sc">$</span>niveau), <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Mauvaise méthode pour repérer les valeurs manquantes</span></span>
<span id="cb279-3"><a href="#cb279-3" aria-hidden="true" tabindex="-1"></a>ageManquant <span class="ot">&lt;-</span> donnees_rbase[donnees_rbase<span class="sc">$</span>age <span class="sc">==</span> <span class="cn">NA</span>,  ]</span>
<span id="cb279-4"><a href="#cb279-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Bonne méthode pour repérer les valeurs manquantes</span></span>
<span id="cb279-5"><a href="#cb279-5" aria-hidden="true" tabindex="-1"></a>ageManquant <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">is.na</span>(donnees_rbase<span class="sc">$</span>age), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-66-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-66-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">manquant =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(age) <span class="sc">|</span> <span class="fu">is.na</span>(niveau), <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Mauvaise méthode pour repérer les valeurs manquantes</span></span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a>ageManquant <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb280-6"><a href="#cb280-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(age <span class="sc">==</span> <span class="cn">NA</span>)</span>
<span id="cb280-7"><a href="#cb280-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Bonne méthode pour repérer les valeurs manquantes</span></span>
<span id="cb280-8"><a href="#cb280-8" aria-hidden="true" tabindex="-1"></a>ageManquant <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb280-9"><a href="#cb280-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(age))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-66-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-66-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, manquant <span class="sc">:</span><span class="er">=</span> <span class="fu">fifelse</span>(<span class="fu">is.na</span>(donnees_datatable<span class="sc">$</span>age) <span class="sc">|</span> <span class="fu">is.na</span>(donnees_datatable<span class="sc">$</span>niveau), <span class="dv">1</span>, <span class="dv">0</span>)]</span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a>ageManquant <span class="ot">&lt;-</span> donnees_datatable[age <span class="sc">==</span> <span class="cn">NA</span>] <span class="co"># Faux</span></span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a>ageManquant <span class="ot">&lt;-</span> donnees_datatable[<span class="fu">is.na</span>(age)] <span class="co"># Correct</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-66-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-66-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="nombre-et-proportion-de-valeurs-manquantes-par-variable" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="nombre-et-proportion-de-valeurs-manquantes-par-variable"><span class="header-section-number">11.2</span> Nombre et proportion de valeurs manquantes par variable</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-67-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-67-1" role="tab" aria-controls="tabset-67-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-67-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-67-2" role="tab" aria-controls="tabset-67-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-67-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-67-3" role="tab" aria-controls="tabset-67-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-67-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-67-4" role="tab" aria-controls="tabset-67-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-67-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-67-5" role="tab" aria-controls="tabset-67-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-67-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-67-1-tab">
<div class="sourceCode" id="cb282"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Pour les variables numériques ou date */</span></span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a><span class="co">/* Partie "Missing Values" en bas du tableau consacré à la variable */</span></span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> univariate<span class="kw"> data</span> = donnees_sas;<span class="fu">var</span> _numeric_<span class="kw">;run</span>;</span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true" tabindex="-1"></a><span class="co">/* Pour l'ensemble des variables */</span></span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true" tabindex="-1"></a><span class="co">/* Une solution possible */</span></span>
<span id="cb282-7"><a href="#cb282-7" aria-hidden="true" tabindex="-1"></a><span class="kw">%macro</span> Iteration(base = donnees_sas);</span>
<span id="cb282-8"><a href="#cb282-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%local</span> nbVar;</span>
<span id="cb282-9"><a href="#cb282-9" aria-hidden="true" tabindex="-1"></a><span class="kw">  proc</span> contents<span class="kw"> data</span> = donnees_sas out = ListeVar noprint<span class="kw">;run</span>;</span>
<span id="cb282-10"><a href="#cb282-10" aria-hidden="true" tabindex="-1"></a><span class="kw">  proc</span> sql noprint;<span class="kw">select</span> count(*) <span class="kw">into</span> :nbVar <span class="kw">from</span> ListeVar;<span class="kw">quit</span>;</span>
<span id="cb282-11"><a href="#cb282-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%do</span> i = <span class="dv">1</span> <span class="kw">%to</span> <span class="kw">&amp;nbVar.</span>;</span>
<span id="cb282-12"><a href="#cb282-12" aria-hidden="true" tabindex="-1"></a><span class="kw">    data</span> _null_;</span>
<span id="cb282-13"><a href="#cb282-13" aria-hidden="true" tabindex="-1"></a>      <span class="kw">set</span> ListeVar (firstobs = <span class="kw">&amp;i.</span> obs = <span class="kw">&amp;i.</span>);</span>
<span id="cb282-14"><a href="#cb282-14" aria-hidden="true" tabindex="-1"></a>      <span class="kw">call</span> symput(<span class="st">'var'</span>, name);</span>
<span id="cb282-15"><a href="#cb282-15" aria-hidden="true" tabindex="-1"></a><span class="kw">    run</span>;</span>
<span id="cb282-16"><a href="#cb282-16" aria-hidden="true" tabindex="-1"></a><span class="kw">    proc</span> sql;</span>
<span id="cb282-17"><a href="#cb282-17" aria-hidden="true" tabindex="-1"></a>      <span class="kw">select</span> <span class="fu">max</span>(<span class="st">"&amp;var."</span>) <span class="kw">as</span> Variable, <span class="fu">sum</span>(missing(<span class="kw">&amp;var.</span>)) <span class="kw">as</span> Manquants, <span class="fu">sum</span>(missing(<span class="kw">&amp;var.</span>)) / count(*) * <span class="dv">100</span> <span class="kw">as</span> Prop_Manquants</span>
<span id="cb282-18"><a href="#cb282-18" aria-hidden="true" tabindex="-1"></a>      <span class="kw">from</span> <span class="kw">&amp;base.</span>;</span>
<span id="cb282-19"><a href="#cb282-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">quit</span>;</span>
<span id="cb282-20"><a href="#cb282-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%end</span>;</span>
<span id="cb282-21"><a href="#cb282-21" aria-hidden="true" tabindex="-1"></a><span class="kw">  proc</span> datasets lib = work nolist;<span class="kw">delete</span> ListeVar<span class="kw">;run</span>;</span>
<span id="cb282-22"><a href="#cb282-22" aria-hidden="true" tabindex="-1"></a><span class="kw">%mend</span> Iteration;</span>
<span id="cb282-23"><a href="#cb282-23" aria-hidden="true" tabindex="-1"></a>%Iteration;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-67-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-67-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour les variables numériques ou date</span></span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(<span class="fu">is.na</span>(</span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a>  donnees_rbase[<span class="fu">sapply</span>(donnees_rbase, <span class="cf">function</span>(x) <span class="fu">is.numeric</span>(x) <span class="sc">|</span> lubridate<span class="sc">::</span><span class="fu">is.Date</span>(x))]</span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true" tabindex="-1"></a>  ), <span class="dv">2</span>, mean) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb283-5"><a href="#cb283-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Autres solutions</span></span>
<span id="cb283-6"><a href="#cb283-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(</span>
<span id="cb283-7"><a href="#cb283-7" aria-hidden="true" tabindex="-1"></a>  donnees_rbase[<span class="fu">sapply</span>(donnees_rbase, <span class="cf">function</span>(x) <span class="fu">is.numeric</span>(x) <span class="sc">|</span> lubridate<span class="sc">::</span><span class="fu">is.Date</span>(x))],</span>
<span id="cb283-8"><a href="#cb283-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">is.na</span>(x)) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb283-9"><a href="#cb283-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(</span>
<span id="cb283-10"><a href="#cb283-10" aria-hidden="true" tabindex="-1"></a>  donnees_rbase[<span class="fu">sapply</span>(donnees_rbase, <span class="cf">function</span>(x) <span class="fu">is.numeric</span>(x) <span class="sc">|</span> lubridate<span class="sc">::</span><span class="fu">is.Date</span>(x))],</span>
<span id="cb283-11"><a href="#cb283-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)) <span class="sc">/</span> <span class="fu">length</span>(x) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb283-12"><a href="#cb283-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-13"><a href="#cb283-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour l'ensemble des variables</span></span>
<span id="cb283-14"><a href="#cb283-14" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(<span class="fu">is.na</span>(donnees_rbase)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb283-15"><a href="#cb283-15" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(<span class="fu">is.na</span>(donnees_rbase), <span class="dv">2</span>, mean) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-67-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-67-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour les variables numériques ou date</span></span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(<span class="sc">~</span> <span class="fu">is.numeric</span>(.x) <span class="sc">|</span> lubridate<span class="sc">::</span><span class="fu">is.Date</span>(.x)),</span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">list</span>(<span class="sc">~</span><span class="fu">sum</span>(<span class="fu">is.na</span>(.x)), <span class="sc">~</span><span class="fu">mean</span>(<span class="fu">is.na</span>(.x)))))</span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb284-6"><a href="#cb284-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(<span class="sc">~</span> <span class="fu">is.numeric</span>(.x) <span class="sc">|</span> lubridate<span class="sc">::</span><span class="fu">is.Date</span>(.x)),</span>
<span id="cb284-7"><a href="#cb284-7" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">list</span>(<span class="sc">~</span><span class="fu">sum</span>(<span class="fu">is.na</span>(.x)), <span class="sc">~</span><span class="fu">sum</span>(<span class="fu">is.na</span>(.x)) <span class="sc">/</span> <span class="fu">length</span>(.x))))</span>
<span id="cb284-8"><a href="#cb284-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-9"><a href="#cb284-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour l'ensemble des variables</span></span>
<span id="cb284-10"><a href="#cb284-10" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb284-11"><a href="#cb284-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span><span class="fu">mean</span>(<span class="fu">is.na</span>(.x))))</span>
<span id="cb284-12"><a href="#cb284-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Autres solutions</span></span>
<span id="cb284-13"><a href="#cb284-13" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span> <span class="fu">mean</span>(<span class="fu">is.na</span>(.)) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb284-14"><a href="#cb284-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Obsolète</span></span>
<span id="cb284-15"><a href="#cb284-15" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">summarise_each</span>(<span class="fu">funs</span>(<span class="fu">mean</span>(<span class="fu">is.na</span>(.)) <span class="sc">*</span> <span class="dv">100</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-67-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-67-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour les variables numériques ou date</span></span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">lapply</span>(.SD, <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">is.na</span>(x)) <span class="sc">*</span> <span class="dv">100</span>), .SDcols <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">c</span>(lubridate<span class="sc">::</span><span class="fu">is.Date</span>(x) <span class="sc">|</span> <span class="fu">is.numeric</span>(x))]</span>
<span id="cb285-3"><a href="#cb285-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour l'ensemble des variables</span></span>
<span id="cb285-4"><a href="#cb285-4" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">lapply</span>(.SD, <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">is.na</span>(x)) <span class="sc">*</span> <span class="dv">100</span>)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-67-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-67-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="incidence-des-valeurs-manquantes" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="incidence-des-valeurs-manquantes"><span class="header-section-number">11.3</span> Incidence des valeurs manquantes</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-68-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-68-1" role="tab" aria-controls="tabset-68-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-68-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-68-2" role="tab" aria-controls="tabset-68-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-68-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-68-3" role="tab" aria-controls="tabset-68-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-68-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-68-4" role="tab" aria-controls="tabset-68-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-68-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-68-5" role="tab" aria-controls="tabset-68-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-68-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-68-1-tab">
<div class="sourceCode" id="cb286"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* En SAS, les valeurs manquantes sont des nombres négatifs faibles */</span></span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Valeur_Manquante;</span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Lorsque Age est manquant (missing), Jeune_Correct vaut 0 mais Jeune_Incorrect vaut 1 */</span></span>
<span id="cb286-5"><a href="#cb286-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* En effet, pour SAS, un Age manquant est une valeur inférieure à 0, donc bien inférieure à 25.</span></span>
<span id="cb286-6"><a href="#cb286-6" aria-hidden="true" tabindex="-1"></a><span class="co">     Donc la variable Jeune_Incorrect vaut bien 1 pour les âges inconnus */</span></span>
<span id="cb286-7"><a href="#cb286-7" aria-hidden="true" tabindex="-1"></a>  Jeune_Incorrect = (Age &lt;= <span class="dv">25</span>);</span>
<span id="cb286-8"><a href="#cb286-8" aria-hidden="true" tabindex="-1"></a>  Jeune_Correct   = (<span class="dv">0</span> &lt;= Age &lt;= <span class="dv">25</span>);</span>
<span id="cb286-9"><a href="#cb286-9" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb286-10"><a href="#cb286-10" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> print<span class="kw"> data</span> = Valeur_Manquante (<span class="kw">keep</span>  = Age Jeune_Correct Jeune_Incorrect</span>
<span id="cb286-11"><a href="#cb286-11" aria-hidden="true" tabindex="-1"></a>                                    <span class="kw">where</span> = (missing(Age)));</span>
<span id="cb286-12"><a href="#cb286-12" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb286-13"><a href="#cb286-13" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> freq<span class="kw"> data</span> = Valeur_Manquante;tables Jeune_Incorrect Jeune_Correct<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-68-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-68-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(donnees_rbase<span class="sc">$</span>note_formateur)</span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(donnees_rbase<span class="sc">$</span>note_formateur, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-68-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-68-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">pull</span>(note_formateur) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">pull</span>(note_formateur) <span class="sc">%&gt;%</span> <span class="fu">mean</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Attention, en tidyverse, les syntaxes suivantes ne fonctionnent pas !</span></span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a><span class="co"># NE PAS ECRIRE !</span></span>
<span id="cb288-5"><a href="#cb288-5" aria-hidden="true" tabindex="-1"></a><span class="co"># donnees_tidyverse %&gt;% mean(note_formateur)</span></span>
<span id="cb288-6"><a href="#cb288-6" aria-hidden="true" tabindex="-1"></a><span class="co"># donnees_tidyverse %&gt;% mean(note_formateur, na.rm = TRUE)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-68-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-68-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">mean</span>(note_formateur)]</span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">mean</span>(note_formateur, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-68-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-68-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="remplacer-toutes-les-valeurs-numériques-manquantes-par-0" class="level2" data-number="11.4">
<h2 data-number="11.4" class="anchored" data-anchor-id="remplacer-toutes-les-valeurs-numériques-manquantes-par-0"><span class="header-section-number">11.4</span> Remplacer toutes les valeurs numériques manquantes par 0</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-69-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-69-1" role="tab" aria-controls="tabset-69-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-69-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-69-2" role="tab" aria-controls="tabset-69-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-69-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-69-3" role="tab" aria-controls="tabset-69-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-69-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-69-4" role="tab" aria-controls="tabset-69-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-69-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-69-5" role="tab" aria-controls="tabset-69-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-69-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-69-1-tab">
<div class="sourceCode" id="cb290"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* On sélectionne toutes les variables numériques */</span></span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> contents<span class="kw"> data</span> = donnees_sas out = <span class="fu">Var</span> noprint<span class="kw">;run</span>;</span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql noprint;</span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> name <span class="kw">into</span> :nom_col separated <span class="kw">by</span> <span class="st">" "</span> <span class="kw">from</span> <span class="fu">Var</span> <span class="kw">where</span> <span class="kw">format</span> = <span class="st">""</span>;</span>
<span id="cb290-5"><a href="#cb290-5" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb290-6"><a href="#cb290-6" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas_sans_missing;</span>
<span id="cb290-7"><a href="#cb290-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb290-8"><a href="#cb290-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%macro</span> Missing;</span>
<span id="cb290-9"><a href="#cb290-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%local</span> i <span class="fu">var</span>;</span>
<span id="cb290-10"><a href="#cb290-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%do</span> i = <span class="dv">1</span> <span class="kw">%to</span> <span class="kw">%sysfunc</span>(countw(<span class="kw">&amp;nom_col.</span>));</span>
<span id="cb290-11"><a href="#cb290-11" aria-hidden="true" tabindex="-1"></a>      <span class="kw">%let</span> <span class="fu">var</span> = <span class="kw">%scan</span>(<span class="kw">&amp;nom_col.</span>, <span class="kw">&amp;i)</span>;</span>
<span id="cb290-12"><a href="#cb290-12" aria-hidden="true" tabindex="-1"></a>      <span class="kw">if</span> missing(<span class="kw">&amp;var.</span>) <span class="kw">then</span> <span class="kw">&amp;var.</span> = <span class="dv">0</span>;</span>
<span id="cb290-13"><a href="#cb290-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%end</span>;</span>
<span id="cb290-14"><a href="#cb290-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%mend</span> Missing;</span>
<span id="cb290-15"><a href="#cb290-15" aria-hidden="true" tabindex="-1"></a>  %Missing;</span>
<span id="cb290-16"><a href="#cb290-16" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb290-17"><a href="#cb290-17" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> datasets lib = Work nolist;<span class="kw">delete</span> <span class="fu">Var</span><span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-69-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-69-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dans le cas des dates, la valeur manquante a été remplacée par 1970-01-01</span></span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase_sans_na <span class="ot">&lt;-</span> donnees_rbase</span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a>donnees_rbase_sans_na[<span class="fu">is.na</span>(donnees_rbase_sans_na)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true" tabindex="-1"></a><span class="co"># On remplace seulement les valeurs numériques par 0</span></span>
<span id="cb291-5"><a href="#cb291-5" aria-hidden="true" tabindex="-1"></a>donnees_rbase_sans_na <span class="ot">&lt;-</span> donnees_rbase</span>
<span id="cb291-6"><a href="#cb291-6" aria-hidden="true" tabindex="-1"></a>varNumeriques <span class="ot">&lt;-</span> <span class="fu">names</span>(donnees_rbase)[<span class="fu">unlist</span>(<span class="fu">lapply</span>(donnees_rbase, is.numeric))]</span>
<span id="cb291-7"><a href="#cb291-7" aria-hidden="true" tabindex="-1"></a>donnees_rbase_sans_na[, varNumeriques][<span class="fu">is.na</span>(donnees_rbase_sans_na[, varNumeriques])] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb291-8"><a href="#cb291-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution, avec replace</span></span>
<span id="cb291-9"><a href="#cb291-9" aria-hidden="true" tabindex="-1"></a>donnees_rbase_sans_na[, varNumeriques] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(donnees_rbase_sans_na[, varNumeriques],</span>
<span id="cb291-10"><a href="#cb291-10" aria-hidden="true" tabindex="-1"></a>                                                 <span class="cf">function</span>(x) {<span class="fu">replace</span>(x, <span class="fu">is.na</span>(x), <span class="dv">0</span>)})</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-69-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-69-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On remplace seulement les valeurs numériques par 0</span></span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse_sans_na <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span>tidyr<span class="sc">::</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb292-4"><a href="#cb292-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Autres façons d'écrire les fonctions anonymes</span></span>
<span id="cb292-5"><a href="#cb292-5" aria-hidden="true" tabindex="-1"></a><span class="co"># La méthode complète</span></span>
<span id="cb292-6"><a href="#cb292-6" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse_sans_na <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb292-7"><a href="#cb292-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="cf">function</span>(x) tidyr<span class="sc">::</span><span class="fu">replace_na</span>(x, <span class="dv">0</span>)))</span>
<span id="cb292-8"><a href="#cb292-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Une autre façon de raccourcir (depuis R 4.1)</span></span>
<span id="cb292-9"><a href="#cb292-9" aria-hidden="true" tabindex="-1"></a><span class="co"># \(x) est un raccourci pour function(x)</span></span>
<span id="cb292-10"><a href="#cb292-10" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse_sans_na <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb292-11"><a href="#cb292-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), \(x) tidyr<span class="sc">::</span><span class="fu">replace_na</span>(x, <span class="dv">0</span>)))</span>
<span id="cb292-12"><a href="#cb292-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb292-13"><a href="#cb292-13" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse_sans_na <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb292-14"><a href="#cb292-14" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">modify_if</span>(is.numeric, <span class="sc">~</span>tidyr<span class="sc">::</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-69-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-69-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a>donnees_datatable_sans_na <span class="ot">&lt;-</span> <span class="fu">copy</span>(donnees_datatable)</span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setnafill</span>(donnees_datatable[, .SD, <span class="at">.SDcols =</span> is.numeric], <span class="at">fill =</span> <span class="dv">0</span>)</span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb293-4"><a href="#cb293-4" aria-hidden="true" tabindex="-1"></a>donnees_datatable_sans_na <span class="ot">&lt;-</span> <span class="fu">copy</span>(donnees_datatable)</span>
<span id="cb293-5"><a href="#cb293-5" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">colnames</span>(donnees_datatable_sans_na[, .SD, <span class="at">.SDcols =</span> is.numeric])</span>
<span id="cb293-6"><a href="#cb293-6" aria-hidden="true" tabindex="-1"></a>donnees_datatable_sans_na[, (cols) <span class="sc">:</span><span class="er">=</span> <span class="fu">lapply</span>(.SD, <span class="cf">function</span>(x) <span class="fu">fifelse</span>(<span class="fu">is.na</span>(x), <span class="dv">0</span>, x)), .SDcols <span class="ot">=</span> cols]</span>
<span id="cb293-7"><a href="#cb293-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensemble des colonnes</span></span>
<span id="cb293-8"><a href="#cb293-8" aria-hidden="true" tabindex="-1"></a>donnees_datatable_sans_na <span class="ot">&lt;-</span> <span class="fu">copy</span>(donnees_datatable)</span>
<span id="cb293-9"><a href="#cb293-9" aria-hidden="true" tabindex="-1"></a>donnees_datatable_sans_na[<span class="fu">is.na</span>(donnees_datatable_sans_na)] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-69-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-69-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="remplacer-les-valeurs-manquantes-dune-seule-variable-par-0" class="level2" data-number="11.5">
<h2 data-number="11.5" class="anchored" data-anchor-id="remplacer-les-valeurs-manquantes-dune-seule-variable-par-0"><span class="header-section-number">11.5</span> Remplacer les valeurs manquantes d’une seule variable par 0</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-70-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-70-1" role="tab" aria-controls="tabset-70-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-70-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-70-2" role="tab" aria-controls="tabset-70-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-70-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-70-3" role="tab" aria-controls="tabset-70-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-70-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-70-4" role="tab" aria-controls="tabset-70-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-70-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-70-5" role="tab" aria-controls="tabset-70-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-70-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-70-1-tab">
<div class="sourceCode" id="cb294"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> <span class="fu">var</span> = note_contenu;</span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas_sans_missing;</span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb294-4"><a href="#cb294-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> missing(<span class="kw">&amp;var.</span>) <span class="kw">then</span> <span class="kw">&amp;var.</span> = <span class="dv">0</span>;</span>
<span id="cb294-5"><a href="#cb294-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Ou alors */</span></span>
<span id="cb294-6"><a href="#cb294-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> <span class="kw">&amp;var.</span> = . <span class="kw">then</span> <span class="kw">&amp;var.</span> = <span class="dv">0</span>;</span>
<span id="cb294-7"><a href="#cb294-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Ou encore */</span></span>
<span id="cb294-8"><a href="#cb294-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> note_contenu = . <span class="kw">then</span> note_contenu = <span class="dv">0</span>;</span>
<span id="cb294-9"><a href="#cb294-9" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-70-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-70-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"note_contenu"</span></span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase_sans_na <span class="ot">&lt;-</span> donnees_rbase</span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a>donnees_rbase_sans_na[, variable][<span class="fu">is.na</span>(donnees_rbase_sans_na[, variable])] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb295-4"><a href="#cb295-4" aria-hidden="true" tabindex="-1"></a>donnees_rbase_sans_na[, variable] <span class="ot">&lt;-</span> <span class="fu">replace</span>(donnees_rbase_sans_na[, variable],</span>
<span id="cb295-5"><a href="#cb295-5" aria-hidden="true" tabindex="-1"></a>                                             <span class="fu">is.na</span>(donnees_rbase_sans_na[, variable]), <span class="dv">0</span>)</span>
<span id="cb295-6"><a href="#cb295-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Ou alors</span></span>
<span id="cb295-7"><a href="#cb295-7" aria-hidden="true" tabindex="-1"></a>donnees_rbase_sans_na <span class="ot">&lt;-</span> donnees_rbase</span>
<span id="cb295-8"><a href="#cb295-8" aria-hidden="true" tabindex="-1"></a>donnees_rbase_sans_na<span class="sc">$</span>note_contenu[<span class="fu">is.na</span>(donnees_rbase_sans_na<span class="sc">$</span>note_contenu)] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-70-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-70-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"note_contenu"</span></span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse_sans_na <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(variable,  <span class="sc">~</span>tidyr<span class="sc">::</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ou alors</span></span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse_sans_na <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">note_contenu =</span> tidyr<span class="sc">::</span><span class="fu">replace_na</span>(note_contenu, <span class="dv">0</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-70-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-70-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"note_contenu"</span></span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">replace</span>(.SD, <span class="fu">is.na</span>(.SD), <span class="dv">0</span>), .SDcols <span class="ot">=</span> variable]</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">lapply</span>(.SD, <span class="cf">function</span>(x) <span class="fu">fifelse</span>(<span class="fu">is.na</span>(x), <span class="dv">0</span>, x)), .SDcols <span class="ot">=</span> variable]</span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">lapply</span>(.SD, \(x) <span class="fu">fifelse</span>(<span class="fu">is.na</span>(x), <span class="dv">0</span>, x)), .SDcols <span class="ot">=</span> variable]</span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ou alors</span></span>
<span id="cb297-6"><a href="#cb297-6" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">replace</span>(.SD, <span class="fu">is.na</span>(.SD), <span class="dv">0</span>), .SDcols <span class="ot">=</span> <span class="st">"note_contenu"</span>]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-70-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-70-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
</section>
<section id="les-doublons" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Les doublons</h1>
<section id="doublons-pour-toutes-les-colonnes" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="doublons-pour-toutes-les-colonnes"><span class="header-section-number">12.1</span> Doublons pour toutes les colonnes</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-71-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-71-1" role="tab" aria-controls="tabset-71-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-71-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-71-2" role="tab" aria-controls="tabset-71-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-71-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-71-3" role="tab" aria-controls="tabset-71-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-71-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-71-4" role="tab" aria-controls="tabset-71-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-71-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-71-5" role="tab" aria-controls="tabset-71-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-71-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-71-1-tab">
<div class="sourceCode" id="cb298"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* On extraie tous les doublons, pas la première occurrence */</span></span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true" tabindex="-1"></a><span class="co">/* On récupère déjà la dernière variable de la base (on en aura besoin plus loin) */</span></span>
<span id="cb298-4"><a href="#cb298-4" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> contents<span class="kw"> data</span> = donnees_sas out = <span class="fu">Var</span> noprint<span class="kw">;run</span>;</span>
<span id="cb298-5"><a href="#cb298-5" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql noprint;</span>
<span id="cb298-6"><a href="#cb298-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> name <span class="kw">into</span> :derniere_var</span>
<span id="cb298-7"><a href="#cb298-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> <span class="fu">Var</span></span>
<span id="cb298-8"><a href="#cb298-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">where</span> <span class="fu">varnum</span> = (<span class="kw">select</span> <span class="fu">max</span>(<span class="fu">varnum</span>) <span class="kw">from</span> <span class="fu">Var</span>);</span>
<span id="cb298-9"><a href="#cb298-9" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span>
<span id="cb298-10"><a href="#cb298-10" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas;<span class="kw">by</span> <span class="kw">&amp;nom_col.;run</span>;</span>
<span id="cb298-11"><a href="#cb298-11" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Doublons;</span>
<span id="cb298-12"><a href="#cb298-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb298-13"><a href="#cb298-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">by</span> <span class="kw">&amp;nom_col.</span>;</span>
<span id="cb298-14"><a href="#cb298-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> <span class="kw">not</span> (first.<span class="kw">&amp;derniere_var.</span> <span class="kw">and</span> last.<span class="kw">&amp;derniere_var.</span>);</span>
<span id="cb298-15"><a href="#cb298-15" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-71-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-71-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On extraie tous les doublons, pas la première occurrence</span></span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a>doublons <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">duplicated</span>(donnees_rbase), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-71-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-71-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On extraie tous les doublons, pas la première occurrence</span></span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a>doublons <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span>  </span>
<span id="cb300-3"><a href="#cb300-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by_all</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb300-4"><a href="#cb300-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb300-5"><a href="#cb300-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb300-6"><a href="#cb300-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-71-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-71-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On extraie tous les doublons, pas la première occurrence</span></span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a>doublons <span class="ot">&lt;-</span> donnees_datatable[<span class="fu">duplicated</span>(donnees_datatable), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-71-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-71-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="doublons-pour-une-ou-plusieurs-colonnes" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="doublons-pour-une-ou-plusieurs-colonnes"><span class="header-section-number">12.2</span> Doublons pour une ou plusieurs colonnes</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-72-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-72-1" role="tab" aria-controls="tabset-72-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-72-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-72-2" role="tab" aria-controls="tabset-72-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-72-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-72-3" role="tab" aria-controls="tabset-72-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-72-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-72-4" role="tab" aria-controls="tabset-72-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-72-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-72-5" role="tab" aria-controls="tabset-72-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-72-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-72-1-tab">
<div class="sourceCode" id="cb302"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* On extraie tous les doublons, pas la première occurrence */</span></span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> <span class="fu">var</span> = identifiant;</span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas;<span class="kw">by</span> <span class="kw">&amp;var.;run</span>;</span>
<span id="cb302-4"><a href="#cb302-4" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> doublons;</span>
<span id="cb302-5"><a href="#cb302-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb302-6"><a href="#cb302-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">by</span> <span class="kw">&amp;var.</span>;</span>
<span id="cb302-7"><a href="#cb302-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> <span class="kw">not</span> first.<span class="kw">&amp;var.</span>;</span>
<span id="cb302-8"><a href="#cb302-8" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-72-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-72-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On extraie tous les doublons, pas la première occurrence</span></span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"identifiant"</span></span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a>doublons <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">duplicated</span>(donnees_rbase[, variable]), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-72-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-72-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On extraie tous les doublons, pas la première occurrence</span></span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"identifiant"</span></span>
<span id="cb304-3"><a href="#cb304-3" aria-hidden="true" tabindex="-1"></a>doublons <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span>  </span>
<span id="cb304-4"><a href="#cb304-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="fu">across</span>(variable)) <span class="sc">%&gt;%</span> </span>
<span id="cb304-5"><a href="#cb304-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb304-6"><a href="#cb304-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb304-7"><a href="#cb304-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-72-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-72-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On extraie tous les doublons, pas la première occurrence</span></span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"identifiant"</span></span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a>doublons <span class="ot">&lt;-</span> donnees_datatable[<span class="fu">duplicated</span>(donnees_datatable[, ..variable]), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-72-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-72-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="récupérer-toutes-les-lignes-pour-les-identifiants-en-doublon" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="récupérer-toutes-les-lignes-pour-les-identifiants-en-doublon"><span class="header-section-number">12.3</span> Récupérer toutes les lignes pour les identifiants en doublon</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-73-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-73-1" role="tab" aria-controls="tabset-73-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-73-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-73-2" role="tab" aria-controls="tabset-73-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-73-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-73-3" role="tab" aria-controls="tabset-73-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-73-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-73-4" role="tab" aria-controls="tabset-73-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-73-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-73-5" role="tab" aria-controls="tabset-73-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-73-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-73-1-tab">
<div class="sourceCode" id="cb306"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> <span class="fu">var</span> = identifiant;</span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a><span class="co">/* On groupe par la colonne identifiant, et si on aboutit à strictement plus d'une ligne, c'est un doublon */</span></span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">table</span> enDouble <span class="kw">as</span></span>
<span id="cb306-5"><a href="#cb306-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> * <span class="kw">from</span> donnees_sas</span>
<span id="cb306-6"><a href="#cb306-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">group</span> <span class="kw">by</span> <span class="kw">&amp;var.</span></span>
<span id="cb306-7"><a href="#cb306-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">having</span> count(*) &gt; <span class="dv">1</span>;</span>
<span id="cb306-8"><a href="#cb306-8" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-73-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-73-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"identifiant"</span></span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>enDouble <span class="ot">&lt;-</span> donnees_rbase[donnees_rbase[, variable] <span class="sc">%in%</span></span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a>                            donnees_rbase[<span class="fu">duplicated</span>(donnees_rbase[, variable]), variable]]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-73-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-73-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"identifiant"</span></span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a>enDouble <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span>  </span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="fu">across</span>(variable)) <span class="sc">%&gt;%</span> </span>
<span id="cb308-4"><a href="#cb308-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb308-5"><a href="#cb308-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-73-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-73-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"identifiant"</span></span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a>enDouble <span class="ot">&lt;-</span> donnees_datatable[donnees_datatable[[variable]] <span class="sc">%chin%</span></span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a>                                donnees_datatable[[variable]][<span class="fu">duplicated</span>(donnees_datatable[[variable]])], ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-73-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-73-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="récupérer-toutes-les-lignes-pour-les-identifiants-sans-doublon" class="level2" data-number="12.4">
<h2 data-number="12.4" class="anchored" data-anchor-id="récupérer-toutes-les-lignes-pour-les-identifiants-sans-doublon"><span class="header-section-number">12.4</span> Récupérer toutes les lignes pour les identifiants sans doublon</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-74-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-74-1" role="tab" aria-controls="tabset-74-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-74-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-74-2" role="tab" aria-controls="tabset-74-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-74-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-74-3" role="tab" aria-controls="tabset-74-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-74-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-74-4" role="tab" aria-controls="tabset-74-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-74-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-74-5" role="tab" aria-controls="tabset-74-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-74-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-74-1-tab">
<div class="sourceCode" id="cb310"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> <span class="fu">var</span> = identifiant;</span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">table</span> sansDouble <span class="kw">as</span></span>
<span id="cb310-4"><a href="#cb310-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> * <span class="kw">from</span> donnees_sas</span>
<span id="cb310-5"><a href="#cb310-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">group</span> <span class="kw">by</span> <span class="kw">&amp;var.</span></span>
<span id="cb310-6"><a href="#cb310-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">having</span> count(*) = <span class="dv">1</span>;</span>
<span id="cb310-7"><a href="#cb310-7" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-74-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-74-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"identifiant"</span></span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a>sansDouble <span class="ot">&lt;-</span> donnees_rbase[<span class="sc">!</span> donnees_rbase[, variable] <span class="sc">%in%</span></span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a>                              donnees_rbase[<span class="fu">duplicated</span>(donnees_rbase[, variable]), variable]]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-74-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-74-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"identifiant"</span></span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a>sansDouble <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span>  </span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="fu">across</span>(variable)) <span class="sc">%&gt;%</span> </span>
<span id="cb312-4"><a href="#cb312-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb312-5"><a href="#cb312-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-74-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-74-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"identifiant"</span></span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a>sansDouble <span class="ot">&lt;-</span> donnees_datatable[<span class="sc">!</span> donnees_datatable[[variable]] <span class="sc">%chin%</span></span>
<span id="cb313-3"><a href="#cb313-3" aria-hidden="true" tabindex="-1"></a>                                  donnees_datatable[[variable]][<span class="fu">duplicated</span>(donnees_datatable[[variable]])], ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-74-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-74-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="suppression-des-doublons-pour-lensemble-des-variables" class="level2" data-number="12.5">
<h2 data-number="12.5" class="anchored" data-anchor-id="suppression-des-doublons-pour-lensemble-des-variables"><span class="header-section-number">12.5</span> Suppression des doublons pour l’ensemble des variables</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-75-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-75-1" role="tab" aria-controls="tabset-75-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-75-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-75-2" role="tab" aria-controls="tabset-75-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-75-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-75-3" role="tab" aria-controls="tabset-75-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-75-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-75-4" role="tab" aria-controls="tabset-75-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-75-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-75-5" role="tab" aria-controls="tabset-75-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-75-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-75-1-tab">
<div class="sourceCode" id="cb314"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* 1ère méthode */</span></span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas nodupkey;</span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">by</span> _all_;</span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb314-5"><a href="#cb314-5" aria-hidden="true" tabindex="-1"></a><span class="co">/* 2e méthode, avec first. et last. (cf. infra) */</span></span>
<span id="cb314-6"><a href="#cb314-6" aria-hidden="true" tabindex="-1"></a><span class="co">/* On récupère déjà la dernière variable de la base (on en aura besoin plus loin) */</span></span>
<span id="cb314-7"><a href="#cb314-7" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> contents<span class="kw"> data</span> = donnees_sas out = <span class="fu">Var</span> noprint<span class="kw">;run</span>;</span>
<span id="cb314-8"><a href="#cb314-8" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql noprint;</span>
<span id="cb314-9"><a href="#cb314-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> name <span class="kw">into</span> :derniere_var <span class="kw">from</span> <span class="fu">Var</span></span>
<span id="cb314-10"><a href="#cb314-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">where</span> <span class="fu">varnum</span> = (<span class="kw">select</span> <span class="fu">max</span>(<span class="fu">varnum</span>) <span class="kw">from</span> <span class="fu">Var</span>);</span>
<span id="cb314-11"><a href="#cb314-11" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span>
<span id="cb314-12"><a href="#cb314-12" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql noprint;</span>
<span id="cb314-13"><a href="#cb314-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> name <span class="kw">into</span> :nom_col separated <span class="kw">by</span> <span class="st">" "</span> <span class="kw">from</span> <span class="fu">Var</span> <span class="kw">order</span> <span class="kw">by</span> <span class="fu">varnum</span>;</span>
<span id="cb314-14"><a href="#cb314-14" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span>
<span id="cb314-15"><a href="#cb314-15" aria-hidden="true" tabindex="-1"></a><span class="kw">%put</span> Dernière variable de la base : <span class="kw">&amp;derniere_var.</span>;</span>
<span id="cb314-16"><a href="#cb314-16" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas;<span class="kw">by</span> <span class="kw">&amp;nom_col.;run</span>;</span>
<span id="cb314-17"><a href="#cb314-17" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> sansDouble;</span>
<span id="cb314-18"><a href="#cb314-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb314-19"><a href="#cb314-19" aria-hidden="true" tabindex="-1"></a>  <span class="kw">by</span> <span class="kw">&amp;nom_col.</span>;</span>
<span id="cb314-20"><a href="#cb314-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> first.<span class="kw">&amp;derniere_var.</span>;</span>
<span id="cb314-21"><a href="#cb314-21" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-75-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-75-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase_sansdoublon <span class="ot">&lt;-</span> donnees_rbase[<span class="sc">!</span> <span class="fu">duplicated</span>(donnees_rbase), ]</span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution (équivalente à la solution first. de SAS)</span></span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a>donnees_rbase_sansdoublon <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(<span class="fu">colnames</span>(donnees_rbase), <span class="at">na.last =</span> <span class="cn">FALSE</span>), ]</span>
<span id="cb315-4"><a href="#cb315-4" aria-hidden="true" tabindex="-1"></a>donnees_rbase_sansdoublon <span class="ot">&lt;-</span> donnees_rbase[<span class="sc">!</span><span class="fu">duplicated</span>(donnees_rbase[, <span class="fu">colnames</span>(donnees_rbase)], <span class="at">fromLast =</span> <span class="cn">TRUE</span>), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-75-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-75-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">pick</span>(<span class="fu">everything</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb316-3"><a href="#cb316-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb316-4"><a href="#cb316-4" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb316-5"><a href="#cb316-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">across</span>(<span class="fu">everything</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb316-6"><a href="#cb316-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-75-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-75-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a>donnees_datatable <span class="ot">&lt;-</span> <span class="fu">unique</span>(donnees_datatable)</span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable <span class="ot">&lt;-</span> donnees_datatable[<span class="sc">!</span> <span class="fu">duplicated</span>(donnees_datatable), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-75-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-75-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="suppression-des-doublons-pour-une-seule-variable" class="level2" data-number="12.6">
<h2 data-number="12.6" class="anchored" data-anchor-id="suppression-des-doublons-pour-une-seule-variable"><span class="header-section-number">12.6</span> Suppression des doublons pour une seule variable</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-76-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-76-1" role="tab" aria-controls="tabset-76-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-76-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-76-2" role="tab" aria-controls="tabset-76-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-76-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-76-3" role="tab" aria-controls="tabset-76-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-76-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-76-4" role="tab" aria-controls="tabset-76-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-76-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-76-5" role="tab" aria-controls="tabset-76-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-76-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-76-1-tab">
<div class="sourceCode" id="cb318"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas;<span class="kw">by</span> _all_<span class="kw">;run</span>;</span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> sansDouble;</span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb318-4"><a href="#cb318-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">by</span> _all_;</span>
<span id="cb318-5"><a href="#cb318-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> first.identifiant;</span>
<span id="cb318-6"><a href="#cb318-6" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-76-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-76-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a>donnees_rbase_sansdoublon <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(<span class="fu">colnames</span>(donnees_rbase), <span class="at">na.last =</span> <span class="cn">FALSE</span>), ]</span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase_sansdoublon <span class="ot">&lt;-</span> donnees_rbase_sansdoublon[<span class="sc">!</span><span class="fu">duplicated</span>(donnees_rbase_sansdoublon<span class="sc">$</span>identifiant), , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-76-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-76-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb320"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="co"># L'option .keep_all = TRUE est nécessaire </span></span>
<span id="cb320-2"><a href="#cb320-2" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : REVOIR LE TRI PAR RAPPORT A SAS !!!</span></span>
<span id="cb320-3"><a href="#cb320-3" aria-hidden="true" tabindex="-1"></a>sansDouble <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb320-4"><a href="#cb320-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">pick</span>(<span class="fu">everything</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb320-5"><a href="#cb320-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(identifiant, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb320-6"><a href="#cb320-6" aria-hidden="true" tabindex="-1"></a>sansDouble <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb320-7"><a href="#cb320-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">across</span>(<span class="fu">everything</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb320-8"><a href="#cb320-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(identifiant, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-76-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-76-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setorderv</span>(donnees_datatable, <span class="at">cols =</span> <span class="fu">colnames</span>(donnees_datatable), <span class="at">na.last =</span> <span class="cn">FALSE</span>)</span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true" tabindex="-1"></a>sansDouble <span class="ot">&lt;-</span> donnees_datatable[<span class="sc">!</span> <span class="fu">duplicated</span>(donnees_datatable[, <span class="fu">c</span>(<span class="st">"identifiant"</span>)]), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-76-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-76-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="identifiants-uniques" class="level2" data-number="12.7">
<h2 data-number="12.7" class="anchored" data-anchor-id="identifiants-uniques"><span class="header-section-number">12.7</span> Identifiants uniques</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-77-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-77-1" role="tab" aria-controls="tabset-77-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-77-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-77-2" role="tab" aria-controls="tabset-77-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-77-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-77-3" role="tab" aria-controls="tabset-77-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-77-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-77-4" role="tab" aria-controls="tabset-77-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-77-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-77-5" role="tab" aria-controls="tabset-77-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-77-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-77-1-tab">
<div class="sourceCode" id="cb322"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb322-2"><a href="#cb322-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">table</span> id <span class="kw">as</span> <span class="kw">select</span> <span class="kw">distinct</span> identifiant <span class="kw">from</span> donnees_sas <span class="kw">order</span> <span class="kw">by</span> identifiant;</span>
<span id="cb322-3"><a href="#cb322-3" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-77-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-77-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(donnees_rbase[<span class="st">"identifiant"</span>])</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-77-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-77-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(identifiant)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-77-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-77-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(donnees_datatable[, <span class="st">"identifiant"</span>])</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-77-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-77-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="nombre-de-lignes-uniques-sans-doublon" class="level2" data-number="12.8">
<h2 data-number="12.8" class="anchored" data-anchor-id="nombre-de-lignes-uniques-sans-doublon"><span class="header-section-number">12.8</span> Nombre de lignes uniques, sans doublon</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-78-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-78-1" role="tab" aria-controls="tabset-78-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-78-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-78-2" role="tab" aria-controls="tabset-78-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-78-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-78-3" role="tab" aria-controls="tabset-78-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-78-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-78-4" role="tab" aria-controls="tabset-78-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-78-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-78-5" role="tab" aria-controls="tabset-78-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-78-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-78-1-tab">
<div class="sourceCode" id="cb326"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> contents<span class="kw"> data</span> = donnees_sas out = <span class="fu">Var</span> noprint<span class="kw">;run</span>;</span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql noprint;<span class="kw">select</span> name <span class="kw">into</span> :nom_col separated <span class="kw">by</span> <span class="st">", "</span> <span class="kw">from</span> <span class="fu">Var</span> <span class="kw">order</span> <span class="kw">by</span> <span class="fu">varnum</span>;<span class="kw">quit</span>;</span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> count(*) <span class="kw">as</span> Nb_Lignes_Uniques</span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> (<span class="kw">select</span> <span class="kw">&amp;nom_col.</span>, count(*) <span class="kw">from</span> donnees_sas <span class="kw">group</span> <span class="kw">by</span> <span class="kw">&amp;nom_col.</span>);</span>
<span id="cb326-6"><a href="#cb326-6" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-78-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-78-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(<span class="fu">unique</span>(donnees_rbase))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-78-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-78-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-78-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-78-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : pas sûr de moi</span></span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a><span class="fu">uniqueN</span>(donnees_datatable)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-78-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-78-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
</section>
<section id="les-jointures-de-bases" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Les jointures de bases</h1>
<section id="importation-de-bases-pour-les-jointures" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="importation-de-bases-pour-les-jointures"><span class="header-section-number">13.1</span> Importation de bases pour les jointures</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-79-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-79-1" role="tab" aria-controls="tabset-79-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-79-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-79-2" role="tab" aria-controls="tabset-79-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-79-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-79-3" role="tab" aria-controls="tabset-79-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-79-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-79-4" role="tab" aria-controls="tabset-79-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-79-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-79-5" role="tab" aria-controls="tabset-79-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-79-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-79-1-tab">
<div class="sourceCode" id="cb330"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* On suppose que l'on dispose d'une base supplémentaire avec les diplômes des personnes */</span></span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Diplome;</span>
<span id="cb330-3"><a href="#cb330-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">infile</span> <span class="kw">cards</span> dsd dlm=<span class="st">'|'</span>;</span>
<span id="cb330-4"><a href="#cb330-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Identifiant $<span class="dv">3</span>. Diplome $<span class="dv">20</span>.;</span>
<span id="cb330-5"><a href="#cb330-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">input</span> Identifiant $ Diplome $;</span>
<span id="cb330-6"><a href="#cb330-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">cards</span>;</span>
<span id="cb330-7"><a href="#cb330-7" aria-hidden="true" tabindex="-1"></a>  <span class="dv">173</span>|Bac</span>
<span id="cb330-8"><a href="#cb330-8" aria-hidden="true" tabindex="-1"></a>  <span class="dv">168</span>|Bep-Cap</span>
<span id="cb330-9"><a href="#cb330-9" aria-hidden="true" tabindex="-1"></a>  <span class="dv">112</span>|Bep-Cap</span>
<span id="cb330-10"><a href="#cb330-10" aria-hidden="true" tabindex="-1"></a>  <span class="dv">087</span>|Bac+<span class="dv">2</span></span>
<span id="cb330-11"><a href="#cb330-11" aria-hidden="true" tabindex="-1"></a>  <span class="dv">689</span>|Bac+<span class="dv">2</span></span>
<span id="cb330-12"><a href="#cb330-12" aria-hidden="true" tabindex="-1"></a>  <span class="dv">765</span>|Pas de diplôme</span>
<span id="cb330-13"><a href="#cb330-13" aria-hidden="true" tabindex="-1"></a>  <span class="dv">113</span>|Bac</span>
<span id="cb330-14"><a href="#cb330-14" aria-hidden="true" tabindex="-1"></a>  <span class="dv">999</span>|Bac</span>
<span id="cb330-15"><a href="#cb330-15" aria-hidden="true" tabindex="-1"></a>  <span class="dv">554</span>|Bep-Cap</span>
<span id="cb330-16"><a href="#cb330-16" aria-hidden="true" tabindex="-1"></a>  ;</span>
<span id="cb330-17"><a href="#cb330-17" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb330-18"><a href="#cb330-18" aria-hidden="true" tabindex="-1"></a><span class="co">/* On suppose que l'on dispose aussi d'une base supplémentaire indiquant la date d'une entrevue avec un conseiller */</span></span>
<span id="cb330-19"><a href="#cb330-19" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Entrevue;</span>
<span id="cb330-20"><a href="#cb330-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">infile</span> <span class="kw">cards</span> dsd dlm=<span class="st">'|'</span>;</span>
<span id="cb330-21"><a href="#cb330-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Identifiant $<span class="dv">3</span>. Date_entrevue ddmmyy10.;</span>
<span id="cb330-22"><a href="#cb330-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">input</span> Identifiant $ Date_entrevue ddmmyy10.;</span>
<span id="cb330-23"><a href="#cb330-23" aria-hidden="true" tabindex="-1"></a>  <span class="kw">cards</span>;</span>
<span id="cb330-24"><a href="#cb330-24" aria-hidden="true" tabindex="-1"></a>  <span class="dv">173</span>|<span class="dv">06</span>/<span class="dv">08</span>/<span class="dv">2021</span></span>
<span id="cb330-25"><a href="#cb330-25" aria-hidden="true" tabindex="-1"></a>  <span class="dv">168</span>|<span class="dv">17</span>/<span class="dv">10</span>/<span class="dv">2019</span></span>
<span id="cb330-26"><a href="#cb330-26" aria-hidden="true" tabindex="-1"></a>  <span class="dv">087</span>|<span class="dv">12</span>/<span class="dv">06</span>/<span class="dv">2021</span></span>
<span id="cb330-27"><a href="#cb330-27" aria-hidden="true" tabindex="-1"></a>  <span class="dv">689</span>|<span class="dv">28</span>/<span class="dv">03</span>/<span class="dv">2018</span></span>
<span id="cb330-28"><a href="#cb330-28" aria-hidden="true" tabindex="-1"></a>  <span class="dv">099</span>|<span class="dv">01</span>/<span class="dv">09</span>/<span class="dv">2022</span></span>
<span id="cb330-29"><a href="#cb330-29" aria-hidden="true" tabindex="-1"></a>  <span class="dv">765</span>|<span class="dv">01</span>/<span class="dv">10</span>/<span class="dv">2020</span></span>
<span id="cb330-30"><a href="#cb330-30" aria-hidden="true" tabindex="-1"></a>  ;</span>
<span id="cb330-31"><a href="#cb330-31" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb330-32"><a href="#cb330-32" aria-hidden="true" tabindex="-1"></a><span class="co">/* On récupère un extrait de la base initiale */</span></span>
<span id="cb330-33"><a href="#cb330-33" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Jointure;</span>
<span id="cb330-34"><a href="#cb330-34" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas (<span class="kw">keep</span> = Identifiant Sexe date_entree date_sortie);</span>
<span id="cb330-35"><a href="#cb330-35" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-79-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-79-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb331"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On suppose que l'on dispose d'une base supplémentaire avec les diplômes des personnes</span></span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true" tabindex="-1"></a>diplome_rbase <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">identifiant =</span> <span class="fu">c</span>(<span class="st">"173"</span>, <span class="st">"168"</span>, <span class="st">"112"</span>, <span class="st">"087"</span>, <span class="st">"689"</span>, <span class="st">"765"</span>, <span class="st">"113"</span>, <span class="st">"999"</span>, <span class="st">"554"</span>),</span>
<span id="cb331-3"><a href="#cb331-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">diplome =</span> <span class="fu">c</span>(<span class="st">"Bac"</span>, <span class="st">"Bep-Cap"</span>, <span class="st">"Bep-Cap"</span>, <span class="st">"Bac+2"</span>, <span class="st">"Bac+2"</span>, <span class="st">"Pas de diplôme"</span>, <span class="st">"Bac"</span>, <span class="st">"Bac"</span>, <span class="st">"Bep-Cap"</span>))</span>
<span id="cb331-4"><a href="#cb331-4" aria-hidden="true" tabindex="-1"></a><span class="co"># On suppose que l'on dispose d'une base supplémentaire indiquant la date d'une entrevue avec un conseiller</span></span>
<span id="cb331-5"><a href="#cb331-5" aria-hidden="true" tabindex="-1"></a>entrevue_rbase <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">identifiant =</span> <span class="fu">c</span>(<span class="st">"173"</span>, <span class="st">"168"</span>, <span class="st">"087"</span>, <span class="st">"689"</span>, <span class="st">"099"</span>, <span class="st">"765"</span>),</span>
<span id="cb331-6"><a href="#cb331-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">date_entrevue =</span> <span class="fu">c</span>(<span class="st">"06/08/2021"</span>, <span class="st">"17/10/2019"</span>, <span class="st">"12/06/2021"</span>, <span class="st">"28/03/2018"</span>, <span class="st">"01/09/2022"</span>, <span class="st">"01/10/2020"</span>))</span>
<span id="cb331-7"><a href="#cb331-7" aria-hidden="true" tabindex="-1"></a>entrevue_rbase<span class="sc">$</span>date_entrevue <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">dmy</span>(entrevue_rbase<span class="sc">$</span>date_entrevue)</span>
<span id="cb331-8"><a href="#cb331-8" aria-hidden="true" tabindex="-1"></a><span class="co"># On récupère un extrait de la base initiale</span></span>
<span id="cb331-9"><a href="#cb331-9" aria-hidden="true" tabindex="-1"></a>jointure_rbase <span class="ot">&lt;-</span> donnees_rbase[, <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"sexe"</span>, <span class="st">"date_entree"</span>, <span class="st">"date_sortie"</span>)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-79-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-79-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On suppose que l'on dispose d'une base supplémentaire avec les diplômes des personnes</span></span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a>diplome_tidyverse <span class="ot">&lt;-</span><span class="fu">tibble</span>(<span class="at">identifiant =</span> <span class="fu">c</span>(<span class="st">"173"</span>, <span class="st">"168"</span>, <span class="st">"112"</span>, <span class="st">"087"</span>, <span class="st">"689"</span>, <span class="st">"765"</span>, <span class="st">"113"</span>, <span class="st">"999"</span>, <span class="st">"554"</span>),</span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">diplome =</span> <span class="fu">c</span>(<span class="st">"Bac"</span>, <span class="st">"Bep-Cap"</span>, <span class="st">"Bep-Cap"</span>, <span class="st">"Bac+2"</span>, <span class="st">"Bac+2"</span>, <span class="st">"Pas de diplôme"</span>, <span class="st">"Bac"</span>, <span class="st">"Bac"</span>, <span class="st">"Bep-Cap"</span>))</span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a><span class="co"># On suppose que l'on dispose d'une base supplémentaire indiquant la date d'une entrevue avec un conseiller</span></span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a>entrevue_tidyverse <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">identifiant =</span> <span class="fu">c</span>(<span class="st">"173"</span>, <span class="st">"168"</span>, <span class="st">"087"</span>, <span class="st">"689"</span>, <span class="st">"099"</span>, <span class="st">"765"</span>),</span>
<span id="cb332-6"><a href="#cb332-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">date_entrevue =</span> <span class="fu">c</span>(<span class="st">"06/08/2021"</span>, <span class="st">"17/10/2019"</span>, <span class="st">"12/06/2021"</span>, <span class="st">"28/03/2018"</span>, <span class="st">"01/09/2022"</span>, <span class="st">"01/10/2020"</span>))</span>
<span id="cb332-7"><a href="#cb332-7" aria-hidden="true" tabindex="-1"></a>entrevue_tidyverse <span class="ot">&lt;-</span> entrevue_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb332-8"><a href="#cb332-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date_entrevue =</span> lubridate<span class="sc">::</span><span class="fu">dmy</span>(date_entrevue))</span>
<span id="cb332-9"><a href="#cb332-9" aria-hidden="true" tabindex="-1"></a><span class="co"># On récupère un extrait de la base initiale</span></span>
<span id="cb332-10"><a href="#cb332-10" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"sexe"</span>, <span class="st">"date_entree"</span>, <span class="st">"date_sortie"</span>)</span>
<span id="cb332-11"><a href="#cb332-11" aria-hidden="true" tabindex="-1"></a>jointure_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb332-12"><a href="#cb332-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(variable)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-79-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-79-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb333"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On suppose que l'on dispose d'une base supplémentaire avec les diplômes des personnes</span></span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a>diplome_datatable <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">identifiant =</span> <span class="fu">c</span>(<span class="st">"173"</span>, <span class="st">"168"</span>, <span class="st">"112"</span>, <span class="st">"087"</span>, <span class="st">"689"</span>, <span class="st">"765"</span>, <span class="st">"113"</span>, <span class="st">"999"</span>, <span class="st">"554"</span>),</span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">diplome =</span> <span class="fu">c</span>(<span class="st">"Bac"</span>, <span class="st">"Bep-Cap"</span>, <span class="st">"Bep-Cap"</span>, <span class="st">"Bac+2"</span>, <span class="st">"Bac+2"</span>, <span class="st">"Pas de diplôme"</span>, <span class="st">"Bac"</span>, <span class="st">"Bac"</span>, <span class="st">"Bep-Cap"</span>))</span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true" tabindex="-1"></a><span class="co"># On suppose que l'on dispose d'une base supplémentaire indiquant la date d'une entrevue avec un conseiller</span></span>
<span id="cb333-5"><a href="#cb333-5" aria-hidden="true" tabindex="-1"></a>entrevue_datatable <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">identifiant =</span> <span class="fu">c</span>(<span class="st">"173"</span>, <span class="st">"168"</span>, <span class="st">"087"</span>, <span class="st">"689"</span>, <span class="st">"099"</span>, <span class="st">"765"</span>),</span>
<span id="cb333-6"><a href="#cb333-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">date_entrevue =</span> <span class="fu">c</span>(<span class="st">"06/08/2021"</span>, <span class="st">"17/10/2019"</span>, <span class="st">"12/06/2021"</span>, <span class="st">"28/03/2018"</span>, <span class="st">"01/09/2022"</span>, <span class="st">"01/10/2020"</span>))</span>
<span id="cb333-7"><a href="#cb333-7" aria-hidden="true" tabindex="-1"></a>entrevue_datatable[, date_entrevue <span class="sc">:</span><span class="er">=</span> lubridate<span class="sc">::</span><span class="fu">dmy</span>(date_entrevue)]</span>
<span id="cb333-8"><a href="#cb333-8" aria-hidden="true" tabindex="-1"></a><span class="co"># On récupère un extrait de la base initiale</span></span>
<span id="cb333-9"><a href="#cb333-9" aria-hidden="true" tabindex="-1"></a>jointure_datatable <span class="ot">&lt;-</span> donnees_datatable[, <span class="fu">c</span>(<span class="st">"identifiant"</span>, <span class="st">"sexe"</span>, <span class="st">"date_entree"</span>, <span class="st">"date_sortie"</span>)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-79-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-79-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="inner-join-les-seuls-identifiants-communs-aux-deux-bases" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="inner-join-les-seuls-identifiants-communs-aux-deux-bases"><span class="header-section-number">13.2</span> Inner join : les seuls identifiants communs aux deux bases</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-80-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-80-1" role="tab" aria-controls="tabset-80-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-80-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-80-2" role="tab" aria-controls="tabset-80-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-80-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-80-3" role="tab" aria-controls="tabset-80-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-80-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-80-4" role="tab" aria-controls="tabset-80-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-80-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-80-5" role="tab" aria-controls="tabset-80-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-80-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-80-1-tab">
<div class="sourceCode" id="cb334"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Le tri préalable des bases de données à joindre par la variable de jointure est nécessaire avec la stratégie merge */</span></span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = Diplome;<span class="kw">by</span> identifiant<span class="kw">;run</span>;</span>
<span id="cb334-3"><a href="#cb334-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = Jointure;<span class="kw">by</span> identifiant<span class="kw">;run</span>;</span>
<span id="cb334-4"><a href="#cb334-4" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Inner_Join1;</span>
<span id="cb334-5"><a href="#cb334-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">merge</span> Jointure (<span class="kw">in</span> = a) Diplome (<span class="kw">in</span> = b);</span>
<span id="cb334-6"><a href="#cb334-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">by</span> identifiant;</span>
<span id="cb334-7"><a href="#cb334-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> a <span class="kw">and</span> b;</span>
<span id="cb334-8"><a href="#cb334-8" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb334-9"><a href="#cb334-9" aria-hidden="true" tabindex="-1"></a><span class="co">/* Le tri préalable des bases de données à joindre n'est pas nécessaire avec la jointure SQL */</span></span>
<span id="cb334-10"><a href="#cb334-10" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb334-11"><a href="#cb334-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">table</span> Inner_Join2 <span class="kw">as</span></span>
<span id="cb334-12"><a href="#cb334-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> * <span class="kw">from</span> Jointure a inner join Diplome b <span class="kw">on</span> a.identifiant = b.identifiant</span>
<span id="cb334-13"><a href="#cb334-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">order</span> <span class="kw">by</span> a.identifiant;</span>
<span id="cb334-14"><a href="#cb334-14" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span>
<span id="cb334-15"><a href="#cb334-15" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> print<span class="kw"> data</span> = Inner_Join1 (obs = <span class="dv">10</span>)<span class="kw">;run</span>;</span>
<span id="cb334-16"><a href="#cb334-16" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;<span class="kw">select</span> count(*) <span class="kw">from</span> Inner_Join1;<span class="kw">quit</span>;</span>
<span id="cb334-17"><a href="#cb334-17" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;<span class="kw">select</span> count(*) <span class="kw">from</span> Inner_Join2;<span class="kw">quit</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-80-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-80-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sont appariés les identifiants communs aux deux bases</span></span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true" tabindex="-1"></a>innerJoin <span class="ot">&lt;-</span> <span class="fu">merge</span>(jointure_rbase, diplome_rbase, <span class="at">by.x =</span> <span class="st">"identifiant"</span>, <span class="at">by.y =</span> <span class="st">"identifiant"</span>)</span>
<span id="cb335-3"><a href="#cb335-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(innerJoin)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-80-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-80-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb336"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sont appariés les identifiants communs aux deux bases</span></span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a>innerJoin <span class="ot">&lt;-</span> jointure_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb336-3"><a href="#cb336-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(diplome_tidyverse, <span class="at">by =</span> <span class="st">"identifiant"</span>)</span>
<span id="cb336-4"><a href="#cb336-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(innerJoin)</span>
<span id="cb336-5"><a href="#cb336-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Autres solutions</span></span>
<span id="cb336-6"><a href="#cb336-6" aria-hidden="true" tabindex="-1"></a>innerJoin <span class="ot">&lt;-</span> jointure_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb336-7"><a href="#cb336-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(diplome_tidyverse, <span class="at">by =</span> <span class="fu">join_by</span>(identifiant <span class="sc">==</span> identifiant))</span>
<span id="cb336-8"><a href="#cb336-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(innerJoin)</span>
<span id="cb336-9"><a href="#cb336-9" aria-hidden="true" tabindex="-1"></a>innerJoin <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(jointure_tidyverse, diplome_tidyverse, <span class="at">by =</span> <span class="st">"identifiant"</span>)</span>
<span id="cb336-10"><a href="#cb336-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(innerJoin)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-80-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-80-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb337"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a>innerJoin <span class="ot">&lt;-</span> <span class="fu">merge</span>(jointure_datatable, diplome_datatable, <span class="at">by.x =</span> <span class="st">"identifiant"</span>, <span class="at">by.y =</span> <span class="st">"identifiant"</span>)</span>
<span id="cb337-2"><a href="#cb337-2" aria-hidden="true" tabindex="-1"></a>innerJoin <span class="ot">&lt;-</span> jointure_datatable[diplome_datatable, nomatch <span class="ot">=</span> <span class="dv">0</span>, on <span class="ot">=</span> <span class="fu">list</span>(identifiant <span class="sc">==</span> identifiant)]</span>
<span id="cb337-3"><a href="#cb337-3" aria-hidden="true" tabindex="-1"></a>innerJoin <span class="ot">&lt;-</span> jointure_datatable[diplome_datatable, nomatch <span class="ot">=</span> <span class="dv">0</span>, on <span class="ot">=</span> .(identifiant <span class="sc">==</span> identifiant)]</span>
<span id="cb337-4"><a href="#cb337-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(innerJoin)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-80-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-80-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="left-join-les-identifiants-de-la-base-de-gauche" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="left-join-les-identifiants-de-la-base-de-gauche"><span class="header-section-number">13.3</span> Left join : les identifiants de la base de gauche</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-81-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-81-1" role="tab" aria-controls="tabset-81-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-81-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-81-2" role="tab" aria-controls="tabset-81-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-81-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-81-3" role="tab" aria-controls="tabset-81-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-81-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-81-4" role="tab" aria-controls="tabset-81-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-81-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-81-5" role="tab" aria-controls="tabset-81-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-81-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-81-1-tab">
<div class="sourceCode" id="cb338"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Le tri préalable des bases de données à joindre par la variable de jointure est nécessaire avec la stratégie merge */</span></span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = Diplome;<span class="kw">by</span> identifiant<span class="kw">;run</span>;</span>
<span id="cb338-3"><a href="#cb338-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = Jointure;<span class="kw">by</span> identifiant<span class="kw">;run</span>;</span>
<span id="cb338-4"><a href="#cb338-4" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Left_Join1;</span>
<span id="cb338-5"><a href="#cb338-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">merge</span> Jointure (<span class="kw">in</span> = a) Diplome (<span class="kw">in</span> = b);</span>
<span id="cb338-6"><a href="#cb338-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">by</span> identifiant;</span>
<span id="cb338-7"><a href="#cb338-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> a;</span>
<span id="cb338-8"><a href="#cb338-8" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb338-9"><a href="#cb338-9" aria-hidden="true" tabindex="-1"></a><span class="co">/* Le tri préalable des bases de données à joindre n'est pas nécessaire avec la jointure SQL */</span></span>
<span id="cb338-10"><a href="#cb338-10" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb338-11"><a href="#cb338-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">table</span> Left_Join2 <span class="kw">as</span></span>
<span id="cb338-12"><a href="#cb338-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> * <span class="kw">from</span> Jointure a <span class="fu">left</span> join Diplome b <span class="kw">on</span> a.identifiant = b.identifiant</span>
<span id="cb338-13"><a href="#cb338-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">order</span> <span class="kw">by</span> a.identifiant;</span>
<span id="cb338-14"><a href="#cb338-14" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span>
<span id="cb338-15"><a href="#cb338-15" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> print<span class="kw"> data</span> = Left_Join1 (obs = <span class="dv">10</span>)<span class="kw">;run</span>;</span>
<span id="cb338-16"><a href="#cb338-16" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;<span class="kw">select</span> count(*) <span class="kw">from</span> Left_Join1;<span class="kw">quit</span>;</span>
<span id="cb338-17"><a href="#cb338-17" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;<span class="kw">select</span> count(*) <span class="kw">from</span> Left_Join2;<span class="kw">quit</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-81-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-81-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb339"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sont appariés tous les identifiants de la base de gauche, et les correspondants éventuels de la base de droite</span></span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a>leftJoin <span class="ot">&lt;-</span> <span class="fu">merge</span>(jointure_rbase, diplome_rbase, <span class="at">by.x =</span> <span class="st">"identifiant"</span>, <span class="at">by.y =</span> <span class="st">"identifiant"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb339-3"><a href="#cb339-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(leftJoin)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-81-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-81-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sont appariés tous les identifiants de la base de gauche, et les correspondants éventuels de la base de droite</span></span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a>leftJoin <span class="ot">&lt;-</span> jointure_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(diplome_tidyverse, <span class="at">by =</span> <span class="st">"identifiant"</span>)</span>
<span id="cb340-4"><a href="#cb340-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(leftJoin)</span>
<span id="cb340-5"><a href="#cb340-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Autres solutions</span></span>
<span id="cb340-6"><a href="#cb340-6" aria-hidden="true" tabindex="-1"></a>leftJoin <span class="ot">&lt;-</span> jointure_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb340-7"><a href="#cb340-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(diplome_tidyverse, <span class="at">by =</span> <span class="fu">join_by</span>(identifiant <span class="sc">==</span> identifiant))</span>
<span id="cb340-8"><a href="#cb340-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(leftJoin)</span>
<span id="cb340-9"><a href="#cb340-9" aria-hidden="true" tabindex="-1"></a>leftJoin <span class="ot">&lt;-</span> <span class="fu">left_join</span>(jointure_tidyverse, diplome_tidyverse, <span class="at">by =</span> <span class="st">"identifiant"</span>)</span>
<span id="cb340-10"><a href="#cb340-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(leftJoin)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-81-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-81-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb341"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a>leftJoin <span class="ot">&lt;-</span> <span class="fu">merge</span>(jointure_datatable, diplome_datatable, <span class="at">by.x =</span> <span class="st">"identifiant"</span>, <span class="at">by.y =</span> <span class="st">"identifiant"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(leftJoin)</span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a>leftJoin <span class="ot">&lt;-</span> diplome_datatable[jointure_datatable, on <span class="ot">=</span> .(identifiant <span class="sc">==</span> identifiant)]</span>
<span id="cb341-4"><a href="#cb341-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(leftJoin)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-81-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-81-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="right-join-les-identifiants-de-la-base-de-droite" class="level2" data-number="13.4">
<h2 data-number="13.4" class="anchored" data-anchor-id="right-join-les-identifiants-de-la-base-de-droite"><span class="header-section-number">13.4</span> Right join : les identifiants de la base de droite</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-82-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-82-1" role="tab" aria-controls="tabset-82-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-82-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-82-2" role="tab" aria-controls="tabset-82-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-82-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-82-3" role="tab" aria-controls="tabset-82-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-82-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-82-4" role="tab" aria-controls="tabset-82-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-82-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-82-5" role="tab" aria-controls="tabset-82-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-82-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-82-1-tab">
<div class="sourceCode" id="cb342"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Le tri préalable des bases de données à joindre par la variable de jointure est nécessaire avec la stratégie merge */</span></span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = Diplome;<span class="kw">by</span> identifiant<span class="kw">;run</span>;</span>
<span id="cb342-3"><a href="#cb342-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = Jointure;<span class="kw">by</span> identifiant<span class="kw">;run</span>;</span>
<span id="cb342-4"><a href="#cb342-4" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Right_Join1;</span>
<span id="cb342-5"><a href="#cb342-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">merge</span> Jointure (<span class="kw">in</span> = a) Diplome (<span class="kw">in</span> = b);</span>
<span id="cb342-6"><a href="#cb342-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">by</span> identifiant;</span>
<span id="cb342-7"><a href="#cb342-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> b;</span>
<span id="cb342-8"><a href="#cb342-8" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb342-9"><a href="#cb342-9" aria-hidden="true" tabindex="-1"></a><span class="co">/* Le tri préalable des bases de données à joindre n'est pas nécessaire avec la jointure SQL */</span></span>
<span id="cb342-10"><a href="#cb342-10" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb342-11"><a href="#cb342-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">table</span> Right_Join2 <span class="kw">as</span></span>
<span id="cb342-12"><a href="#cb342-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> * <span class="kw">from</span> Jointure a <span class="fu">right</span> join Diplome b <span class="kw">on</span> a.identifiant = b.identifiant</span>
<span id="cb342-13"><a href="#cb342-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">order</span> <span class="kw">by</span> a.identifiant;</span>
<span id="cb342-14"><a href="#cb342-14" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span>
<span id="cb342-15"><a href="#cb342-15" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> print<span class="kw"> data</span> = Right_Join1 (obs = <span class="dv">10</span>)<span class="kw">;run</span>;</span>
<span id="cb342-16"><a href="#cb342-16" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;<span class="kw">select</span> count(*) <span class="kw">from</span> Right_Join1;<span class="kw">quit</span>;</span>
<span id="cb342-17"><a href="#cb342-17" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;<span class="kw">select</span> count(*) <span class="kw">from</span> Right_Join2;<span class="kw">quit</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-82-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-82-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sont appariés tous les identifiants de la base de droite et les correspondants éventuels de la base de gauche</span></span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a>rightJoin <span class="ot">&lt;-</span> <span class="fu">merge</span>(jointure_rbase, diplome_rbase, <span class="at">by.x =</span> <span class="st">"identifiant"</span>, <span class="at">by.y =</span> <span class="st">"identifiant"</span>, <span class="at">all.y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb343-3"><a href="#cb343-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(rightJoin)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-82-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-82-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb344"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sont appariés tous les identifiants de la base de droite et les correspondants éventuels de la base de gauche</span></span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a>rightJoin <span class="ot">&lt;-</span> jointure_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb344-3"><a href="#cb344-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(diplome_tidyverse, <span class="at">by =</span> <span class="st">"identifiant"</span>)</span>
<span id="cb344-4"><a href="#cb344-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(rightJoin)</span>
<span id="cb344-5"><a href="#cb344-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb344-6"><a href="#cb344-6" aria-hidden="true" tabindex="-1"></a>rightJoin <span class="ot">&lt;-</span> jointure_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb344-7"><a href="#cb344-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(diplome_tidyverse, <span class="at">by =</span> <span class="fu">join_by</span>(identifiant <span class="sc">==</span> identifiant))</span>
<span id="cb344-8"><a href="#cb344-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(rightJoin)</span>
<span id="cb344-9"><a href="#cb344-9" aria-hidden="true" tabindex="-1"></a>rightJoin <span class="ot">&lt;-</span> <span class="fu">right_join</span>(jointure_tidyverse, diplome_tidyverse, <span class="at">by =</span> <span class="st">"identifiant"</span>)</span>
<span id="cb344-10"><a href="#cb344-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(rightJoin)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-82-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-82-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb345"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a>rightJoin <span class="ot">&lt;-</span> <span class="fu">merge</span>(jointure_datatable, diplome_datatable, <span class="at">by.x =</span> <span class="st">"identifiant"</span>, <span class="at">by.y =</span> <span class="st">"identifiant"</span>, <span class="at">all.y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(rightJoin)</span>
<span id="cb345-3"><a href="#cb345-3" aria-hidden="true" tabindex="-1"></a>rightJoin <span class="ot">&lt;-</span> jointure_datatable[diplome_datatable, on <span class="ot">=</span> .(identifiant <span class="sc">==</span> identifiant)]</span>
<span id="cb345-4"><a href="#cb345-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(rightJoin)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-82-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-82-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="full-join-les-identifiants-des-deux-bases" class="level2" data-number="13.5">
<h2 data-number="13.5" class="anchored" data-anchor-id="full-join-les-identifiants-des-deux-bases"><span class="header-section-number">13.5</span> Full join : les identifiants des deux bases</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-83-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-83-1" role="tab" aria-controls="tabset-83-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-83-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-83-2" role="tab" aria-controls="tabset-83-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-83-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-83-3" role="tab" aria-controls="tabset-83-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-83-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-83-4" role="tab" aria-controls="tabset-83-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-83-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-83-5" role="tab" aria-controls="tabset-83-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-83-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-83-1-tab">
<div class="sourceCode" id="cb346"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Le tri préalable des bases de données à joindre par la variable de jointure est nécessaire avec la stratégie merge */</span></span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = Diplome;<span class="kw">by</span> identifiant<span class="kw">;run</span>;</span>
<span id="cb346-3"><a href="#cb346-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = Jointure;<span class="kw">by</span> identifiant<span class="kw">;run</span>;</span>
<span id="cb346-4"><a href="#cb346-4" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Full_Join1;</span>
<span id="cb346-5"><a href="#cb346-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">merge</span> Jointure (<span class="kw">in</span> = a) Diplome (<span class="kw">in</span> = b);</span>
<span id="cb346-6"><a href="#cb346-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">by</span> identifiant;</span>
<span id="cb346-7"><a href="#cb346-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> a <span class="kw">or</span> b;</span>
<span id="cb346-8"><a href="#cb346-8" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb346-9"><a href="#cb346-9" aria-hidden="true" tabindex="-1"></a><span class="co">/* Le tri préalable des bases de données à joindre n'est pas nécessaire avec la jointure SQL */</span></span>
<span id="cb346-10"><a href="#cb346-10" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb346-11"><a href="#cb346-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">table</span> Full_Join2 <span class="kw">as</span></span>
<span id="cb346-12"><a href="#cb346-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> coalesce(a.identifiant, b.identifiant) <span class="kw">as</span> Identifiant, *</span>
<span id="cb346-13"><a href="#cb346-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> Jointure a full outer join Diplome b <span class="kw">on</span> a.identifiant = b.identifiant</span>
<span id="cb346-14"><a href="#cb346-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">order</span> <span class="kw">by</span> calculated identifiant;</span>
<span id="cb346-15"><a href="#cb346-15" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span>
<span id="cb346-16"><a href="#cb346-16" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> print<span class="kw"> data</span> = Full_Join1 (obs = <span class="dv">10</span>)<span class="kw">;run</span>;</span>
<span id="cb346-17"><a href="#cb346-17" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;<span class="kw">select</span> count(*) <span class="kw">from</span> Full_Join1;<span class="kw">quit</span>;</span>
<span id="cb346-18"><a href="#cb346-18" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;<span class="kw">select</span> count(*) <span class="kw">from</span> Full_Join2;<span class="kw">quit</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-83-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-83-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sont appariés les identifiants des deux bases</span></span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a>fullJoin <span class="ot">&lt;-</span> <span class="fu">merge</span>(jointure_rbase, diplome_rbase, <span class="at">by.x =</span> <span class="st">"identifiant"</span>, <span class="at">by.y =</span> <span class="st">"identifiant"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb347-3"><a href="#cb347-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(fullJoin)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-83-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-83-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb348"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sont appariés les identifiants des deux bases</span></span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a>fullJoin <span class="ot">&lt;-</span> jointure_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(diplome_tidyverse, <span class="at">by =</span> <span class="st">"identifiant"</span>)</span>
<span id="cb348-4"><a href="#cb348-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(fullJoin)</span>
<span id="cb348-5"><a href="#cb348-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb348-6"><a href="#cb348-6" aria-hidden="true" tabindex="-1"></a>fullJoin <span class="ot">&lt;-</span> jointure_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb348-7"><a href="#cb348-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(diplome_tidyverse, <span class="at">by =</span> <span class="fu">join_by</span>(identifiant <span class="sc">==</span> identifiant))</span>
<span id="cb348-8"><a href="#cb348-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(fullJoin)</span>
<span id="cb348-9"><a href="#cb348-9" aria-hidden="true" tabindex="-1"></a>fullJoin <span class="ot">&lt;-</span> <span class="fu">full_join</span>(jointure_tidyverse, diplome_tidyverse, <span class="at">by =</span> <span class="st">"identifiant"</span>)</span>
<span id="cb348-10"><a href="#cb348-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(fullJoin)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-83-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-83-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a>fullJoin <span class="ot">&lt;-</span> <span class="fu">merge</span>(jointure_datatable, diplome_datatable, <span class="at">by.x =</span> <span class="st">"identifiant"</span>, <span class="at">by.y =</span> <span class="st">"identifiant"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(fullJoin)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-83-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-83-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="jointure-de-3-bases-ou-plus-en-une-seule-opération-inner-join" class="level2" data-number="13.6">
<h2 data-number="13.6" class="anchored" data-anchor-id="jointure-de-3-bases-ou-plus-en-une-seule-opération-inner-join"><span class="header-section-number">13.6</span> Jointure de 3 bases ou plus en une seule opération (inner join)</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-84-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-84-1" role="tab" aria-controls="tabset-84-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-84-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-84-2" role="tab" aria-controls="tabset-84-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-84-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-84-3" role="tab" aria-controls="tabset-84-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-84-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-84-4" role="tab" aria-controls="tabset-84-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-84-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-84-5" role="tab" aria-controls="tabset-84-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-84-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-84-1-tab">
<div class="sourceCode" id="cb350"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = Jointure;<span class="kw">by</span> identifiant<span class="kw">;run</span>;</span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = Diplome;<span class="kw">by</span> identifiant<span class="kw">;run</span>;</span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = Entrevue;<span class="kw">by</span> identifiant<span class="kw">;run</span>;</span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Inner_Join3;</span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">merge</span> Jointure (<span class="kw">in</span> = a) Diplome (<span class="kw">in</span> = b) Entrevue (<span class="kw">in</span> = c);</span>
<span id="cb350-6"><a href="#cb350-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">by</span> identifiant;</span>
<span id="cb350-7"><a href="#cb350-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> a <span class="kw">and</span> b <span class="kw">and</span> c;</span>
<span id="cb350-8"><a href="#cb350-8" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb350-9"><a href="#cb350-9" aria-hidden="true" tabindex="-1"></a><span class="co">/* Le tri préalable des bases de données à joindre n'est pas nécessaire avec la jointure SQL */</span></span>
<span id="cb350-10"><a href="#cb350-10" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb350-11"><a href="#cb350-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">table</span> Inner_Join4 <span class="kw">as</span></span>
<span id="cb350-12"><a href="#cb350-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> * <span class="kw">from</span> Jointure a inner join Diplome b <span class="kw">on</span> a.identifiant = b.identifiant</span>
<span id="cb350-13"><a href="#cb350-13" aria-hidden="true" tabindex="-1"></a>                           inner join Entrevue c <span class="kw">on</span> a.identifiant = c.identifiant</span>
<span id="cb350-14"><a href="#cb350-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">order</span> <span class="kw">by</span> a.identifiant;</span>
<span id="cb350-15"><a href="#cb350-15" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span>
<span id="cb350-16"><a href="#cb350-16" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> print<span class="kw"> data</span> = Inner_Join4 (obs = <span class="dv">10</span>)<span class="kw">;run</span>;</span>
<span id="cb350-17"><a href="#cb350-17" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;<span class="kw">select</span> count(*) <span class="kw">from</span> Inner_Join3;<span class="kw">quit</span>;</span>
<span id="cb350-18"><a href="#cb350-18" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;<span class="kw">select</span> count(*) <span class="kw">from</span> Inner_Join4;<span class="kw">quit</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-84-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-84-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Via un inner join</span></span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilisation de la fonction Reduce</span></span>
<span id="cb351-3"><a href="#cb351-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Elle applique successivement (et non simultanément, comme do.call) à tous les éléments d'une liste une fonction</span></span>
<span id="cb351-4"><a href="#cb351-4" aria-hidden="true" tabindex="-1"></a>innerJoin2 <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(<span class="cf">function</span>(x, y) <span class="fu">merge</span>(x, y, <span class="at">all =</span> <span class="cn">FALSE</span>, <span class="at">by.x =</span> <span class="st">"identifiant"</span>, <span class="at">by.y =</span> <span class="st">"identifiant"</span>),</span>
<span id="cb351-5"><a href="#cb351-5" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">list</span>(jointure_rbase, diplome_rbase, entrevue_rbase))</span>
<span id="cb351-6"><a href="#cb351-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(innerJoin2)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-84-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-84-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb352"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Via un inner join</span></span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilisation de la fonction reduce de purrr</span></span>
<span id="cb352-3"><a href="#cb352-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Elle applique successivement (et non simultanément, comme do.call) à tous les éléments d'une liste une fonction</span></span>
<span id="cb352-4"><a href="#cb352-4" aria-hidden="true" tabindex="-1"></a>innerJoin2 <span class="ot">&lt;-</span> <span class="fu">list</span>(jointure_tidyverse, diplome_tidyverse, entrevue_tidyverse) <span class="sc">%&gt;%</span></span>
<span id="cb352-5"><a href="#cb352-5" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">reduce</span>(dplyr<span class="sc">::</span>inner_join, <span class="at">by =</span> <span class="fu">join_by</span>(identifiant <span class="sc">==</span> identifiant))</span>
<span id="cb352-6"><a href="#cb352-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(innerJoin2)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-84-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-84-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilisation de la fonction Reduce : elle applique successivement (et non simultanément, comme do.call) à tous les éléments d'une liste une fonction</span></span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a>innerJoin2 <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(<span class="cf">function</span>(x, y) <span class="fu">merge</span>(x, y, <span class="at">all =</span> <span class="cn">FALSE</span>, <span class="at">by.x =</span> <span class="st">"identifiant"</span>, <span class="at">by.y =</span> <span class="st">"identifiant"</span>),</span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">list</span>(jointure_datatable, diplome_datatable, entrevue_datatable))</span>
<span id="cb353-4"><a href="#cb353-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(innerJoin2)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-84-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-84-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="jointure-sur-inégalités" class="level2" data-number="13.7">
<h2 data-number="13.7" class="anchored" data-anchor-id="jointure-sur-inégalités"><span class="header-section-number">13.7</span> Jointure sur inégalités</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-85-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-85-1" role="tab" aria-controls="tabset-85-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-85-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-85-2" role="tab" aria-controls="tabset-85-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-85-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-85-3" role="tab" aria-controls="tabset-85-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-85-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-85-4" role="tab" aria-controls="tabset-85-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-85-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-85-5" role="tab" aria-controls="tabset-85-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-85-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-85-1-tab">
<div class="sourceCode" id="cb354"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* On associe l'entrevue au contrat au cours duquel elle a eu lieu */</span></span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">table</span> Inner_Join_Inegalite <span class="kw">as</span></span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> *</span>
<span id="cb354-5"><a href="#cb354-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> Jointure a inner join Entrevue b</span>
<span id="cb354-6"><a href="#cb354-6" aria-hidden="true" tabindex="-1"></a>       <span class="kw">on</span> a.identifiant = b.identifiant <span class="kw">and</span> a.date_entree &lt;= b.date_entrevue &lt;= a.date_sortie</span>
<span id="cb354-7"><a href="#cb354-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">order</span> <span class="kw">by</span> a.identifiant;</span>
<span id="cb354-8"><a href="#cb354-8" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span>
<span id="cb354-9"><a href="#cb354-9" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> print<span class="kw"> data</span> = Inner_Join_Inegalite (obs = <span class="dv">10</span>)<span class="kw">;run</span>;</span>
<span id="cb354-10"><a href="#cb354-10" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;<span class="kw">select</span> count(*) <span class="kw">from</span> Inner_Join_Inegalite;<span class="kw">quit</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-85-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-85-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ne semble pas natif en R-Base.</span></span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Une proposition indicative où on applique la sélection après la jointure, ce qui ne doit pas être très efficace ...</span></span>
<span id="cb355-3"><a href="#cb355-3" aria-hidden="true" tabindex="-1"></a>innerJoinInegalite <span class="ot">&lt;-</span> <span class="fu">merge</span>(jointure_rbase, entrevue_rbase, <span class="at">by =</span> <span class="st">"identifiant"</span>)</span>
<span id="cb355-4"><a href="#cb355-4" aria-hidden="true" tabindex="-1"></a>innerJoinInegalite <span class="ot">&lt;-</span> <span class="fu">with</span>(innerJoinInegalite,</span>
<span id="cb355-5"><a href="#cb355-5" aria-hidden="true" tabindex="-1"></a>                           innerJoinInegalite[<span class="fu">which</span>(date_entree <span class="sc">&lt;=</span> date_entrevue <span class="sc">&amp;</span> date_entrevue <span class="sc">&lt;=</span> date_sortie), ])</span>
<span id="cb355-6"><a href="#cb355-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(innerJoinInegalite)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-85-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-85-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb356"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ne semble pas natif en R-Base.</span></span>
<span id="cb356-2"><a href="#cb356-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Une proposition indicative où on applique la sélection après la jointure, ce qui ne doit pas être très efficace ...</span></span>
<span id="cb356-3"><a href="#cb356-3" aria-hidden="true" tabindex="-1"></a>innerJoinInegalite <span class="ot">&lt;-</span> jointure_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb356-4"><a href="#cb356-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(entrevue_tidyverse, <span class="fu">join_by</span>(identifiant <span class="sc">==</span> identifiant,</span>
<span id="cb356-5"><a href="#cb356-5" aria-hidden="true" tabindex="-1"></a>                                         date_entree <span class="sc">&lt;=</span> date_entrevue,</span>
<span id="cb356-6"><a href="#cb356-6" aria-hidden="true" tabindex="-1"></a>                                         date_sortie <span class="sc">&gt;=</span> date_entrevue))</span>
<span id="cb356-7"><a href="#cb356-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(innerJoinInegalite)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-85-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-85-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Attention, l'ordre des conditions doit correspondre à l'ordre des bases dans la jointure !</span></span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Il semble que l'on soit forcé de spécifier tous les noms des colonnes, et ce qui est un peu problématique ...</span></span>
<span id="cb357-3"><a href="#cb357-3" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : Peut-on faire plus simplement ??</span></span>
<span id="cb357-4"><a href="#cb357-4" aria-hidden="true" tabindex="-1"></a>innerJoinInegalite <span class="ot">&lt;-</span> jointure_datatable[entrevue_datatable,</span>
<span id="cb357-5"><a href="#cb357-5" aria-hidden="true" tabindex="-1"></a>                                         .(identifiant, sexe, date_entree, date_sortie, date_entrevue),</span>
<span id="cb357-6"><a href="#cb357-6" aria-hidden="true" tabindex="-1"></a>                                         on <span class="ot">=</span> .(identifiant, date_entree <span class="sc">&lt;=</span> date_entrevue, date_sortie <span class="sc">&gt;=</span> date_entrevue),</span>
<span id="cb357-7"><a href="#cb357-7" aria-hidden="true" tabindex="-1"></a>                                         nomatch <span class="ot">=</span> 0L</span>
<span id="cb357-8"><a href="#cb357-8" aria-hidden="true" tabindex="-1"></a>                                         ][<span class="fu">order</span>(identifiant)]</span>
<span id="cb357-9"><a href="#cb357-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(innerJoinInegalite)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-85-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-85-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="cross-join-toutes-les-combinaisons-possibles-de-csp-sexe-et-diplome" class="level2" data-number="13.8">
<h2 data-number="13.8" class="anchored" data-anchor-id="cross-join-toutes-les-combinaisons-possibles-de-csp-sexe-et-diplome"><span class="header-section-number">13.8</span> Cross join : toutes les combinaisons possibles de CSP, sexe et Diplome</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-86-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-86-1" role="tab" aria-controls="tabset-86-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-86-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-86-2" role="tab" aria-controls="tabset-86-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-86-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-86-3" role="tab" aria-controls="tabset-86-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-86-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-86-4" role="tab" aria-controls="tabset-86-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-86-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-86-5" role="tab" aria-controls="tabset-86-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-86-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-86-1-tab">
<div class="sourceCode" id="cb358"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb358-2"><a href="#cb358-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">table</span> CrossJoin <span class="kw">as</span></span>
<span id="cb358-3"><a href="#cb358-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> *</span>
<span id="cb358-4"><a href="#cb358-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> (<span class="kw">select</span> <span class="kw">distinct</span> CSPF <span class="kw">from</span> donnees_sas)  cross join</span>
<span id="cb358-5"><a href="#cb358-5" aria-hidden="true" tabindex="-1"></a>       (<span class="kw">select</span> <span class="kw">distinct</span> Sexef <span class="kw">from</span> donnees_sas) cross join</span>
<span id="cb358-6"><a href="#cb358-6" aria-hidden="true" tabindex="-1"></a>       (<span class="kw">select</span> <span class="kw">distinct</span> Diplome <span class="kw">from</span> Diplome)</span>
<span id="cb358-7"><a href="#cb358-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">order</span> <span class="kw">by</span> CSPF, Sexef, Diplome;</span>
<span id="cb358-8"><a href="#cb358-8" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span>
<span id="cb358-9"><a href="#cb358-9" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;<span class="kw">select</span> count(*) <span class="kw">from</span> CrossJoin;<span class="kw">quit</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-86-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-86-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Toutes les combinaisons possibles de CSP, sexe et diplome</span></span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a>crossJoin <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">expand.grid</span>(donnees_rbase<span class="sc">$</span>cspf, donnees_rbase<span class="sc">$</span>sexef, diplome_rbase<span class="sc">$</span>diplome))</span>
<span id="cb359-3"><a href="#cb359-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(crossJoin) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cspf"</span>, <span class="st">"sexef"</span>, <span class="st">"diplome"</span>)</span>
<span id="cb359-4"><a href="#cb359-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(crossJoin)</span>
<span id="cb359-5"><a href="#cb359-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb359-6"><a href="#cb359-6" aria-hidden="true" tabindex="-1"></a>crossJoin2 <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">merge</span>(donnees_rbase[, <span class="fu">c</span>(<span class="st">"cspf"</span>, <span class="st">"sexef"</span>)], diplome_rbase[, <span class="st">"diplome"</span>], <span class="at">by =</span> <span class="cn">NULL</span>))</span>
<span id="cb359-7"><a href="#cb359-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(crossJoin2)</span>
<span id="cb359-8"><a href="#cb359-8" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stackoverflow.com/questions/10600060/how-to-do-cross-join-in-r</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-86-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-86-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb360"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Toutes les combinaisons possibles de CSP, sexe et diplome</span></span>
<span id="cb360-2"><a href="#cb360-2" aria-hidden="true" tabindex="-1"></a>crossJoin <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb360-3"><a href="#cb360-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cspf, sexef) <span class="sc">%&gt;%</span> </span>
<span id="cb360-4"><a href="#cb360-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cross_join</span>(diplome_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select</span>(diplome)) <span class="sc">%&gt;%</span> </span>
<span id="cb360-5"><a href="#cb360-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb360-6"><a href="#cb360-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(crossJoin)</span>
<span id="cb360-7"><a href="#cb360-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb360-8"><a href="#cb360-8" aria-hidden="true" tabindex="-1"></a>crossJoin <span class="ot">&lt;-</span> <span class="fu">cross_join</span>(donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select</span>(cspf, sexef), diplome_tidyverse <span class="sc">%&gt;%</span> <span class="fu">select</span>(diplome)) <span class="sc">%&gt;%</span> </span>
<span id="cb360-9"><a href="#cb360-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb360-10"><a href="#cb360-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(crossJoin)</span>
<span id="cb360-11"><a href="#cb360-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb360-12"><a href="#cb360-12" aria-hidden="true" tabindex="-1"></a>crossJoin <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb360-13"><a href="#cb360-13" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">expand</span>(cspf, sexef, diplome_tidyverse<span class="sc">$</span>diplome) <span class="sc">%&gt;%</span></span>
<span id="cb360-14"><a href="#cb360-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb360-15"><a href="#cb360-15" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(crossJoin)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-86-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-86-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb361"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a>crossJoin <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">CJ</span>(donnees_datatable<span class="sc">$</span>cspf, donnees_datatable<span class="sc">$</span>sexef, diplome_datatable<span class="sc">$</span>diplome, <span class="at">unique =</span> <span class="cn">TRUE</span>)</span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(crossJoin) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cspf"</span>, <span class="st">"sexef"</span>, <span class="st">"diplome"</span>)</span>
<span id="cb361-3"><a href="#cb361-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(crossJoin)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-86-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-86-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="juxtaposer-côte-à-côte-deux-bases-de-données" class="level2" data-number="13.9">
<h2 data-number="13.9" class="anchored" data-anchor-id="juxtaposer-côte-à-côte-deux-bases-de-données"><span class="header-section-number">13.9</span> Juxtaposer côte à côte deux bases de données</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-87-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-87-1" role="tab" aria-controls="tabset-87-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-87-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-87-2" role="tab" aria-controls="tabset-87-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-87-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-87-3" role="tab" aria-controls="tabset-87-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-87-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-87-4" role="tab" aria-controls="tabset-87-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-87-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-87-5" role="tab" aria-controls="tabset-87-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-87-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-87-1-tab">
<div class="sourceCode" id="cb362"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* On va ajouter le numéro de la ligne */</span></span>
<span id="cb362-2"><a href="#cb362-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql noprint;<span class="kw">select</span> count(*) <span class="kw">into</span> :tot <span class="kw">from</span> donnees_sas<span class="kw">;run</span>;</span>
<span id="cb362-3"><a href="#cb362-3" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Ajout<span class="kw">;do</span> Num_ligne = <span class="dv">1</span> <span class="kw">to</span> <span class="kw">&amp;tot.</span>;<span class="kw">output;end;run</span>;</span>
<span id="cb362-4"><a href="#cb362-4" aria-hidden="true" tabindex="-1"></a><span class="co">/* Le merge sans by va juxtaposer côte à côte les bases */</span></span>
<span id="cb362-5"><a href="#cb362-5" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Concatener;<span class="kw">merge</span> Ajout donnees_sas<span class="kw">;run</span>;</span>
<span id="cb362-6"><a href="#cb362-6" aria-hidden="true" tabindex="-1"></a><span class="co">/* Si l'une des bases comprend plus de ligne que l'autre, ajout d'une ligne de valeurs manquantes */</span></span>
<span id="cb362-7"><a href="#cb362-7" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql noprint;<span class="kw">select</span> count(*) + <span class="dv">1</span> <span class="kw">into</span> :tot <span class="kw">from</span> donnees_sas<span class="kw">;run</span>;</span>
<span id="cb362-8"><a href="#cb362-8" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Ajout<span class="kw">;do</span> Num_ligne = <span class="dv">1</span> <span class="kw">to</span> <span class="kw">&amp;tot.</span>;<span class="kw">output;end;run</span>;</span>
<span id="cb362-9"><a href="#cb362-9" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Concatener;<span class="kw">merge</span> Ajout donnees_sas<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-87-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-87-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On va ajouter le numéro de la ligne</span></span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a><span class="co"># cbind si les deux bases comprennent le même nombre de lignes</span></span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a>ajout <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">num_ligne =</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(donnees_rbase)))</span>
<span id="cb363-4"><a href="#cb363-4" aria-hidden="true" tabindex="-1"></a>concatener <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ajout, donnees_rbase)</span>
<span id="cb363-5"><a href="#cb363-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Erreur si l'une des bases comprend plus de lignes que l'autre</span></span>
<span id="cb363-6"><a href="#cb363-6" aria-hidden="true" tabindex="-1"></a>ajout <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">num_ligne =</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(donnees_rbase) <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb363-7"><a href="#cb363-7" aria-hidden="true" tabindex="-1"></a><span class="co"># donnees_rbase_ajout &lt;- cbind(ajout, donnees_rbase)</span></span>
<span id="cb363-8"><a href="#cb363-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Proposition de solution</span></span>
<span id="cb363-9"><a href="#cb363-9" aria-hidden="true" tabindex="-1"></a>cbind_alt <span class="ot">&lt;-</span> <span class="cf">function</span>(liste) {</span>
<span id="cb363-10"><a href="#cb363-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Nombre maximal de colonnes dans la liste de dataframes</span></span>
<span id="cb363-11"><a href="#cb363-11" aria-hidden="true" tabindex="-1"></a>  maxCol <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(liste, nrow)))</span>
<span id="cb363-12"><a href="#cb363-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ajout d'une colonne de valeurs manquantes pour toutes les bases ayant moins de ligne que le maximum</span></span>
<span id="cb363-13"><a href="#cb363-13" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">lapply</span>(liste, <span class="cf">function</span>(x) {</span>
<span id="cb363-14"><a href="#cb363-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(maxCol <span class="sc">-</span> <span class="fu">nrow</span>(x))) {</span>
<span id="cb363-15"><a href="#cb363-15" aria-hidden="true" tabindex="-1"></a>      x[<span class="fu">nrow</span>(x) <span class="sc">+</span> i, ] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb363-16"><a href="#cb363-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb363-17"><a href="#cb363-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb363-18"><a href="#cb363-18" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb363-19"><a href="#cb363-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># On joint les résultats</span></span>
<span id="cb363-20"><a href="#cb363-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">do.call</span>(cbind, res))</span>
<span id="cb363-21"><a href="#cb363-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb363-22"><a href="#cb363-22" aria-hidden="true" tabindex="-1"></a>concatener <span class="ot">&lt;-</span> <span class="fu">cbind_alt</span>(<span class="fu">list</span>(ajout, donnees_rbase))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-87-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-87-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb364"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On va ajouter le numéro de la ligne</span></span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a><span class="co"># cbind si les deux bases comprennent le même nombre de lignes</span></span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a>ajout <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">num_ligne =</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(donnees_tidyverse)))</span>
<span id="cb364-4"><a href="#cb364-4" aria-hidden="true" tabindex="-1"></a>concatener <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(ajout)</span>
<span id="cb364-5"><a href="#cb364-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ne fonctionne si l'une des bases comprend plus de lignes que l'autre !</span></span>
<span id="cb364-6"><a href="#cb364-6" aria-hidden="true" tabindex="-1"></a>ajout <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">num_ligne =</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(donnees_tidyverse) <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb364-7"><a href="#cb364-7" aria-hidden="true" tabindex="-1"></a><span class="co">#concatener &lt;- donnees_tidyverse %&gt;% bind_cols(ajout)</span></span>
<span id="cb364-8"><a href="#cb364-8" aria-hidden="true" tabindex="-1"></a><span class="co"># cf. solution proposée dans R-Base</span></span>
<span id="cb364-9"><a href="#cb364-9" aria-hidden="true" tabindex="-1"></a>cbind_alt <span class="ot">&lt;-</span> <span class="cf">function</span>(liste) {</span>
<span id="cb364-10"><a href="#cb364-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Nombre maximal de colonnes dans la liste de dataframes</span></span>
<span id="cb364-11"><a href="#cb364-11" aria-hidden="true" tabindex="-1"></a>  maxCol <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(liste, nrow)))</span>
<span id="cb364-12"><a href="#cb364-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ajout d'une colonne de valeurs manquantes pour toutes les bases ayant moins de ligne que le maximum</span></span>
<span id="cb364-13"><a href="#cb364-13" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">lapply</span>(liste, <span class="cf">function</span>(x) {</span>
<span id="cb364-14"><a href="#cb364-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(maxCol <span class="sc">-</span> <span class="fu">nrow</span>(x))) {</span>
<span id="cb364-15"><a href="#cb364-15" aria-hidden="true" tabindex="-1"></a>      x[<span class="fu">nrow</span>(x) <span class="sc">+</span> i, ] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb364-16"><a href="#cb364-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb364-17"><a href="#cb364-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb364-18"><a href="#cb364-18" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb364-19"><a href="#cb364-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># On joint les résultats</span></span>
<span id="cb364-20"><a href="#cb364-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">bind_cols</span>(res))</span>
<span id="cb364-21"><a href="#cb364-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb364-22"><a href="#cb364-22" aria-hidden="true" tabindex="-1"></a>concatener <span class="ot">&lt;-</span> <span class="fu">cbind_alt</span>(<span class="fu">list</span>(ajout, donnees_tidyverse))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-87-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-87-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb365"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On va ajouter le numéro de la ligne</span></span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a><span class="co"># data.frame::cbind si les deux bases comprennent le même nombre de lignes</span></span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true" tabindex="-1"></a>ajout <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">num_ligne =</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(donnees_datatable)))</span>
<span id="cb365-4"><a href="#cb365-4" aria-hidden="true" tabindex="-1"></a>concatener <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ajout, donnees_datatable)</span>
<span id="cb365-5"><a href="#cb365-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Fonctionne aussi avec des bases comportement un nombre différent de lignes</span></span>
<span id="cb365-6"><a href="#cb365-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Mais attention, le résultat n'est pas le même que sur SAS, il y a recycling</span></span>
<span id="cb365-7"><a href="#cb365-7" aria-hidden="true" tabindex="-1"></a>ajout <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">num_ligne =</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(donnees_datatable) <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb365-8"><a href="#cb365-8" aria-hidden="true" tabindex="-1"></a>concatener <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ajout, donnees_datatable)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-87-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-87-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="empiler-deux-bases-de-données" class="level2" data-number="13.10">
<h2 data-number="13.10" class="anchored" data-anchor-id="empiler-deux-bases-de-données"><span class="header-section-number">13.10</span> Empiler deux bases de données</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-88-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-88-1" role="tab" aria-controls="tabset-88-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-88-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-88-2" role="tab" aria-controls="tabset-88-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-88-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-88-3" role="tab" aria-controls="tabset-88-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-88-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-88-4" role="tab" aria-controls="tabset-88-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-88-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-88-5" role="tab" aria-controls="tabset-88-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-88-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-88-1-tab">
<div class="sourceCode" id="cb366"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* On va empiler la somme des notes en dessous de la base des notes */</span></span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> <span class="fu">var</span> = Identifiant Note_Contenu Note_Formateur Note_Moyens Note_Accompagnement Note_Materiel;</span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a><span class="co">/* On sélectionne un nombre réduit de variables pour simplifier l'exemple */</span></span>
<span id="cb366-4"><a href="#cb366-4" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> var2 = <span class="kw">%sysfunc</span>(<span class="fu">tranwrd</span>(<span class="kw">&amp;var.</span>, Identifiant,));</span>
<span id="cb366-5"><a href="#cb366-5" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Notes;<span class="kw">set</span> donnees_sas (<span class="kw">keep</span> = <span class="kw">&amp;var.</span>)<span class="kw">;run</span>;</span>
<span id="cb366-6"><a href="#cb366-6" aria-hidden="true" tabindex="-1"></a><span class="co">/* Moyenne des notes par individu */</span></span>
<span id="cb366-7"><a href="#cb366-7" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> means<span class="kw"> data</span> = Notes noprint <span class="fu">mean</span>;<span class="fu">var</span> <span class="kw">&amp;var2.</span>;<span class="kw">output</span> out = Ajout <span class="fu">mean</span> = <span class="kw">&amp;var2.;run</span>;</span>
<span id="cb366-8"><a href="#cb366-8" aria-hidden="true" tabindex="-1"></a><span class="co">/* On concatène avec les données. Valeur manquante si les variables ne correspondent pas */</span></span>
<span id="cb366-9"><a href="#cb366-9" aria-hidden="true" tabindex="-1"></a><span class="co">/* L'instruction set permet de concaténer les bases */</span></span>
<span id="cb366-10"><a href="#cb366-10" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Empiler;<span class="kw">set</span> Notes Ajout (<span class="kw">drop</span> = _type_ _freq_)<span class="kw">;run</span>;</span>
<span id="cb366-11"><a href="#cb366-11" aria-hidden="true" tabindex="-1"></a><span class="co">/* Autre solution, proc append */</span></span>
<span id="cb366-12"><a href="#cb366-12" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Empiler;<span class="kw">set</span> Notes<span class="kw">;run</span>;</span>
<span id="cb366-13"><a href="#cb366-13" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> append base = Empiler<span class="kw"> data</span> = Ajout force<span class="kw">;run</span>;</span>
<span id="cb366-14"><a href="#cb366-14" aria-hidden="true" tabindex="-1"></a><span class="co">/* On renomme la ligne des moyennes ajoutée */</span></span>
<span id="cb366-15"><a href="#cb366-15" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Empiler;</span>
<span id="cb366-16"><a href="#cb366-16" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> Empiler nobs = nobs;</span>
<span id="cb366-17"><a href="#cb366-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> _N_ = nobs <span class="kw">then</span> Identifiant = <span class="st">"Moyenne"</span>;</span>
<span id="cb366-18"><a href="#cb366-18" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-88-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-88-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On va empiler la somme des notes en dessous de la base des notes</span></span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Moyenne des notes par individu</span></span>
<span id="cb367-4"><a href="#cb367-4" aria-hidden="true" tabindex="-1"></a>moyennes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">colMeans</span>(donnees_rbase[, varNotes], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb367-5"><a href="#cb367-5" aria-hidden="true" tabindex="-1"></a><span class="co"># On sélectionne la base des notes</span></span>
<span id="cb367-6"><a href="#cb367-6" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> donnees_rbase[, varNotes]</span>
<span id="cb367-7"><a href="#cb367-7" aria-hidden="true" tabindex="-1"></a><span class="co"># rbind lorsque les bases empilées ont le même nombre de colonne</span></span>
<span id="cb367-8"><a href="#cb367-8" aria-hidden="true" tabindex="-1"></a>empiler <span class="ot">&lt;-</span> <span class="fu">rbind</span>(notes, moyennes)</span>
<span id="cb367-9"><a href="#cb367-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Mais, ne fonctionne plus si l'on concatène des bases de taille différente</span></span>
<span id="cb367-10"><a href="#cb367-10" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> donnees_rbase[, <span class="fu">c</span>(<span class="st">"identifiant"</span>, varNotes)]</span>
<span id="cb367-11"><a href="#cb367-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Ne fonctionne pas</span></span>
<span id="cb367-12"><a href="#cb367-12" aria-hidden="true" tabindex="-1"></a><span class="co">#empiler &lt;- rbind(notes, moyennes)</span></span>
<span id="cb367-13"><a href="#cb367-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Une solution alternative, lorsque le nombre de colonnes diffère entre les deux bases</span></span>
<span id="cb367-14"><a href="#cb367-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Lorsque les variables ne correspondent pas, on les crée avec des valeurs manquantes, via setdiff</span></span>
<span id="cb367-15"><a href="#cb367-15" aria-hidden="true" tabindex="-1"></a>rbind_alt <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb367-16"><a href="#cb367-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(<span class="fu">data.frame</span>(<span class="fu">c</span>(x, <span class="fu">sapply</span>(<span class="fu">setdiff</span>(<span class="fu">names</span>(y), <span class="fu">names</span>(x)), <span class="cf">function</span>(z) <span class="cn">NA</span>))),</span>
<span id="cb367-17"><a href="#cb367-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">data.frame</span>(<span class="fu">c</span>(y, <span class="fu">sapply</span>(<span class="fu">setdiff</span>(<span class="fu">names</span>(x), <span class="fu">names</span>(y)), <span class="cf">function</span>(z) <span class="cn">NA</span>)))</span>
<span id="cb367-18"><a href="#cb367-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb367-19"><a href="#cb367-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb367-20"><a href="#cb367-20" aria-hidden="true" tabindex="-1"></a>empiler <span class="ot">&lt;-</span> <span class="fu">rbind_alt</span>(notes, moyennes)</span>
<span id="cb367-21"><a href="#cb367-21" aria-hidden="true" tabindex="-1"></a><span class="co"># On renomme la ligne des moyennes ajoutée</span></span>
<span id="cb367-22"><a href="#cb367-22" aria-hidden="true" tabindex="-1"></a>empiler[<span class="fu">nrow</span>(empiler), <span class="st">"identifiant"</span>] <span class="ot">&lt;-</span> <span class="st">"Moyenne"</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-88-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-88-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb368"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On va empiler la somme des notes en dessous de la base des notes</span></span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Moyenne des notes par individu</span></span>
<span id="cb368-4"><a href="#cb368-4" aria-hidden="true" tabindex="-1"></a>moyennes <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb368-5"><a href="#cb368-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(varNotes, <span class="sc">~</span><span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb368-6"><a href="#cb368-6" aria-hidden="true" tabindex="-1"></a>empiler <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb368-7"><a href="#cb368-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(varNotes)) <span class="sc">%&gt;%</span> </span>
<span id="cb368-8"><a href="#cb368-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(moyennes)</span>
<span id="cb368-9"><a href="#cb368-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fonctionne toujours si l'on concatène des bases de taille différente</span></span>
<span id="cb368-10"><a href="#cb368-10" aria-hidden="true" tabindex="-1"></a>empiler <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb368-11"><a href="#cb368-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(identifiant, <span class="fu">all_of</span>(varNotes)) <span class="sc">%&gt;%</span> </span>
<span id="cb368-12"><a href="#cb368-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(moyennes)</span>
<span id="cb368-13"><a href="#cb368-13" aria-hidden="true" tabindex="-1"></a>empiler <span class="ot">&lt;-</span> empiler <span class="sc">%&gt;%</span> </span>
<span id="cb368-14"><a href="#cb368-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># On renomme la ligne des moyennes ajoutée</span></span>
<span id="cb368-15"><a href="#cb368-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">identifiant =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="fu">nrow</span>(empiler),</span>
<span id="cb368-16"><a href="#cb368-16" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Moyenne"</span>,</span>
<span id="cb368-17"><a href="#cb368-17" aria-hidden="true" tabindex="-1"></a>                              identifiant))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-88-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-88-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb369"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On va empiler la somme des notes en dessous de la base des notes</span></span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Moyenne des notes par individu</span></span>
<span id="cb369-4"><a href="#cb369-4" aria-hidden="true" tabindex="-1"></a>moyennes <span class="ot">&lt;-</span> <span class="fu">data.table</span>(donnees_datatable[, <span class="fu">lapply</span>(.SD, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.SDcols =</span> varNotes])</span>
<span id="cb369-5"><a href="#cb369-5" aria-hidden="true" tabindex="-1"></a><span class="co"># On sélectionne la base des notes</span></span>
<span id="cb369-6"><a href="#cb369-6" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> donnees_datatable[, <span class="fu">mget</span>(<span class="fu">c</span>(<span class="st">"identifiant"</span>, varNotes))]</span>
<span id="cb369-7"><a href="#cb369-7" aria-hidden="true" tabindex="-1"></a>empiler <span class="ot">&lt;-</span> <span class="fu">rbindlist</span>(<span class="fu">list</span>(notes, moyennes), <span class="at">fill =</span> <span class="cn">TRUE</span>)</span>
<span id="cb369-8"><a href="#cb369-8" aria-hidden="true" tabindex="-1"></a><span class="co"># On renomme la ligne des moyennes ajoutée</span></span>
<span id="cb369-9"><a href="#cb369-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set</span>(empiler, <span class="at">i =</span> <span class="fu">nrow</span>(empiler), <span class="at">j =</span> <span class="st">"identifiant"</span>, <span class="at">value =</span> <span class="st">"Moyenne"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-88-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-88-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="ajouter-une-ligne-de-valeurs-manquantes-à-une-base-de-données" class="level2" data-number="13.11">
<h2 data-number="13.11" class="anchored" data-anchor-id="ajouter-une-ligne-de-valeurs-manquantes-à-une-base-de-données"><span class="header-section-number">13.11</span> Ajouter une ligne de valeurs manquantes à une base de données</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-89-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-89-1" role="tab" aria-controls="tabset-89-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-89-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-89-2" role="tab" aria-controls="tabset-89-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-89-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-89-3" role="tab" aria-controls="tabset-89-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-89-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-89-4" role="tab" aria-controls="tabset-89-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-89-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-89-5" role="tab" aria-controls="tabset-89-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-89-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-89-1-tab">
<div class="sourceCode" id="cb370"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Ajout<span class="kw">;run</span>;</span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> Ajout_Missing;<span class="kw">set</span> Jointure Ajout<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-89-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-89-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb371"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a>ajout_na <span class="ot">&lt;-</span> donnees_rbase</span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a>ajout_na[<span class="fu">nrow</span>(ajout_na) <span class="sc">+</span> <span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-89-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-89-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb372"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a>ajout_na <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">tibble</span>(<span class="cn">NA</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-89-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-89-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb373"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a>ajout_na <span class="ot">&lt;-</span> <span class="fu">rbindlist</span>(<span class="fu">list</span>(donnees_datatable, <span class="fu">data.table</span>(<span class="cn">NA</span>)), <span class="at">fill =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-89-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-89-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="semi-join" class="level2" data-number="13.12">
<h2 data-number="13.12" class="anchored" data-anchor-id="semi-join"><span class="header-section-number">13.12</span> Semi join</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-90-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-90-1" role="tab" aria-controls="tabset-90-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-90-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-90-2" role="tab" aria-controls="tabset-90-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-90-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-90-3" role="tab" aria-controls="tabset-90-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-90-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-90-4" role="tab" aria-controls="tabset-90-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-90-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-90-5" role="tab" aria-controls="tabset-90-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-90-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-90-1-tab">
<div class="sourceCode" id="cb374"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Identifiants de la base de gauche qui ont un correspondant dans la base de droite */</span></span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb374-3"><a href="#cb374-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">table</span> Semi_Join <span class="kw">as</span> <span class="kw">select</span> * <span class="kw">from</span> donnees_sas</span>
<span id="cb374-4"><a href="#cb374-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">where</span> Identifiant <span class="kw">in</span> (<span class="kw">select</span> <span class="kw">distinct</span> Identifiant <span class="kw">from</span> Diplome);</span>
<span id="cb374-5"><a href="#cb374-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> count(*) <span class="kw">from</span> Semi_Join;</span>
<span id="cb374-6"><a href="#cb374-6" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span>
<span id="cb374-7"><a href="#cb374-7" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb374-8"><a href="#cb374-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">table</span> Semi_Join <span class="kw">as</span> <span class="kw">select</span> * <span class="kw">from</span> donnees_sas a</span>
<span id="cb374-9"><a href="#cb374-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">where</span> exists (<span class="kw">select</span> * <span class="kw">from</span> Diplome b <span class="kw">where</span> (a.Identifiant = b.Identifiant));</span>
<span id="cb374-10"><a href="#cb374-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> count(*) <span class="kw">from</span> Semi_Join;</span>
<span id="cb374-11"><a href="#cb374-11" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-90-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-90-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb375"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifiants de la base de gauche qui ont un correspondant dans la base de droite</span></span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a>semiJoin <span class="ot">&lt;-</span> donnees_rbase[donnees_rbase<span class="sc">$</span>identifiant <span class="sc">%in%</span> diplome_rbase<span class="sc">$</span>identifiant, ]</span>
<span id="cb375-3"><a href="#cb375-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(semiJoin)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-90-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-90-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb376"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifiants de la base de gauche qui ont un correspondant dans la base de droite</span></span>
<span id="cb376-2"><a href="#cb376-2" aria-hidden="true" tabindex="-1"></a>semiJoin <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb376-3"><a href="#cb376-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(diplome_tidyverse, <span class="fu">join_by</span>(identifiant <span class="sc">==</span> identifiant))</span>
<span id="cb376-4"><a href="#cb376-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(semiJoin)</span>
<span id="cb376-5"><a href="#cb376-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb376-6"><a href="#cb376-6" aria-hidden="true" tabindex="-1"></a>semiJoin <span class="ot">&lt;-</span> <span class="fu">semi_join</span>(donnees_tidyverse, diplome_tidyverse, <span class="fu">join_by</span>(identifiant <span class="sc">==</span> identifiant))</span>
<span id="cb376-7"><a href="#cb376-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(semiJoin)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-90-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-90-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb377"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifiants de la base de gauche qui ont un correspondant dans la base de droite</span></span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true" tabindex="-1"></a>semiJoin <span class="ot">&lt;-</span> donnees_datatable[identifiant <span class="sc">%in%</span> diplome_datatable<span class="sc">$</span>identifiant, ]</span>
<span id="cb377-3"><a href="#cb377-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(semiJoin)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-90-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-90-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="anti-join" class="level2" data-number="13.13">
<h2 data-number="13.13" class="anchored" data-anchor-id="anti-join"><span class="header-section-number">13.13</span> Anti join</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-91-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-91-1" role="tab" aria-controls="tabset-91-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-91-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-91-2" role="tab" aria-controls="tabset-91-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-91-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-91-3" role="tab" aria-controls="tabset-91-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-91-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-91-4" role="tab" aria-controls="tabset-91-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-91-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-91-5" role="tab" aria-controls="tabset-91-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-91-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-91-1-tab">
<div class="sourceCode" id="cb378"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Identifiants de la base de gauche qui n'ont pas de correspondant dans la base de droite */</span></span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">table</span> Anti_Join <span class="kw">as</span> <span class="kw">select</span> * <span class="kw">from</span> donnees_sas</span>
<span id="cb378-4"><a href="#cb378-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">where</span> Identifiant <span class="kw">not</span> <span class="kw">in</span> (<span class="kw">select</span> <span class="kw">distinct</span> Identifiant <span class="kw">from</span> Diplome);</span>
<span id="cb378-5"><a href="#cb378-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> count(*) <span class="kw">from</span> Anti_Join;</span>
<span id="cb378-6"><a href="#cb378-6" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span>
<span id="cb378-7"><a href="#cb378-7" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb378-8"><a href="#cb378-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">create</span> <span class="kw">table</span> Anti_Join <span class="kw">as</span> <span class="kw">select</span> * <span class="kw">from</span> donnees_sas a</span>
<span id="cb378-9"><a href="#cb378-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">where</span> <span class="kw">not</span> exists (<span class="kw">select</span> * <span class="kw">from</span> Diplome b <span class="kw">where</span> (a.Identifiant = b.Identifiant);</span>
<span id="cb378-10"><a href="#cb378-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> count(*) <span class="kw">from</span> Anti_Join;</span>
<span id="cb378-11"><a href="#cb378-11" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-91-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-91-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb379"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifiants de la base de gauche qui n'ont pas de correspondant dans la base de droite</span></span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a>antiJoin <span class="ot">&lt;-</span> donnees_rbase[<span class="sc">!</span> donnees_rbase<span class="sc">$</span>identifiant <span class="sc">%in%</span> diplome_rbase<span class="sc">$</span>identifiant, ]</span>
<span id="cb379-3"><a href="#cb379-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(antiJoin)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-91-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-91-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb380"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifiants de la base de gauche qui n'ont pas de correspondant dans la base de droite</span></span>
<span id="cb380-2"><a href="#cb380-2" aria-hidden="true" tabindex="-1"></a>antiJoin <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb380-3"><a href="#cb380-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(diplome_tidyverse, <span class="fu">join_by</span>(identifiant <span class="sc">==</span> identifiant))</span>
<span id="cb380-4"><a href="#cb380-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(antiJoin)</span>
<span id="cb380-5"><a href="#cb380-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb380-6"><a href="#cb380-6" aria-hidden="true" tabindex="-1"></a>antiJoin <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(donnees_tidyverse, diplome_tidyverse, <span class="fu">join_by</span>(identifiant <span class="sc">==</span> identifiant))</span>
<span id="cb380-7"><a href="#cb380-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(antiJoin)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-91-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-91-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb381"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifiants de la base de gauche qui n'ont pas de correspondant dans la base de droite</span></span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a>antiJoin <span class="ot">&lt;-</span> donnees_datatable[<span class="sc">!</span> identifiant <span class="sc">%in%</span> diplome_datatable<span class="sc">$</span>identifiant, ]</span>
<span id="cb381-3"><a href="#cb381-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(antiJoin)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-91-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-91-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="autres-fonctions-utiles" class="level2" data-number="13.14">
<h2 data-number="13.14" class="anchored" data-anchor-id="autres-fonctions-utiles"><span class="header-section-number">13.14</span> Autres fonctions utiles</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-92-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-92-1" role="tab" aria-controls="tabset-92-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-92-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-92-2" role="tab" aria-controls="tabset-92-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-92-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-92-3" role="tab" aria-controls="tabset-92-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-92-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-92-4" role="tab" aria-controls="tabset-92-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-92-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-92-5" role="tab" aria-controls="tabset-92-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-92-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-92-1-tab">
<div class="sourceCode" id="cb382"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb382-2"><a href="#cb382-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Concaténation des identifiants */</span></span>
<span id="cb382-3"><a href="#cb382-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> Identifiant <span class="kw">from</span> Jointure union all</span>
<span id="cb382-4"><a href="#cb382-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> Identifiant <span class="kw">from</span> Diplome <span class="kw">order</span> <span class="kw">by</span> identifiant;</span>
<span id="cb382-5"><a href="#cb382-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Identifiants uniques des 2 bases */</span></span>
<span id="cb382-6"><a href="#cb382-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> <span class="kw">distinct</span> Identifiant <span class="kw">from</span></span>
<span id="cb382-7"><a href="#cb382-7" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">select</span> <span class="kw">distinct</span> Identifiant <span class="kw">from</span> Jointure union <span class="kw">select</span> <span class="kw">distinct</span> Identifiant <span class="kw">from</span> Diplome)</span>
<span id="cb382-8"><a href="#cb382-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">order</span> <span class="kw">by</span> identifiant;</span>
<span id="cb382-9"><a href="#cb382-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Identifiants communs des 2 bases */</span></span>
<span id="cb382-10"><a href="#cb382-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> Identifiant <span class="kw">from</span> Jointure intersect <span class="kw">select</span> Identifiant <span class="kw">from</span> Diplome</span>
<span id="cb382-11"><a href="#cb382-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">order</span> <span class="kw">by</span> identifiant;</span>
<span id="cb382-12"><a href="#cb382-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Identifiants dans jointure mais pas diplome */</span></span>
<span id="cb382-13"><a href="#cb382-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> <span class="kw">distinct</span> Identifiant <span class="kw">from</span> Jointure <span class="kw">where</span></span>
<span id="cb382-14"><a href="#cb382-14" aria-hidden="true" tabindex="-1"></a>  Identifiant <span class="kw">not</span> <span class="kw">in</span> (<span class="kw">select</span> <span class="kw">distinct</span> Identifiant <span class="kw">from</span> Diplome)</span>
<span id="cb382-15"><a href="#cb382-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">order</span> <span class="kw">by</span> identifiant;</span>
<span id="cb382-16"><a href="#cb382-16" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> Identifiant <span class="kw">from</span> Jointure except <span class="kw">select</span> Identifiant <span class="kw">from</span> Diplome;</span>
<span id="cb382-17"><a href="#cb382-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Identifiants dans diplome mais pas jointure */</span></span>
<span id="cb382-18"><a href="#cb382-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> <span class="kw">distinct</span> Identifiant <span class="kw">from</span> Diplome</span>
<span id="cb382-19"><a href="#cb382-19" aria-hidden="true" tabindex="-1"></a>  <span class="kw">where</span> Identifiant <span class="kw">not</span> <span class="kw">in</span> (<span class="kw">select</span> <span class="kw">distinct</span> Identifiant <span class="kw">from</span> Jointure)</span>
<span id="cb382-20"><a href="#cb382-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">order</span> <span class="kw">by</span> identifiant;</span>
<span id="cb382-21"><a href="#cb382-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> Identifiant <span class="kw">from</span> Diplome except</span>
<span id="cb382-22"><a href="#cb382-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> Identifiant <span class="kw">from</span> Jointure <span class="kw">order</span> <span class="kw">by</span> identifiant;</span>
<span id="cb382-23"><a href="#cb382-23" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-92-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-92-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="co"># base:: permet de s'assurer que les fonctions proviennent de R-Base</span></span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Des fonctions du même nom existent en Tidyverse, et tendent à prédominer si le package est lancé</span></span>
<span id="cb383-3"><a href="#cb383-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concaténation des identifiants avec les doublons</span></span>
<span id="cb383-4"><a href="#cb383-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">c</span>(jointure_rbase<span class="sc">$</span>identifiant, diplome_rbase<span class="sc">$</span>identifiant))</span>
<span id="cb383-5"><a href="#cb383-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifiants uniques des 2 bases</span></span>
<span id="cb383-6"><a href="#cb383-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(base<span class="sc">::</span><span class="fu">union</span>(jointure_rbase<span class="sc">$</span>identifiant, diplome_rbase<span class="sc">$</span>identifiant))</span>
<span id="cb383-7"><a href="#cb383-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(base<span class="sc">::</span><span class="fu">unique</span>(<span class="fu">c</span>(jointure_rbase<span class="sc">$</span>identifiant, diplome_rbase<span class="sc">$</span>identifiant)))</span>
<span id="cb383-8"><a href="#cb383-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifiants communs des 2 bases</span></span>
<span id="cb383-9"><a href="#cb383-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(base<span class="sc">::</span><span class="fu">intersect</span>(jointure_rbase<span class="sc">$</span>identifiant, diplome_rbase<span class="sc">$</span>identifiant))</span>
<span id="cb383-10"><a href="#cb383-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifiants dans jointure mais pas diplome</span></span>
<span id="cb383-11"><a href="#cb383-11" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(base<span class="sc">::</span><span class="fu">setdiff</span>(jointure_rbase<span class="sc">$</span>identifiant, diplome_rbase<span class="sc">$</span>identifiant))</span>
<span id="cb383-12"><a href="#cb383-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifiants dans diplome mais pas jointure</span></span>
<span id="cb383-13"><a href="#cb383-13" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(base<span class="sc">::</span><span class="fu">setdiff</span>(diplome_rbase<span class="sc">$</span>identifiant, jointure_rbase<span class="sc">$</span>identifiant))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-92-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-92-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb384"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dplyr:: permet de s'assurer que ce sont les fonctions du Tidyverse (et non leurs homonymes de R-Base qui sont utilisées)</span></span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concaténation des identifiants</span></span>
<span id="cb384-4"><a href="#cb384-4" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">union_all</span>(jointure_tidyverse<span class="sc">$</span>identifiant, diplome_tidyverse<span class="sc">$</span>identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb384-5"><a href="#cb384-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>()</span>
<span id="cb384-6"><a href="#cb384-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifiants uniques des 2 bases</span></span>
<span id="cb384-7"><a href="#cb384-7" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(dplyr<span class="sc">::</span><span class="fu">union_all</span>(jointure_tidyverse<span class="sc">$</span>identifiant, diplome_tidyverse<span class="sc">$</span>identifiant)) <span class="sc">%&gt;%</span> </span>
<span id="cb384-8"><a href="#cb384-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>()</span>
<span id="cb384-9"><a href="#cb384-9" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">union</span>(jointure_tidyverse<span class="sc">$</span>identifiant, diplome_tidyverse<span class="sc">$</span>identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb384-10"><a href="#cb384-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>()</span>
<span id="cb384-11"><a href="#cb384-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifiants communs des 2 bases</span></span>
<span id="cb384-12"><a href="#cb384-12" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">intersect</span>(jointure_tidyverse<span class="sc">$</span>identifiant, diplome_tidyverse<span class="sc">$</span>identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb384-13"><a href="#cb384-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>()</span>
<span id="cb384-14"><a href="#cb384-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifiants dans jointure mais pas diplome</span></span>
<span id="cb384-15"><a href="#cb384-15" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">setdiff</span>(jointure_tidyverse<span class="sc">$</span>identifiant, diplome_tidyverse<span class="sc">$</span>identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb384-16"><a href="#cb384-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>()</span>
<span id="cb384-17"><a href="#cb384-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifiants dans diplome mais pas jointure</span></span>
<span id="cb384-18"><a href="#cb384-18" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">setdiff</span>(diplome_tidyverse<span class="sc">$</span>identifiant, jointure_tidyverse<span class="sc">$</span>identifiant) <span class="sc">%&gt;%</span> </span>
<span id="cb384-19"><a href="#cb384-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-92-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-92-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Les fonctions spécifiques à data.table fonctionnent avec des formats data.table, d'où la syntaxe un peu différente de R-Base</span></span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-3"><a href="#cb385-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concaténation des identifiants</span></span>
<span id="cb385-4"><a href="#cb385-4" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"identifiant"</span></span>
<span id="cb385-5"><a href="#cb385-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">c</span>(jointure_datatable[[variable]], diplome_datatable[[variable]]))</span>
<span id="cb385-6"><a href="#cb385-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifiants uniques des 2 bases</span></span>
<span id="cb385-7"><a href="#cb385-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">unique</span>(<span class="fu">c</span>(jointure_datatable[[variable]], diplome_datatable[[variable]])))</span>
<span id="cb385-8"><a href="#cb385-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">union</span>(jointure_datatable[[variable]], diplome_datatable[[variable]]))</span>
<span id="cb385-9"><a href="#cb385-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifiants communs des 2 bases</span></span>
<span id="cb385-10"><a href="#cb385-10" aria-hidden="true" tabindex="-1"></a><span class="fu">fintersect</span>(jointure_datatable[, ..variable], diplome_datatable[, ..variable])[<span class="fu">order</span>(identifiant)]</span>
<span id="cb385-11"><a href="#cb385-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifiants dans jointure mais pas diplome</span></span>
<span id="cb385-12"><a href="#cb385-12" aria-hidden="true" tabindex="-1"></a><span class="fu">fsetdiff</span>(jointure_datatable[, ..variable], diplome_datatable[, ..variable])[<span class="fu">order</span>(identifiant)]</span>
<span id="cb385-13"><a href="#cb385-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifiants dans diplome mais pas jointure</span></span>
<span id="cb385-14"><a href="#cb385-14" aria-hidden="true" tabindex="-1"></a><span class="fu">fsetdiff</span>(diplome_datatable[, ..variable], jointure_datatable[, ..variable])[<span class="fu">order</span>(identifiant)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-92-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-92-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
</section>
<section id="statistiques-descriptives" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> Statistiques descriptives</h1>
<section id="moyenne" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="moyenne"><span class="header-section-number">14.1</span> Moyenne</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-93-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-93-1" role="tab" aria-controls="tabset-93-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-93-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-93-2" role="tab" aria-controls="tabset-93-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-93-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-93-3" role="tab" aria-controls="tabset-93-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-93-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-93-4" role="tab" aria-controls="tabset-93-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-93-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-93-5" role="tab" aria-controls="tabset-93-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-93-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-93-1-tab">
<div class="sourceCode" id="cb386"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> means<span class="kw"> data</span> = donnees_sas <span class="fu">mean</span>;<span class="fu">var</span> note_contenu<span class="kw">;run</span>;</span>
<span id="cb386-2"><a href="#cb386-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;<span class="kw">select</span> <span class="fu">mean</span>(note_contenu) <span class="kw">from</span> donnees_sas<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-93-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-93-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb387"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importance du na.rm = TRUE</span></span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(donnees_rbase<span class="sc">$</span>note_contenu)</span>
<span id="cb387-3"><a href="#cb387-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(donnees_rbase<span class="sc">$</span>note_contenu, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-93-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-93-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb388"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importance du na.rm = TRUE</span></span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">pull</span>(note_contenu) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span>
<span id="cb388-3"><a href="#cb388-3" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">pull</span>(note_contenu) <span class="sc">%&gt;%</span> <span class="fu">mean</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb388-4"><a href="#cb388-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb388-5"><a href="#cb388-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Le chiffre est arrondi lorsqu'il est affiché, du fait des propriétés des tibbles</span></span>
<span id="cb388-6"><a href="#cb388-6" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb388-7"><a href="#cb388-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(note_contenu, <span class="sc">~</span><span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb388-8"><a href="#cb388-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Attention, en tidyverse, les syntaxes suivantes ne fonctionnent pas !</span></span>
<span id="cb388-9"><a href="#cb388-9" aria-hidden="true" tabindex="-1"></a><span class="co"># donnees_tidyverse %&gt;% mean(note_formateur)</span></span>
<span id="cb388-10"><a href="#cb388-10" aria-hidden="true" tabindex="-1"></a><span class="co"># donnees_tidyverse %&gt;% mean(note_formateur, na.rm = TRUE)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-93-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-93-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importance du na.rm = TRUE</span></span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">mean</span>(note_contenu)]</span>
<span id="cb389-3"><a href="#cb389-3" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">mean</span>(note_contenu, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-93-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-93-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="moyenne-par-sélection" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="moyenne-par-sélection"><span class="header-section-number">14.2</span> Moyenne par sélection</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-94-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-94-1" role="tab" aria-controls="tabset-94-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-94-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-94-2" role="tab" aria-controls="tabset-94-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-94-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-94-3" role="tab" aria-controls="tabset-94-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-94-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-94-4" role="tab" aria-controls="tabset-94-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-94-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-94-5" role="tab" aria-controls="tabset-94-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-94-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-94-1-tab">
<div class="sourceCode" id="cb390"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Ici pour les seules femmes */</span></span>
<span id="cb390-2"><a href="#cb390-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> means<span class="kw"> data</span> = donnees_sas <span class="fu">mean</span>;</span>
<span id="cb390-3"><a href="#cb390-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> note_contenu;</span>
<span id="cb390-4"><a href="#cb390-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">where</span> sexef = <span class="st">"Femme"</span>;</span>
<span id="cb390-5"><a href="#cb390-5" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-94-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-94-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb391"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ici, pour les seules femmes</span></span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(<span class="fu">subset</span>(donnees_rbase, sexef <span class="sc">==</span> <span class="st">"Femme"</span>), <span class="fu">mean</span>(note_contenu, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-94-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-94-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb392"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ici, pour les seules femmes</span></span>
<span id="cb392-2"><a href="#cb392-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb392-3"><a href="#cb392-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sexef <span class="sc">==</span> <span class="st">"Femme"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb392-4"><a href="#cb392-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(note_contenu) <span class="sc">%&gt;%</span></span>
<span id="cb392-5"><a href="#cb392-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb392-6"><a href="#cb392-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Autres solutions</span></span>
<span id="cb392-7"><a href="#cb392-7" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb392-8"><a href="#cb392-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sexef <span class="sc">==</span> <span class="st">"Femme"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb392-9"><a href="#cb392-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(note_contenu, <span class="sc">~</span> <span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb392-10"><a href="#cb392-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Attention, syntaxe qui ne fonctionne qu'avec %&gt;%, pas avec %&gt;% !</span></span>
<span id="cb392-11"><a href="#cb392-11" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb392-12"><a href="#cb392-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sexef <span class="sc">==</span> <span class="st">"Femme"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb392-13"><a href="#cb392-13" aria-hidden="true" tabindex="-1"></a>  {<span class="fu">mean</span>(.<span class="sc">$</span>note_contenu, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)}</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-94-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-94-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb393"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ici, pour les seules femmes</span></span>
<span id="cb393-2"><a href="#cb393-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[sexef <span class="sc">==</span> <span class="st">"Femme"</span>, <span class="fu">mean</span>(note_contenu, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)]</span>
<span id="cb393-3"><a href="#cb393-3" aria-hidden="true" tabindex="-1"></a>donnees_datatable[sexef <span class="sc">==</span> <span class="st">"Femme"</span>, <span class="fu">lapply</span>(.SD, <span class="cf">function</span>(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), .SDcols <span class="ot">=</span> <span class="st">"note_contenu"</span>]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-94-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-94-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="moyenne-pondérée" class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="moyenne-pondérée"><span class="header-section-number">14.3</span> Moyenne pondérée</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-95-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-95-1" role="tab" aria-controls="tabset-95-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-95-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-95-2" role="tab" aria-controls="tabset-95-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-95-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-95-3" role="tab" aria-controls="tabset-95-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-95-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-95-4" role="tab" aria-controls="tabset-95-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-95-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-95-5" role="tab" aria-controls="tabset-95-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-95-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-95-1-tab">
<div class="sourceCode" id="cb394"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Ensemble des données */</span></span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> means<span class="kw"> data</span> = donnees_sas <span class="fu">mean</span>;</span>
<span id="cb394-3"><a href="#cb394-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> note_contenu;</span>
<span id="cb394-4"><a href="#cb394-4" aria-hidden="true" tabindex="-1"></a>  weight poids_sondage;</span>
<span id="cb394-5"><a href="#cb394-5" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb394-6"><a href="#cb394-6" aria-hidden="true" tabindex="-1"></a><span class="co">/* Par sélection (ici pour les seules femmes) */</span></span>
<span id="cb394-7"><a href="#cb394-7" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> means<span class="kw"> data</span> = donnees_sas <span class="fu">mean</span>;</span>
<span id="cb394-8"><a href="#cb394-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> note_contenu;</span>
<span id="cb394-9"><a href="#cb394-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">where</span> sexef = <span class="st">"Femme"</span>;</span>
<span id="cb394-10"><a href="#cb394-10" aria-hidden="true" tabindex="-1"></a>  weight poids_sondage;</span>
<span id="cb394-11"><a href="#cb394-11" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-95-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-95-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb395"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensemble des données</span></span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true" tabindex="-1"></a><span class="fu">weighted.mean</span>(donnees_rbase<span class="sc">$</span>note_contenu, donnees_rbase<span class="sc">$</span>poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb395-3"><a href="#cb395-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre méthode, mais attention aux NA !!</span></span>
<span id="cb395-4"><a href="#cb395-4" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(donnees_rbase, <span class="fu">sum</span>(note_contenu <span class="sc">*</span> poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>((<span class="sc">!</span><span class="fu">is.na</span>(note_contenu)) <span class="sc">*</span> poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb395-5"><a href="#cb395-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Par sélection (ici pour les seules femmes)</span></span>
<span id="cb395-6"><a href="#cb395-6" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(<span class="fu">subset</span>(donnees_rbase, sexef <span class="sc">==</span> <span class="st">"Femme"</span>), <span class="fu">sum</span>(note_contenu <span class="sc">*</span> poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb395-7"><a href="#cb395-7" aria-hidden="true" tabindex="-1"></a><span class="co"># On peut aussi utiliser la fonction crossprod</span></span>
<span id="cb395-8"><a href="#cb395-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Mais ne fonctionne pas dans ce cas, car elle ne prend pas en compte les na.rm = TRUE</span></span>
<span id="cb395-9"><a href="#cb395-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Ne pas confondre cumprod et crossprod !!!!</span></span>
<span id="cb395-10"><a href="#cb395-10" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(<span class="fu">subset</span>(donnees_rbase, sexef <span class="sc">==</span> <span class="st">"Femme"</span>), <span class="fu">crossprod</span>(note_contenu, poids_sondage) <span class="sc">/</span> <span class="fu">sum</span>(poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-95-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-95-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb396"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensemble des données</span></span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb396-3"><a href="#cb396-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(note_contenu, <span class="sc">~</span><span class="fu">weighted.mean</span>(., <span class="at">w =</span> poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb396-4"><a href="#cb396-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Par sélection</span></span>
<span id="cb396-5"><a href="#cb396-5" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb396-6"><a href="#cb396-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sexef <span class="sc">==</span> <span class="st">"Femme"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb396-7"><a href="#cb396-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(note_contenu, <span class="sc">~</span><span class="fu">weighted.mean</span>(., <span class="at">w =</span> poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-95-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-95-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb397"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensemble des données</span></span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">weighted.mean</span>(note_contenu, poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)]</span>
<span id="cb397-3"><a href="#cb397-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Par sélection (ici pour les seules femmes)</span></span>
<span id="cb397-4"><a href="#cb397-4" aria-hidden="true" tabindex="-1"></a>donnees_datatable[sexef <span class="sc">==</span> <span class="st">"Femme"</span>, <span class="fu">weighted.mean</span>(note_contenu, poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)]</span>
<span id="cb397-5"><a href="#cb397-5" aria-hidden="true" tabindex="-1"></a>donnees_datatable[sexef <span class="sc">==</span> <span class="st">"Femme"</span>, <span class="fu">lapply</span>(.SD, <span class="cf">function</span>(x) <span class="fu">weighted.mean</span>(x, poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb397-6"><a href="#cb397-6" aria-hidden="true" tabindex="-1"></a>                  .SDcols <span class="ot">=</span> <span class="st">"note_contenu"</span>]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-95-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-95-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="moyenne-de-plusieurs-variables" class="level2" data-number="14.4">
<h2 data-number="14.4" class="anchored" data-anchor-id="moyenne-de-plusieurs-variables"><span class="header-section-number">14.4</span> Moyenne de plusieurs variables</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-96-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-96-1" role="tab" aria-controls="tabset-96-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-96-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-96-2" role="tab" aria-controls="tabset-96-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-96-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-96-3" role="tab" aria-controls="tabset-96-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-96-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-96-4" role="tab" aria-controls="tabset-96-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-96-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-96-5" role="tab" aria-controls="tabset-96-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-96-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-96-1-tab">
<div class="sourceCode" id="cb398"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> notes = Note_Contenu Note_Formateur Note_Moyens Note_Accompagnement Note_Materiel;</span>
<span id="cb398-2"><a href="#cb398-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> means<span class="kw"> data</span> = donnees_sas <span class="fu">mean</span>;</span>
<span id="cb398-3"><a href="#cb398-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> <span class="kw">&amp;notes.</span>;</span>
<span id="cb398-4"><a href="#cb398-4" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-96-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-96-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb399"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">c</span>(<span class="st">"Note_Contenu"</span>, <span class="st">"Note_Formateur"</span>, <span class="st">"Note_Moyens"</span>, <span class="st">"Note_Accompagnement"</span>, <span class="st">"Note_Materiel"</span>))</span>
<span id="cb399-2"><a href="#cb399-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Plusieurs solutions</span></span>
<span id="cb399-3"><a href="#cb399-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sous forme de liste</span></span>
<span id="cb399-4"><a href="#cb399-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(donnees_rbase[, notes], mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb399-5"><a href="#cb399-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Sous forme de vecteur</span></span>
<span id="cb399-6"><a href="#cb399-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(donnees_rbase[, notes], mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb399-7"><a href="#cb399-7" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(donnees_rbase[, notes], <span class="dv">2</span>, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb399-8"><a href="#cb399-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Si l'on souhaite renommer les colonnes</span></span>
<span id="cb399-9"><a href="#cb399-9" aria-hidden="true" tabindex="-1"></a>moyennes <span class="ot">&lt;-</span> <span class="fu">sapply</span>(donnees_rbase[, notes], mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb399-10"><a href="#cb399-10" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(moyennes) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Moyenne"</span>, <span class="fu">names</span>(moyennes), <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb399-11"><a href="#cb399-11" aria-hidden="true" tabindex="-1"></a>moyennes</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-96-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-96-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb400"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">c</span>(<span class="st">"Note_Contenu"</span>, <span class="st">"Note_Formateur"</span>, <span class="st">"Note_Moyens"</span>, <span class="st">"Note_Accompagnement"</span>, <span class="st">"Note_Materiel"</span>))</span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb400-3"><a href="#cb400-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(notes, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb400-4"><a href="#cb400-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Autres solutions</span></span>
<span id="cb400-5"><a href="#cb400-5" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb400-6"><a href="#cb400-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(notes), <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb400-7"><a href="#cb400-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Obsolète</span></span>
<span id="cb400-8"><a href="#cb400-8" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span>  </span>
<span id="cb400-9"><a href="#cb400-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"Note"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">ends_with</span>(<span class="st">"_100"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb400-10"><a href="#cb400-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="sc">~</span> <span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.vars =</span> notes)</span>
<span id="cb400-11"><a href="#cb400-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Si l'on souhaite renommer les colonnes</span></span>
<span id="cb400-12"><a href="#cb400-12" aria-hidden="true" tabindex="-1"></a>moyennes <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb400-13"><a href="#cb400-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(notes, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb400-14"><a href="#cb400-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">paste</span>(<span class="st">"Moyenne"</span>, ., <span class="at">sep =</span> <span class="st">"_"</span>))</span>
<span id="cb400-15"><a href="#cb400-15" aria-hidden="true" tabindex="-1"></a>moyennes <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb400-16"><a href="#cb400-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(notes), <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.names =</span> <span class="st">"Moyenne_{.col}"</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-96-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-96-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb401"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">c</span>(<span class="st">"Note_Contenu"</span>, <span class="st">"Note_Formateur"</span>, <span class="st">"Note_Moyens"</span>, <span class="st">"Note_Accompagnement"</span>, <span class="st">"Note_Materiel"</span>))</span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true" tabindex="-1"></a>moyennes <span class="ot">&lt;-</span> donnees_datatable[, <span class="fu">lapply</span>(.SD, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), .SDcols <span class="ot">=</span> notes]</span>
<span id="cb401-3"><a href="#cb401-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Si l'on souhaite renommer les colonnes</span></span>
<span id="cb401-4"><a href="#cb401-4" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(moyennes, notes, <span class="fu">paste</span>(<span class="st">"Moyenne"</span>, notes, <span class="at">sep =</span> <span class="st">"_"</span>))</span>
<span id="cb401-5"><a href="#cb401-5" aria-hidden="true" tabindex="-1"></a>moyennes</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-96-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-96-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="moyenne-pondérée-de-plusieurs-variables" class="level2" data-number="14.5">
<h2 data-number="14.5" class="anchored" data-anchor-id="moyenne-pondérée-de-plusieurs-variables"><span class="header-section-number">14.5</span> Moyenne pondérée de plusieurs variables</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-97-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-97-1" role="tab" aria-controls="tabset-97-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-97-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-97-2" role="tab" aria-controls="tabset-97-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-97-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-97-3" role="tab" aria-controls="tabset-97-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-97-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-97-4" role="tab" aria-controls="tabset-97-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-97-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-97-5" role="tab" aria-controls="tabset-97-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-97-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-97-1-tab">
<div class="sourceCode" id="cb402"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> notes = Note_Contenu Note_Formateur Note_Moyens Note_Accompagnement Note_Materiel;</span>
<span id="cb402-2"><a href="#cb402-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> means<span class="kw"> data</span> = donnees_sas <span class="fu">mean</span>;</span>
<span id="cb402-3"><a href="#cb402-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> <span class="kw">&amp;notes.</span>;</span>
<span id="cb402-4"><a href="#cb402-4" aria-hidden="true" tabindex="-1"></a>  weight poids_sondage;</span>
<span id="cb402-5"><a href="#cb402-5" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-97-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-97-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb403"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(donnees_rbase, <span class="fu">sapply</span>(donnees_rbase[, notes], <span class="cf">function</span>(x) <span class="fu">weighted.mean</span>(x, poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-97-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-97-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb404"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">c</span>(<span class="st">"Note_Contenu"</span>, <span class="st">"Note_Formateur"</span>, <span class="st">"Note_Moyens"</span>, <span class="st">"Note_Accompagnement"</span>, <span class="st">"Note_Materiel"</span>))</span>
<span id="cb404-2"><a href="#cb404-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb404-3"><a href="#cb404-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(notes, <span class="sc">~</span> <span class="fu">weighted.mean</span>(.x, poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb404-4"><a href="#cb404-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb404-5"><a href="#cb404-5" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb404-6"><a href="#cb404-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(notes, <span class="sc">~</span> <span class="fu">weighted.mean</span>(.x, poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-97-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-97-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb405"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a>moyennes <span class="ot">&lt;-</span> donnees_datatable[, <span class="fu">lapply</span>(.SD, <span class="cf">function</span>(x) <span class="fu">weighted.mean</span>(x, poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), .SDcols <span class="ot">=</span> notes]</span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true" tabindex="-1"></a>moyennes</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-97-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-97-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="nombreuses-statistiques-somme-moyenne-médiane-mode-etc." class="level2" data-number="14.6">
<h2 data-number="14.6" class="anchored" data-anchor-id="nombreuses-statistiques-somme-moyenne-médiane-mode-etc."><span class="header-section-number">14.6</span> Nombreuses statistiques (somme, moyenne, médiane, mode, etc.)</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-98-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-98-1" role="tab" aria-controls="tabset-98-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-98-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-98-2" role="tab" aria-controls="tabset-98-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-98-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-98-3" role="tab" aria-controls="tabset-98-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-98-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-98-4" role="tab" aria-controls="tabset-98-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-98-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-98-5" role="tab" aria-controls="tabset-98-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-98-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-98-1-tab">
<div class="sourceCode" id="cb406"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Petite différence avec SAS sur le nombre de lignes du fait des valeurs manquantes */</span></span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a><span class="co">/* Somme, moyenne, médiane, minimum, maximum, variance, écart-type, nombre de données non manquantes (n),</span></span>
<span id="cb406-3"><a href="#cb406-3" aria-hidden="true" tabindex="-1"></a><span class="co">   nombre de données manquantes (nmiss), intervalle, mode */</span></span>
<span id="cb406-4"><a href="#cb406-4" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> notes = Note_Contenu Note_Formateur Note_Moyens Note_Accompagnement Note_Materiel;</span>
<span id="cb406-5"><a href="#cb406-5" aria-hidden="true" tabindex="-1"></a><span class="co">/* Par la proc means, en un seul tableau */</span></span>
<span id="cb406-6"><a href="#cb406-6" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> means<span class="kw"> data</span> = donnees_sas <span class="fu">sum</span> <span class="fu">mean</span> median <span class="fu">min</span> <span class="fu">max</span> <span class="fu">var</span> <span class="fu">std</span> <span class="fu">n</span> <span class="fu">nmiss</span> <span class="fu">range</span> mode;</span>
<span id="cb406-7"><a href="#cb406-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> <span class="kw">&amp;notes.</span>;</span>
<span id="cb406-8"><a href="#cb406-8" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb406-9"><a href="#cb406-9" aria-hidden="true" tabindex="-1"></a><span class="co">/* Par la proc univariate, variable par variable */</span></span>
<span id="cb406-10"><a href="#cb406-10" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> univariate<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb406-11"><a href="#cb406-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> <span class="kw">&amp;notes.</span>;</span>
<span id="cb406-12"><a href="#cb406-12" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-98-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-98-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb407"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Somme, moyenne, médiane, minimum, maximum, variance, écart-type, nombre de données (manquantes et non manquantes),</span></span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombre de valeurs manquantes, Intervalle</span></span>
<span id="cb407-3"><a href="#cb407-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Petite différence avec SAS sur le nombre de lignes du fait des valeurs manquantes</span></span>
<span id="cb407-4"><a href="#cb407-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Une solution pour obtenir le mode est d'utiliser fmode du package collapse</span></span>
<span id="cb407-5"><a href="#cb407-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(collapse)</span>
<span id="cb407-6"><a href="#cb407-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(donnees_rbase[, notes], <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="st">"Somme"</span>      <span class="ot">=</span> <span class="fu">sum</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb407-7"><a href="#cb407-7" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Moyenne"</span>    <span class="ot">=</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb407-8"><a href="#cb407-8" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Médiane"</span>    <span class="ot">=</span> <span class="fu">median</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb407-9"><a href="#cb407-9" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Min"</span>        <span class="ot">=</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb407-10"><a href="#cb407-10" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Max"</span>        <span class="ot">=</span> <span class="fu">max</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb407-11"><a href="#cb407-11" aria-hidden="true" tabindex="-1"></a>                                             <span class="co"># Pour la variance, la somme des carrés est divisée par n - 1, où n est le nombre de données</span></span>
<span id="cb407-12"><a href="#cb407-12" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Variance"</span>   <span class="ot">=</span> <span class="fu">var</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb407-13"><a href="#cb407-13" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Ecart-type"</span> <span class="ot">=</span> <span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb407-14"><a href="#cb407-14" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"N"</span>          <span class="ot">=</span> <span class="fu">length</span>(x),</span>
<span id="cb407-15"><a href="#cb407-15" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"NMiss"</span>      <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(x)),</span>
<span id="cb407-16"><a href="#cb407-16" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Intervalle"</span> <span class="ot">=</span> <span class="fu">max</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb407-17"><a href="#cb407-17" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Mode"</span>       <span class="ot">=</span> collapse<span class="sc">::</span><span class="fu">fmode</span>(x)</span>
<span id="cb407-18"><a href="#cb407-18" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-98-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-98-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb408"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Petite différence avec SAS sur le nombre de lignes du fait des valeurs manquantes</span></span>
<span id="cb408-2"><a href="#cb408-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Une solution pour obtenir le mode est d'utiliser fmode du package collapse</span></span>
<span id="cb408-3"><a href="#cb408-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(collapse)</span>
<span id="cb408-4"><a href="#cb408-4" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">c</span>(<span class="st">"Note_Contenu"</span>, <span class="st">"Note_Formateur"</span>, <span class="st">"Note_Moyens"</span>, <span class="st">"Note_Accompagnement"</span>, <span class="st">"Note_Materiel"</span>))</span>
<span id="cb408-5"><a href="#cb408-5" aria-hidden="true" tabindex="-1"></a>StatsDesc_tidyverse <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb408-6"><a href="#cb408-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb408-7"><a href="#cb408-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Somme      =</span> <span class="fu">sum</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb408-8"><a href="#cb408-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moyenne    =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb408-9"><a href="#cb408-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mediane    =</span> <span class="fu">median</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb408-10"><a href="#cb408-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min        =</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb408-11"><a href="#cb408-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max        =</span> <span class="fu">max</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb408-12"><a href="#cb408-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variance   =</span> <span class="fu">var</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb408-13"><a href="#cb408-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ecart_type =</span> <span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb408-14"><a href="#cb408-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">N          =</span> <span class="fu">length</span>(x),</span>
<span id="cb408-15"><a href="#cb408-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">NMiss      =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(x)),</span>
<span id="cb408-16"><a href="#cb408-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Intervalle =</span> <span class="fu">max</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb408-17"><a href="#cb408-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mode       =</span> collapse<span class="sc">::</span><span class="fu">fmode</span>(x)</span>
<span id="cb408-18"><a href="#cb408-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb408-19"><a href="#cb408-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb408-20"><a href="#cb408-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 1ère solution avec les notes en ligne et les statistiques en colonnes</span></span>
<span id="cb408-21"><a href="#cb408-21" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb408-22"><a href="#cb408-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(notes)) <span class="sc">%&gt;%</span> </span>
<span id="cb408-23"><a href="#cb408-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> <span class="fu">StatsDesc_tidyverse</span>(.x)) <span class="sc">%&gt;%</span> </span>
<span id="cb408-24"><a href="#cb408-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb408-25"><a href="#cb408-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">tibble</span>(<span class="at">Note =</span> <span class="fu">c</span>(notes))) <span class="sc">%&gt;%</span> </span>
<span id="cb408-26"><a href="#cb408-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Note)</span>
<span id="cb408-27"><a href="#cb408-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 2e solution avec les notes en colonne</span></span>
<span id="cb408-28"><a href="#cb408-28" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb408-29"><a href="#cb408-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="fu">across</span>(notes, <span class="sc">~</span> <span class="fu">StatsDesc_tidyverse</span>(.x))) <span class="sc">%&gt;%</span> </span>
<span id="cb408-30"><a href="#cb408-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">tibble</span>(<span class="at">Indicateur =</span> <span class="fu">c</span>(<span class="st">"Somme"</span>, <span class="st">"Moyenne"</span>, <span class="st">"Mediane"</span>, <span class="st">"Min"</span>, <span class="st">"Max"</span>, <span class="st">"Variance"</span>,</span>
<span id="cb408-31"><a href="#cb408-31" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Ecart_type"</span>, <span class="st">"N"</span>, <span class="st">"NMiss"</span>, <span class="st">"Intervalle"</span>, <span class="st">"Mode"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb408-32"><a href="#cb408-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Indicateur)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-98-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-98-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb409"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Petite différence avec SAS sur le nombre de lignes du fait des valeurs manquantes</span></span>
<span id="cb409-2"><a href="#cb409-2" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">c</span>(<span class="st">"Note_Contenu"</span>, <span class="st">"Note_Formateur"</span>, <span class="st">"Note_Moyens"</span>, <span class="st">"Note_Accompagnement"</span>, <span class="st">"Note_Materiel"</span>))</span>
<span id="cb409-3"><a href="#cb409-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Une solution pour obtenir le mode est d'utiliser fmode du package collapse</span></span>
<span id="cb409-4"><a href="#cb409-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(collapse)</span>
<span id="cb409-5"><a href="#cb409-5" aria-hidden="true" tabindex="-1"></a>moyennes <span class="ot">&lt;-</span> donnees_datatable[, <span class="fu">lapply</span>(.SD, <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="fu">sum</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb409-6"><a href="#cb409-6" aria-hidden="true" tabindex="-1"></a>                                                          <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb409-7"><a href="#cb409-7" aria-hidden="true" tabindex="-1"></a>                                                          <span class="fu">median</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb409-8"><a href="#cb409-8" aria-hidden="true" tabindex="-1"></a>                                                          <span class="fu">min</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb409-9"><a href="#cb409-9" aria-hidden="true" tabindex="-1"></a>                                                          <span class="fu">max</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb409-10"><a href="#cb409-10" aria-hidden="true" tabindex="-1"></a>                                                          <span class="fu">var</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb409-11"><a href="#cb409-11" aria-hidden="true" tabindex="-1"></a>                                                          <span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb409-12"><a href="#cb409-12" aria-hidden="true" tabindex="-1"></a>                                                          .N,</span>
<span id="cb409-13"><a href="#cb409-13" aria-hidden="true" tabindex="-1"></a>                                                          <span class="fu">sum</span>(<span class="fu">is.na</span>(x)),</span>
<span id="cb409-14"><a href="#cb409-14" aria-hidden="true" tabindex="-1"></a>                                                          <span class="fu">max</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb409-15"><a href="#cb409-15" aria-hidden="true" tabindex="-1"></a>                                                          collapse<span class="sc">::</span><span class="fu">fmode</span>(x)</span>
<span id="cb409-16"><a href="#cb409-16" aria-hidden="true" tabindex="-1"></a>                                                          )),</span>
<span id="cb409-17"><a href="#cb409-17" aria-hidden="true" tabindex="-1"></a>                              .SDcols <span class="ot">=</span> notes]</span>
<span id="cb409-18"><a href="#cb409-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">data.table</span>(<span class="at">Nom =</span> <span class="fu">c</span>(<span class="st">"Somme"</span>, <span class="st">"Moyenne"</span>, <span class="st">"Médiane"</span>, <span class="st">"Min"</span>, <span class="st">"Max"</span>, <span class="st">"Variance"</span>, <span class="st">"Ecart_type"</span>, <span class="st">"N"</span>, <span class="st">"NMiss"</span>, <span class="st">"Intervalle"</span>, <span class="st">"Mode"</span>)), moyennes)</span>
<span id="cb409-19"><a href="#cb409-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb409-20"><a href="#cb409-20" aria-hidden="true" tabindex="-1"></a>StatsDesc <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb409-21"><a href="#cb409-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb409-22"><a href="#cb409-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable   =</span> <span class="fu">names</span>(x),</span>
<span id="cb409-23"><a href="#cb409-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Somme      =</span> <span class="fu">lapply</span>(x, sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb409-24"><a href="#cb409-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moyenne    =</span> <span class="fu">lapply</span>(x, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb409-25"><a href="#cb409-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mediane    =</span> <span class="fu">lapply</span>(x, median, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb409-26"><a href="#cb409-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min        =</span> <span class="fu">lapply</span>(x, min, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb409-27"><a href="#cb409-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max        =</span> <span class="fu">lapply</span>(x, max, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb409-28"><a href="#cb409-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variance   =</span> <span class="fu">lapply</span>(x, var, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb409-29"><a href="#cb409-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ecart_type =</span> <span class="fu">lapply</span>(x, sd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb409-30"><a href="#cb409-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">N          =</span> <span class="fu">lapply</span>(x, <span class="cf">function</span>(x) <span class="fu">length</span>(x)),</span>
<span id="cb409-31"><a href="#cb409-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">NMiss      =</span> <span class="fu">lapply</span>(x, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x))),</span>
<span id="cb409-32"><a href="#cb409-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">Intervalle =</span> <span class="fu">lapply</span>(x, <span class="cf">function</span>(x) <span class="fu">max</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb409-33"><a href="#cb409-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mode       =</span> <span class="fu">lapply</span>(x, collapse<span class="sc">::</span>fmode)</span>
<span id="cb409-34"><a href="#cb409-34" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb409-35"><a href="#cb409-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb409-36"><a href="#cb409-36" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">StatsDesc</span>(.SD), .SDcols <span class="ot">=</span> notes]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-98-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-98-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="nombreuses-statistiques-pondérées-somme-moyenne-médiane-mode-etc." class="level2" data-number="14.7">
<h2 data-number="14.7" class="anchored" data-anchor-id="nombreuses-statistiques-pondérées-somme-moyenne-médiane-mode-etc."><span class="header-section-number">14.7</span> Nombreuses statistiques pondérées (somme, moyenne, médiane, mode, etc.)</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-99-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-99-1" role="tab" aria-controls="tabset-99-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-99-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-99-2" role="tab" aria-controls="tabset-99-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-99-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-99-3" role="tab" aria-controls="tabset-99-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-99-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-99-4" role="tab" aria-controls="tabset-99-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-99-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-99-5" role="tab" aria-controls="tabset-99-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-99-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-99-1-tab">
<div class="sourceCode" id="cb410"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Somme, moyenne, médiane, minimum, maximum, variance, écart-type, nombre de données non manquantes (n),</span></span>
<span id="cb410-2"><a href="#cb410-2" aria-hidden="true" tabindex="-1"></a><span class="co">   nombre de données manquantes (nmiss), intervalle, mode */</span></span>
<span id="cb410-3"><a href="#cb410-3" aria-hidden="true" tabindex="-1"></a><span class="co">/* Par la proc means, en un seul tableau */</span></span>
<span id="cb410-4"><a href="#cb410-4" aria-hidden="true" tabindex="-1"></a><span class="co">/* L'option vardef = wgt permet de diviser la variable par la somme des poids et non le nombre de données, pour être cohérent</span></span>
<span id="cb410-5"><a href="#cb410-5" aria-hidden="true" tabindex="-1"></a><span class="co">   avec R */</span></span>
<span id="cb410-6"><a href="#cb410-6" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> notes = Note_Contenu Note_Formateur Note_Moyens Note_Accompagnement Note_Materiel;</span>
<span id="cb410-7"><a href="#cb410-7" aria-hidden="true" tabindex="-1"></a><span class="co">/* Par la proc means, en un seul tableau */</span></span>
<span id="cb410-8"><a href="#cb410-8" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> means<span class="kw"> data</span> = donnees_sas <span class="fu">sum</span> <span class="fu">mean</span> median <span class="fu">min</span> <span class="fu">max</span> <span class="fu">var</span> <span class="fu">std</span> <span class="fu">n</span> <span class="fu">nmiss</span> <span class="fu">range</span> mode vardef = wgt;</span>
<span id="cb410-9"><a href="#cb410-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> <span class="kw">&amp;notes.</span>;</span>
<span id="cb410-10"><a href="#cb410-10" aria-hidden="true" tabindex="-1"></a>  weight poids_sondage;</span>
<span id="cb410-11"><a href="#cb410-11" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb410-12"><a href="#cb410-12" aria-hidden="true" tabindex="-1"></a><span class="co">/* Par la proc univariate, variable par variable */</span></span>
<span id="cb410-13"><a href="#cb410-13" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> univariate<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb410-14"><a href="#cb410-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> <span class="kw">&amp;notes.</span>;</span>
<span id="cb410-15"><a href="#cb410-15" aria-hidden="true" tabindex="-1"></a>  weight poids_sondage;</span>
<span id="cb410-16"><a href="#cb410-16" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-99-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-99-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb411"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb411-1"><a href="#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Une solution pour obtenir les résultats pondérés est d'utiliser les fonctions du package collapse</span></span>
<span id="cb411-2"><a href="#cb411-2" aria-hidden="true" tabindex="-1"></a><span class="co"># L'option na.rm est par défaut à TRUE dans le package</span></span>
<span id="cb411-3"><a href="#cb411-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(collapse)</span>
<span id="cb411-4"><a href="#cb411-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(donnees_rbase[, notes], <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="st">"Somme"</span>      <span class="ot">=</span> collapse<span class="sc">::</span><span class="fu">fsum</span>(x, <span class="at">w =</span> donnees_rbase<span class="sc">$</span>poids_sondage),</span>
<span id="cb411-5"><a href="#cb411-5" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Moyenne"</span>    <span class="ot">=</span> collapse<span class="sc">::</span><span class="fu">fmean</span>(x, <span class="at">w =</span> donnees_rbase<span class="sc">$</span>poids_sondage),</span>
<span id="cb411-6"><a href="#cb411-6" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Médiane"</span>    <span class="ot">=</span> collapse<span class="sc">::</span><span class="fu">fmedian</span>(x, <span class="at">w =</span> donnees_rbase<span class="sc">$</span>poids_sondage),</span>
<span id="cb411-7"><a href="#cb411-7" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Min"</span>        <span class="ot">=</span> collapse<span class="sc">::</span><span class="fu">fmin</span>(x),</span>
<span id="cb411-8"><a href="#cb411-8" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Max"</span>        <span class="ot">=</span> collapse<span class="sc">::</span><span class="fu">fmax</span>(x),</span>
<span id="cb411-9"><a href="#cb411-9" aria-hidden="true" tabindex="-1"></a>                                             <span class="co"># Pour la variance, la somme des carrés est divisée par n - 1, où n est le nombre de données</span></span>
<span id="cb411-10"><a href="#cb411-10" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Variance"</span>   <span class="ot">=</span> collapse<span class="sc">::</span><span class="fu">fvar</span>(x, <span class="at">w =</span> donnees_rbase<span class="sc">$</span>poids_sondage),</span>
<span id="cb411-11"><a href="#cb411-11" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Ecart-type"</span> <span class="ot">=</span> collapse<span class="sc">::</span><span class="fu">fsd</span>(x, <span class="at">w =</span> donnees_rbase<span class="sc">$</span>poids_sondage),</span>
<span id="cb411-12"><a href="#cb411-12" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"N"</span>          <span class="ot">=</span> collapse<span class="sc">::</span><span class="fu">fnobs</span>(x),</span>
<span id="cb411-13"><a href="#cb411-13" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"NMiss"</span>      <span class="ot">=</span> collapse<span class="sc">::</span><span class="fu">fnobs</span>(<span class="fu">is.na</span>(x)),</span>
<span id="cb411-14"><a href="#cb411-14" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Intervalle"</span> <span class="ot">=</span> collapse<span class="sc">::</span><span class="fu">fmax</span>(x) <span class="sc">-</span> collapse<span class="sc">::</span><span class="fu">fmin</span>(x),</span>
<span id="cb411-15"><a href="#cb411-15" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Mode"</span>       <span class="ot">=</span> collapse<span class="sc">::</span><span class="fu">fmode</span>(x, <span class="at">w =</span> donnees_rbase<span class="sc">$</span>poids_sondage)</span>
<span id="cb411-16"><a href="#cb411-16" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-99-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-99-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb412"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Une solution pour obtenir les résultats pondérés est d'utiliser les fonctions du package collapse</span></span>
<span id="cb412-2"><a href="#cb412-2" aria-hidden="true" tabindex="-1"></a><span class="co"># L'option na.rm est par défaut à TRUE dans le package</span></span>
<span id="cb412-3"><a href="#cb412-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(collapse)</span>
<span id="cb412-4"><a href="#cb412-4" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">c</span>(<span class="st">"Note_Contenu"</span>, <span class="st">"Note_Formateur"</span>, <span class="st">"Note_Moyens"</span>, <span class="st">"Note_Accompagnement"</span>, <span class="st">"Note_Materiel"</span>))</span>
<span id="cb412-5"><a href="#cb412-5" aria-hidden="true" tabindex="-1"></a>StatsDescPond_tidyverse <span class="ot">&lt;-</span> <span class="cf">function</span>(x, w) {</span>
<span id="cb412-6"><a href="#cb412-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb412-7"><a href="#cb412-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Somme      =</span> collapse<span class="sc">::</span><span class="fu">fsum</span>(x, w),</span>
<span id="cb412-8"><a href="#cb412-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moyenne    =</span> collapse<span class="sc">::</span><span class="fu">fmean</span>(x, w),</span>
<span id="cb412-9"><a href="#cb412-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mediane    =</span> collapse<span class="sc">::</span><span class="fu">fmedian</span>(x, w),</span>
<span id="cb412-10"><a href="#cb412-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min        =</span> collapse<span class="sc">::</span><span class="fu">fmin</span>(x),</span>
<span id="cb412-11"><a href="#cb412-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max        =</span> collapse<span class="sc">::</span><span class="fu">fmax</span>(x),</span>
<span id="cb412-12"><a href="#cb412-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variance   =</span> collapse<span class="sc">::</span><span class="fu">fvar</span>(x, w),</span>
<span id="cb412-13"><a href="#cb412-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ecart_type =</span> collapse<span class="sc">::</span><span class="fu">fsd</span>(x, w),</span>
<span id="cb412-14"><a href="#cb412-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">N          =</span> collapse<span class="sc">::</span><span class="fu">fnobs</span>(x),</span>
<span id="cb412-15"><a href="#cb412-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">NMiss      =</span> collapse<span class="sc">::</span><span class="fu">fnobs</span>(<span class="fu">is.na</span>(x)),</span>
<span id="cb412-16"><a href="#cb412-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Intervalle =</span> collapse<span class="sc">::</span><span class="fu">fmax</span>(x) <span class="sc">-</span> collapse<span class="sc">::</span><span class="fu">fmin</span>(x),</span>
<span id="cb412-17"><a href="#cb412-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mode       =</span> collapse<span class="sc">::</span><span class="fu">fmode</span>(x, w)</span>
<span id="cb412-18"><a href="#cb412-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb412-19"><a href="#cb412-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb412-20"><a href="#cb412-20" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : Comment faire cela ???</span></span>
<span id="cb412-21"><a href="#cb412-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Tous les codes suivants ne fonctionnent pas !</span></span>
<span id="cb412-22"><a href="#cb412-22" aria-hidden="true" tabindex="-1"></a><span class="co">#donnees_tidyverse %&gt;%</span></span>
<span id="cb412-23"><a href="#cb412-23" aria-hidden="true" tabindex="-1"></a><span class="co">#  reframe(across(notes, ~ StatsDescPond_tidyverse(.x, 10))) %&gt;% </span></span>
<span id="cb412-24"><a href="#cb412-24" aria-hidden="true" tabindex="-1"></a><span class="co">#  bind_cols(tibble(Indicateur = c("Somme", "Moyenne", "Mediane", "Min", "Max", "Variance",</span></span>
<span id="cb412-25"><a href="#cb412-25" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  "Ecart_type", "N", "NMiss", "Intervalle", "Mode"))) %&gt;% </span></span>
<span id="cb412-26"><a href="#cb412-26" aria-hidden="true" tabindex="-1"></a><span class="co">#  relocate(Indicateur)</span></span>
<span id="cb412-27"><a href="#cb412-27" aria-hidden="true" tabindex="-1"></a><span class="co">#donnees_tidyverse %&gt;% </span></span>
<span id="cb412-28"><a href="#cb412-28" aria-hidden="true" tabindex="-1"></a><span class="co">#  select(all_of(notes), poids_sondage) %&gt;% </span></span>
<span id="cb412-29"><a href="#cb412-29" aria-hidden="true" tabindex="-1"></a><span class="co">#  map(all_of(notes), ~ StatsDescPond_tidyverse(.x, poids_sondage)) %&gt;% </span></span>
<span id="cb412-30"><a href="#cb412-30" aria-hidden="true" tabindex="-1"></a><span class="co">#  bind_rows() %&gt;% </span></span>
<span id="cb412-31"><a href="#cb412-31" aria-hidden="true" tabindex="-1"></a><span class="co">#  bind_cols(tibble(Note = c(notes))) %&gt;% </span></span>
<span id="cb412-32"><a href="#cb412-32" aria-hidden="true" tabindex="-1"></a><span class="co">#  relocate(Note)</span></span>
<span id="cb412-33"><a href="#cb412-33" aria-hidden="true" tabindex="-1"></a><span class="co">#donnees_tidyverse %&gt;% </span></span>
<span id="cb412-34"><a href="#cb412-34" aria-hidden="true" tabindex="-1"></a><span class="co">#  select(all_of(notes), poids_sondage) %&gt;% </span></span>
<span id="cb412-35"><a href="#cb412-35" aria-hidden="true" tabindex="-1"></a><span class="co">#  map(~StatsDescPond_tidyverse(.x, donnees_tidyverse$poids_sondage) )</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-99-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-99-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb413"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Une solution pour obtenir les résultats pondérés est d'utiliser les fonctions du package collapse</span></span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true" tabindex="-1"></a><span class="co"># L'option na.rm est par défaut à TRUE dans le package</span></span>
<span id="cb413-3"><a href="#cb413-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(collapse)</span>
<span id="cb413-4"><a href="#cb413-4" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : y-a-t-il plus simple ???</span></span>
<span id="cb413-5"><a href="#cb413-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Est-on obligés d'utiliser systématiquement donnees_datatable$poids_sondage ?</span></span>
<span id="cb413-6"><a href="#cb413-6" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">c</span>(<span class="st">"Note_Contenu"</span>, <span class="st">"Note_Formateur"</span>, <span class="st">"Note_Moyens"</span>, <span class="st">"Note_Accompagnement"</span>, <span class="st">"Note_Materiel"</span>))</span>
<span id="cb413-7"><a href="#cb413-7" aria-hidden="true" tabindex="-1"></a>StatsDescPond <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb413-8"><a href="#cb413-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb413-9"><a href="#cb413-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variables  =</span> <span class="fu">names</span>(x),</span>
<span id="cb413-10"><a href="#cb413-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Somme      =</span> <span class="fu">lapply</span>(x, collapse<span class="sc">::</span>fsum, <span class="at">w =</span> donnees_datatable<span class="sc">$</span>poids_sondage),</span>
<span id="cb413-11"><a href="#cb413-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moyenne    =</span> <span class="fu">lapply</span>(x, collapse<span class="sc">::</span>fmean, <span class="at">w =</span> donnees_datatable<span class="sc">$</span>poids_sondage),</span>
<span id="cb413-12"><a href="#cb413-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mediane    =</span> <span class="fu">lapply</span>(x, collapse<span class="sc">::</span>fmedian, <span class="at">w =</span> donnees_datatable<span class="sc">$</span>poids_sondage),</span>
<span id="cb413-13"><a href="#cb413-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min        =</span> <span class="fu">lapply</span>(x, collapse<span class="sc">::</span>fmin),</span>
<span id="cb413-14"><a href="#cb413-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max        =</span> <span class="fu">lapply</span>(x, collapse<span class="sc">::</span>fmax),</span>
<span id="cb413-15"><a href="#cb413-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variance   =</span> <span class="fu">lapply</span>(x, collapse<span class="sc">::</span>fvar, <span class="at">w =</span> donnees_datatable<span class="sc">$</span>poids_sondage),</span>
<span id="cb413-16"><a href="#cb413-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ecart_type =</span> <span class="fu">lapply</span>(x, collapse<span class="sc">::</span>fsd, <span class="at">w =</span> donnees_datatable<span class="sc">$</span>poids_sondage),</span>
<span id="cb413-17"><a href="#cb413-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">N          =</span> <span class="fu">lapply</span>(x, collapse<span class="sc">::</span>fnobs),</span>
<span id="cb413-18"><a href="#cb413-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">NMiss      =</span> <span class="fu">lapply</span>(x, <span class="cf">function</span>(x) collapse<span class="sc">::</span><span class="fu">fnobs</span>(<span class="fu">is.na</span>(x))),</span>
<span id="cb413-19"><a href="#cb413-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Intervalle =</span> <span class="fu">lapply</span>(x, <span class="cf">function</span>(x) collapse<span class="sc">::</span><span class="fu">fmax</span>(x) <span class="sc">-</span> collapse<span class="sc">::</span><span class="fu">fmin</span>(x)),</span>
<span id="cb413-20"><a href="#cb413-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mode       =</span> <span class="fu">lapply</span>(x, collapse<span class="sc">::</span>fmode, <span class="at">w =</span> donnees_datatable<span class="sc">$</span>poids_sondage)</span>
<span id="cb413-21"><a href="#cb413-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb413-22"><a href="#cb413-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb413-23"><a href="#cb413-23" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">StatsDescPond</span>(.SD), .SDcols <span class="ot">=</span> notes]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-99-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-99-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="calcul-dune-variance-pondérée" class="level2" data-number="14.8">
<h2 data-number="14.8" class="anchored" data-anchor-id="calcul-dune-variance-pondérée"><span class="header-section-number">14.8</span> Calcul d’une variance pondérée</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-100-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-100-1" role="tab" aria-controls="tabset-100-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-100-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-100-2" role="tab" aria-controls="tabset-100-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-100-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-100-3" role="tab" aria-controls="tabset-100-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-100-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-100-4" role="tab" aria-controls="tabset-100-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-100-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-100-5" role="tab" aria-controls="tabset-100-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-100-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-100-1-tab">
<div class="sourceCode" id="cb414"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> means<span class="kw"> data</span> = donnees_sas <span class="fu">var</span> vardef = wgt;</span>
<span id="cb414-2"><a href="#cb414-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> note_contenu;</span>
<span id="cb414-3"><a href="#cb414-3" aria-hidden="true" tabindex="-1"></a>  weight poids_sondage;</span>
<span id="cb414-4"><a href="#cb414-4" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-100-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-100-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb415"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(collapse)</span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(donnees_rbase, collapse<span class="sc">::</span><span class="fu">fvar</span>(note_contenu, <span class="at">w =</span> poids_sondage))</span>
<span id="cb415-3"><a href="#cb415-3" aria-hidden="true" tabindex="-1"></a><span class="co"># On la calcule "manuellement" pour confirmer le résultat</span></span>
<span id="cb415-4"><a href="#cb415-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Formule : S_i{w_i * x_i**2} / S_i{w_i} - x_m**2</span></span>
<span id="cb415-5"><a href="#cb415-5" aria-hidden="true" tabindex="-1"></a>x_2 <span class="ot">&lt;-</span> <span class="fu">with</span>(donnees_rbase,</span>
<span id="cb415-6"><a href="#cb415-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">sum</span>(poids_sondage <span class="sc">*</span> note_contenu<span class="sc">**</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">complete.cases</span>(note_contenu, poids_sondage), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb415-7"><a href="#cb415-7" aria-hidden="true" tabindex="-1"></a>x_m <span class="ot">&lt;-</span> <span class="fu">with</span>(donnees_rbase,</span>
<span id="cb415-8"><a href="#cb415-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">sum</span>(poids_sondage <span class="sc">*</span> note_contenu <span class="sc">*</span> <span class="fu">complete.cases</span>(note_contenu, poids_sondage), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb415-9"><a href="#cb415-9" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">with</span>(donnees_rbase,</span>
<span id="cb415-10"><a href="#cb415-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">sum</span>(poids_sondage <span class="sc">*</span> <span class="fu">complete.cases</span>(note_contenu, poids_sondage), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb415-11"><a href="#cb415-11" aria-hidden="true" tabindex="-1"></a>x_2 <span class="sc">/</span> p <span class="sc">-</span> (x_m <span class="sc">/</span> p) <span class="sc">**</span> <span class="dv">2</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-100-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-100-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb416"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(collapse)</span>
<span id="cb416-2"><a href="#cb416-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb416-3"><a href="#cb416-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">var =</span> collapse<span class="sc">::</span><span class="fu">fvar</span>(note_contenu, <span class="at">w =</span> poids_sondage))</span>
<span id="cb416-4"><a href="#cb416-4" aria-hidden="true" tabindex="-1"></a><span class="co"># On la calcule "manuellement" pour confirmer le résultat</span></span>
<span id="cb416-5"><a href="#cb416-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Formule : S_i{w_i * x_i**2} / S_i{w_i} - x_m**2</span></span>
<span id="cb416-6"><a href="#cb416-6" aria-hidden="true" tabindex="-1"></a>x_2 <span class="ot">&lt;-</span> <span class="fu">with</span>(donnees_tidyverse,</span>
<span id="cb416-7"><a href="#cb416-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">sum</span>(poids_sondage <span class="sc">*</span> note_contenu<span class="sc">**</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">complete.cases</span>(note_contenu, poids_sondage), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb416-8"><a href="#cb416-8" aria-hidden="true" tabindex="-1"></a>x_m <span class="ot">&lt;-</span> <span class="fu">with</span>(donnees_tidyverse,</span>
<span id="cb416-9"><a href="#cb416-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">sum</span>(poids_sondage <span class="sc">*</span> note_contenu <span class="sc">*</span> <span class="fu">complete.cases</span>(note_contenu, poids_sondage), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb416-10"><a href="#cb416-10" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">with</span>(donnees_tidyverse,</span>
<span id="cb416-11"><a href="#cb416-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">sum</span>(poids_sondage <span class="sc">*</span> <span class="fu">complete.cases</span>(note_contenu, poids_sondage), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb416-12"><a href="#cb416-12" aria-hidden="true" tabindex="-1"></a>x_2 <span class="sc">/</span> p <span class="sc">-</span> (x_m <span class="sc">/</span> p) <span class="sc">**</span> <span class="dv">2</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-100-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-100-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb417"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(collapse)</span>
<span id="cb417-2"><a href="#cb417-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, collapse<span class="sc">::</span><span class="fu">fvar</span>(note_contenu, <span class="at">w =</span> poids_sondage)]</span>
<span id="cb417-3"><a href="#cb417-3" aria-hidden="true" tabindex="-1"></a><span class="co"># On la calcule "manuellement" pour confirmer le résultat</span></span>
<span id="cb417-4"><a href="#cb417-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Formule : S_i{w_i * x_i**2} / S_i{w_i} - x_m**2</span></span>
<span id="cb417-5"><a href="#cb417-5" aria-hidden="true" tabindex="-1"></a>x_2 <span class="ot">&lt;-</span> donnees_datatable[, <span class="fu">sum</span>(poids_sondage <span class="sc">*</span> note_contenu<span class="sc">**</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">complete.cases</span>(note_contenu, poids_sondage),</span>
<span id="cb417-6"><a href="#cb417-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">na.rm =</span> <span class="cn">TRUE</span>)]</span>
<span id="cb417-7"><a href="#cb417-7" aria-hidden="true" tabindex="-1"></a>x_m <span class="ot">&lt;-</span> donnees_datatable[, <span class="fu">sum</span>(poids_sondage <span class="sc">*</span> note_contenu <span class="sc">*</span> <span class="fu">complete.cases</span>(note_contenu, poids_sondage),</span>
<span id="cb417-8"><a href="#cb417-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">na.rm =</span> <span class="cn">TRUE</span>)]</span>
<span id="cb417-9"><a href="#cb417-9" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> donnees_datatable[, <span class="fu">sum</span>(poids_sondage <span class="sc">*</span> <span class="fu">complete.cases</span>(note_contenu, poids_sondage), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)]</span>
<span id="cb417-10"><a href="#cb417-10" aria-hidden="true" tabindex="-1"></a>x_2 <span class="sc">/</span> p <span class="sc">-</span> (x_m <span class="sc">/</span> p) <span class="sc">**</span> <span class="dv">2</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-100-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-100-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="déciles-et-quartiles" class="level2" data-number="14.9">
<h2 data-number="14.9" class="anchored" data-anchor-id="déciles-et-quartiles"><span class="header-section-number">14.9</span> Déciles et quartiles</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-101-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-101-1" role="tab" aria-controls="tabset-101-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-101-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-101-2" role="tab" aria-controls="tabset-101-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-101-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-101-3" role="tab" aria-controls="tabset-101-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-101-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-101-4" role="tab" aria-controls="tabset-101-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-101-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-101-5" role="tab" aria-controls="tabset-101-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-101-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-101-1-tab">
<div class="sourceCode" id="cb418"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* On calcule déjà la moyenne des notes par individu */</span></span>
<span id="cb418-2"><a href="#cb418-2" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> notes = Note_Contenu Note_Formateur Note_Moyens Note_Accompagnement Note_Materiel;</span>
<span id="cb418-3"><a href="#cb418-3" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb418-4"><a href="#cb418-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb418-5"><a href="#cb418-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* 1ère solution */</span></span>
<span id="cb418-6"><a href="#cb418-6" aria-hidden="true" tabindex="-1"></a>  Note_moyenne    = <span class="fu">mean</span>(of <span class="kw">&amp;notes.</span>);</span>
<span id="cb418-7"><a href="#cb418-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* 2e solution : l'équivalent des list-comprehension de Python en SAS */</span></span>
<span id="cb418-8"><a href="#cb418-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%macro</span> List_comprehension;</span>
<span id="cb418-9"><a href="#cb418-9" aria-hidden="true" tabindex="-1"></a>    Note_moyenne2 = <span class="fu">mean</span>(of <span class="kw">%do</span> i = <span class="dv">1</span> <span class="kw">%to</span> <span class="kw">%sysfunc</span>(countw(<span class="kw">&amp;notes.</span>));</span>
<span id="cb418-10"><a href="#cb418-10" aria-hidden="true" tabindex="-1"></a>                              <span class="kw">%let</span> j = <span class="kw">%scan</span>(<span class="kw">&amp;notes.</span>, <span class="kw">&amp;i.</span>);</span>
<span id="cb418-11"><a href="#cb418-11" aria-hidden="true" tabindex="-1"></a>                              <span class="kw">&amp;j.</span></span>
<span id="cb418-12"><a href="#cb418-12" aria-hidden="true" tabindex="-1"></a>                            <span class="kw">%end</span>;);;</span>
<span id="cb418-13"><a href="#cb418-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%mend</span> List_comprehension;</span>
<span id="cb418-14"><a href="#cb418-14" aria-hidden="true" tabindex="-1"></a>  %List_comprehension;</span>
<span id="cb418-15"><a href="#cb418-15" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb418-16"><a href="#cb418-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb418-17"><a href="#cb418-17" aria-hidden="true" tabindex="-1"></a><span class="co">/* Déciles et quartiles de la note moyenne */</span></span>
<span id="cb418-18"><a href="#cb418-18" aria-hidden="true" tabindex="-1"></a><span class="co">/* Par la proc means */</span></span>
<span id="cb418-19"><a href="#cb418-19" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> means<span class="kw"> data</span> = donnees_sas StackODSOutput <span class="fu">Min</span> P10 P20 P30 P40 Median P60 P70 Q3 P80 P90 <span class="fu">Max</span> Q1 Median Q3 QRANGE;</span>
<span id="cb418-20"><a href="#cb418-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> Note_moyenne;</span>
<span id="cb418-21"><a href="#cb418-21" aria-hidden="true" tabindex="-1"></a>  ods <span class="kw">output</span> summary = Deciles_proc_means;</span>
<span id="cb418-22"><a href="#cb418-22" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb418-23"><a href="#cb418-23" aria-hidden="true" tabindex="-1"></a><span class="co">/* Par la proc univariate */</span></span>
<span id="cb418-24"><a href="#cb418-24" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> univariate<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb418-25"><a href="#cb418-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> Note_moyenne;</span>
<span id="cb418-26"><a href="#cb418-26" aria-hidden="true" tabindex="-1"></a>  <span class="kw">output</span> out = Deciles_proc_univariate pctlpts=<span class="dv">00</span> <span class="kw">to</span> <span class="dv">100</span> <span class="kw">by</span> <span class="dv">10</span> <span class="dv">25</span> <span class="dv">50</span> <span class="dv">75</span> PCTLPRE=_; </span>
<span id="cb418-27"><a href="#cb418-27" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-101-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-101-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb419"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="co"># on calcule déjà la moyenne des notes par individu</span></span>
<span id="cb419-2"><a href="#cb419-2" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">c</span>(<span class="st">"Note_Contenu"</span>, <span class="st">"Note_Formateur"</span>, <span class="st">"Note_Moyens"</span>, <span class="st">"Note_Accompagnement"</span>, <span class="st">"Note_Materiel"</span>))</span>
<span id="cb419-3"><a href="#cb419-3" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>note_moyenne <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(donnees_rbase[, notes], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb419-4"><a href="#cb419-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Et les quantiles</span></span>
<span id="cb419-5"><a href="#cb419-5" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(donnees_rbase<span class="sc">$</span>note_moyenne, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>), <span class="fl">0.25</span>, <span class="fl">0.75</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb419-6"><a href="#cb419-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalle inter-quartile</span></span>
<span id="cb419-7"><a href="#cb419-7" aria-hidden="true" tabindex="-1"></a><span class="fu">IQR</span>(donnees_rbase<span class="sc">$</span>note_moyenne, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-101-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-101-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb420"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="co"># on calcule déjà la moyenne des notes par individu</span></span>
<span id="cb420-2"><a href="#cb420-2" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb420-3"><a href="#cb420-3" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb420-4"><a href="#cb420-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">note_moyenne =</span> <span class="fu">rowMeans</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(varNotes)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb420-5"><a href="#cb420-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Et les quantiles</span></span>
<span id="cb420-6"><a href="#cb420-6" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb420-7"><a href="#cb420-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(note_moyenne) <span class="sc">%&gt;%</span> </span>
<span id="cb420-8"><a href="#cb420-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(<span class="at">probs =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>), <span class="fl">0.25</span>, <span class="fl">0.75</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb420-9"><a href="#cb420-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalle inter-quartile</span></span>
<span id="cb420-10"><a href="#cb420-10" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb420-11"><a href="#cb420-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(note_moyenne) <span class="sc">%&gt;%</span> </span>
<span id="cb420-12"><a href="#cb420-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">IQR</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-101-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-101-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb421"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="co"># on calcule déjà la moyenne des notes par individu</span></span>
<span id="cb421-2"><a href="#cb421-2" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>,<span class="st">"note_formateur"</span>,<span class="st">"note_moyens"</span>,<span class="st">"note_accompagnement"</span>,<span class="st">"note_materiel"</span>)</span>
<span id="cb421-3"><a href="#cb421-3" aria-hidden="true" tabindex="-1"></a><span class="co"># On souhaite moyenner les notes par formation</span></span>
<span id="cb421-4"><a href="#cb421-4" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, note_moyenne <span class="sc">:</span><span class="er">=</span> <span class="fu">rowMeans</span>(.SD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), .SDcols <span class="ot">=</span> notes]</span>
<span id="cb421-5"><a href="#cb421-5" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">quantile</span>(.SD, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>), <span class="fl">0.25</span>, <span class="fl">0.75</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>), .SDcols <span class="ot">=</span> <span class="st">"note_moyenne"</span>]</span>
<span id="cb421-6"><a href="#cb421-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalle inter-quartile</span></span>
<span id="cb421-7"><a href="#cb421-7" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">IQR</span>(note_moyenne, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)]</span>
<span id="cb421-8"><a href="#cb421-8" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">lapply</span>(.SD, <span class="cf">function</span>(x) <span class="fu">IQR</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), .SDcols <span class="ot">=</span> <span class="st">"note_moyenne"</span>]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-101-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-101-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="déciles-et-quartiles-pondérés" class="level2" data-number="14.10">
<h2 data-number="14.10" class="anchored" data-anchor-id="déciles-et-quartiles-pondérés"><span class="header-section-number">14.10</span> Déciles et quartiles pondérés</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-102-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-102-1" role="tab" aria-controls="tabset-102-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-102-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-102-2" role="tab" aria-controls="tabset-102-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-102-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-102-3" role="tab" aria-controls="tabset-102-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-102-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-102-4" role="tab" aria-controls="tabset-102-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-102-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-102-5" role="tab" aria-controls="tabset-102-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-102-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-102-1-tab">
<div class="sourceCode" id="cb422"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* On calcule déjà la moyenne des notes par individu */</span></span>
<span id="cb422-2"><a href="#cb422-2" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> notes = Note_Contenu Note_Formateur Note_Moyens Note_Accompagnement Note_Materiel;</span>
<span id="cb422-3"><a href="#cb422-3" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb422-4"><a href="#cb422-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb422-5"><a href="#cb422-5" aria-hidden="true" tabindex="-1"></a>  Note_moyenne = <span class="fu">mean</span>(of <span class="kw">&amp;notes.</span>);</span>
<span id="cb422-6"><a href="#cb422-6" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb422-7"><a href="#cb422-7" aria-hidden="true" tabindex="-1"></a><span class="co">/* Par la proc means */</span></span>
<span id="cb422-8"><a href="#cb422-8" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> means<span class="kw"> data</span> = donnees_sas StackODSOutput <span class="fu">Min</span> P10 P20 P30 P40 Median P60 P70 Q3 P80 P90 <span class="fu">Max</span> Q1 Median Q3 QRANGE;</span>
<span id="cb422-9"><a href="#cb422-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> Note_moyenne;</span>
<span id="cb422-10"><a href="#cb422-10" aria-hidden="true" tabindex="-1"></a>  ods <span class="kw">output</span> summary = Deciles_proc_means;</span>
<span id="cb422-11"><a href="#cb422-11" aria-hidden="true" tabindex="-1"></a>  weight poids_sondage;</span>
<span id="cb422-12"><a href="#cb422-12" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb422-13"><a href="#cb422-13" aria-hidden="true" tabindex="-1"></a><span class="co">/* Par la proc univariate */</span></span>
<span id="cb422-14"><a href="#cb422-14" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> univariate<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb422-15"><a href="#cb422-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> Note_moyenne;</span>
<span id="cb422-16"><a href="#cb422-16" aria-hidden="true" tabindex="-1"></a>  <span class="kw">output</span> out = Deciles_proc_univariate pctlpts=<span class="dv">00</span> <span class="kw">to</span> <span class="dv">100</span> <span class="kw">by</span> <span class="dv">10</span> <span class="dv">25</span> <span class="dv">50</span> <span class="dv">75</span> PCTLPRE=_;</span>
<span id="cb422-17"><a href="#cb422-17" aria-hidden="true" tabindex="-1"></a>  weight poids_sondage;</span>
<span id="cb422-18"><a href="#cb422-18" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-102-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-102-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb423"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Une solution pour obtenir les résultats pondérés est d'utiliser la fonction fquantile du package collapse</span></span>
<span id="cb423-2"><a href="#cb423-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(collapse)</span>
<span id="cb423-3"><a href="#cb423-3" aria-hidden="true" tabindex="-1"></a><span class="co"># on calcule déjà la moyenne des notes par individu</span></span>
<span id="cb423-4"><a href="#cb423-4" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">c</span>(<span class="st">"Note_Contenu"</span>, <span class="st">"Note_Formateur"</span>, <span class="st">"Note_Moyens"</span>, <span class="st">"Note_Accompagnement"</span>, <span class="st">"Note_Materiel"</span>))</span>
<span id="cb423-5"><a href="#cb423-5" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>note_moyenne <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(donnees_rbase[, notes], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb423-6"><a href="#cb423-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Et les quantiles</span></span>
<span id="cb423-7"><a href="#cb423-7" aria-hidden="true" tabindex="-1"></a><span class="co"># L'option na.rm est par défaut à TRUE dans le package</span></span>
<span id="cb423-8"><a href="#cb423-8" aria-hidden="true" tabindex="-1"></a>collapse<span class="sc">::</span><span class="fu">fquantile</span>(donnees_rbase<span class="sc">$</span>note_moyenne, <span class="at">w =</span> donnees_rbase<span class="sc">$</span>poids_sondage,</span>
<span id="cb423-9"><a href="#cb423-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">probs =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-102-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-102-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb424"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Une solution pour obtenir les résultats pondérés est d'utiliser les fonctions du package collapse</span></span>
<span id="cb424-2"><a href="#cb424-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(collapse)</span>
<span id="cb424-3"><a href="#cb424-3" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb424-4"><a href="#cb424-4" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb424-5"><a href="#cb424-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">note_moyenne =</span> <span class="fu">rowMeans</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(varNotes)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb424-6"><a href="#cb424-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Et les quantiles</span></span>
<span id="cb424-7"><a href="#cb424-7" aria-hidden="true" tabindex="-1"></a><span class="co"># L'option na.rm est par défaut à TRUE dans le package</span></span>
<span id="cb424-8"><a href="#cb424-8" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb424-9"><a href="#cb424-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(note_moyenne) <span class="sc">%&gt;%</span> </span>
<span id="cb424-10"><a href="#cb424-10" aria-hidden="true" tabindex="-1"></a>  collapse<span class="sc">::</span><span class="fu">fquantile</span>(<span class="at">probs =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)), <span class="at">w =</span> donnees_tidyverse<span class="sc">$</span>poids_sondage)</span>
<span id="cb424-11"><a href="#cb424-11" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb424-12"><a href="#cb424-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(note_moyenne) <span class="sc">%&gt;%</span> </span>
<span id="cb424-13"><a href="#cb424-13" aria-hidden="true" tabindex="-1"></a>  collapse<span class="sc">::</span><span class="fu">fquantile</span>(<span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="dv">1</span>), <span class="at">w =</span> donnees_tidyverse<span class="sc">$</span>poids_sondage)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-102-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-102-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb425"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Une solution pour obtenir les résultats pondérés est d'utiliser la fonction fquantile du package collapse</span></span>
<span id="cb425-2"><a href="#cb425-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(collapse)</span>
<span id="cb425-3"><a href="#cb425-3" aria-hidden="true" tabindex="-1"></a><span class="co"># on calcule déjà la moyenne des notes par individu</span></span>
<span id="cb425-4"><a href="#cb425-4" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>,<span class="st">"note_formateur"</span>,<span class="st">"note_moyens"</span>,<span class="st">"note_accompagnement"</span>,<span class="st">"note_materiel"</span>)</span>
<span id="cb425-5"><a href="#cb425-5" aria-hidden="true" tabindex="-1"></a><span class="co"># On souhaite moyenner les notes par formation</span></span>
<span id="cb425-6"><a href="#cb425-6" aria-hidden="true" tabindex="-1"></a><span class="co"># L'option na.rm est par défaut à TRUE dans le package</span></span>
<span id="cb425-7"><a href="#cb425-7" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, note_moyenne <span class="sc">:</span><span class="er">=</span> <span class="fu">rowMeans</span>(.SD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), .SDcols <span class="ot">=</span> notes]</span>
<span id="cb425-8"><a href="#cb425-8" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">lapply</span>(.SD, <span class="cf">function</span>(x) collapse<span class="sc">::</span><span class="fu">fquantile</span>(x, <span class="at">w =</span> poids_sondage,</span>
<span id="cb425-9"><a href="#cb425-9" aria-hidden="true" tabindex="-1"></a>                                                                <span class="at">probs =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>))</span>
<span id="cb425-10"><a href="#cb425-10" aria-hidden="true" tabindex="-1"></a>                                                                )),</span>
<span id="cb425-11"><a href="#cb425-11" aria-hidden="true" tabindex="-1"></a>                           .SDcols <span class="ot">=</span> <span class="st">"note_moyenne"</span>]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-102-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-102-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="rang-de-la-note" class="level2" data-number="14.11">
<h2 data-number="14.11" class="anchored" data-anchor-id="rang-de-la-note"><span class="header-section-number">14.11</span> Rang de la note</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-103-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-103-1" role="tab" aria-controls="tabset-103-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-103-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-103-2" role="tab" aria-controls="tabset-103-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-103-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-103-3" role="tab" aria-controls="tabset-103-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-103-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-103-4" role="tab" aria-controls="tabset-103-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-103-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-103-5" role="tab" aria-controls="tabset-103-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-103-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-103-1-tab">
<div class="sourceCode" id="cb426"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Ajouter dans la base le rang de la note par ordre décroissant */</span></span>
<span id="cb426-2"><a href="#cb426-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> <span class="fu">rank</span><span class="kw"> data</span> = donnees_sas out = donnees_sas descending;</span>
<span id="cb426-3"><a href="#cb426-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> note_moyenne;</span>
<span id="cb426-4"><a href="#cb426-4" aria-hidden="true" tabindex="-1"></a>  ranks rang_note_moyenne;</span>
<span id="cb426-5"><a href="#cb426-5" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-103-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-103-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb427"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter dans la base le rang de la note par ordre décroissant</span></span>
<span id="cb427-2"><a href="#cb427-2" aria-hidden="true" tabindex="-1"></a>donnees_rbase<span class="sc">$</span>rang_note_moyenne <span class="ot">&lt;-</span> <span class="fu">rank</span>(<span class="sc">-</span>donnees_rbase<span class="sc">$</span>note_moyenne)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-103-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-103-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb428"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter dans la base le rang de la note par ordre décroissant</span></span>
<span id="cb428-2"><a href="#cb428-2" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb428-3"><a href="#cb428-3" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span></span>
<span id="cb428-4"><a href="#cb428-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">note_moyenne =</span> <span class="fu">rowMeans</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(varNotes)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb428-5"><a href="#cb428-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rang_note_moyenne =</span> <span class="fu">rank</span>(<span class="sc">-</span>note_moyenne))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-103-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-103-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb429"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb429-1"><a href="#cb429-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter dans la base le rang de la note par ordre décroissant</span></span>
<span id="cb429-2"><a href="#cb429-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Attention, en R, rank trie par ordre croissant par défaut, alors que le tri est par ordre décroissant en SAS</span></span>
<span id="cb429-3"><a href="#cb429-3" aria-hidden="true" tabindex="-1"></a><span class="co"># On exprime le rang par ordre décroissant, avec le - devant</span></span>
<span id="cb429-4"><a href="#cb429-4" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, rang_note_moyenne <span class="sc">:</span><span class="er">=</span> <span class="fu">rank</span>(<span class="sc">-</span>note_moyenne)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-103-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-103-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="corrélation-linéaire-entre-deux-notes" class="level2" data-number="14.12">
<h2 data-number="14.12" class="anchored" data-anchor-id="corrélation-linéaire-entre-deux-notes"><span class="header-section-number">14.12</span> Corrélation linéaire entre deux notes</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-104-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-104-1" role="tab" aria-controls="tabset-104-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-104-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-104-2" role="tab" aria-controls="tabset-104-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-104-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-104-3" role="tab" aria-controls="tabset-104-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-104-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-104-4" role="tab" aria-controls="tabset-104-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-104-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-104-5" role="tab" aria-controls="tabset-104-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-104-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-104-1-tab">
<div class="sourceCode" id="cb430"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Covariance et corrélation linéaire (Kendall, Pearson, Spearman) */</span></span>
<span id="cb430-2"><a href="#cb430-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> corr<span class="kw"> data</span> = donnees_sas kendall pearson spearman cov;</span>
<span id="cb430-3"><a href="#cb430-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> note_contenu note_formateur;</span>
<span id="cb430-4"><a href="#cb430-4" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-104-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-104-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb431"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Covariance (Kendall, Pearson, Spearman)</span></span>
<span id="cb431-2"><a href="#cb431-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(donnees_rbase,</span>
<span id="cb431-3"><a href="#cb431-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="st">"pearson"</span>, <span class="st">"spearman"</span>, <span class="st">"kendall"</span>),</span>
<span id="cb431-4"><a href="#cb431-4" aria-hidden="true" tabindex="-1"></a>            <span class="cf">function</span>(x) <span class="fu">cov</span>(note_contenu, note_formateur, <span class="at">method =</span> x, <span class="at">use =</span> <span class="st">"complete.obs"</span>)))</span>
<span id="cb431-5"><a href="#cb431-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Corrélation linéaire (Kendall, Pearson, Spearman)</span></span>
<span id="cb431-6"><a href="#cb431-6" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(donnees_rbase,</span>
<span id="cb431-7"><a href="#cb431-7" aria-hidden="true" tabindex="-1"></a>     <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="st">"pearson"</span>, <span class="st">"spearman"</span>, <span class="st">"kendall"</span>),</span>
<span id="cb431-8"><a href="#cb431-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">function</span>(x) <span class="fu">cor</span>(note_contenu, note_formateur, <span class="at">method =</span> x, <span class="at">use =</span> <span class="st">"complete.obs"</span>)))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-104-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-104-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb432"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Covariance (Kendall, Pearson, Spearman)</span></span>
<span id="cb432-2"><a href="#cb432-2" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : peut-on faire mieux ???</span></span>
<span id="cb432-3"><a href="#cb432-3" aria-hidden="true" tabindex="-1"></a>methodes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"pearson"</span>, <span class="st">"spearman"</span>, <span class="st">"kendall"</span>)</span>
<span id="cb432-4"><a href="#cb432-4" aria-hidden="true" tabindex="-1"></a>methodes <span class="sc">%&gt;%</span> </span>
<span id="cb432-5"><a href="#cb432-5" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span> </span>
<span id="cb432-6"><a href="#cb432-6" aria-hidden="true" tabindex="-1"></a>    donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb432-7"><a href="#cb432-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">cov =</span> <span class="fu">cov</span>(note_contenu, note_formateur, <span class="at">method =</span> .x, <span class="at">use =</span> <span class="st">"complete.obs"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb432-8"><a href="#cb432-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(methodes) <span class="sc">%&gt;%</span> </span>
<span id="cb432-9"><a href="#cb432-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb432-10"><a href="#cb432-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-11"><a href="#cb432-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Corrélation linéaire (Kendall, Pearson, Spearman)</span></span>
<span id="cb432-12"><a href="#cb432-12" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : peut-on faire mieux ???</span></span>
<span id="cb432-13"><a href="#cb432-13" aria-hidden="true" tabindex="-1"></a>methodes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"pearson"</span>, <span class="st">"spearman"</span>, <span class="st">"kendall"</span>)</span>
<span id="cb432-14"><a href="#cb432-14" aria-hidden="true" tabindex="-1"></a>methodes <span class="sc">%&gt;%</span> </span>
<span id="cb432-15"><a href="#cb432-15" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb432-16"><a href="#cb432-16" aria-hidden="true" tabindex="-1"></a>               <span class="fu">summarise</span>(<span class="at">cor =</span> <span class="fu">cor</span>(note_contenu, note_formateur, <span class="at">method =</span> .x, <span class="at">use =</span> <span class="st">"complete.obs"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb432-17"><a href="#cb432-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(methodes) <span class="sc">%&gt;%</span> </span>
<span id="cb432-18"><a href="#cb432-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-104-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-104-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb433"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Covariance (Kendall, Pearson, Spearman)</span></span>
<span id="cb433-2"><a href="#cb433-2" aria-hidden="true" tabindex="-1"></a>methodes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"pearson"</span>, <span class="st">"spearman"</span>, <span class="st">"kendall"</span>)</span>
<span id="cb433-3"><a href="#cb433-3" aria-hidden="true" tabindex="-1"></a><span class="fu">setNames</span>(donnees_datatable[, <span class="fu">lapply</span>(methodes,</span>
<span id="cb433-4"><a href="#cb433-4" aria-hidden="true" tabindex="-1"></a>                           <span class="cf">function</span>(x) <span class="fu">cov</span>(note_contenu, note_formateur,</span>
<span id="cb433-5"><a href="#cb433-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">method =</span> x,</span>
<span id="cb433-6"><a href="#cb433-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">use =</span> <span class="st">"complete.obs"</span>))],</span>
<span id="cb433-7"><a href="#cb433-7" aria-hidden="true" tabindex="-1"></a>         methodes)</span>
<span id="cb433-8"><a href="#cb433-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Corrélation linéaire (Kendall, Pearson, Spearman)</span></span>
<span id="cb433-9"><a href="#cb433-9" aria-hidden="true" tabindex="-1"></a><span class="fu">setNames</span>(donnees_datatable[, <span class="fu">lapply</span>(methodes,</span>
<span id="cb433-10"><a href="#cb433-10" aria-hidden="true" tabindex="-1"></a>                                    <span class="cf">function</span>(x) <span class="fu">cor</span>(note_contenu, note_formateur,</span>
<span id="cb433-11"><a href="#cb433-11" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">method =</span> x,</span>
<span id="cb433-12"><a href="#cb433-12" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">use =</span> <span class="st">"complete.obs"</span>))],</span>
<span id="cb433-13"><a href="#cb433-13" aria-hidden="true" tabindex="-1"></a>         methodes)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-104-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-104-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
</section>
<section id="tableaux-de-fréquence" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> Tableaux de fréquence</h1>
<section id="tableaux-de-fréquence-proc-freq-pour-1-variable" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="tableaux-de-fréquence-proc-freq-pour-1-variable"><span class="header-section-number">15.1</span> Tableaux de fréquence (proc freq) pour 1 variable</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-105-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-105-1" role="tab" aria-controls="tabset-105-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-105-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-105-2" role="tab" aria-controls="tabset-105-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-105-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-105-3" role="tab" aria-controls="tabset-105-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-105-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-105-4" role="tab" aria-controls="tabset-105-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-105-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-105-5" role="tab" aria-controls="tabset-105-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-105-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-105-1-tab">
<div class="sourceCode" id="cb434"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> freq<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb434-2"><a href="#cb434-2" aria-hidden="true" tabindex="-1"></a>  tables Sexe CSP;</span>
<span id="cb434-3"><a href="#cb434-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Sexe sexef. CSP $cspf.;</span>
<span id="cb434-4"><a href="#cb434-4" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-105-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-105-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb435"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableaux de fréquence (proc freq) (sans les valeurs manquantes)</span></span>
<span id="cb435-2"><a href="#cb435-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(donnees_rbase<span class="sc">$</span>cspf)</span>
<span id="cb435-3"><a href="#cb435-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(donnees_rbase<span class="sc">$</span>sexef)</span>
<span id="cb435-4"><a href="#cb435-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre syntaxe, donnant une mise en forme différente</span></span>
<span id="cb435-5"><a href="#cb435-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(donnees_rbase<span class="sc">$</span>cspf)</span>
<span id="cb435-6"><a href="#cb435-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour enlever les "donnees_rbase$", on peut utiliser with pour se placer dans l'environnement de donnees_rbase</span></span>
<span id="cb435-7"><a href="#cb435-7" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(donnees_rbase, <span class="fu">table</span>(cspf))</span>
<span id="cb435-8"><a href="#cb435-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour les proportions</span></span>
<span id="cb435-9"><a href="#cb435-9" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(donnees_rbase<span class="sc">$</span>cspf)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb435-10"><a href="#cb435-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Devient plus difficile si l'on souhaite plus (sommes et proportions cumulées par exemple)</span></span>
<span id="cb435-11"><a href="#cb435-11" aria-hidden="true" tabindex="-1"></a>freq <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">as.data.frame</span>(<span class="fu">table</span>(donnees_rbase<span class="sc">$</span>cspf)), <span class="fu">c</span>(<span class="st">"cspf"</span>, <span class="st">"Freq"</span>))</span>
<span id="cb435-12"><a href="#cb435-12" aria-hidden="true" tabindex="-1"></a>freq <span class="ot">&lt;-</span> <span class="fu">transform</span>(freq, <span class="at">Prop =</span> Freq <span class="sc">/</span> <span class="fu">sum</span>(Freq) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb435-13"><a href="#cb435-13" aria-hidden="true" tabindex="-1"></a>freq <span class="ot">&lt;-</span> <span class="fu">transform</span>(freq,</span>
<span id="cb435-14"><a href="#cb435-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Freq_cum =</span> <span class="fu">cumsum</span>(Freq),</span>
<span id="cb435-15"><a href="#cb435-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Prop_cum =</span> <span class="fu">cumsum</span>(Prop))</span>
<span id="cb435-16"><a href="#cb435-16" aria-hidden="true" tabindex="-1"></a>freq</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-105-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-105-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb436"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb436-2"><a href="#cb436-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(cspf) <span class="sc">%&gt;%</span> </span>
<span id="cb436-3"><a href="#cb436-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb436-4"><a href="#cb436-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">n_cum =</span> <span class="fu">cumsum</span>(n),</span>
<span id="cb436-5"><a href="#cb436-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">prop_cum =</span> <span class="fu">cumsum</span>(prop))</span>
<span id="cb436-6"><a href="#cb436-6" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb436-7"><a href="#cb436-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sexef) <span class="sc">%&gt;%</span> </span>
<span id="cb436-8"><a href="#cb436-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb436-9"><a href="#cb436-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">n_cum =</span> <span class="fu">cumsum</span>(n),</span>
<span id="cb436-10"><a href="#cb436-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">prop_cum =</span> <span class="fu">cumsum</span>(prop))</span>
<span id="cb436-11"><a href="#cb436-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Ou alors</span></span>
<span id="cb436-12"><a href="#cb436-12" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb436-13"><a href="#cb436-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cspf) <span class="sc">%&gt;%</span> </span>
<span id="cb436-14"><a href="#cb436-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb436-15"><a href="#cb436-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb436-16"><a href="#cb436-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">n_cum =</span> <span class="fu">cumsum</span>(n),</span>
<span id="cb436-17"><a href="#cb436-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">prop_cum =</span> <span class="fu">cumsum</span>(prop)</span>
<span id="cb436-18"><a href="#cb436-18" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-105-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-105-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb437"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb437-1"><a href="#cb437-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableaux de fréquence (proc freq) (avec les valeurs manquantes)</span></span>
<span id="cb437-2"><a href="#cb437-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">table</span>(cspf) ]</span>
<span id="cb437-3"><a href="#cb437-3" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">table</span>(sexef) ]</span>
<span id="cb437-4"><a href="#cb437-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour les proportions</span></span>
<span id="cb437-5"><a href="#cb437-5" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">prop.table</span>(<span class="fu">table</span>(cspf)) ] <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb437-6"><a href="#cb437-6" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, .(<span class="at">Nombre =</span> .N,</span>
<span id="cb437-7"><a href="#cb437-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pourcentage =</span> .N <span class="sc">/</span> <span class="fu">length</span>(donnees_datatable[, cspf]) <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb437-8"><a href="#cb437-8" aria-hidden="true" tabindex="-1"></a>                  keyby <span class="ot">=</span> cspf]</span>
<span id="cb437-9"><a href="#cb437-9" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, {tot <span class="ot">=</span> .N; .SD[, .(<span class="at">frac =</span> .N <span class="sc">/</span> tot <span class="sc">*</span> <span class="dv">100</span>), keyby <span class="ot">=</span> cspf]} ]</span>
<span id="cb437-10"><a href="#cb437-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre façon d'utiliser les méthodes de data.table, avec les fréquences et proportions cumulés</span></span>
<span id="cb437-11"><a href="#cb437-11" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">dcast</span>(donnees_datatable, cspf <span class="sc">~</span> ., <span class="at">fun =</span> length)</span>
<span id="cb437-12"><a href="#cb437-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab)[<span class="fu">colnames</span>(tab) <span class="sc">==</span> <span class="st">"."</span>] <span class="ot">&lt;-</span> <span class="st">"Nombre"</span></span>
<span id="cb437-13"><a href="#cb437-13" aria-hidden="true" tabindex="-1"></a>tab[, Prop <span class="sc">:</span><span class="er">=</span> <span class="fu">lapply</span>(.SD, <span class="cf">function</span>(col) col <span class="sc">/</span> <span class="fu">sum</span>(col) <span class="sc">*</span> <span class="dv">100</span>), .SDcols <span class="ot">=</span> is.numeric]</span>
<span id="cb437-14"><a href="#cb437-14" aria-hidden="true" tabindex="-1"></a>tab[, <span class="fu">c</span>(<span class="st">"Freq_cum"</span>, <span class="st">"Prop_cum"</span>) <span class="sc">:</span><span class="er">=</span> <span class="fu">list</span>(<span class="fu">cumsum</span>(Nombre), <span class="fu">cumsum</span>(Prop))]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-105-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-105-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="tableaux-de-fréquence-avec-les-valeurs-manquantes" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="tableaux-de-fréquence-avec-les-valeurs-manquantes"><span class="header-section-number">15.2</span> Tableaux de fréquence avec les valeurs manquantes</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-106-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-106-1" role="tab" aria-controls="tabset-106-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-106-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-106-2" role="tab" aria-controls="tabset-106-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-106-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-106-3" role="tab" aria-controls="tabset-106-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-106-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-106-4" role="tab" aria-controls="tabset-106-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-106-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-106-5" role="tab" aria-controls="tabset-106-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-106-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-106-1-tab">
<div class="sourceCode" id="cb438"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> freq<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb438-2"><a href="#cb438-2" aria-hidden="true" tabindex="-1"></a>  tables Sexe CSP / missing;</span>
<span id="cb438-3"><a href="#cb438-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Sexe sexef. CSP $cspf.;</span>
<span id="cb438-4"><a href="#cb438-4" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-106-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-106-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb439"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableaux de fréquence (proc freq) (avec les valeurs manquantes)</span></span>
<span id="cb439-2"><a href="#cb439-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(donnees_rbase<span class="sc">$</span>cspf, <span class="at">useNA =</span> <span class="st">"always"</span>)</span>
<span id="cb439-3"><a href="#cb439-3" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(donnees_rbase<span class="sc">$</span>cspf, <span class="at">useNA =</span> <span class="st">"always"</span>)) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-106-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-106-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb440"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb440-1"><a href="#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableaux de fréquence (proc freq) (avec les valeurs manquantes)</span></span>
<span id="cb440-2"><a href="#cb440-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(donnees_rbase<span class="sc">$</span>cspf, <span class="at">useNA =</span> <span class="st">"always"</span>)</span>
<span id="cb440-3"><a href="#cb440-3" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(donnees_rbase<span class="sc">$</span>cspf, <span class="at">useNA =</span> <span class="st">"always"</span>)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb440-4"><a href="#cb440-4" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb440-5"><a href="#cb440-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(cspf) <span class="sc">%&gt;%</span> </span>
<span id="cb440-6"><a href="#cb440-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-106-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-106-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb441"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">table</span>(cspf, <span class="at">useNA =</span> <span class="st">"always"</span>) ]</span>
<span id="cb441-2"><a href="#cb441-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">prop.table</span>(<span class="fu">table</span>(cspf, <span class="at">useNA =</span> <span class="st">"always"</span>))] <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb441-3"><a href="#cb441-3" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, .(<span class="at">Nombre =</span> .N,</span>
<span id="cb441-4"><a href="#cb441-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pourcentage =</span> .N <span class="sc">/</span> <span class="fu">length</span>(donnees_datatable[, cspf]) <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb441-5"><a href="#cb441-5" aria-hidden="true" tabindex="-1"></a>                  keyby <span class="ot">=</span> cspf]</span>
<span id="cb441-6"><a href="#cb441-6" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, {tot <span class="ot">=</span> .N; .SD[, .(<span class="at">frac =</span> .N <span class="sc">/</span> tot <span class="sc">*</span> <span class="dv">100</span>), keyby <span class="ot">=</span> cspf]} ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-106-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-106-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="tableaux-de-fréquence-trié-par-modalité-la-plus-courante" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="tableaux-de-fréquence-trié-par-modalité-la-plus-courante"><span class="header-section-number">15.3</span> Tableaux de fréquence trié par modalité la plus courante</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-107-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-107-1" role="tab" aria-controls="tabset-107-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-107-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-107-2" role="tab" aria-controls="tabset-107-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-107-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-107-3" role="tab" aria-controls="tabset-107-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-107-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-107-4" role="tab" aria-controls="tabset-107-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-107-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-107-5" role="tab" aria-controls="tabset-107-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-107-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-107-1-tab">
<div class="sourceCode" id="cb442"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> freq<span class="kw"> data</span> = donnees_sas <span class="kw">order</span> = freq;</span>
<span id="cb442-2"><a href="#cb442-2" aria-hidden="true" tabindex="-1"></a>  tables Sexe CSP / missing;</span>
<span id="cb442-3"><a href="#cb442-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Sexe sexef. CSP $cspf.;</span>
<span id="cb442-4"><a href="#cb442-4" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-107-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-107-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb443"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb443-1"><a href="#cb443-1" aria-hidden="true" tabindex="-1"></a>freq <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">as.data.frame</span>(<span class="fu">table</span>(donnees_rbase<span class="sc">$</span>cspf)), <span class="fu">c</span>(<span class="st">"cspf"</span>, <span class="st">"Freq"</span>))</span>
<span id="cb443-2"><a href="#cb443-2" aria-hidden="true" tabindex="-1"></a>freq <span class="ot">&lt;-</span> <span class="fu">transform</span>(freq, <span class="at">Prop =</span> Freq <span class="sc">/</span> <span class="fu">sum</span>(Freq) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb443-3"><a href="#cb443-3" aria-hidden="true" tabindex="-1"></a>freq[<span class="fu">order</span>(<span class="sc">-</span>freq<span class="sc">$</span>Freq), ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-107-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-107-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb444"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb444-2"><a href="#cb444-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(cspf) <span class="sc">%&gt;%</span> </span>
<span id="cb444-3"><a href="#cb444-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb444-4"><a href="#cb444-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb444-5"><a href="#cb444-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">n_cum =</span> <span class="fu">cumsum</span>(n),</span>
<span id="cb444-6"><a href="#cb444-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">prop_cum =</span> <span class="fu">cumsum</span>(prop))</span>
<span id="cb444-7"><a href="#cb444-7" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb444-8"><a href="#cb444-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(cspf, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb444-9"><a href="#cb444-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb444-10"><a href="#cb444-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">n_cum =</span> <span class="fu">cumsum</span>(n),</span>
<span id="cb444-11"><a href="#cb444-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">prop_cum =</span> <span class="fu">cumsum</span>(prop))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-107-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-107-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb445"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, .(<span class="at">Nombre =</span> .N,</span>
<span id="cb445-2"><a href="#cb445-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pourcentage =</span> .N <span class="sc">/</span> <span class="fu">length</span>(donnees_datatable[, cspf]) <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb445-3"><a href="#cb445-3" aria-hidden="true" tabindex="-1"></a>                  keyby <span class="ot">=</span> cspf][<span class="fu">order</span>(<span class="sc">-</span>Nombre)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-107-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-107-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="tableaux-de-fréquence-avec-la-pondération" class="level2" data-number="15.4">
<h2 data-number="15.4" class="anchored" data-anchor-id="tableaux-de-fréquence-avec-la-pondération"><span class="header-section-number">15.4</span> Tableaux de fréquence avec la pondération</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-108-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-108-1" role="tab" aria-controls="tabset-108-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-108-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-108-2" role="tab" aria-controls="tabset-108-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-108-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-108-3" role="tab" aria-controls="tabset-108-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-108-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-108-4" role="tab" aria-controls="tabset-108-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-108-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-108-5" role="tab" aria-controls="tabset-108-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-108-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-108-1-tab">
<div class="sourceCode" id="cb446"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> freq<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb446-2"><a href="#cb446-2" aria-hidden="true" tabindex="-1"></a>  tables Sexe CSP / missing;</span>
<span id="cb446-3"><a href="#cb446-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Sexe sexef. CSP $cspf.;</span>
<span id="cb446-4"><a href="#cb446-4" aria-hidden="true" tabindex="-1"></a>  weight poids_sondage;</span>
<span id="cb446-5"><a href="#cb446-5" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-108-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-108-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb447"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb447-1"><a href="#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xtabs</span>(poids_sondage <span class="sc">~</span> cspf, <span class="at">data =</span> donnees_rbase, <span class="at">addNA =</span> <span class="cn">TRUE</span>)</span>
<span id="cb447-2"><a href="#cb447-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">xtabs</span>(poids_sondage <span class="sc">~</span> cspf, <span class="at">data =</span> donnees_rbase, <span class="at">addNA =</span> <span class="cn">TRUE</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-108-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-108-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb448"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb448-2"><a href="#cb448-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(cspf, <span class="at">wt =</span> poids_sondage) <span class="sc">%&gt;%</span> </span>
<span id="cb448-3"><a href="#cb448-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb448-4"><a href="#cb448-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">n_cum =</span> <span class="fu">cumsum</span>(n),</span>
<span id="cb448-5"><a href="#cb448-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">prop_cum =</span> <span class="fu">cumsum</span>(prop))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-108-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-108-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb449"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">xtabs</span>(poids_sondage <span class="sc">~</span> cspf, <span class="at">data =</span> donnees_datatable, <span class="at">addNA =</span> <span class="cn">TRUE</span>) ]</span>
<span id="cb449-2"><a href="#cb449-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">prop.table</span>(<span class="fu">xtabs</span>(poids_sondage <span class="sc">~</span> cspf, <span class="at">data =</span> donnees_datatable, <span class="at">addNA =</span> <span class="cn">TRUE</span>)) ]</span>
<span id="cb449-3"><a href="#cb449-3" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, .(<span class="at">prop =</span> <span class="fu">sum</span>(poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(donnees_datatable[, poids_sondage]) <span class="sc">*</span> <span class="dv">100</span>), keyby <span class="ot">=</span> cspf]</span>
<span id="cb449-4"><a href="#cb449-4" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, {tot <span class="ot">=</span> <span class="fu">sum</span>(poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>); .SD[, .(<span class="at">prop =</span> <span class="fu">sum</span>(poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> tot <span class="sc">*</span> <span class="dv">100</span>), by <span class="ot">=</span> cspf]} ]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-108-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-108-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="tableaux-de-contingence-proc-freq-pour-2-variables" class="level2" data-number="15.5">
<h2 data-number="15.5" class="anchored" data-anchor-id="tableaux-de-contingence-proc-freq-pour-2-variables"><span class="header-section-number">15.5</span> Tableaux de contingence (proc freq) pour 2 variables</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-109-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-109-1" role="tab" aria-controls="tabset-109-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-109-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-109-2" role="tab" aria-controls="tabset-109-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-109-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-109-3" role="tab" aria-controls="tabset-109-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-109-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-109-4" role="tab" aria-controls="tabset-109-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-109-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-109-5" role="tab" aria-controls="tabset-109-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-109-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-109-1-tab">
<div class="sourceCode" id="cb450"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb450-1"><a href="#cb450-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> freq<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb450-2"><a href="#cb450-2" aria-hidden="true" tabindex="-1"></a>  tables Sexe * CSP / missing;</span>
<span id="cb450-3"><a href="#cb450-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Sexe sexef. CSP $cspf.;</span>
<span id="cb450-4"><a href="#cb450-4" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb450-5"><a href="#cb450-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb450-6"><a href="#cb450-6" aria-hidden="true" tabindex="-1"></a><span class="co">/* Tableau de contingence (tableau croisé) sans les proportions lignes, colonnes et totales */</span></span>
<span id="cb450-7"><a href="#cb450-7" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> freq<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb450-8"><a href="#cb450-8" aria-hidden="true" tabindex="-1"></a>  tables CSP * Sexe  / missing nofreq norow nocol;</span>
<span id="cb450-9"><a href="#cb450-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Sexe sexef. CSP $cspf.;</span>
<span id="cb450-10"><a href="#cb450-10" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-109-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-109-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb451"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb451-1"><a href="#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableau simple</span></span>
<span id="cb451-2"><a href="#cb451-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(donnees_rbase<span class="sc">$</span>cspf, donnees_rbase<span class="sc">$</span>sexef, <span class="at">useNA =</span> <span class="st">"always"</span>)</span>
<span id="cb451-3"><a href="#cb451-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableau avec les sommes</span></span>
<span id="cb451-4"><a href="#cb451-4" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">table</span>(donnees_rbase<span class="sc">$</span>cspf, donnees_rbase<span class="sc">$</span>sexef, <span class="at">useNA =</span> <span class="st">"always"</span>))</span>
<span id="cb451-5"><a href="#cb451-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions</span></span>
<span id="cb451-6"><a href="#cb451-6" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(donnees_rbase<span class="sc">$</span>cspf, donnees_rbase<span class="sc">$</span>sexef, <span class="at">useNA =</span> <span class="st">"always"</span>)</span>
<span id="cb451-7"><a href="#cb451-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions par case</span></span>
<span id="cb451-8"><a href="#cb451-8" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">prop.table</span>(tab)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb451-9"><a href="#cb451-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions par ligne</span></span>
<span id="cb451-10"><a href="#cb451-10" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">prop.table</span>(tab, <span class="at">margin =</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb451-11"><a href="#cb451-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions par colonne</span></span>
<span id="cb451-12"><a href="#cb451-12" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">prop.table</span>(tab, <span class="at">margin =</span> <span class="dv">2</span>)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb451-13"><a href="#cb451-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-14"><a href="#cb451-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution alternative, sans pondération</span></span>
<span id="cb451-15"><a href="#cb451-15" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(<span class="sc">~</span> cspf <span class="sc">+</span> sexef, <span class="at">data =</span> donnees_rbase)</span>
<span id="cb451-16"><a href="#cb451-16" aria-hidden="true" tabindex="-1"></a>tab</span>
<span id="cb451-17"><a href="#cb451-17" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">prop.table</span>(tab)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb451-18"><a href="#cb451-18" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">prop.table</span>(tab, <span class="at">margin =</span> <span class="dv">1</span>), <span class="at">margin =</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb451-19"><a href="#cb451-19" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">prop.table</span>(tab, <span class="at">margin =</span> <span class="dv">2</span>), <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-109-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-109-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb452"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : ajouter une une ligne avec les sommes !</span></span>
<span id="cb452-2"><a href="#cb452-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableau de fréquence</span></span>
<span id="cb452-3"><a href="#cb452-3" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb452-4"><a href="#cb452-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cspf, sexef) <span class="sc">%&gt;%</span> </span>
<span id="cb452-5"><a href="#cb452-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">prop =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop_last"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb452-6"><a href="#cb452-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb452-7"><a href="#cb452-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> prop <span class="sc">/</span> <span class="fu">sum</span>(prop) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb452-8"><a href="#cb452-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(sexef, prop) <span class="sc">%&gt;%</span> </span>
<span id="cb452-9"><a href="#cb452-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb452-10"><a href="#cb452-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb452-11"><a href="#cb452-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions par ligne</span></span>
<span id="cb452-12"><a href="#cb452-12" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb452-13"><a href="#cb452-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cspf, sexef) <span class="sc">%&gt;%</span> </span>
<span id="cb452-14"><a href="#cb452-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">prop =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb452-15"><a href="#cb452-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> prop <span class="sc">/</span> <span class="fu">sum</span>(prop) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb452-16"><a href="#cb452-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(sexef, prop)</span>
<span id="cb452-17"><a href="#cb452-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb452-18"><a href="#cb452-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions par colonne</span></span>
<span id="cb452-19"><a href="#cb452-19" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb452-20"><a href="#cb452-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sexef, cspf) <span class="sc">%&gt;%</span> </span>
<span id="cb452-21"><a href="#cb452-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">prop =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb452-22"><a href="#cb452-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> prop <span class="sc">/</span> <span class="fu">sum</span>(prop) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb452-23"><a href="#cb452-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(sexef, prop)</span>
<span id="cb452-24"><a href="#cb452-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb452-25"><a href="#cb452-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb452-26"><a href="#cb452-26" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb452-27"><a href="#cb452-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(cspf, sexef, <span class="at">wt =</span> poids_sondage, <span class="at">name =</span> <span class="st">"prop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb452-28"><a href="#cb452-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb452-29"><a href="#cb452-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> prop <span class="sc">/</span> <span class="fu">sum</span>(prop) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb452-30"><a href="#cb452-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># À FAIRE : pourrait-on sommer directement avec pivot_wider ? Argument values_fn?</span></span>
<span id="cb452-31"><a href="#cb452-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ne semble pas fonctionner, pourqoi ???</span></span>
<span id="cb452-32"><a href="#cb452-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> sexef, <span class="at">values_from =</span> prop) <span class="sc">%&gt;%</span> </span>
<span id="cb452-33"><a href="#cb452-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Somme par lignes</span></span>
<span id="cb452-34"><a href="#cb452-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb452-35"><a href="#cb452-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution avec rowwise : bien penser à c_across et non across !</span></span>
<span id="cb452-36"><a href="#cb452-36" aria-hidden="true" tabindex="-1"></a><span class="co">#rowwise() %&gt;% </span></span>
<span id="cb452-37"><a href="#cb452-37" aria-hidden="true" tabindex="-1"></a><span class="co">#mutate(Total = sum(c_across(where(is.numeric)), na.rm = T)) %&gt;% </span></span>
<span id="cb452-38"><a href="#cb452-38" aria-hidden="true" tabindex="-1"></a><span class="co">#ungroup()</span></span>
<span id="cb452-39"><a href="#cb452-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Somme par colonnes</span></span>
<span id="cb452-40"><a href="#cb452-40" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab, tab <span class="sc">%&gt;%</span> </span>
<span id="cb452-41"><a href="#cb452-41" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), \(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb452-42"><a href="#cb452-42" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">across</span>(<span class="fu">where</span>(is.character), <span class="sc">~</span><span class="st">"Total"</span>))</span>
<span id="cb452-43"><a href="#cb452-43" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb452-44"><a href="#cb452-44" aria-hidden="true" tabindex="-1"></a>tab</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-109-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-109-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb453"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb453-1"><a href="#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableau simple</span></span>
<span id="cb453-2"><a href="#cb453-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">table</span>(cspf, sexef, <span class="at">useNA =</span> <span class="st">"always"</span>) ]</span>
<span id="cb453-3"><a href="#cb453-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableau avec les sommes</span></span>
<span id="cb453-4"><a href="#cb453-4" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">addmargins</span>(<span class="fu">table</span>(cspf, sexef, <span class="at">useNA =</span> <span class="st">"always"</span>)) ]</span>
<span id="cb453-5"><a href="#cb453-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions</span></span>
<span id="cb453-6"><a href="#cb453-6" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> donnees_datatable[, <span class="fu">table</span>(cspf, sexef, <span class="at">useNA =</span> <span class="st">"always"</span>) ]</span>
<span id="cb453-7"><a href="#cb453-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions par case</span></span>
<span id="cb453-8"><a href="#cb453-8" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">prop.table</span>(tab)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb453-9"><a href="#cb453-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions par ligne</span></span>
<span id="cb453-10"><a href="#cb453-10" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">prop.table</span>(tab, <span class="at">margin =</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb453-11"><a href="#cb453-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions par colonne</span></span>
<span id="cb453-12"><a href="#cb453-12" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">prop.table</span>(tab, <span class="at">margin =</span> <span class="dv">2</span>)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb453-13"><a href="#cb453-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb453-14"><a href="#cb453-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution alternative, sans pondération</span></span>
<span id="cb453-15"><a href="#cb453-15" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> donnees_datatable[, <span class="fu">xtabs</span>(<span class="sc">~</span> cspf <span class="sc">+</span> sexef, <span class="at">data =</span> donnees_datatable) ]</span>
<span id="cb453-16"><a href="#cb453-16" aria-hidden="true" tabindex="-1"></a>tab</span>
<span id="cb453-17"><a href="#cb453-17" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">prop.table</span>(tab)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb453-18"><a href="#cb453-18" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">prop.table</span>(tab, <span class="at">margin =</span> <span class="dv">1</span>), <span class="at">margin =</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb453-19"><a href="#cb453-19" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">prop.table</span>(tab, <span class="at">margin =</span> <span class="dv">2</span>), <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb453-20"><a href="#cb453-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb453-21"><a href="#cb453-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution, avec les Grouping sets</span></span>
<span id="cb453-22"><a href="#cb453-22" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">cube</span>(donnees_datatable, .(<span class="at">Nb =</span> .N), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cspf"</span>, <span class="st">"sexef"</span>))</span>
<span id="cb453-23"><a href="#cb453-23" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">dcast</span>(tab, cspf <span class="sc">~</span> sexef, <span class="at">value.var =</span> <span class="st">"Nb"</span>)</span>
<span id="cb453-24"><a href="#cb453-24" aria-hidden="true" tabindex="-1"></a><span class="co"># On harmonise le tableau</span></span>
<span id="cb453-25"><a href="#cb453-25" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">rbind</span>(tab[<span class="dv">2</span><span class="sc">:</span><span class="fu">nrow</span>(tab)], tab[<span class="dv">1</span>,])</span>
<span id="cb453-26"><a href="#cb453-26" aria-hidden="true" tabindex="-1"></a><span class="fu">setcolorder</span>(tab, <span class="fu">c</span>(<span class="fu">setdiff</span>(<span class="fu">names</span>(tab), <span class="st">"NA"</span>), <span class="st">"NA"</span>))</span>
<span id="cb453-27"><a href="#cb453-27" aria-hidden="true" tabindex="-1"></a><span class="co"># On renomme la ligne et la colonne des totaux</span></span>
<span id="cb453-28"><a href="#cb453-28" aria-hidden="true" tabindex="-1"></a>tab[<span class="fu">nrow</span>(tab), <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Total"</span></span>
<span id="cb453-29"><a href="#cb453-29" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tab)[<span class="fu">which</span>(<span class="fu">names</span>(tab) <span class="sc">==</span> <span class="st">"NA"</span>)] <span class="ot">&lt;-</span> <span class="st">"Total"</span></span>
<span id="cb453-30"><a href="#cb453-30" aria-hidden="true" tabindex="-1"></a>tab</span>
<span id="cb453-31"><a href="#cb453-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb453-32"><a href="#cb453-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre façon d'utiliser les méthodes de data.table</span></span>
<span id="cb453-33"><a href="#cb453-33" aria-hidden="true" tabindex="-1"></a>tab_prop <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">dcast</span>(donnees_datatable, cspf <span class="sc">~</span> sexef, <span class="at">fun.aggregate =</span> length)</span>
<span id="cb453-34"><a href="#cb453-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportion par ligne</span></span>
<span id="cb453-35"><a href="#cb453-35" aria-hidden="true" tabindex="-1"></a>tab_prop[, .SD <span class="sc">/</span> <span class="fu">Reduce</span>(<span class="st">`</span><span class="at">+</span><span class="st">`</span>, .SD), cspf]</span>
<span id="cb453-36"><a href="#cb453-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportion par colonne</span></span>
<span id="cb453-37"><a href="#cb453-37" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">unique</span>(donnees_datatable[, (sexef)])</span>
<span id="cb453-38"><a href="#cb453-38" aria-hidden="true" tabindex="-1"></a>tab_prop[, (<span class="fu">lapply</span>(.SD, <span class="cf">function</span>(col) col <span class="sc">/</span> <span class="fu">sum</span>(col))), .SDcols <span class="ot">=</span> cols]</span>
<span id="cb453-39"><a href="#cb453-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb453-40"><a href="#cb453-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour avoir les sommes lignes</span></span>
<span id="cb453-41"><a href="#cb453-41" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : ne marche pas, à revoir !</span></span>
<span id="cb453-42"><a href="#cb453-42" aria-hidden="true" tabindex="-1"></a><span class="co">#tab_prop &lt;- data.table::dcast(donnees_datatable, cspf ~ sexef, fun.aggregate = length)</span></span>
<span id="cb453-43"><a href="#cb453-43" aria-hidden="true" tabindex="-1"></a><span class="co">#tab_prop[, Total := rowSums(.SD), .SDcols = is.numeric]</span></span>
<span id="cb453-44"><a href="#cb453-44" aria-hidden="true" tabindex="-1"></a><span class="co">#tab_prop &lt;- rbind(tab_prop, tab_prop[, c(cspf = "Total", lapply(.SD, sum, na.rm = TRUE)),</span></span>
<span id="cb453-45"><a href="#cb453-45" aria-hidden="true" tabindex="-1"></a><span class="co">#                                     .SDcols = is.numeric],</span></span>
<span id="cb453-46"><a href="#cb453-46" aria-hidden="true" tabindex="-1"></a><span class="co">#                  fill = TRUE)</span></span>
<span id="cb453-47"><a href="#cb453-47" aria-hidden="true" tabindex="-1"></a><span class="co">#tab_prop[, (lapply(.SD, function(col) col / sum(col))), .SDcols = -1]</span></span>
<span id="cb453-48"><a href="#cb453-48" aria-hidden="true" tabindex="-1"></a><span class="do">## Pour avoir les sommes colonnes</span></span>
<span id="cb453-49"><a href="#cb453-49" aria-hidden="true" tabindex="-1"></a><span class="co">#tab[, sum(.SD), by = 1:nrow(tab), .SDcols = is.numeric]</span></span>
<span id="cb453-50"><a href="#cb453-50" aria-hidden="true" tabindex="-1"></a><span class="co">#tab[, (lapply(.SD, function(col) col / sum(col))), .SDcols = -1]</span></span>
<span id="cb453-51"><a href="#cb453-51" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb453-52"><a href="#cb453-52" aria-hidden="true" tabindex="-1"></a><span class="do">## Autre solution plus pratique avec data.table</span></span>
<span id="cb453-53"><a href="#cb453-53" aria-hidden="true" tabindex="-1"></a><span class="do">## Manipuler des formules sur R</span></span>
<span id="cb453-54"><a href="#cb453-54" aria-hidden="true" tabindex="-1"></a><span class="co">#variable &lt;- c("cspf", "sexef")</span></span>
<span id="cb453-55"><a href="#cb453-55" aria-hidden="true" tabindex="-1"></a><span class="co">#formule &lt;- as.formula(paste(paste(variable, collapse = " + "), ".", sep = " ~ "))</span></span>
<span id="cb453-56"><a href="#cb453-56" aria-hidden="true" tabindex="-1"></a><span class="co">#tab_prop &lt;- data.table::dcast(donnees_datatable, formule, fun.aggregate = length)</span></span>
<span id="cb453-57"><a href="#cb453-57" aria-hidden="true" tabindex="-1"></a><span class="co">#colnames(tab_prop)[colnames(tab_prop) == "."] &lt;- "total"</span></span>
<span id="cb453-58"><a href="#cb453-58" aria-hidden="true" tabindex="-1"></a><span class="co">#tab_prop[, prop := total / sum(total)]</span></span>
<span id="cb453-59"><a href="#cb453-59" aria-hidden="true" tabindex="-1"></a><span class="do">## Le tableau est remis sous forme croisée</span></span>
<span id="cb453-60"><a href="#cb453-60" aria-hidden="true" tabindex="-1"></a><span class="co">#tab_prop &lt;- dcast(tab_prop, cspf ~ sexef, value.var = c("prop"), fill = 0)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-109-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-109-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="tableau-de-contingence-avec-pondération" class="level2" data-number="15.6">
<h2 data-number="15.6" class="anchored" data-anchor-id="tableau-de-contingence-avec-pondération"><span class="header-section-number">15.6</span> Tableau de contingence avec pondération</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-110-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-110-1" role="tab" aria-controls="tabset-110-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-110-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-110-2" role="tab" aria-controls="tabset-110-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-110-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-110-3" role="tab" aria-controls="tabset-110-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-110-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-110-4" role="tab" aria-controls="tabset-110-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-110-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-110-5" role="tab" aria-controls="tabset-110-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-110-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-110-1-tab">
<div class="sourceCode" id="cb454"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> freq<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb454-2"><a href="#cb454-2" aria-hidden="true" tabindex="-1"></a>  tables Sexe * CSP / missing;</span>
<span id="cb454-3"><a href="#cb454-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Sexe sexef. CSP $cspf.;</span>
<span id="cb454-4"><a href="#cb454-4" aria-hidden="true" tabindex="-1"></a>  weight poids_sondage;</span>
<span id="cb454-5"><a href="#cb454-5" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-110-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-110-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb455"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb455-1"><a href="#cb455-1" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(poids_sondage <span class="sc">~</span> cspf <span class="sc">+</span> sexef, <span class="at">data =</span> donnees_rbase, <span class="at">addNA =</span> <span class="cn">TRUE</span>)</span>
<span id="cb455-2"><a href="#cb455-2" aria-hidden="true" tabindex="-1"></a>tab</span>
<span id="cb455-3"><a href="#cb455-3" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">prop.table</span>(tab)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb455-4"><a href="#cb455-4" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">prop.table</span>(tab, <span class="at">margin =</span> <span class="dv">1</span>), <span class="at">margin =</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb455-5"><a href="#cb455-5" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">prop.table</span>(tab, <span class="at">margin =</span> <span class="dv">2</span>), <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-110-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-110-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb456"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec la fonction count</span></span>
<span id="cb456-2"><a href="#cb456-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb456-3"><a href="#cb456-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(cspf, sexef, <span class="at">wt =</span> poids_sondage, <span class="at">name =</span> <span class="st">"prop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb456-4"><a href="#cb456-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb456-5"><a href="#cb456-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> prop <span class="sc">/</span> <span class="fu">sum</span>(prop) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb456-6"><a href="#cb456-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(sexef, prop)</span>
<span id="cb456-7"><a href="#cb456-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec la fonction summarise</span></span>
<span id="cb456-8"><a href="#cb456-8" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb456-9"><a href="#cb456-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cspf, sexef) <span class="sc">%&gt;%</span> </span>
<span id="cb456-10"><a href="#cb456-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">prop =</span> <span class="fu">sum</span>(poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb456-11"><a href="#cb456-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb456-12"><a href="#cb456-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> prop <span class="sc">/</span> <span class="fu">sum</span>(prop) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb456-13"><a href="#cb456-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(sexef, prop)</span>
<span id="cb456-14"><a href="#cb456-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec ajout des sommes par ligne et colonne</span></span>
<span id="cb456-15"><a href="#cb456-15" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb456-16"><a href="#cb456-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(cspf, sexef, <span class="at">wt =</span> poids_sondage, <span class="at">name =</span> <span class="st">"prop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb456-17"><a href="#cb456-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb456-18"><a href="#cb456-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> prop <span class="sc">/</span> <span class="fu">sum</span>(prop) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb456-19"><a href="#cb456-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># À FAIRE : pourrait-on sommer directement avec pivot_wider ? Argument values_fn?</span></span>
<span id="cb456-20"><a href="#cb456-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ne semble pas fonctionner, pourqoi ???</span></span>
<span id="cb456-21"><a href="#cb456-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> sexef, <span class="at">values_from =</span> prop) <span class="sc">%&gt;%</span> </span>
<span id="cb456-22"><a href="#cb456-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Somme par lignes</span></span>
<span id="cb456-23"><a href="#cb456-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb456-24"><a href="#cb456-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Autre solution avec rowwise : bien penser à c_across et non across !</span></span>
<span id="cb456-25"><a href="#cb456-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#rowwise() %&gt;% </span></span>
<span id="cb456-26"><a href="#cb456-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(Total = sum(c_across(where(is.numeric)), na.rm = T)) %&gt;% </span></span>
<span id="cb456-27"><a href="#cb456-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ungroup()</span></span>
<span id="cb456-28"><a href="#cb456-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Somme par colonnes</span></span>
<span id="cb456-29"><a href="#cb456-29" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(tab, tab <span class="sc">%&gt;%</span> </span>
<span id="cb456-30"><a href="#cb456-30" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb456-31"><a href="#cb456-31" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">across</span>(<span class="fu">where</span>(is.character), <span class="sc">~</span><span class="st">"Total"</span>))</span>
<span id="cb456-32"><a href="#cb456-32" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb456-33"><a href="#cb456-33" aria-hidden="true" tabindex="-1"></a>tab</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-110-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-110-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb457"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb457-1"><a href="#cb457-1" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> donnees_datatable[, <span class="fu">xtabs</span>(poids_sondage <span class="sc">~</span> cspf <span class="sc">+</span> sexef, <span class="at">data =</span> donnees_datatable, <span class="at">addNA =</span> <span class="cn">TRUE</span>) ]</span>
<span id="cb457-2"><a href="#cb457-2" aria-hidden="true" tabindex="-1"></a>tab</span>
<span id="cb457-3"><a href="#cb457-3" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">prop.table</span>(tab)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb457-4"><a href="#cb457-4" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">prop.table</span>(tab, <span class="at">margin =</span> <span class="dv">1</span>), <span class="at">margin =</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb457-5"><a href="#cb457-5" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">prop.table</span>(tab, <span class="at">margin =</span> <span class="dv">2</span>), <span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-110-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-110-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="copier-coller-le-tableau-dans-un-tableur-excel-etc." class="level2" data-number="15.7">
<h2 data-number="15.7" class="anchored" data-anchor-id="copier-coller-le-tableau-dans-un-tableur-excel-etc."><span class="header-section-number">15.7</span> Copier-coller le tableau dans un tableur (Excel, etc.)</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-111-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-111-1" role="tab" aria-controls="tabset-111-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-111-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-111-2" role="tab" aria-controls="tabset-111-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-111-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-111-3" role="tab" aria-controls="tabset-111-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-111-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-111-4" role="tab" aria-controls="tabset-111-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-111-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-111-5" role="tab" aria-controls="tabset-111-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-111-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-111-1-tab">
<div class="sourceCode" id="cb458"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Copier-coller le résultat sur la fenêtre html "Results Viewer" */</span></span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> freq<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb458-3"><a href="#cb458-3" aria-hidden="true" tabindex="-1"></a>  tables Sexe * CSP / missing chisq;</span>
<span id="cb458-4"><a href="#cb458-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Sexe sexef. CSP $cspf.;</span>
<span id="cb458-5"><a href="#cb458-5" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-111-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-111-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb459"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb459-1"><a href="#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On utilise les packages knitr et kableExtra</span></span>
<span id="cb459-2"><a href="#cb459-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb459-3"><a href="#cb459-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb459-4"><a href="#cb459-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d'un tableau</span></span>
<span id="cb459-5"><a href="#cb459-5" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(<span class="sc">~</span> cspf <span class="sc">+</span> sexef, <span class="at">data =</span> donnees_rbase)</span>
<span id="cb459-6"><a href="#cb459-6" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">addmargins</span>(<span class="fu">prop.table</span>(tab)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb459-7"><a href="#cb459-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb459-8"><a href="#cb459-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher de façon plus jolie un tableau</span></span>
<span id="cb459-9"><a href="#cb459-9" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(tab)</span>
<span id="cb459-10"><a href="#cb459-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb459-11"><a href="#cb459-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Copier-coller le résultat vers Excel</span></span>
<span id="cb459-12"><a href="#cb459-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Il suffit d'appliquer ce code ....</span></span>
<span id="cb459-13"><a href="#cb459-13" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_paper</span>(kableExtra<span class="sc">::</span><span class="fu">kbl</span>(tab), <span class="st">"hover"</span>, <span class="at">full_width =</span> F)</span>
<span id="cb459-14"><a href="#cb459-14" aria-hidden="true" tabindex="-1"></a><span class="co"># ... et de copier-coller le résultat de la fenêtre Viewer vers Excel</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-111-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-111-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb460"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On utilise les packages knitr et kableExtra</span></span>
<span id="cb460-2"><a href="#cb460-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb460-3"><a href="#cb460-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb460-4"><a href="#cb460-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d'un tableau</span></span>
<span id="cb460-5"><a href="#cb460-5" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb460-6"><a href="#cb460-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cspf, sexef) <span class="sc">%&gt;%</span> </span>
<span id="cb460-7"><a href="#cb460-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">prop =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop_last"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb460-8"><a href="#cb460-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb460-9"><a href="#cb460-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> prop <span class="sc">/</span> <span class="fu">sum</span>(prop) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb460-10"><a href="#cb460-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(sexef, prop)</span>
<span id="cb460-11"><a href="#cb460-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb460-12"><a href="#cb460-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher de façon plus jolie un tableau</span></span>
<span id="cb460-13"><a href="#cb460-13" aria-hidden="true" tabindex="-1"></a>tab <span class="sc">%&gt;%</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb460-14"><a href="#cb460-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb460-15"><a href="#cb460-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Copier-coller le résultat vers Excel</span></span>
<span id="cb460-16"><a href="#cb460-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Il suffit d'appliquer ce code ....</span></span>
<span id="cb460-17"><a href="#cb460-17" aria-hidden="true" tabindex="-1"></a>tab <span class="sc">%&gt;%</span> </span>
<span id="cb460-18"><a href="#cb460-18" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb460-19"><a href="#cb460-19" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_paper</span>(<span class="st">"hover"</span>, <span class="at">full_width =</span> F)</span>
<span id="cb460-20"><a href="#cb460-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ... et de copier-coller le résultat de la fenêtre Viewer vers Excel</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-111-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-111-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb461"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb461-1"><a href="#cb461-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On utilise les packages knitr et kableExtra</span></span>
<span id="cb461-2"><a href="#cb461-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb461-3"><a href="#cb461-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb461-4"><a href="#cb461-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d'un tableau</span></span>
<span id="cb461-5"><a href="#cb461-5" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> donnees_datatable[, <span class="fu">xtabs</span>(poids_sondage <span class="sc">~</span> cspf <span class="sc">+</span> sexef, <span class="at">data =</span> donnees_datatable, <span class="at">addNA =</span> <span class="cn">TRUE</span>) ]</span>
<span id="cb461-6"><a href="#cb461-6" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> </span>
<span id="cb461-7"><a href="#cb461-7" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">prop.table</span>(tab)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb461-8"><a href="#cb461-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb461-9"><a href="#cb461-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher de façon plus jolie un tableau</span></span>
<span id="cb461-10"><a href="#cb461-10" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(tab)</span>
<span id="cb461-11"><a href="#cb461-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb461-12"><a href="#cb461-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Copier-coller le résultat vers Excel</span></span>
<span id="cb461-13"><a href="#cb461-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Il suffit d'appliquer ce code ....</span></span>
<span id="cb461-14"><a href="#cb461-14" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_paper</span>(kableExtra<span class="sc">::</span><span class="fu">kbl</span>(tab), <span class="st">"hover"</span>, <span class="at">full_width =</span> F)</span>
<span id="cb461-15"><a href="#cb461-15" aria-hidden="true" tabindex="-1"></a><span class="co"># ... et de copier-coller le résultat de la fenêtre Viewer vers Excel</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-111-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-111-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="tests-dassociaton-chi-deux-etc." class="level2" data-number="15.8">
<h2 data-number="15.8" class="anchored" data-anchor-id="tests-dassociaton-chi-deux-etc."><span class="header-section-number">15.8</span> Tests d’associaton (Chi-Deux, etc.)</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-112-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-112-1" role="tab" aria-controls="tabset-112-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-112-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-112-2" role="tab" aria-controls="tabset-112-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-112-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-112-3" role="tab" aria-controls="tabset-112-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-112-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-112-4" role="tab" aria-controls="tabset-112-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-112-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-112-5" role="tab" aria-controls="tabset-112-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-112-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-112-1-tab">
<div class="sourceCode" id="cb462"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> freq<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb462-2"><a href="#cb462-2" aria-hidden="true" tabindex="-1"></a>  tables Sexe * CSP / missing chisq;</span>
<span id="cb462-3"><a href="#cb462-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Sexe sexef. CSP $cspf.;</span>
<span id="cb462-4"><a href="#cb462-4" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-112-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-112-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb463"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb463-1"><a href="#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test du Khi-Deux</span></span>
<span id="cb463-2"><a href="#cb463-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(donnees_rbase, <span class="fu">chisq.test</span>(cspf, sexef))</span>
<span id="cb463-3"><a href="#cb463-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">table</span>(donnees_rbase<span class="sc">$</span>cspf, donnees_rbase<span class="sc">$</span>sexef))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-112-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-112-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb464"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test du Khi-Deux</span></span>
<span id="cb464-2"><a href="#cb464-2" aria-hidden="true" tabindex="-1"></a><span class="co">#donnees_tidyverse %&gt;%</span></span>
<span id="cb464-3"><a href="#cb464-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  summarise(a = chisq.test(sexef, cspf))</span></span>
<span id="cb464-4"><a href="#cb464-4" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : fonctionne, mais pas vraiment Tidyverse</span></span>
<span id="cb464-5"><a href="#cb464-5" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(donnees_tidyverse, <span class="fu">chisq.test</span>(cspf, sexef))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-112-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-112-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb465"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb465-1"><a href="#cb465-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test du Khi-Deux</span></span>
<span id="cb465-2"><a href="#cb465-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">chisq.test</span>(cspf, sexef)]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-112-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-112-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="solutions-avec-package-r-permettant-de-pondérer" class="level2" data-number="15.9">
<h2 data-number="15.9" class="anchored" data-anchor-id="solutions-avec-package-r-permettant-de-pondérer"><span class="header-section-number">15.9</span> Solutions avec package R permettant de pondérer</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-113-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-113-1" role="tab" aria-controls="tabset-113-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-113-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-113-2" role="tab" aria-controls="tabset-113-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-113-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-113-3" role="tab" aria-controls="tabset-113-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-113-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-113-4" role="tab" aria-controls="tabset-113-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-113-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-113-5" role="tab" aria-controls="tabset-113-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-113-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-113-1-tab">
<div class="sourceCode" id="cb466"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb466-1"><a href="#cb466-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Sans objet pour SAS */</span></span>
<span id="cb466-2"><a href="#cb466-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> freq<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb466-3"><a href="#cb466-3" aria-hidden="true" tabindex="-1"></a>  tables Sexe * CSP / missing;</span>
<span id="cb466-4"><a href="#cb466-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Sexe sexef. CSP $cspf.;</span>
<span id="cb466-5"><a href="#cb466-5" aria-hidden="true" tabindex="-1"></a>  weight poids_sondage;</span>
<span id="cb466-6"><a href="#cb466-6" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-113-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-113-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb467"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb467-1"><a href="#cb467-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre possibilité, avec packages, pour avoir la même présentation que la proc freq de SAS</span></span>
<span id="cb467-2"><a href="#cb467-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 4 packages paraissent pertinents : descr, flextable, survey, procs</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-113-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-113-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb468"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre possibilité, avec packages, pour avoir la même présentation que la proc freq de SAS</span></span>
<span id="cb468-2"><a href="#cb468-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 4 packages paraissent pertinents : descr, flextable, survey, procs</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-113-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-113-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb469"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb469-1"><a href="#cb469-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre possibilité, avec packages, pour avoir la même présentation que la proc freq de SAS</span></span>
<span id="cb469-2"><a href="#cb469-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 4 packages paraissent pertinents : descr, flextable, survey, procs</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-113-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-113-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="package-descr" class="level2" data-number="15.10">
<h2 data-number="15.10" class="anchored" data-anchor-id="package-descr"><span class="header-section-number">15.10</span> Package descr</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-114-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-114-1" role="tab" aria-controls="tabset-114-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-114-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-114-2" role="tab" aria-controls="tabset-114-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-114-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-114-3" role="tab" aria-controls="tabset-114-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-114-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-114-4" role="tab" aria-controls="tabset-114-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-114-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-114-5" role="tab" aria-controls="tabset-114-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-114-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-114-1-tab">
<div class="sourceCode" id="cb470"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Sans objet pour SAS */</span></span>
<span id="cb470-2"><a href="#cb470-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> freq<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb470-3"><a href="#cb470-3" aria-hidden="true" tabindex="-1"></a>  tables Sexe * CSP / missing;</span>
<span id="cb470-4"><a href="#cb470-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Sexe sexef. CSP $cspf.;</span>
<span id="cb470-5"><a href="#cb470-5" aria-hidden="true" tabindex="-1"></a>  weight poids_sondage;</span>
<span id="cb470-6"><a href="#cb470-6" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-114-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-114-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb471"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb471-1"><a href="#cb471-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(descr)</span>
<span id="cb471-2"><a href="#cb471-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Non pondéré</span></span>
<span id="cb471-3"><a href="#cb471-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(donnees_rbase, descr<span class="sc">::</span><span class="fu">crosstab</span>(cspf, sexef,                         <span class="at">prop.r =</span> <span class="cn">TRUE</span>, <span class="at">prop.c =</span> <span class="cn">TRUE</span>, <span class="at">prop.t =</span> <span class="cn">TRUE</span>))</span>
<span id="cb471-4"><a href="#cb471-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Pondéré</span></span>
<span id="cb471-5"><a href="#cb471-5" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(donnees_rbase, descr<span class="sc">::</span><span class="fu">crosstab</span>(cspf, sexef, <span class="at">weight =</span> poids_sondage, <span class="at">prop.r =</span> <span class="cn">TRUE</span>, <span class="at">prop.c =</span> <span class="cn">TRUE</span>, <span class="at">prop.t =</span> <span class="cn">TRUE</span>))</span>
<span id="cb471-6"><a href="#cb471-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Sans les proportions par ligne et colonne</span></span>
<span id="cb471-7"><a href="#cb471-7" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(donnees_rbase, descr<span class="sc">::</span><span class="fu">crosstab</span>(cspf, sexef, <span class="at">weight =</span> poids_sondage, <span class="at">prop.r =</span> <span class="cn">FALSE</span>, <span class="at">prop.c =</span> <span class="cn">FALSE</span>, <span class="at">prop.t =</span> <span class="cn">TRUE</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-114-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-114-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb472"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb472-1"><a href="#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : est-il possible d'appliquer le pipe ???</span></span>
<span id="cb472-2"><a href="#cb472-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(descr)</span>
<span id="cb472-3"><a href="#cb472-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Non pondéré</span></span>
<span id="cb472-4"><a href="#cb472-4" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(donnees_tidyverse, descr<span class="sc">::</span><span class="fu">crosstab</span>(cspf, sexef,                         <span class="at">prop.r =</span> <span class="cn">TRUE</span>, <span class="at">prop.c =</span> <span class="cn">TRUE</span>, <span class="at">prop.t =</span> <span class="cn">TRUE</span>))</span>
<span id="cb472-5"><a href="#cb472-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pondéré</span></span>
<span id="cb472-6"><a href="#cb472-6" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(donnees_tidyverse, descr<span class="sc">::</span><span class="fu">crosstab</span>(cspf, sexef, <span class="at">weight =</span> poids_sondage, <span class="at">prop.r =</span> <span class="cn">TRUE</span>, <span class="at">prop.c =</span> <span class="cn">TRUE</span>, <span class="at">prop.t =</span> <span class="cn">TRUE</span>))</span>
<span id="cb472-7"><a href="#cb472-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Sans les proportions par ligne et colonne</span></span>
<span id="cb472-8"><a href="#cb472-8" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(donnees_tidyverse, descr<span class="sc">::</span><span class="fu">crosstab</span>(cspf, sexef, <span class="at">weight =</span> poids_sondage, <span class="at">prop.r =</span> <span class="cn">FALSE</span>, <span class="at">prop.c =</span> <span class="cn">FALSE</span>, <span class="at">prop.t =</span> <span class="cn">TRUE</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-114-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-114-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb473"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb473-1"><a href="#cb473-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(descr)</span>
<span id="cb473-2"><a href="#cb473-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Non pondéré</span></span>
<span id="cb473-3"><a href="#cb473-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(donnees_datatable, descr<span class="sc">::</span><span class="fu">crosstab</span>(cspf, sexef,                         <span class="at">prop.r =</span> <span class="cn">TRUE</span>, <span class="at">prop.c =</span> <span class="cn">TRUE</span>, <span class="at">prop.t =</span> <span class="cn">TRUE</span>))</span>
<span id="cb473-4"><a href="#cb473-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Pondéré</span></span>
<span id="cb473-5"><a href="#cb473-5" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(donnees_datatable, descr<span class="sc">::</span><span class="fu">crosstab</span>(cspf, sexef, <span class="at">weight =</span> poids_sondage, <span class="at">prop.r =</span> <span class="cn">TRUE</span>, <span class="at">prop.c =</span> <span class="cn">TRUE</span>, <span class="at">prop.t =</span> <span class="cn">TRUE</span>))</span>
<span id="cb473-6"><a href="#cb473-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Sans les proportions par ligne et colonne</span></span>
<span id="cb473-7"><a href="#cb473-7" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(donnees_datatable, descr<span class="sc">::</span><span class="fu">crosstab</span>(cspf, sexef, <span class="at">weight =</span> poids_sondage, <span class="at">prop.r =</span> <span class="cn">FALSE</span>, <span class="at">prop.c =</span> <span class="cn">FALSE</span>, <span class="at">prop.t =</span> <span class="cn">TRUE</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-114-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-114-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="package-flextable" class="level2" data-number="15.11">
<h2 data-number="15.11" class="anchored" data-anchor-id="package-flextable"><span class="header-section-number">15.11</span> Package flextable</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-115-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-115-1" role="tab" aria-controls="tabset-115-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-115-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-115-2" role="tab" aria-controls="tabset-115-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-115-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-115-3" role="tab" aria-controls="tabset-115-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-115-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-115-4" role="tab" aria-controls="tabset-115-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-115-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-115-5" role="tab" aria-controls="tabset-115-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-115-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-115-1-tab">
<div class="sourceCode" id="cb474"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb474-1"><a href="#cb474-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Sans objet pour SAS */</span></span>
<span id="cb474-2"><a href="#cb474-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> freq<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb474-3"><a href="#cb474-3" aria-hidden="true" tabindex="-1"></a>  tables Sexe * CSP / missing;</span>
<span id="cb474-4"><a href="#cb474-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Sexe sexef. CSP $cspf.;</span>
<span id="cb474-5"><a href="#cb474-5" aria-hidden="true" tabindex="-1"></a>  weight poids_sondage;</span>
<span id="cb474-6"><a href="#cb474-6" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-115-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-115-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb475"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb475-1"><a href="#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb475-2"><a href="#cb475-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Non pondéré</span></span>
<span id="cb475-3"><a href="#cb475-3" aria-hidden="true" tabindex="-1"></a>flextable<span class="sc">::</span><span class="fu">proc_freq</span>(donnees_rbase, <span class="st">"cspf"</span>, <span class="st">"sexef"</span>)</span>
<span id="cb475-4"><a href="#cb475-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Pondéré</span></span>
<span id="cb475-5"><a href="#cb475-5" aria-hidden="true" tabindex="-1"></a>flextable<span class="sc">::</span><span class="fu">proc_freq</span>(donnees_rbase, <span class="st">"cspf"</span>, <span class="st">"sexef"</span>, <span class="at">weight =</span> <span class="st">"poids_sondage"</span>)</span>
<span id="cb475-6"><a href="#cb475-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Sans les proportions par ligne et colonne</span></span>
<span id="cb475-7"><a href="#cb475-7" aria-hidden="true" tabindex="-1"></a>flextable<span class="sc">::</span><span class="fu">proc_freq</span>(donnees_rbase, <span class="st">"cspf"</span>, <span class="st">"sexef"</span>, <span class="at">weight =</span> <span class="st">"poids_sondage"</span>, <span class="at">include.row_percent =</span> <span class="cn">FALSE</span>,</span>
<span id="cb475-8"><a href="#cb475-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">include.column_percent =</span> <span class="cn">FALSE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-115-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-115-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb476"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb476-1"><a href="#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : est-il possible d'appliquer le pipe ???</span></span>
<span id="cb476-2"><a href="#cb476-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb476-3"><a href="#cb476-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Non pondéré</span></span>
<span id="cb476-4"><a href="#cb476-4" aria-hidden="true" tabindex="-1"></a>flextable<span class="sc">::</span><span class="fu">proc_freq</span>(donnees_tidyverse, <span class="st">"cspf"</span>, <span class="st">"sexef"</span>)</span>
<span id="cb476-5"><a href="#cb476-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pondéré</span></span>
<span id="cb476-6"><a href="#cb476-6" aria-hidden="true" tabindex="-1"></a>flextable<span class="sc">::</span><span class="fu">proc_freq</span>(donnees_tidyverse, <span class="st">"cspf"</span>, <span class="st">"sexef"</span>, <span class="at">weight =</span> <span class="st">"poids_sondage"</span>)</span>
<span id="cb476-7"><a href="#cb476-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Sans les proportions par ligne et colonne</span></span>
<span id="cb476-8"><a href="#cb476-8" aria-hidden="true" tabindex="-1"></a>flextable<span class="sc">::</span><span class="fu">proc_freq</span>(donnees_tidyverse, <span class="st">"cspf"</span>, <span class="st">"sexef"</span>, <span class="at">weight =</span> <span class="st">"poids_sondage"</span>, <span class="at">include.row_percent =</span> <span class="cn">FALSE</span>,</span>
<span id="cb476-9"><a href="#cb476-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">include.column_percent =</span> <span class="cn">FALSE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-115-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-115-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb477"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb477-1"><a href="#cb477-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb477-2"><a href="#cb477-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Non pondéré</span></span>
<span id="cb477-3"><a href="#cb477-3" aria-hidden="true" tabindex="-1"></a>flextable<span class="sc">::</span><span class="fu">proc_freq</span>(donnees_datatable, <span class="st">"cspf"</span>, <span class="st">"sexef"</span>)</span>
<span id="cb477-4"><a href="#cb477-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Pondéré</span></span>
<span id="cb477-5"><a href="#cb477-5" aria-hidden="true" tabindex="-1"></a>flextable<span class="sc">::</span><span class="fu">proc_freq</span>(donnees_datatable, <span class="st">"cspf"</span>, <span class="st">"sexef"</span>, <span class="at">weight =</span> <span class="st">"poids_sondage"</span>)</span>
<span id="cb477-6"><a href="#cb477-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Sans les proportions par ligne et colonne</span></span>
<span id="cb477-7"><a href="#cb477-7" aria-hidden="true" tabindex="-1"></a>flextable<span class="sc">::</span><span class="fu">proc_freq</span>(donnees_datatable, <span class="st">"cspf"</span>, <span class="st">"sexef"</span>, <span class="at">weight =</span> <span class="st">"poids_sondage"</span>, <span class="at">include.row_percent =</span> <span class="cn">FALSE</span>,</span>
<span id="cb477-8"><a href="#cb477-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">include.column_percent =</span> <span class="cn">FALSE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-115-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-115-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="package-questionr" class="level2" data-number="15.12">
<h2 data-number="15.12" class="anchored" data-anchor-id="package-questionr"><span class="header-section-number">15.12</span> Package questionr</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-116-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-116-1" role="tab" aria-controls="tabset-116-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-116-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-116-2" role="tab" aria-controls="tabset-116-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-116-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-116-3" role="tab" aria-controls="tabset-116-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-116-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-116-4" role="tab" aria-controls="tabset-116-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-116-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-116-5" role="tab" aria-controls="tabset-116-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-116-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-116-1-tab">
<div class="sourceCode" id="cb478"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb478-1"><a href="#cb478-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Sans objet pour SAS */</span></span>
<span id="cb478-2"><a href="#cb478-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> freq<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb478-3"><a href="#cb478-3" aria-hidden="true" tabindex="-1"></a>  tables Sexe * CSP / missing;</span>
<span id="cb478-4"><a href="#cb478-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Sexe sexef. CSP $cspf.;</span>
<span id="cb478-5"><a href="#cb478-5" aria-hidden="true" tabindex="-1"></a>  weight poids_sondage;</span>
<span id="cb478-6"><a href="#cb478-6" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-116-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-116-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb479"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb479-1"><a href="#cb479-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sans pondération</span></span>
<span id="cb479-2"><a href="#cb479-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(questionr)</span>
<span id="cb479-3"><a href="#cb479-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableau croisé</span></span>
<span id="cb479-4"><a href="#cb479-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sans pondération</span></span>
<span id="cb479-5"><a href="#cb479-5" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">with</span>(donnees_rbase, questionr<span class="sc">::</span><span class="fu">wtd.table</span>(cspf, sexef, <span class="at">useNA =</span> <span class="st">"ifany"</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb479-6"><a href="#cb479-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec pondération</span></span>
<span id="cb479-7"><a href="#cb479-7" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">with</span>(donnees_rbase, questionr<span class="sc">::</span><span class="fu">wtd.table</span>(cspf, sexef, <span class="at">weights =</span> poids_sondage, <span class="at">useNA =</span> <span class="st">"ifany"</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb479-8"><a href="#cb479-8" aria-hidden="true" tabindex="-1"></a>tab</span>
<span id="cb479-9"><a href="#cb479-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions</span></span>
<span id="cb479-10"><a href="#cb479-10" aria-hidden="true" tabindex="-1"></a>questionr<span class="sc">::</span><span class="fu">prop</span>(tab)</span>
<span id="cb479-11"><a href="#cb479-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions colonnes</span></span>
<span id="cb479-12"><a href="#cb479-12" aria-hidden="true" tabindex="-1"></a>questionr<span class="sc">::</span><span class="fu">cprop</span>(tab)</span>
<span id="cb479-13"><a href="#cb479-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions lignes</span></span>
<span id="cb479-14"><a href="#cb479-14" aria-hidden="true" tabindex="-1"></a>questionr<span class="sc">::</span><span class="fu">rprop</span>(tab)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-116-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-116-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb480"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb480-1"><a href="#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sans pondération</span></span>
<span id="cb480-2"><a href="#cb480-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(questionr)</span>
<span id="cb480-3"><a href="#cb480-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableau croisé</span></span>
<span id="cb480-4"><a href="#cb480-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sans pondération</span></span>
<span id="cb480-5"><a href="#cb480-5" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">with</span>(donnees_tidyverse, questionr<span class="sc">::</span><span class="fu">wtd.table</span>(cspf, sexef, <span class="at">useNA =</span> <span class="st">"ifany"</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb480-6"><a href="#cb480-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec pondération</span></span>
<span id="cb480-7"><a href="#cb480-7" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">with</span>(donnees_tidyverse, questionr<span class="sc">::</span><span class="fu">wtd.table</span>(cspf, sexef, <span class="at">weights =</span> poids_sondage, <span class="at">useNA =</span> <span class="st">"ifany"</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb480-8"><a href="#cb480-8" aria-hidden="true" tabindex="-1"></a>tab</span>
<span id="cb480-9"><a href="#cb480-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions</span></span>
<span id="cb480-10"><a href="#cb480-10" aria-hidden="true" tabindex="-1"></a>questionr<span class="sc">::</span><span class="fu">prop</span>(tab)</span>
<span id="cb480-11"><a href="#cb480-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions colonnes</span></span>
<span id="cb480-12"><a href="#cb480-12" aria-hidden="true" tabindex="-1"></a>questionr<span class="sc">::</span><span class="fu">cprop</span>(tab)</span>
<span id="cb480-13"><a href="#cb480-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions lignes</span></span>
<span id="cb480-14"><a href="#cb480-14" aria-hidden="true" tabindex="-1"></a>questionr<span class="sc">::</span><span class="fu">rprop</span>(tab)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-116-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-116-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb481"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb481-1"><a href="#cb481-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sans pondération</span></span>
<span id="cb481-2"><a href="#cb481-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(questionr)</span>
<span id="cb481-3"><a href="#cb481-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableau croisé</span></span>
<span id="cb481-4"><a href="#cb481-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sans pondération</span></span>
<span id="cb481-5"><a href="#cb481-5" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">with</span>(donnees_datatable, questionr<span class="sc">::</span><span class="fu">wtd.table</span>(cspf, sexef, <span class="at">useNA =</span> <span class="st">"ifany"</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb481-6"><a href="#cb481-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec pondération</span></span>
<span id="cb481-7"><a href="#cb481-7" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">with</span>(donnees_datatable, questionr<span class="sc">::</span><span class="fu">wtd.table</span>(cspf, sexef, <span class="at">weights =</span> poids_sondage, <span class="at">useNA =</span> <span class="st">"ifany"</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb481-8"><a href="#cb481-8" aria-hidden="true" tabindex="-1"></a>tab</span>
<span id="cb481-9"><a href="#cb481-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions</span></span>
<span id="cb481-10"><a href="#cb481-10" aria-hidden="true" tabindex="-1"></a>questionr<span class="sc">::</span><span class="fu">prop</span>(tab)</span>
<span id="cb481-11"><a href="#cb481-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions colonnes</span></span>
<span id="cb481-12"><a href="#cb481-12" aria-hidden="true" tabindex="-1"></a>questionr<span class="sc">::</span><span class="fu">cprop</span>(tab)</span>
<span id="cb481-13"><a href="#cb481-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions lignes</span></span>
<span id="cb481-14"><a href="#cb481-14" aria-hidden="true" tabindex="-1"></a>questionr<span class="sc">::</span><span class="fu">rprop</span>(tab)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-116-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-116-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="package-survey" class="level2" data-number="15.13">
<h2 data-number="15.13" class="anchored" data-anchor-id="package-survey"><span class="header-section-number">15.13</span> Package survey</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-117-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-117-1" role="tab" aria-controls="tabset-117-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-117-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-117-2" role="tab" aria-controls="tabset-117-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-117-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-117-3" role="tab" aria-controls="tabset-117-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-117-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-117-4" role="tab" aria-controls="tabset-117-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-117-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-117-5" role="tab" aria-controls="tabset-117-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-117-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-117-1-tab">
<div class="sourceCode" id="cb482"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb482-1"><a href="#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Sans objet pour SAS */</span></span>
<span id="cb482-2"><a href="#cb482-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> freq<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb482-3"><a href="#cb482-3" aria-hidden="true" tabindex="-1"></a>  tables Sexe * CSP / missing;</span>
<span id="cb482-4"><a href="#cb482-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Sexe sexef. CSP $cspf.;</span>
<span id="cb482-5"><a href="#cb482-5" aria-hidden="true" tabindex="-1"></a>  weight poids_sondage;</span>
<span id="cb482-6"><a href="#cb482-6" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-117-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-117-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb483"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb483-1"><a href="#cb483-1" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : ne fonctionne pas</span></span>
<span id="cb483-2"><a href="#cb483-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb483-3"><a href="#cb483-3" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> survey<span class="sc">::</span><span class="fu">svydesign</span>(<span class="at">id =</span> <span class="sc">~</span><span class="dv">1</span>, <span class="at">weights =</span> <span class="sc">~</span>poids_sondage, <span class="at">data =</span> donnees_rbase)</span>
<span id="cb483-4"><a href="#cb483-4" aria-hidden="true" tabindex="-1"></a>survey<span class="sc">::</span><span class="fu">svytable</span>(poids_sondage <span class="sc">~</span> sexef <span class="sc">+</span> cspf, <span class="at">design =</span> tab)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-117-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-117-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb484"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb484-1"><a href="#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="co"># La syntaxe avec pipe n'est pas compatible avec le package survey</span></span>
<span id="cb484-2"><a href="#cb484-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb484-3"><a href="#cb484-3" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> survey<span class="sc">::</span><span class="fu">svydesign</span>(<span class="at">id =</span> <span class="sc">~</span><span class="dv">1</span>, <span class="at">weights =</span> <span class="sc">~</span>poids_sondage, <span class="at">data =</span> donnees_tidyverse)</span>
<span id="cb484-4"><a href="#cb484-4" aria-hidden="true" tabindex="-1"></a>survey<span class="sc">::</span><span class="fu">svytable</span>(poids_sondage <span class="sc">~</span> sexef <span class="sc">+</span> cspf, <span class="at">design =</span> tab)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-117-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-117-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb485"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb485-1"><a href="#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : ne fonctionne pas</span></span>
<span id="cb485-2"><a href="#cb485-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb485-3"><a href="#cb485-3" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> survey<span class="sc">::</span><span class="fu">svydesign</span>(<span class="at">id =</span> <span class="sc">~</span><span class="dv">1</span>, <span class="at">weights =</span> <span class="sc">~</span>poids_sondage, <span class="at">data =</span> donnees_datatable)</span>
<span id="cb485-4"><a href="#cb485-4" aria-hidden="true" tabindex="-1"></a>survey<span class="sc">::</span><span class="fu">svytable</span>(poids_sondage <span class="sc">~</span> sexef <span class="sc">+</span> cspf, <span class="at">design =</span> tab)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-117-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-117-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="package-procs" class="level2" data-number="15.14">
<h2 data-number="15.14" class="anchored" data-anchor-id="package-procs"><span class="header-section-number">15.14</span> Package procs</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-118-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-118-1" role="tab" aria-controls="tabset-118-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-118-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-118-2" role="tab" aria-controls="tabset-118-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-118-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-118-3" role="tab" aria-controls="tabset-118-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-118-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-118-4" role="tab" aria-controls="tabset-118-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-118-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-118-5" role="tab" aria-controls="tabset-118-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-118-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-118-1-tab">
<div class="sourceCode" id="cb486"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb486-1"><a href="#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Sans objet pour SAS */</span></span>
<span id="cb486-2"><a href="#cb486-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> freq<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb486-3"><a href="#cb486-3" aria-hidden="true" tabindex="-1"></a>  tables Sexe * CSP / missing;</span>
<span id="cb486-4"><a href="#cb486-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Sexe sexef. CSP $cspf.;</span>
<span id="cb486-5"><a href="#cb486-5" aria-hidden="true" tabindex="-1"></a>  weight poids_sondage;</span>
<span id="cb486-6"><a href="#cb486-6" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-118-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-118-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb487"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb487-1"><a href="#cb487-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(procs)</span>
<span id="cb487-2"><a href="#cb487-2" aria-hidden="true" tabindex="-1"></a>procs<span class="sc">::</span><span class="fu">proc_freq</span>(donnees_rbase, <span class="at">tables =</span> cspf <span class="sc">*</span> sexef, <span class="at">options =</span> <span class="fu">v</span>(missing))</span>
<span id="cb487-3"><a href="#cb487-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ne fonctionne pas avec le poids !!!</span></span>
<span id="cb487-4"><a href="#cb487-4" aria-hidden="true" tabindex="-1"></a><span class="co">#procs::proc_freq(donnees_rbase, tables = cspf * sexef, weight = poids_sondage, options = v(missing))</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-118-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-118-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb488"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb488-1"><a href="#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(procs)</span>
<span id="cb488-2"><a href="#cb488-2" aria-hidden="true" tabindex="-1"></a>procs<span class="sc">::</span><span class="fu">proc_freq</span>(donnees_tidyverse, <span class="at">tables =</span> cspf <span class="sc">*</span> sexef, <span class="at">options =</span> <span class="fu">v</span>(missing))</span>
<span id="cb488-3"><a href="#cb488-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ne fonctionne pas avec le poids !!!</span></span>
<span id="cb488-4"><a href="#cb488-4" aria-hidden="true" tabindex="-1"></a><span class="co">#procs::proc_freq(donnees_tidyverse, tables = cspf * sexef, weight = poids_sondage, options = v(missing))</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-118-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-118-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb489"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb489-1"><a href="#cb489-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(procs)</span>
<span id="cb489-2"><a href="#cb489-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Il semble nécessaire de convertire l'objet en data.frame</span></span>
<span id="cb489-3"><a href="#cb489-3" aria-hidden="true" tabindex="-1"></a>procs<span class="sc">::</span><span class="fu">proc_freq</span>(<span class="fu">setDF</span>(donnees_datatable), <span class="at">tables =</span> cspf <span class="sc">*</span> sexef, <span class="at">options =</span> <span class="fu">v</span>(missing))</span>
<span id="cb489-4"><a href="#cb489-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ne fonctionne pas avec le poids !!!</span></span>
<span id="cb489-5"><a href="#cb489-5" aria-hidden="true" tabindex="-1"></a><span class="co">#procs::proc_freq(setDF(donnees_datatable), tables = cspf * sexef, weight = poids_sondage, options = v(missing))</span></span>
<span id="cb489-6"><a href="#cb489-6" aria-hidden="true" tabindex="-1"></a><span class="co"># On reconvertit en data.table</span></span>
<span id="cb489-7"><a href="#cb489-7" aria-hidden="true" tabindex="-1"></a><span class="fu">setDT</span>(donnees_datatable)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-118-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-118-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="solutions-avec-package-r-ne-permettant-apparemment-pas-de-pondérer" class="level2" data-number="15.15">
<h2 data-number="15.15" class="anchored" data-anchor-id="solutions-avec-package-r-ne-permettant-apparemment-pas-de-pondérer"><span class="header-section-number">15.15</span> Solutions avec package R ne permettant apparemment pas de pondérer</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-119-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-119-1" role="tab" aria-controls="tabset-119-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-119-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-119-2" role="tab" aria-controls="tabset-119-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-119-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-119-3" role="tab" aria-controls="tabset-119-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-119-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-119-4" role="tab" aria-controls="tabset-119-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-119-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-119-5" role="tab" aria-controls="tabset-119-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-119-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-119-1-tab">
<div class="sourceCode" id="cb490"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb490-1"><a href="#cb490-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Sans objet pour SAS */</span></span>
<span id="cb490-2"><a href="#cb490-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> freq<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb490-3"><a href="#cb490-3" aria-hidden="true" tabindex="-1"></a>  tables Sexe * CSP / missing;</span>
<span id="cb490-4"><a href="#cb490-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">format</span> Sexe sexef. CSP $cspf.;</span>
<span id="cb490-5"><a href="#cb490-5" aria-hidden="true" tabindex="-1"></a>  weight poids_sondage;</span>
<span id="cb490-6"><a href="#cb490-6" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-119-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-119-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb491"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb491-1"><a href="#cb491-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre possibilité, avec packages, pour avoir la même présentation que la proc freq de SAS</span></span>
<span id="cb491-2"><a href="#cb491-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Autres packages, qui semblent quasi-inutiles, car ils ne permettent apparemment pas de pondérer</span></span>
<span id="cb491-3"><a href="#cb491-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb491-4"><a href="#cb491-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Package janitor</span></span>
<span id="cb491-5"><a href="#cb491-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb491-6"><a href="#cb491-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Attention, la fonction tabyl ne permet pas de pondérer</span></span>
<span id="cb491-7"><a href="#cb491-7" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> janitor<span class="sc">::</span><span class="fu">tabyl</span>(donnees_rbase, cspf, sexef)</span>
<span id="cb491-8"><a href="#cb491-8" aria-hidden="true" tabindex="-1"></a>tab</span>
<span id="cb491-9"><a href="#cb491-9" aria-hidden="true" tabindex="-1"></a>janitor<span class="sc">::</span><span class="fu">adorn_totals</span>(tab, <span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>))</span>
<span id="cb491-10"><a href="#cb491-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Pourcentages</span></span>
<span id="cb491-11"><a href="#cb491-11" aria-hidden="true" tabindex="-1"></a>janitor<span class="sc">::</span><span class="fu">adorn_percentages</span>(tab, <span class="at">denominator =</span> <span class="st">"all"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb491-12"><a href="#cb491-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Pourcentages lignes</span></span>
<span id="cb491-13"><a href="#cb491-13" aria-hidden="true" tabindex="-1"></a>janitor<span class="sc">::</span><span class="fu">adorn_percentages</span>(tab, <span class="at">denominator =</span> <span class="st">"row"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb491-14"><a href="#cb491-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Pourcentages colonnes</span></span>
<span id="cb491-15"><a href="#cb491-15" aria-hidden="true" tabindex="-1"></a>janitor<span class="sc">::</span><span class="fu">adorn_percentages</span>(tab, <span class="at">denominator =</span> <span class="st">"col"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb491-16"><a href="#cb491-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb491-17"><a href="#cb491-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Package crosstable</span></span>
<span id="cb491-18"><a href="#cb491-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(crosstable)</span>
<span id="cb491-19"><a href="#cb491-19" aria-hidden="true" tabindex="-1"></a>crosstable<span class="sc">::</span><span class="fu">crosstable</span>(donnees_rbase, cspf, <span class="at">by =</span> sexef, <span class="at">showNA =</span> <span class="st">"always"</span>, <span class="at">percent_digits =</span> <span class="dv">0</span>, <span class="at">percent_pattern =</span><span class="st">"{n} ({p_col}/{p_row})"</span>)</span>
<span id="cb491-20"><a href="#cb491-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb491-21"><a href="#cb491-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Package gmodels</span></span>
<span id="cb491-22"><a href="#cb491-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmodels)</span>
<span id="cb491-23"><a href="#cb491-23" aria-hidden="true" tabindex="-1"></a>gmodels<span class="sc">::</span><span class="fu">CrossTable</span>(donnees_rbase<span class="sc">$</span>cspf, donnees_rbase<span class="sc">$</span>sexef)</span>
<span id="cb491-24"><a href="#cb491-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb491-25"><a href="#cb491-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Package gtsummary</span></span>
<span id="cb491-26"><a href="#cb491-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb491-27"><a href="#cb491-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Pourcentages par case, colonne, ligne</span></span>
<span id="cb491-28"><a href="#cb491-28" aria-hidden="true" tabindex="-1"></a>gtsummary<span class="sc">::</span><span class="fu">tbl_cross</span>(<span class="at">data =</span> donnees_rbase, <span class="at">row =</span> cspf, <span class="at">col =</span> sexef, <span class="at">percent =</span> <span class="fu">c</span>(<span class="st">"cell"</span>),   <span class="at">margin =</span> <span class="fu">c</span>(<span class="st">"column"</span>, <span class="st">"row"</span>), <span class="at">missing =</span> <span class="fu">c</span>(<span class="st">"always"</span>))</span>
<span id="cb491-29"><a href="#cb491-29" aria-hidden="true" tabindex="-1"></a>gtsummary<span class="sc">::</span><span class="fu">tbl_cross</span>(<span class="at">data =</span> donnees_rbase, <span class="at">row =</span> cspf, <span class="at">col =</span> sexef, <span class="at">percent =</span> <span class="fu">c</span>(<span class="st">"column"</span>), <span class="at">margin =</span> <span class="fu">c</span>(<span class="st">"column"</span>, <span class="st">"row"</span>), <span class="at">missing =</span> <span class="fu">c</span>(<span class="st">"always"</span>))</span>
<span id="cb491-30"><a href="#cb491-30" aria-hidden="true" tabindex="-1"></a>gtsummary<span class="sc">::</span><span class="fu">tbl_cross</span>(<span class="at">data =</span> donnees_rbase, <span class="at">row =</span> cspf, <span class="at">col =</span> sexef, <span class="at">percent =</span> <span class="fu">c</span>(<span class="st">"row"</span>),    <span class="at">margin =</span> <span class="fu">c</span>(<span class="st">"column"</span>, <span class="st">"row"</span>), <span class="at">missing =</span> <span class="fu">c</span>(<span class="st">"always"</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-119-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-119-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb492"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb492-1"><a href="#cb492-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre possibilité, avec packages, pour avoir la même présentation que la proc freq de SAS</span></span>
<span id="cb492-2"><a href="#cb492-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Autres packages, qui semblent quasi-inutiles, car ils ne permettent apparemment pas de pondérer</span></span>
<span id="cb492-3"><a href="#cb492-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb492-4"><a href="#cb492-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Package janitor</span></span>
<span id="cb492-5"><a href="#cb492-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb492-6"><a href="#cb492-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Attention, la fonction tabyl ne permet pas de pondérer</span></span>
<span id="cb492-7"><a href="#cb492-7" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb492-8"><a href="#cb492-8" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">tabyl</span>(cspf, sexef) <span class="sc">%&gt;%</span> </span>
<span id="cb492-9"><a href="#cb492-9" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">adorn_totals</span>(<span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>))</span>
<span id="cb492-10"><a href="#cb492-10" aria-hidden="true" tabindex="-1"></a>tab</span>
<span id="cb492-11"><a href="#cb492-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Pourcentages</span></span>
<span id="cb492-12"><a href="#cb492-12" aria-hidden="true" tabindex="-1"></a>tab <span class="sc">%&gt;%</span> janitor<span class="sc">::</span><span class="fu">adorn_percentages</span>(<span class="at">denominator =</span> <span class="st">"all"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb492-13"><a href="#cb492-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Pourcentages lignes</span></span>
<span id="cb492-14"><a href="#cb492-14" aria-hidden="true" tabindex="-1"></a>tab <span class="sc">%&gt;%</span> janitor<span class="sc">::</span><span class="fu">adorn_percentages</span>(<span class="at">denominator =</span> <span class="st">"row"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb492-15"><a href="#cb492-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Pourcentages colonnes</span></span>
<span id="cb492-16"><a href="#cb492-16" aria-hidden="true" tabindex="-1"></a>tab <span class="sc">%&gt;%</span> janitor<span class="sc">::</span><span class="fu">adorn_percentages</span>(<span class="at">denominator =</span> <span class="st">"col"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb492-17"><a href="#cb492-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb492-18"><a href="#cb492-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Package crosstable</span></span>
<span id="cb492-19"><a href="#cb492-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(crosstable)</span>
<span id="cb492-20"><a href="#cb492-20" aria-hidden="true" tabindex="-1"></a>crosstable<span class="sc">::</span><span class="fu">crosstable</span>(donnees_tidyverse, cspf, <span class="at">by =</span> sexef, <span class="at">showNA =</span> <span class="st">"always"</span>,</span>
<span id="cb492-21"><a href="#cb492-21" aria-hidden="true" tabindex="-1"></a>                       <span class="at">percent_digits =</span> <span class="dv">0</span>, <span class="at">percent_pattern =</span><span class="st">"{n} ({p_col}/{p_row})"</span>)</span>
<span id="cb492-22"><a href="#cb492-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb492-23"><a href="#cb492-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Package gmodels</span></span>
<span id="cb492-24"><a href="#cb492-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmodels)</span>
<span id="cb492-25"><a href="#cb492-25" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb492-26"><a href="#cb492-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(gmodels<span class="sc">::</span><span class="fu">CrossTable</span>(cspf, sexef))</span>
<span id="cb492-27"><a href="#cb492-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb492-28"><a href="#cb492-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Package gtsummary</span></span>
<span id="cb492-29"><a href="#cb492-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb492-30"><a href="#cb492-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Pourcentages par case, colonne, ligne</span></span>
<span id="cb492-31"><a href="#cb492-31" aria-hidden="true" tabindex="-1"></a>gtsummary<span class="sc">::</span><span class="fu">tbl_cross</span>(<span class="at">data =</span> donnees_tidyverse, <span class="at">row =</span> cspf, <span class="at">col =</span> sexef, <span class="at">percent =</span> <span class="fu">c</span>(<span class="st">"cell"</span>),   <span class="at">margin =</span> <span class="fu">c</span>(<span class="st">"column"</span>, <span class="st">"row"</span>), <span class="at">missing =</span> <span class="fu">c</span>(<span class="st">"always"</span>))</span>
<span id="cb492-32"><a href="#cb492-32" aria-hidden="true" tabindex="-1"></a>gtsummary<span class="sc">::</span><span class="fu">tbl_cross</span>(<span class="at">data =</span> donnees_tidyverse, <span class="at">row =</span> cspf, <span class="at">col =</span> sexef, <span class="at">percent =</span> <span class="fu">c</span>(<span class="st">"column"</span>), <span class="at">margin =</span> <span class="fu">c</span>(<span class="st">"column"</span>, <span class="st">"row"</span>), <span class="at">missing =</span> <span class="fu">c</span>(<span class="st">"always"</span>))</span>
<span id="cb492-33"><a href="#cb492-33" aria-hidden="true" tabindex="-1"></a>gtsummary<span class="sc">::</span><span class="fu">tbl_cross</span>(<span class="at">data =</span> donnees_tidyverse, <span class="at">row =</span> cspf, <span class="at">col =</span> sexef, <span class="at">percent =</span> <span class="fu">c</span>(<span class="st">"row"</span>),    <span class="at">margin =</span> <span class="fu">c</span>(<span class="st">"column"</span>, <span class="st">"row"</span>), <span class="at">missing =</span> <span class="fu">c</span>(<span class="st">"always"</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-119-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-119-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb493"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb493-1"><a href="#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre possibilité, avec packages, pour avoir la même présentation que la proc freq de SAS</span></span>
<span id="cb493-2"><a href="#cb493-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Autres packages, qui semblent quasi-inutiles, car ils ne permettent apparemment pas de pondérer</span></span>
<span id="cb493-3"><a href="#cb493-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-4"><a href="#cb493-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Package janitor</span></span>
<span id="cb493-5"><a href="#cb493-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb493-6"><a href="#cb493-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Attention, la fonction tabyl ne permet pas de pondérer</span></span>
<span id="cb493-7"><a href="#cb493-7" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> janitor<span class="sc">::</span><span class="fu">tabyl</span>(donnees_datatable, cspf, sexef)</span>
<span id="cb493-8"><a href="#cb493-8" aria-hidden="true" tabindex="-1"></a>tab</span>
<span id="cb493-9"><a href="#cb493-9" aria-hidden="true" tabindex="-1"></a>janitor<span class="sc">::</span><span class="fu">adorn_totals</span>(tab, <span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>))</span>
<span id="cb493-10"><a href="#cb493-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Pourcentages</span></span>
<span id="cb493-11"><a href="#cb493-11" aria-hidden="true" tabindex="-1"></a>janitor<span class="sc">::</span><span class="fu">adorn_percentages</span>(tab, <span class="at">denominator =</span> <span class="st">"all"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb493-12"><a href="#cb493-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Pourcentages lignes</span></span>
<span id="cb493-13"><a href="#cb493-13" aria-hidden="true" tabindex="-1"></a>janitor<span class="sc">::</span><span class="fu">adorn_percentages</span>(tab, <span class="at">denominator =</span> <span class="st">"row"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb493-14"><a href="#cb493-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Pourcentages colonnes</span></span>
<span id="cb493-15"><a href="#cb493-15" aria-hidden="true" tabindex="-1"></a>janitor<span class="sc">::</span><span class="fu">adorn_percentages</span>(tab, <span class="at">denominator =</span> <span class="st">"col"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb493-16"><a href="#cb493-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-17"><a href="#cb493-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Package crosstable : lui non plus ne permet pas de pondérer, apparemment ...</span></span>
<span id="cb493-18"><a href="#cb493-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(crosstable)</span>
<span id="cb493-19"><a href="#cb493-19" aria-hidden="true" tabindex="-1"></a>crosstable<span class="sc">::</span><span class="fu">crosstable</span>(donnees_datatable, cspf, <span class="at">by =</span> sexef, <span class="at">showNA =</span> <span class="st">"always"</span>,</span>
<span id="cb493-20"><a href="#cb493-20" aria-hidden="true" tabindex="-1"></a>                       <span class="at">percent_digits =</span> <span class="dv">0</span>, <span class="at">percent_pattern =</span><span class="st">"{n} ({p_col}/{p_row})"</span>)</span>
<span id="cb493-21"><a href="#cb493-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-22"><a href="#cb493-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Package gmodels : ne permet pas de pondérer, apparemment</span></span>
<span id="cb493-23"><a href="#cb493-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmodels)</span>
<span id="cb493-24"><a href="#cb493-24" aria-hidden="true" tabindex="-1"></a>gmodels<span class="sc">::</span><span class="fu">CrossTable</span>(donnees_datatable<span class="sc">$</span>cspf, donnees_datatable<span class="sc">$</span>sexef)</span>
<span id="cb493-25"><a href="#cb493-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-26"><a href="#cb493-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Package gtsummary : ne permet pas de pondérer, apparemment</span></span>
<span id="cb493-27"><a href="#cb493-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb493-28"><a href="#cb493-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Pourcentages par case, colonne, ligne</span></span>
<span id="cb493-29"><a href="#cb493-29" aria-hidden="true" tabindex="-1"></a>gtsummary<span class="sc">::</span><span class="fu">tbl_cross</span>(<span class="at">data =</span> donnees_datatable, <span class="at">row =</span> cspf, <span class="at">col =</span> sexef, <span class="at">percent =</span> <span class="fu">c</span>(<span class="st">"cell"</span>),  </span>
<span id="cb493-30"><a href="#cb493-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">margin =</span> <span class="fu">c</span>(<span class="st">"column"</span>, <span class="st">"row"</span>), <span class="at">missing =</span> <span class="fu">c</span>(<span class="st">"always"</span>))</span>
<span id="cb493-31"><a href="#cb493-31" aria-hidden="true" tabindex="-1"></a>gtsummary<span class="sc">::</span><span class="fu">tbl_cross</span>(<span class="at">data =</span> donnees_datatable, <span class="at">row =</span> cspf, <span class="at">col =</span> sexef, <span class="at">percent =</span> <span class="fu">c</span>(<span class="st">"column"</span>),</span>
<span id="cb493-32"><a href="#cb493-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">margin =</span> <span class="fu">c</span>(<span class="st">"column"</span>, <span class="st">"row"</span>), <span class="at">missing =</span> <span class="fu">c</span>(<span class="st">"always"</span>))</span>
<span id="cb493-33"><a href="#cb493-33" aria-hidden="true" tabindex="-1"></a>gtsummary<span class="sc">::</span><span class="fu">tbl_cross</span>(<span class="at">data =</span> donnees_datatable, <span class="at">row =</span> cspf, <span class="at">col =</span> sexef, <span class="at">percent =</span> <span class="fu">c</span>(<span class="st">"row"</span>),   </span>
<span id="cb493-34"><a href="#cb493-34" aria-hidden="true" tabindex="-1"></a>                     <span class="at">margin =</span> <span class="fu">c</span>(<span class="st">"column"</span>, <span class="st">"row"</span>), <span class="at">missing =</span> <span class="fu">c</span>(<span class="st">"always"</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-119-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-119-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
</section>
<section id="statistiques-agrégées-par-groupe" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> Statistiques agrégées par groupe</h1>
<section id="une-seule-variable-de-groupement-une-seule-variable" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="une-seule-variable-de-groupement-une-seule-variable"><span class="header-section-number">16.1</span> Une seule variable de groupement, une seule variable</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-120-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-120-1" role="tab" aria-controls="tabset-120-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-120-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-120-2" role="tab" aria-controls="tabset-120-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-120-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-120-3" role="tab" aria-controls="tabset-120-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-120-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-120-4" role="tab" aria-controls="tabset-120-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-120-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-120-5" role="tab" aria-controls="tabset-120-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-120-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-120-1-tab">
<div class="sourceCode" id="cb494"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb494-1"><a href="#cb494-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Moyenne de note_contenu et nombre de personnes */</span></span>
<span id="cb494-2"><a href="#cb494-2" aria-hidden="true" tabindex="-1"></a><span class="co">/* 1ère solution */</span></span>
<span id="cb494-3"><a href="#cb494-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas;<span class="kw">by</span> cspf<span class="kw">;run</span>;</span>
<span id="cb494-4"><a href="#cb494-4" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> means<span class="kw"> data</span> = donnees_sas <span class="fu">mean</span> <span class="fu">n</span>;<span class="fu">var</span> note_contenu;class cspf<span class="kw">;run</span>;</span>
<span id="cb494-5"><a href="#cb494-5" aria-hidden="true" tabindex="-1"></a><span class="co">/* 2e solution */</span></span>
<span id="cb494-6"><a href="#cb494-6" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> tabulate<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb494-7"><a href="#cb494-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> note_contenu;</span>
<span id="cb494-8"><a href="#cb494-8" aria-hidden="true" tabindex="-1"></a>  class cspf;</span>
<span id="cb494-9"><a href="#cb494-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">table</span> (cspf all = <span class="st">"Total"</span>), note_contenu * (<span class="fu">mean</span> <span class="fu">n</span>);</span>
<span id="cb494-10"><a href="#cb494-10" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb494-11"><a href="#cb494-11" aria-hidden="true" tabindex="-1"></a><span class="co">/* 3e solution */</span></span>
<span id="cb494-12"><a href="#cb494-12" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb494-13"><a href="#cb494-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> cspf, <span class="fu">mean</span>(note_contenu) <span class="kw">as</span> note_contenu_moyenne, count(*) <span class="kw">as</span> <span class="fu">N</span></span>
<span id="cb494-14"><a href="#cb494-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> donnees_sas</span>
<span id="cb494-15"><a href="#cb494-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">group</span> <span class="kw">by</span> cspf</span>
<span id="cb494-16"><a href="#cb494-16" aria-hidden="true" tabindex="-1"></a>  <span class="kw">order</span> <span class="kw">by</span> cspf;</span>
<span id="cb494-17"><a href="#cb494-17" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span>
<span id="cb494-18"><a href="#cb494-18" aria-hidden="true" tabindex="-1"></a><span class="co">/* Avec la pondération */</span></span>
<span id="cb494-19"><a href="#cb494-19" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas;<span class="kw">by</span> cspf<span class="kw">;run</span>;</span>
<span id="cb494-20"><a href="#cb494-20" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> means<span class="kw"> data</span> = donnees_sas <span class="fu">mean</span> <span class="fu">n</span>;</span>
<span id="cb494-21"><a href="#cb494-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> note_contenu;class cspf;</span>
<span id="cb494-22"><a href="#cb494-22" aria-hidden="true" tabindex="-1"></a>  weight poids_sondage;</span>
<span id="cb494-23"><a href="#cb494-23" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb494-24"><a href="#cb494-24" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> tabulate<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb494-25"><a href="#cb494-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> note_contenu;</span>
<span id="cb494-26"><a href="#cb494-26" aria-hidden="true" tabindex="-1"></a>  class cspf;</span>
<span id="cb494-27"><a href="#cb494-27" aria-hidden="true" tabindex="-1"></a>  weight poids_sondage;</span>
<span id="cb494-28"><a href="#cb494-28" aria-hidden="true" tabindex="-1"></a>  <span class="kw">table</span> (cspf all = <span class="st">"Total"</span>), note_contenu * (<span class="fu">mean</span> <span class="fu">n</span>);</span>
<span id="cb494-29"><a href="#cb494-29" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-120-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-120-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb495"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb495-1"><a href="#cb495-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Moyenne de note_contenu et nombre de personnes</span></span>
<span id="cb495-2"><a href="#cb495-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(note_contenu <span class="sc">~</span> cspf, donnees_rbase, <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="at">Moyenne =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">Nombre =</span> <span class="fu">length</span>(x)))</span>
<span id="cb495-3"><a href="#cb495-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Moyenne de note_contenu</span></span>
<span id="cb495-4"><a href="#cb495-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Une seule variable, une seule variable de groupe, une seule fonction</span></span>
<span id="cb495-5"><a href="#cb495-5" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(note_contenu <span class="sc">~</span> cspf, donnees_rbase, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb495-6"><a href="#cb495-6" aria-hidden="true" tabindex="-1"></a><span class="co"># rowsum, à ne pas confondre avec rowSums, calcule des sommes, et uniquement des sommes</span></span>
<span id="cb495-7"><a href="#cb495-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rowsum</span>(donnees_rbase<span class="sc">$</span>note_contenu, donnees_rbase<span class="sc">$</span>cspf, <span class="at">recorder =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb495-8"><a href="#cb495-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Fonctions tapply et by</span></span>
<span id="cb495-9"><a href="#cb495-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(donnees_rbase<span class="sc">$</span>note_contenu, donnees_rbase<span class="sc">$</span>cspf, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb495-10"><a href="#cb495-10" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(donnees_rbase, <span class="fu">tapply</span>(note_contenu, cspf, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb495-11"><a href="#cb495-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(donnees_rbase<span class="sc">$</span>note_contenu, donnees_rbase<span class="sc">$</span>cspf, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb495-12"><a href="#cb495-12" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span>(donnees_rbase<span class="sc">$</span>note_contenu, donnees_rbase<span class="sc">$</span>cspf, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb495-13"><a href="#cb495-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb495-14"><a href="#cb495-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec la pondération : tapply ne fonctionne pas, il faut découper la base en facteurs avec split</span></span>
<span id="cb495-15"><a href="#cb495-15" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(<span class="fu">split</span>(donnees_rbase, donnees_rbase<span class="sc">$</span>cspf), <span class="cf">function</span>(x) <span class="fu">weighted.mean</span>(x<span class="sc">$</span>note_contenu, x<span class="sc">$</span>poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb495-16"><a href="#cb495-16" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : autre solution ?</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-120-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-120-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb496"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb496-1"><a href="#cb496-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Moyenne de note_contenu et nombre de personnes</span></span>
<span id="cb496-2"><a href="#cb496-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb496-3"><a href="#cb496-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cspf) <span class="sc">%&gt;%</span> </span>
<span id="cb496-4"><a href="#cb496-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Nombre =</span> <span class="fu">n</span>(), <span class="at">Moyenne =</span> <span class="fu">mean</span>(note_contenu, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb496-5"><a href="#cb496-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Moyenne de note_contenu</span></span>
<span id="cb496-6"><a href="#cb496-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Une seule variable, une seule variable de groupe, une seule fonction</span></span>
<span id="cb496-7"><a href="#cb496-7" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb496-8"><a href="#cb496-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cspf) <span class="sc">%&gt;%</span> </span>
<span id="cb496-9"><a href="#cb496-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Moyenne =</span> <span class="fu">mean</span>(note_contenu, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb496-10"><a href="#cb496-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb496-11"><a href="#cb496-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec la pondération</span></span>
<span id="cb496-12"><a href="#cb496-12" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb496-13"><a href="#cb496-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cspf) <span class="sc">%&gt;%</span> </span>
<span id="cb496-14"><a href="#cb496-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Moyenne =</span> <span class="fu">weighted.mean</span>(note_contenu, poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-120-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-120-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb497"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb497-1"><a href="#cb497-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Moyenne de note_contenu et nombre de personnes</span></span>
<span id="cb497-2"><a href="#cb497-2" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, .(<span class="at">note_contenu_moyenne =</span> <span class="fu">mean</span>(note_contenu, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">N =</span> .N), by <span class="ot">=</span> cspf]</span>
<span id="cb497-3"><a href="#cb497-3" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, .(<span class="at">note_contenu_moyenne =</span> <span class="fu">mean</span>(note_contenu, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">N =</span> .N), keyby <span class="ot">=</span> <span class="st">"cspf"</span>]</span>
<span id="cb497-4"><a href="#cb497-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables définies à part</span></span>
<span id="cb497-5"><a href="#cb497-5" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="st">"note_contenu"</span></span>
<span id="cb497-6"><a href="#cb497-6" aria-hidden="true" tabindex="-1"></a>var_groupe <span class="ot">&lt;-</span> <span class="st">"cspf"</span></span>
<span id="cb497-7"><a href="#cb497-7" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : les deux variables sont empilées, pourquoi ??</span></span>
<span id="cb497-8"><a href="#cb497-8" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">lapply</span>(.SD, <span class="cf">function</span>(x) <span class="fu">list</span>(<span class="at">moyenne =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">n =</span> <span class="fu">length</span>(x))), keyby <span class="ot">=</span> var_groupe,</span>
<span id="cb497-9"><a href="#cb497-9" aria-hidden="true" tabindex="-1"></a>                  .SDcols <span class="ot">=</span> varNotes]</span>
<span id="cb497-10"><a href="#cb497-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec la pondération</span></span>
<span id="cb497-11"><a href="#cb497-11" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">lapply</span>(.SD, <span class="cf">function</span>(x) <span class="fu">weighted.mean</span>(x, poids_sondage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), keyby <span class="ot">=</span> var_groupe,</span>
<span id="cb497-12"><a href="#cb497-12" aria-hidden="true" tabindex="-1"></a>                  .SDcols <span class="ot">=</span> varNotes]</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-120-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-120-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="plusieurs-variables" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="plusieurs-variables"><span class="header-section-number">16.2</span> Plusieurs variables</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-121-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-121-1" role="tab" aria-controls="tabset-121-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-121-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-121-2" role="tab" aria-controls="tabset-121-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-121-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-121-3" role="tab" aria-controls="tabset-121-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-121-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-121-4" role="tab" aria-controls="tabset-121-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-121-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-121-5" role="tab" aria-controls="tabset-121-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-121-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-121-1-tab">
<div class="sourceCode" id="cb498"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb498-1"><a href="#cb498-1" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> var_notes = note_contenu note_formateur note_moyens note_accompagnement note_materiel;</span>
<span id="cb498-2"><a href="#cb498-2" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> var_groupe = cspf sexef;</span>
<span id="cb498-3"><a href="#cb498-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sort<span class="kw"> data</span> = donnees_sas;<span class="kw">by</span> <span class="kw">&amp;var_groupe.;run</span>;</span>
<span id="cb498-4"><a href="#cb498-4" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> means<span class="kw"> data</span> = donnees_sas <span class="fu">mean</span> <span class="fu">n</span>;</span>
<span id="cb498-5"><a href="#cb498-5" aria-hidden="true" tabindex="-1"></a>  class <span class="kw">&amp;var_groupe.</span>;</span>
<span id="cb498-6"><a href="#cb498-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> <span class="kw">&amp;var_notes.</span>;</span>
<span id="cb498-7"><a href="#cb498-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">output</span> out = Resultat;</span>
<span id="cb498-8"><a href="#cb498-8" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb498-9"><a href="#cb498-9" aria-hidden="true" tabindex="-1"></a><span class="co">/* Autre solution */</span></span>
<span id="cb498-10"><a href="#cb498-10" aria-hidden="true" tabindex="-1"></a><span class="kw">%macro</span> sel;</span>
<span id="cb498-11"><a href="#cb498-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%global</span> <span class="kw">select</span>;</span>
<span id="cb498-12"><a href="#cb498-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%local</span> i j;</span>
<span id="cb498-13"><a href="#cb498-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%let</span> <span class="kw">select</span> = ;</span>
<span id="cb498-14"><a href="#cb498-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%do</span> i = <span class="dv">1</span> <span class="kw">%to</span> <span class="kw">%sysfunc</span>(countw(<span class="kw">&amp;var_notes.</span>));</span>
<span id="cb498-15"><a href="#cb498-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%let</span> j = <span class="kw">%scan</span>(<span class="kw">&amp;var_notes.</span>, <span class="kw">&amp;i.</span>, <span class="kw">%str</span>( ));</span>
<span id="cb498-16"><a href="#cb498-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%let</span> <span class="kw">select</span> = <span class="kw">&amp;select.</span> <span class="fu">mean</span>(<span class="kw">&amp;j)</span> <span class="kw">as</span> <span class="kw">&amp;j.</span>_moyenne,;</span>
<span id="cb498-17"><a href="#cb498-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%end</span>;</span>
<span id="cb498-18"><a href="#cb498-18" aria-hidden="true" tabindex="-1"></a><span class="kw">%mend</span> sel;</span>
<span id="cb498-19"><a href="#cb498-19" aria-hidden="true" tabindex="-1"></a>%sel;</span>
<span id="cb498-20"><a href="#cb498-20" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> <span class="kw">group</span> = <span class="kw">%sysfunc</span>(<span class="fu">tranwrd</span>(<span class="kw">&amp;var_groupe.</span>, <span class="kw">%str</span>( ), <span class="kw">%str</span>(, )));</span>
<span id="cb498-21"><a href="#cb498-21" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb498-22"><a href="#cb498-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> <span class="kw">&amp;group.</span>, <span class="kw">&amp;select.</span> count(*) <span class="kw">as</span> <span class="fu">N</span></span>
<span id="cb498-23"><a href="#cb498-23" aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> donnees_sas</span>
<span id="cb498-24"><a href="#cb498-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">group</span> <span class="kw">by</span> <span class="kw">&amp;group.</span></span>
<span id="cb498-25"><a href="#cb498-25" aria-hidden="true" tabindex="-1"></a>  <span class="kw">order</span> <span class="kw">by</span> <span class="kw">&amp;group.</span>;</span>
<span id="cb498-26"><a href="#cb498-26" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-121-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-121-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb499"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb499-1"><a href="#cb499-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plusieurs solutions avec aggregate (plutôt lent)</span></span>
<span id="cb499-2"><a href="#cb499-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(note_contenu <span class="sc">~</span> cspf <span class="sc">+</span> sexef, donnees_rbase, <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="at">mean =</span> <span class="fu">mean</span>(x), <span class="at">n =</span> <span class="fu">length</span>(x)))</span>
<span id="cb499-3"><a href="#cb499-3" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(<span class="fu">cbind</span>(note_contenu, note_materiel) <span class="sc">~</span> cspf <span class="sc">+</span> sexef, donnees_rbase, <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="at">moyenne =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">n =</span> <span class="fu">length</span>(x)))</span>
<span id="cb499-4"><a href="#cb499-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Via les formules</span></span>
<span id="cb499-5"><a href="#cb499-5" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>)</span>
<span id="cb499-6"><a href="#cb499-6" aria-hidden="true" tabindex="-1"></a>varGroupement <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cspf"</span>, <span class="st">"sexef"</span>)</span>
<span id="cb499-7"><a href="#cb499-7" aria-hidden="true" tabindex="-1"></a>formule <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(variable, <span class="fu">paste</span>(varGroupement, <span class="at">collapse =</span> <span class="st">" + "</span>), <span class="at">sep =</span> <span class="st">" ~ "</span>))</span>
<span id="cb499-8"><a href="#cb499-8" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(formule, donnees_rbase, <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="at">moyenne =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">n =</span> <span class="fu">length</span>(x)))</span>
<span id="cb499-9"><a href="#cb499-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec by</span></span>
<span id="cb499-10"><a href="#cb499-10" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span>(donnees_rbase[, variable], donnees_rbase[, varGroupement], <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="at">mean =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">n =</span> <span class="fu">length</span>(x)))</span>
<span id="cb499-11"><a href="#cb499-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec rowum : on ne peut calculer que la somme</span></span>
<span id="cb499-12"><a href="#cb499-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rowsum</span>(donnees_rbase[, variable], <span class="fu">interaction</span>(donnees_rbase[, varGroupement], <span class="at">sep =</span> <span class="st">"_"</span>, <span class="at">lex.order =</span> <span class="cn">TRUE</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-121-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-121-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb500"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb500-1"><a href="#cb500-1" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb500-2"><a href="#cb500-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cspf, sexef) <span class="sc">%&gt;%</span> </span>
<span id="cb500-3"><a href="#cb500-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Moyenne =</span> <span class="fu">mean</span>(note_contenu, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">n =</span> <span class="fu">n</span>())</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-121-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-121-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb501"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb501-1"><a href="#cb501-1" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, .(<span class="at">note_contenu_moyenne =</span> <span class="fu">mean</span>(note_contenu, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">N =</span> .N), keyby <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"cspf"</span>, <span class="st">"sexef"</span>)]</span>
<span id="cb501-2"><a href="#cb501-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb501-3"><a href="#cb501-3" aria-hidden="true" tabindex="-1"></a>data.table<span class="sc">::</span><span class="fu">dcast</span>(donnees_datatable, cspf <span class="sc">+</span> sexef <span class="sc">~</span> ., <span class="at">value.var =</span> <span class="st">"note_contenu"</span>, <span class="at">fun.aggregate =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb501-4"><a href="#cb501-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables définies à part</span></span>
<span id="cb501-5"><a href="#cb501-5" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb501-6"><a href="#cb501-6" aria-hidden="true" tabindex="-1"></a>var_groupe <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cspf"</span>, <span class="st">"sexef"</span>)</span>
<span id="cb501-7"><a href="#cb501-7" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : les deux variables sont empilées, pourquoi ??</span></span>
<span id="cb501-8"><a href="#cb501-8" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, <span class="fu">lapply</span>(.SD, <span class="cf">function</span>(x) <span class="fu">list</span>(<span class="at">moyenne =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">n =</span> <span class="fu">length</span>(x))),</span>
<span id="cb501-9"><a href="#cb501-9" aria-hidden="true" tabindex="-1"></a>                  keyby <span class="ot">=</span> var_groupe,</span>
<span id="cb501-10"><a href="#cb501-10" aria-hidden="true" tabindex="-1"></a>                  .SDcols <span class="ot">=</span> varNotes]</span>
<span id="cb501-11"><a href="#cb501-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-12"><a href="#cb501-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombre de femmes par CSP</span></span>
<span id="cb501-13"><a href="#cb501-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Il y a un recycling de gender = "M", utile de le mentionner</span></span>
<span id="cb501-14"><a href="#cb501-14" aria-hidden="true" tabindex="-1"></a>donnees_datatable[, .(<span class="at">Femmes =</span> <span class="fu">sum</span>(sexef <span class="sc">==</span> <span class="st">"Femme"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">Hommes =</span> <span class="fu">sum</span>(sexef <span class="sc">==</span> <span class="st">"Homme"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), by <span class="ot">=</span> .(cspf)]</span>
<span id="cb501-15"><a href="#cb501-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-16"><a href="#cb501-16" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE :</span></span>
<span id="cb501-17"><a href="#cb501-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemple avec les variables dans .SDcols</span></span>
<span id="cb501-18"><a href="#cb501-18" aria-hidden="true" tabindex="-1"></a><span class="co"># data.table::setDT(DF)[, lapply(.SD, mean, na.rm = TRUE), .SDcols = c("x", "y"), by = list(g, h)]</span></span>
<span id="cb501-19"><a href="#cb501-19" aria-hidden="true" tabindex="-1"></a><span class="co"># D'autres variations (par exemple, c(x, y) ou list("x", "y") ne fonctionnent pas !)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-121-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-121-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="tableaux-croisés-à-2-variables-de-groupement" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="tableaux-croisés-à-2-variables-de-groupement"><span class="header-section-number">16.3</span> Tableaux croisés à 2 variables de groupement</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-122-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-122-1" role="tab" aria-controls="tabset-122-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-122-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-122-2" role="tab" aria-controls="tabset-122-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-122-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-122-3" role="tab" aria-controls="tabset-122-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-122-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-122-4" role="tab" aria-controls="tabset-122-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-122-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-122-5" role="tab" aria-controls="tabset-122-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-122-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-122-1-tab">
<div class="sourceCode" id="cb502"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb502-1"><a href="#cb502-1" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> tabulate<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb502-2"><a href="#cb502-2" aria-hidden="true" tabindex="-1"></a>  class cspf sexef;</span>
<span id="cb502-3"><a href="#cb502-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> note_contenu;</span>
<span id="cb502-4"><a href="#cb502-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">table</span> (cspf all = <span class="st">"Ensemble"</span>), sexef * (note_contenu) * <span class="fu">mean</span>;</span>
<span id="cb502-5"><a href="#cb502-5" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-122-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-122-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb503"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb503-1"><a href="#cb503-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableau croisé Cspf par Sexef</span></span>
<span id="cb503-2"><a href="#cb503-2" aria-hidden="true" tabindex="-1"></a>varGroupement <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cspf"</span>, <span class="st">"sexef"</span>)</span>
<span id="cb503-3"><a href="#cb503-3" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>)</span>
<span id="cb503-4"><a href="#cb503-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution avec tapply</span></span>
<span id="cb503-5"><a href="#cb503-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(donnees_rbase[, variable], donnees_rbase[varGroupement], <span class="cf">function</span>(x) <span class="at">moyenne =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb503-6"><a href="#cb503-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution avec xtabs</span></span>
<span id="cb503-7"><a href="#cb503-7" aria-hidden="true" tabindex="-1"></a><span class="fu">xtabs</span>(note_contenu <span class="sc">~</span> cspf <span class="sc">+</span> sexef, <span class="fu">aggregate</span>(note_contenu <span class="sc">~</span> cspf <span class="sc">+</span> sexef, <span class="at">data =</span> donnees_rbase, <span class="at">FUN =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb503-8"><a href="#cb503-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Ou, sous forme de formule</span></span>
<span id="cb503-9"><a href="#cb503-9" aria-hidden="true" tabindex="-1"></a>formule <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(variable, <span class="fu">paste</span>(varGroupement, <span class="at">collapse =</span> <span class="st">" + "</span>), <span class="at">sep =</span> <span class="st">" ~ "</span>))</span>
<span id="cb503-10"><a href="#cb503-10" aria-hidden="true" tabindex="-1"></a><span class="fu">xtabs</span>(formule, <span class="fu">aggregate</span>(formule, <span class="at">data =</span> donnees_rbase, <span class="at">FUN =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb503-11"><a href="#cb503-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution, en calculant un tableau "long", et en le transformant en "wide"</span></span>
<span id="cb503-12"><a href="#cb503-12" aria-hidden="true" tabindex="-1"></a>tableau <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(note_contenu <span class="sc">~</span> cspf <span class="sc">+</span> sexef, <span class="at">data =</span> donnees_rbase, <span class="at">FUN =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb503-13"><a href="#cb503-13" aria-hidden="true" tabindex="-1"></a><span class="fu">reshape</span>(tableau, </span>
<span id="cb503-14"><a href="#cb503-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">timevar =</span> varGroupement[<span class="dv">2</span>],</span>
<span id="cb503-15"><a href="#cb503-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">idvar =</span> varGroupement[<span class="dv">1</span>],</span>
<span id="cb503-16"><a href="#cb503-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">direction =</span> <span class="st">"wide"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-122-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-122-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb504"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb504-1"><a href="#cb504-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableau croisé Cspf par Sexef</span></span>
<span id="cb504-2"><a href="#cb504-2" aria-hidden="true" tabindex="-1"></a>varGroupement <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cspf"</span>, <span class="st">"sexef"</span>)</span>
<span id="cb504-3"><a href="#cb504-3" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>)</span>
<span id="cb504-4"><a href="#cb504-4" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb504-5"><a href="#cb504-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(varGroupement))) <span class="sc">%&gt;%</span> </span>
<span id="cb504-6"><a href="#cb504-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(variable), <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.names =</span> <span class="st">"Moyenne"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb504-7"><a href="#cb504-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(varGroupement[<span class="dv">2</span>], Moyenne)</span>
<span id="cb504-8"><a href="#cb504-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution</span></span>
<span id="cb504-9"><a href="#cb504-9" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb504-10"><a href="#cb504-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="sc">!!!</span><span class="fu">syms</span>(varGroupement)) <span class="sc">%&gt;%</span> </span>
<span id="cb504-11"><a href="#cb504-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Moyenne =</span> <span class="fu">mean</span>(.data[[variable]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb504-12"><a href="#cb504-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(varGroupement[<span class="dv">2</span>], Moyenne)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-122-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-122-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb505"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb505-1"><a href="#cb505-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableau croisé Cspf par Sexef</span></span>
<span id="cb505-2"><a href="#cb505-2" aria-hidden="true" tabindex="-1"></a>varGroupement <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cspf"</span>, <span class="st">"sexef"</span>)</span>
<span id="cb505-3"><a href="#cb505-3" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"note_contenu"</span></span>
<span id="cb505-4"><a href="#cb505-4" aria-hidden="true" tabindex="-1"></a>data.table<span class="sc">::</span><span class="fu">dcast</span>(donnees_datatable, cspf <span class="sc">~</span> sexef, <span class="at">value.var =</span> <span class="st">"note_contenu"</span>, <span class="at">fun.aggregate =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb505-5"><a href="#cb505-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec références seulement</span></span>
<span id="cb505-6"><a href="#cb505-6" aria-hidden="true" tabindex="-1"></a>data.table<span class="sc">::</span><span class="fu">dcast</span>(donnees_datatable, <span class="fu">get</span>(varGroupement[<span class="dv">1</span>]) <span class="sc">~</span> <span class="fu">get</span>(varGroupement[<span class="dv">2</span>]), <span class="at">value.var =</span> variable,</span>
<span id="cb505-7"><a href="#cb505-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fun.aggregate =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb505-8"><a href="#cb505-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre solution, plus indirecte</span></span>
<span id="cb505-9"><a href="#cb505-9" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : attention, toujours utiliser lapply, même avec une seule variable ! LE DIRE !!!</span></span>
<span id="cb505-10"><a href="#cb505-10" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> donnees_datatable[, <span class="fu">lapply</span>(.SD, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), keyby <span class="ot">=</span> varGroupement, .SDcols <span class="ot">=</span> <span class="st">"note_contenu"</span>]</span>
<span id="cb505-11"><a href="#cb505-11" aria-hidden="true" tabindex="-1"></a>data.table<span class="sc">::</span><span class="fu">dcast</span>(tab, <span class="fu">get</span>(varGroupement[<span class="dv">1</span>]) <span class="sc">~</span> <span class="fu">get</span>(varGroupement[<span class="dv">2</span>]), <span class="at">value.var =</span> variable)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-122-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-122-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="tableaux-croisés-à-3-variables-de-groupement-ou-plus-1-variable-en-ligne-2-en-colonne" class="level2" data-number="16.4">
<h2 data-number="16.4" class="anchored" data-anchor-id="tableaux-croisés-à-3-variables-de-groupement-ou-plus-1-variable-en-ligne-2-en-colonne"><span class="header-section-number">16.4</span> Tableaux croisés à 3 variables de groupement ou plus : 1 variable en ligne, 2 en colonne</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-123-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-123-1" role="tab" aria-controls="tabset-123-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-123-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-123-2" role="tab" aria-controls="tabset-123-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-123-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-123-3" role="tab" aria-controls="tabset-123-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-123-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-123-4" role="tab" aria-controls="tabset-123-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-123-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-123-5" role="tab" aria-controls="tabset-123-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-123-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-123-1-tab">
<div class="sourceCode" id="cb506"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb506-1"><a href="#cb506-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Notes par croisement de CSP (en ligne) et de Sexe x Niveau */</span></span>
<span id="cb506-2"><a href="#cb506-2" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> notes = note_contenu note_formateur note_moyens note_accompagnement note_materiel;</span>
<span id="cb506-3"><a href="#cb506-3" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> tabulate<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb506-4"><a href="#cb506-4" aria-hidden="true" tabindex="-1"></a>  class cspf sexef;</span>
<span id="cb506-5"><a href="#cb506-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> <span class="kw">&amp;notes.</span>;</span>
<span id="cb506-6"><a href="#cb506-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">table</span> (cspf all = <span class="st">"Ensemble"</span>), sexef * (<span class="kw">&amp;notes.</span>) * <span class="fu">mean</span>;</span>
<span id="cb506-7"><a href="#cb506-7" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb506-8"><a href="#cb506-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-9"><a href="#cb506-9" aria-hidden="true" tabindex="-1"></a><span class="co">/* Note_contenu par croisement de CSP (en ligne) et de Sexe x Niveau */</span></span>
<span id="cb506-10"><a href="#cb506-10" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> tabulate<span class="kw"> data</span> = donnees_sas;</span>
<span id="cb506-11"><a href="#cb506-11" aria-hidden="true" tabindex="-1"></a>  class cspf sexef Niveau;</span>
<span id="cb506-12"><a href="#cb506-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span> note_moyenne;</span>
<span id="cb506-13"><a href="#cb506-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">table</span> (cspf all = <span class="st">"Ensemble"</span>), (sexef * Niveau) * (note_moyenne) * <span class="fu">mean</span>;</span>
<span id="cb506-14"><a href="#cb506-14" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-123-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-123-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb507"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb507-1"><a href="#cb507-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1er exemple : CSPF en ligne, et chacune des 5 notes croisées avec le sexe en colonne</span></span>
<span id="cb507-2"><a href="#cb507-2" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb507-3"><a href="#cb507-3" aria-hidden="true" tabindex="-1"></a>var_groupe <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cspf"</span>, <span class="st">"sexef"</span>)</span>
<span id="cb507-4"><a href="#cb507-4" aria-hidden="true" tabindex="-1"></a>tableau <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(donnees_rbase[, varNotes], donnees_rbase[var_groupe], <span class="cf">function</span>(x) <span class="at">moyenne =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb507-5"><a href="#cb507-5" aria-hidden="true" tabindex="-1"></a><span class="fu">reshape</span>(tableau, </span>
<span id="cb507-6"><a href="#cb507-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">timevar =</span> var_groupe[<span class="dv">2</span>],</span>
<span id="cb507-7"><a href="#cb507-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">idvar =</span> var_groupe[<span class="dv">1</span>],</span>
<span id="cb507-8"><a href="#cb507-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">direction =</span> <span class="st">"wide"</span>)</span>
<span id="cb507-9"><a href="#cb507-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-10"><a href="#cb507-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 2e exemple : CSPF en ligne, et croisement Sexe x Qualifié en colonne, note_contenu sommée</span></span>
<span id="cb507-11"><a href="#cb507-11" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : proposer une fonction ?</span></span>
<span id="cb507-12"><a href="#cb507-12" aria-hidden="true" tabindex="-1"></a>formule <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="st">"note_contenu ~ cspf + sexef + niveau"</span>)</span>
<span id="cb507-13"><a href="#cb507-13" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(formule, <span class="fu">aggregate</span>(formule, <span class="at">data =</span> donnees_rbase, <span class="at">FUN =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb507-14"><a href="#cb507-14" aria-hidden="true" tabindex="-1"></a>nomsCol <span class="ot">&lt;-</span> <span class="fu">do.call</span>(paste, <span class="fu">c</span>(<span class="fu">expand.grid</span>(<span class="fu">dimnames</span>(tab)[<span class="sc">-</span>1L]), <span class="at">sep =</span> <span class="st">"_"</span>))</span>
<span id="cb507-15"><a href="#cb507-15" aria-hidden="true" tabindex="-1"></a>nomsLig <span class="ot">&lt;-</span> <span class="fu">dimnames</span>(tab)[[1L]]</span>
<span id="cb507-16"><a href="#cb507-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformation du tableau de résultats (en format array) vers un format matrix, puis dataframe</span></span>
<span id="cb507-17"><a href="#cb507-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Permet d'exprimer le array (matrice multidimensionnelle) en un tableau à deux dimensions</span></span>
<span id="cb507-18"><a href="#cb507-18" aria-hidden="true" tabindex="-1"></a><span class="co"># On transforme le tableau en matrice ayant en nombre de lignes dim(tab)[1], c'est-à-dire le nombre de lignes du array</span></span>
<span id="cb507-19"><a href="#cb507-19" aria-hidden="true" tabindex="-1"></a><span class="co"># et en nombre de colonnes le reste des variables</span></span>
<span id="cb507-20"><a href="#cb507-20" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(tab, <span class="at">nrow =</span> <span class="fu">dim</span>(tab)[1L]))</span>
<span id="cb507-21"><a href="#cb507-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Renommage des noms des colonnes de la base</span></span>
<span id="cb507-22"><a href="#cb507-22" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab) <span class="ot">&lt;-</span> nomsCol</span>
<span id="cb507-23"><a href="#cb507-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Renommage des noms des lignes de la base</span></span>
<span id="cb507-24"><a href="#cb507-24" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(tab) <span class="ot">&lt;-</span> nomsLig</span>
<span id="cb507-25"><a href="#cb507-25" aria-hidden="true" tabindex="-1"></a><span class="co"># On annule les valeurs manquantes</span></span>
<span id="cb507-26"><a href="#cb507-26" aria-hidden="true" tabindex="-1"></a>tab[<span class="fu">is.na</span>(tab)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb507-27"><a href="#cb507-27" aria-hidden="true" tabindex="-1"></a>tab</span>
<span id="cb507-28"><a href="#cb507-28" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : développer autour de cet exemple</span></span>
<span id="cb507-29"><a href="#cb507-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec 3 variables</span></span>
<span id="cb507-30"><a href="#cb507-30" aria-hidden="true" tabindex="-1"></a><span class="fu">xtabs</span>(<span class="fu">cbind</span>(note_contenu, note_materiel) <span class="sc">~</span> cspf <span class="sc">+</span> sexef, donnees_rbase)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-123-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-123-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb508"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb508-1"><a href="#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1er exemple : CSPF en ligne, et chacune des 5 notes croisées avec le sexe en colonne</span></span>
<span id="cb508-2"><a href="#cb508-2" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb508-3"><a href="#cb508-3" aria-hidden="true" tabindex="-1"></a>var_groupe <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cspf"</span>, <span class="st">"sexef"</span>)</span>
<span id="cb508-4"><a href="#cb508-4" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb508-5"><a href="#cb508-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(var_groupe))) <span class="sc">%&gt;%</span> </span>
<span id="cb508-6"><a href="#cb508-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(varNotes), <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb508-7"><a href="#cb508-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> sexef,</span>
<span id="cb508-8"><a href="#cb508-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">all_of</span>(varNotes))</span>
<span id="cb508-9"><a href="#cb508-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb508-10"><a href="#cb508-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb508-11"><a href="#cb508-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb508-12"><a href="#cb508-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 2e exemple : CSPF en ligne, et croisement Sexe x Qualifié en colonne, note_contenu sommée</span></span>
<span id="cb508-13"><a href="#cb508-13" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>)</span>
<span id="cb508-14"><a href="#cb508-14" aria-hidden="true" tabindex="-1"></a>var_groupe <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cspf"</span>, <span class="st">"sexef"</span>, <span class="st">"niveau"</span>)</span>
<span id="cb508-15"><a href="#cb508-15" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb508-16"><a href="#cb508-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(var_groupe))) <span class="sc">%&gt;%</span> </span>
<span id="cb508-17"><a href="#cb508-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(varNotes), <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb508-18"><a href="#cb508-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="fu">c</span>(sexef, niveau),</span>
<span id="cb508-19"><a href="#cb508-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">all_of</span>(varNotes),</span>
<span id="cb508-20"><a href="#cb508-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="dv">0</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-123-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-123-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb509"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb509-1"><a href="#cb509-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1er exemple : CSPF en ligne, et chacune des 5 notes croisées avec le sexe en colonne</span></span>
<span id="cb509-2"><a href="#cb509-2" aria-hidden="true" tabindex="-1"></a>varNotes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"note_contenu"</span>, <span class="st">"note_formateur"</span>, <span class="st">"note_moyens"</span>, <span class="st">"note_accompagnement"</span>, <span class="st">"note_materiel"</span>)</span>
<span id="cb509-3"><a href="#cb509-3" aria-hidden="true" tabindex="-1"></a>var_groupe <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cspf"</span>, <span class="st">"sexef"</span>)</span>
<span id="cb509-4"><a href="#cb509-4" aria-hidden="true" tabindex="-1"></a>data.table<span class="sc">::</span><span class="fu">dcast</span>(donnees_datatable, <span class="fu">get</span>(varGroupement[<span class="dv">1</span>]) <span class="sc">~</span> <span class="fu">get</span>(varGroupement[<span class="dv">2</span>]), <span class="at">value.var =</span> varNotes,</span>
<span id="cb509-5"><a href="#cb509-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fun.aggregate =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb509-6"><a href="#cb509-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-7"><a href="#cb509-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2e exemple : CSPF en ligne, et croisement Sexe x Qualifié en colonne, note_contenu sommée</span></span>
<span id="cb509-8"><a href="#cb509-8" aria-hidden="true" tabindex="-1"></a>data.table<span class="sc">::</span><span class="fu">dcast</span>(donnees_datatable, cspf <span class="sc">~</span> sexef <span class="sc">+</span> niveau, <span class="at">value.var =</span> <span class="st">"note_contenu"</span>,</span>
<span id="cb509-9"><a href="#cb509-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fun.aggregate =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-123-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-123-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
</section>
<section id="boucles" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> Boucles</h1>
<section id="boucles-imbriquées" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="boucles-imbriquées"><span class="header-section-number">17.1</span> Boucles imbriquées</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-124-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-124-1" role="tab" aria-controls="tabset-124-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-124-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-124-2" role="tab" aria-controls="tabset-124-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-124-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-124-3" role="tab" aria-controls="tabset-124-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-124-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-124-4" role="tab" aria-controls="tabset-124-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-124-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-124-5" role="tab" aria-controls="tabset-124-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-124-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-124-1-tab">
<div class="sourceCode" id="cb510"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb510-1"><a href="#cb510-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> _null_;<span class="kw">call</span> symput(<span class="st">'annee'</span>, strip(<span class="fu">year</span>(<span class="fu">today</span>())))<span class="kw">;run</span>;</span>
<span id="cb510-2"><a href="#cb510-2" aria-hidden="true" tabindex="-1"></a><span class="co">/* Ensemble des premiers jours de chaque mois entre 2020 et le 31 décembre de l'année courante */</span></span>
<span id="cb510-3"><a href="#cb510-3" aria-hidden="true" tabindex="-1"></a><span class="kw">%macro</span> Boucles_Imbriquees(an_debut, an_fin);</span>
<span id="cb510-4"><a href="#cb510-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%local</span> i j;</span>
<span id="cb510-5"><a href="#cb510-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%global</span> liste_mois;</span>
<span id="cb510-6"><a href="#cb510-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%let</span> liste_mois = ;</span>
<span id="cb510-7"><a href="#cb510-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%do</span> i = <span class="kw">&amp;an_debut.</span> <span class="kw">%to</span> <span class="kw">&amp;an_fin.</span>;</span>
<span id="cb510-8"><a href="#cb510-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%do</span> j = <span class="dv">1</span> <span class="kw">%to</span> <span class="dv">12</span>;</span>
<span id="cb510-9"><a href="#cb510-9" aria-hidden="true" tabindex="-1"></a>      <span class="kw">%let</span> liste_mois = <span class="kw">&amp;liste_mois.</span> <span class="kw">%sysfunc</span>(<span class="fu">putn</span>(<span class="kw">%sysfunc</span>(<span class="fu">mdy</span>(<span class="kw">&amp;j.</span>, <span class="dv">1</span>, <span class="kw">&amp;i.</span>)), ddmmyy10.));</span>
<span id="cb510-10"><a href="#cb510-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%end</span>;</span>
<span id="cb510-11"><a href="#cb510-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%end</span>;</span>
<span id="cb510-12"><a href="#cb510-12" aria-hidden="true" tabindex="-1"></a><span class="kw">%mend</span> Boucles_Imbriquees;</span>
<span id="cb510-13"><a href="#cb510-13" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> annee = <span class="kw">%sysfunc</span>(<span class="fu">year</span>(<span class="kw">%sysfunc</span>(<span class="fu">today</span>())));</span>
<span id="cb510-14"><a href="#cb510-14" aria-hidden="true" tabindex="-1"></a>%Boucles_Imbriquees(an_debut = 2020, an_fin = &amp;annee.);</span>
<span id="cb510-15"><a href="#cb510-15" aria-hidden="true" tabindex="-1"></a><span class="kw">%put</span> <span class="kw">&amp;liste_mois.</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-124-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-124-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb511"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb511-1"><a href="#cb511-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensemble des premiers jours de chaque mois entre 2020 et l'année courante</span></span>
<span id="cb511-2"><a href="#cb511-2" aria-hidden="true" tabindex="-1"></a>annee <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">year</span>(<span class="fu">Sys.Date</span>())</span>
<span id="cb511-3"><a href="#cb511-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1ère solution avec for (lente, à déconseiller !)</span></span>
<span id="cb511-4"><a href="#cb511-4" aria-hidden="true" tabindex="-1"></a>listeMois <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb511-5"><a href="#cb511-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">2020</span>, annee)) {</span>
<span id="cb511-6"><a href="#cb511-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>) {</span>
<span id="cb511-7"><a href="#cb511-7" aria-hidden="true" tabindex="-1"></a>    listeMois <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(listeMois, lubridate<span class="sc">::</span><span class="fu">ymd</span>(<span class="fu">sprintf</span>(<span class="st">"%02d-%02d-01"</span>, i, j))), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>)</span>
<span id="cb511-8"><a href="#cb511-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb511-9"><a href="#cb511-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb511-10"><a href="#cb511-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 2e  solution : 2 fonctions lapply imbriquées</span></span>
<span id="cb511-11"><a href="#cb511-11" aria-hidden="true" tabindex="-1"></a>listeMois <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="fu">seq</span>(<span class="dv">2020</span>, annee), </span>
<span id="cb511-12"><a href="#cb511-12" aria-hidden="true" tabindex="-1"></a>                                   <span class="cf">function</span>(x) <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="cf">function</span>(y) lubridate<span class="sc">::</span><span class="fu">ymd</span>(<span class="fu">sprintf</span>(<span class="st">"%02d-%02d-01"</span>, x, y))))),</span>
<span id="cb511-13"><a href="#cb511-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">origin =</span> <span class="st">"1970-01-01"</span>)</span>
<span id="cb511-14"><a href="#cb511-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 3e solution : expand.grid</span></span>
<span id="cb511-15"><a href="#cb511-15" aria-hidden="true" tabindex="-1"></a>listeMois <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.Date</span>(<span class="fu">apply</span>(<span class="fu">expand.grid</span>(<span class="fu">seq</span>(<span class="dv">2020</span>, annee), <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>), <span class="dv">1</span>, </span>
<span id="cb511-16"><a href="#cb511-16" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">function</span>(x) lubridate<span class="sc">::</span><span class="fu">ymd</span>(<span class="fu">sprintf</span>(<span class="st">"%02d-%02d-01"</span>, x[<span class="dv">1</span>], x[<span class="dv">2</span>]))),</span>
<span id="cb511-17"><a href="#cb511-17" aria-hidden="true" tabindex="-1"></a>                          <span class="at">origin =</span> <span class="st">"1970-01-01"</span>))</span>
<span id="cb511-18"><a href="#cb511-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 4e solution, la plus simple !</span></span>
<span id="cb511-19"><a href="#cb511-19" aria-hidden="true" tabindex="-1"></a><span class="fu">seq.Date</span>(lubridate<span class="sc">::</span><span class="fu">ymd</span>(<span class="fu">sprintf</span>(<span class="st">"%02d-01-01"</span>, <span class="dv">2020</span>)), lubridate<span class="sc">::</span><span class="fu">ymd</span>(<span class="fu">sprintf</span>(<span class="st">"%02d-12-01"</span>, annee)), <span class="at">by =</span> <span class="st">"month"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-124-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-124-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb512"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb512-1"><a href="#cb512-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensemble des premiers jours de chaque mois entre 2020 et l'année courante</span></span>
<span id="cb512-2"><a href="#cb512-2" aria-hidden="true" tabindex="-1"></a>annee <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">year</span>(<span class="fu">Sys.Date</span>())</span>
<span id="cb512-3"><a href="#cb512-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1ère solution : 2 fonctions map imbriquées</span></span>
<span id="cb512-4"><a href="#cb512-4" aria-hidden="true" tabindex="-1"></a>listeMois <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(<span class="fu">seq</span>(<span class="dv">2020</span>, annee), </span>
<span id="cb512-5"><a href="#cb512-5" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">function</span>(x) purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,</span>
<span id="cb512-6"><a href="#cb512-6" aria-hidden="true" tabindex="-1"></a>                                               <span class="cf">function</span>(y) lubridate<span class="sc">::</span><span class="fu">ymd</span>(<span class="fu">sprintf</span>(<span class="st">"%02d-%02d-01"</span>, x, y)))) <span class="sc">%&gt;%</span> </span>
<span id="cb512-7"><a href="#cb512-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb512-8"><a href="#cb512-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.Date</span>(, <span class="at">origin =</span> <span class="st">"1970-01-01"</span>)</span>
<span id="cb512-9"><a href="#cb512-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-10"><a href="#cb512-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 2e solution : expand_grid</span></span>
<span id="cb512-11"><a href="#cb512-11" aria-hidden="true" tabindex="-1"></a>listeMois <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">expand_grid</span>(<span class="at">annee =</span> <span class="fu">seq</span>(<span class="dv">2020</span>, annee), <span class="at">mois =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb512-12"><a href="#cb512-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(<span class="dv">1</span>, <span class="cf">function</span>(x) lubridate<span class="sc">::</span><span class="fu">ymd</span>(<span class="fu">sprintf</span>(<span class="st">"%02d-%02d-01"</span>, x[<span class="dv">1</span>], x[<span class="dv">2</span>]))) <span class="sc">%&gt;%</span> </span>
<span id="cb512-13"><a href="#cb512-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.Date</span>(, <span class="at">origin =</span> <span class="st">"1970-01-01"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb512-14"><a href="#cb512-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>()</span>
<span id="cb512-15"><a href="#cb512-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-16"><a href="#cb512-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 3e solution, la plus simple</span></span>
<span id="cb512-17"><a href="#cb512-17" aria-hidden="true" tabindex="-1"></a><span class="fu">seq.Date</span>(lubridate<span class="sc">::</span><span class="fu">ymd</span>(<span class="fu">sprintf</span>(<span class="st">"%02d-01-01"</span>, <span class="dv">2020</span>)), lubridate<span class="sc">::</span><span class="fu">ymd</span>(<span class="fu">sprintf</span>(<span class="st">"%02d-12-01"</span>, annee)), <span class="at">by =</span> <span class="st">"month"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-124-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-124-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb513"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb513-1"><a href="#cb513-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensemble des premiers jours de chaque mois entre 2020 et l'année courante</span></span>
<span id="cb513-2"><a href="#cb513-2" aria-hidden="true" tabindex="-1"></a>annee <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">year</span>(<span class="fu">Sys.Date</span>())</span>
<span id="cb513-3"><a href="#cb513-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1ère solution avec for (lente, à déconseiller !)</span></span>
<span id="cb513-4"><a href="#cb513-4" aria-hidden="true" tabindex="-1"></a>listeMois <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb513-5"><a href="#cb513-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">2020</span>, annee)) {</span>
<span id="cb513-6"><a href="#cb513-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>) {</span>
<span id="cb513-7"><a href="#cb513-7" aria-hidden="true" tabindex="-1"></a>    listeMois <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(listeMois, lubridate<span class="sc">::</span><span class="fu">ymd</span>(<span class="fu">sprintf</span>(<span class="st">"%02d-%02d-01"</span>, i, j))), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>)</span>
<span id="cb513-8"><a href="#cb513-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb513-9"><a href="#cb513-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb513-10"><a href="#cb513-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 2e  solution : 2 fonctions lapply imbriquées</span></span>
<span id="cb513-11"><a href="#cb513-11" aria-hidden="true" tabindex="-1"></a>listeMois <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="fu">seq</span>(<span class="dv">2020</span>, annee), </span>
<span id="cb513-12"><a href="#cb513-12" aria-hidden="true" tabindex="-1"></a>                                   <span class="cf">function</span>(x) <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="cf">function</span>(y) lubridate<span class="sc">::</span><span class="fu">ymd</span>(<span class="fu">sprintf</span>(<span class="st">"%02d-%02d-01"</span>, x, y))))),</span>
<span id="cb513-13"><a href="#cb513-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">origin =</span> <span class="st">"1970-01-01"</span>)</span>
<span id="cb513-14"><a href="#cb513-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 3e solution : expand.grid</span></span>
<span id="cb513-15"><a href="#cb513-15" aria-hidden="true" tabindex="-1"></a>listeMois <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.Date</span>(<span class="fu">apply</span>(<span class="fu">expand.grid</span>(<span class="fu">seq</span>(<span class="dv">2020</span>, annee), <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>), <span class="dv">1</span>, </span>
<span id="cb513-16"><a href="#cb513-16" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">function</span>(x) lubridate<span class="sc">::</span><span class="fu">ymd</span>(<span class="fu">sprintf</span>(<span class="st">"%02d-%02d-01"</span>, x[<span class="dv">1</span>], x[<span class="dv">2</span>]))),</span>
<span id="cb513-17"><a href="#cb513-17" aria-hidden="true" tabindex="-1"></a>                          <span class="at">origin =</span> <span class="st">"1970-01-01"</span>))</span>
<span id="cb513-18"><a href="#cb513-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 4e solution, la plus simple</span></span>
<span id="cb513-19"><a href="#cb513-19" aria-hidden="true" tabindex="-1"></a><span class="fu">seq.Date</span>(lubridate<span class="sc">::</span><span class="fu">ymd</span>(<span class="fu">sprintf</span>(<span class="st">"%02d-01-01"</span>, <span class="dv">2020</span>)), lubridate<span class="sc">::</span><span class="fu">ymd</span>(<span class="fu">sprintf</span>(<span class="st">"%02d-12-01"</span>, annee)), <span class="at">by =</span> <span class="st">"month"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-124-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-124-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="boucles-imbriquées-second-exemple" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="boucles-imbriquées-second-exemple"><span class="header-section-number">17.2</span> Boucles imbriquées (second exemple)</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-125-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-125-1" role="tab" aria-controls="tabset-125-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-125-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-125-2" role="tab" aria-controls="tabset-125-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-125-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-125-3" role="tab" aria-controls="tabset-125-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-125-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-125-4" role="tab" aria-controls="tabset-125-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-125-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-125-5" role="tab" aria-controls="tabset-125-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-125-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-125-1-tab">
<div class="sourceCode" id="cb514"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb514-1"><a href="#cb514-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Itérer sur toutes les années et les trimestres d'une certaine plage */</span></span>
<span id="cb514-2"><a href="#cb514-2" aria-hidden="true" tabindex="-1"></a><span class="co">/* on va afficher les noms base_AAAA_tT_nmax où AAAA désigne les années, T les trimestres, depuis 2020 */</span></span>
<span id="cb514-3"><a href="#cb514-3" aria-hidden="true" tabindex="-1"></a><span class="kw">%macro</span> iteration(debut, fin);</span>
<span id="cb514-4"><a href="#cb514-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%global</span> liste_an;</span>
<span id="cb514-5"><a href="#cb514-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%let</span> liste_an = ;</span>
<span id="cb514-6"><a href="#cb514-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%do</span> i = <span class="kw">&amp;debut.</span> <span class="kw">%to</span> <span class="kw">&amp;fin.</span>;</span>
<span id="cb514-7"><a href="#cb514-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%let</span> liste_an = <span class="kw">&amp;liste_an.&amp;i.</span>-;</span>
<span id="cb514-8"><a href="#cb514-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%end</span>;</span>
<span id="cb514-9"><a href="#cb514-9" aria-hidden="true" tabindex="-1"></a><span class="kw">%mend</span> iteration;</span>
<span id="cb514-10"><a href="#cb514-10" aria-hidden="true" tabindex="-1"></a>%iteration(debut = 2020, fin = %sysfunc(year(%sysfunc(today()))));</span>
<span id="cb514-11"><a href="#cb514-11" aria-hidden="true" tabindex="-1"></a><span class="kw">%put</span> <span class="kw">&amp;liste_an.</span>;</span>
<span id="cb514-12"><a href="#cb514-12" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> liste_trim = <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span>;</span>
<span id="cb514-13"><a href="#cb514-13" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> liste_niv = <span class="fu">max</span> <span class="fu">min</span>;</span>
<span id="cb514-14"><a href="#cb514-14" aria-hidden="true" tabindex="-1"></a><span class="co">/* Supposons que nous ayons des noms de fichier suffixés par AXXXX_TY_NZ, avec X l'année, Y le trimestre et</span></span>
<span id="cb514-15"><a href="#cb514-15" aria-hidden="true" tabindex="-1"></a><span class="co">   Z max ou min. Par exemple, A2010_T2_NMax */</span></span>
<span id="cb514-16"><a href="#cb514-16" aria-hidden="true" tabindex="-1"></a><span class="co">/* Pour obtenir l'ensemble de ces noms de 2010 à cette année */</span></span>
<span id="cb514-17"><a href="#cb514-17" aria-hidden="true" tabindex="-1"></a><span class="kw">%macro</span> noms_fichiers(base = temp);</span>
<span id="cb514-18"><a href="#cb514-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%global</span> res;</span>
<span id="cb514-19"><a href="#cb514-19" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%let</span> res = ;</span>
<span id="cb514-20"><a href="#cb514-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%do</span> j = <span class="dv">1</span> <span class="kw">%to</span> <span class="kw">%sysfunc</span>(countw(<span class="kw">&amp;liste_an.</span>, <span class="st">"-"</span>));</span>
<span id="cb514-21"><a href="#cb514-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%let</span> y = <span class="kw">%scan</span>(<span class="kw">&amp;liste_an.</span>, <span class="kw">&amp;j.</span>, <span class="st">"-"</span>); <span class="co">/* année */</span></span>
<span id="cb514-22"><a href="#cb514-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%do</span> i = <span class="dv">1</span> <span class="kw">%to</span> <span class="dv">4</span>;</span>
<span id="cb514-23"><a href="#cb514-23" aria-hidden="true" tabindex="-1"></a>      <span class="kw">%let</span> t = <span class="kw">%scan</span>(<span class="kw">&amp;liste_trim,</span> <span class="kw">&amp;i.</span>); <span class="co">/* trimestre */</span></span>
<span id="cb514-24"><a href="#cb514-24" aria-hidden="true" tabindex="-1"></a>      <span class="kw">%do</span> g = <span class="dv">1</span> <span class="kw">%to</span> <span class="dv">2</span>;</span>
<span id="cb514-25"><a href="#cb514-25" aria-hidden="true" tabindex="-1"></a>        <span class="kw">%let</span> <span class="fu">n</span> = <span class="kw">%scan</span>(<span class="kw">&amp;liste_niv.</span>, <span class="kw">&amp;g.</span>); <span class="co">/* niveau */</span></span>
<span id="cb514-26"><a href="#cb514-26" aria-hidden="true" tabindex="-1"></a>        <span class="kw">%let</span> res = <span class="kw">&amp;res.</span> <span class="kw">&amp;base.</span>_<span class="kw">&amp;y.</span>_t<span class="kw">&amp;t.</span>_n<span class="kw">&amp;n.</span>;</span>
<span id="cb514-27"><a href="#cb514-27" aria-hidden="true" tabindex="-1"></a>      <span class="kw">%end</span>;</span>
<span id="cb514-28"><a href="#cb514-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%end</span>;</span>
<span id="cb514-29"><a href="#cb514-29" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%end</span>;</span>
<span id="cb514-30"><a href="#cb514-30" aria-hidden="true" tabindex="-1"></a><span class="kw">%mend</span> noms_fichiers;</span>
<span id="cb514-31"><a href="#cb514-31" aria-hidden="true" tabindex="-1"></a>%noms_fichiers(base = base);</span>
<span id="cb514-32"><a href="#cb514-32" aria-hidden="true" tabindex="-1"></a><span class="kw">%put</span> <span class="kw">&amp;res.</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-125-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-125-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb515"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb515-1"><a href="#cb515-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Itérer sur toutes les années et les trimestres d'une certaine plage</span></span>
<span id="cb515-2"><a href="#cb515-2" aria-hidden="true" tabindex="-1"></a><span class="co"># on va afficher les noms base_AAAA_tT_nmax où AAAA désigne les années, T les trimestres, depuis 2020 </span></span>
<span id="cb515-3"><a href="#cb515-3" aria-hidden="true" tabindex="-1"></a>debut <span class="ot">&lt;-</span> <span class="dv">2020</span></span>
<span id="cb515-4"><a href="#cb515-4" aria-hidden="true" tabindex="-1"></a>fin <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">year</span>(<span class="fu">Sys.Date</span>())</span>
<span id="cb515-5"><a href="#cb515-5" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(debut<span class="sc">:</span>fin, <span class="cf">function</span>(x) <span class="fu">lapply</span>(<span class="fu">c</span>(<span class="st">"max"</span>, <span class="st">"min"</span>), <span class="cf">function</span>(y)  <span class="fu">sprintf</span>(<span class="st">"base_%4d_t%d_n%s"</span>, x, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, y))))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-125-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-125-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb516"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb516-1"><a href="#cb516-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Itérer sur toutes les années et les trimestres d'une certaine plage</span></span>
<span id="cb516-2"><a href="#cb516-2" aria-hidden="true" tabindex="-1"></a><span class="co"># on va afficher les noms base_AAAA_tT_nmax où AAAA désigne les années, T les trimestres, depuis 2020 </span></span>
<span id="cb516-3"><a href="#cb516-3" aria-hidden="true" tabindex="-1"></a>debut <span class="ot">&lt;-</span> <span class="dv">2020</span></span>
<span id="cb516-4"><a href="#cb516-4" aria-hidden="true" tabindex="-1"></a>fin <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">year</span>(<span class="fu">Sys.Date</span>())</span>
<span id="cb516-5"><a href="#cb516-5" aria-hidden="true" tabindex="-1"></a>listeMois <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(debut<span class="sc">:</span>fin, </span>
<span id="cb516-6"><a href="#cb516-6" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">function</span>(x) purrr<span class="sc">::</span><span class="fu">map</span>(<span class="fu">c</span>(<span class="st">"max"</span>, <span class="st">"min"</span>),</span>
<span id="cb516-7"><a href="#cb516-7" aria-hidden="true" tabindex="-1"></a>                                               <span class="cf">function</span>(y) <span class="fu">sprintf</span>(<span class="st">"base_%4d_t%d_n%s"</span>, x, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, y))) <span class="sc">%&gt;%</span> </span>
<span id="cb516-8"><a href="#cb516-8" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">unlist</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-125-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-125-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb517"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb517-1"><a href="#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Itérer sur toutes les années et les trimestres d'une certaine plage</span></span>
<span id="cb517-2"><a href="#cb517-2" aria-hidden="true" tabindex="-1"></a><span class="co"># on va afficher les noms base_AAAA_tT_nmax où AAAA désigne les années, T les trimestres, depuis 2020 </span></span>
<span id="cb517-3"><a href="#cb517-3" aria-hidden="true" tabindex="-1"></a>debut <span class="ot">&lt;-</span> <span class="dv">2020</span></span>
<span id="cb517-4"><a href="#cb517-4" aria-hidden="true" tabindex="-1"></a>fin <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">year</span>(<span class="fu">Sys.Date</span>())</span>
<span id="cb517-5"><a href="#cb517-5" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(debut<span class="sc">:</span>fin, <span class="cf">function</span>(x) <span class="fu">lapply</span>(<span class="fu">c</span>(<span class="st">"max"</span>, <span class="st">"min"</span>), <span class="cf">function</span>(y)  <span class="fu">sprintf</span>(<span class="st">"base_%4d_t%d_n%s"</span>, x, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, y))))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-125-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-125-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="boucles-for" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="boucles-for"><span class="header-section-number">17.3</span> Boucles for</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-126-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-126-1" role="tab" aria-controls="tabset-126-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-126-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-126-2" role="tab" aria-controls="tabset-126-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-126-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-126-3" role="tab" aria-controls="tabset-126-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-126-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-126-4" role="tab" aria-controls="tabset-126-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-126-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-126-5" role="tab" aria-controls="tabset-126-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-126-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-126-1-tab">
<div class="sourceCode" id="cb518"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb518-1"><a href="#cb518-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* On va créer une base par année d'entrée */</span></span>
<span id="cb518-2"><a href="#cb518-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql noprint;</span>
<span id="cb518-3"><a href="#cb518-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> <span class="fu">year</span>(<span class="fu">min</span>(date_entree)), <span class="fu">year</span>(<span class="fu">max</span>(date_entree)) <span class="kw">into</span> :an_min, :an_max</span>
<span id="cb518-4"><a href="#cb518-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> donnees_sas;</span>
<span id="cb518-5"><a href="#cb518-5" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span>
<span id="cb518-6"><a href="#cb518-6" aria-hidden="true" tabindex="-1"></a><span class="kw">%macro</span> Base_par_mois(debut, fin);</span>
<span id="cb518-7"><a href="#cb518-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* %local impose que an n'est pas de signification hors de la macro */</span></span>
<span id="cb518-8"><a href="#cb518-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%local</span> an;</span>
<span id="cb518-9"><a href="#cb518-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* %global impose que nom_bases peut être utilisé en dehors de la macro */</span></span>
<span id="cb518-10"><a href="#cb518-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%global</span> nom_bases;</span>
<span id="cb518-11"><a href="#cb518-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* On initalise la création de la macri-variable nom_bases */</span></span>
<span id="cb518-12"><a href="#cb518-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%let</span> nom_bases = ;</span>
<span id="cb518-13"><a href="#cb518-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* On itère entre &amp;debut. et &amp;fin. */</span></span>
<span id="cb518-14"><a href="#cb518-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%do</span> an = <span class="kw">&amp;debut.</span> <span class="kw">%to</span> <span class="kw">&amp;fin.</span>;</span>
<span id="cb518-15"><a href="#cb518-15" aria-hidden="true" tabindex="-1"></a><span class="kw">    data</span> Entree_<span class="kw">&amp;an.</span>;</span>
<span id="cb518-16"><a href="#cb518-16" aria-hidden="true" tabindex="-1"></a>      <span class="kw">set</span> donnees_sas;</span>
<span id="cb518-17"><a href="#cb518-17" aria-hidden="true" tabindex="-1"></a>      <span class="kw">if</span> <span class="fu">year</span>(date_entree) = <span class="kw">&amp;an.</span>;</span>
<span id="cb518-18"><a href="#cb518-18" aria-hidden="true" tabindex="-1"></a><span class="kw">    run</span>;</span>
<span id="cb518-19"><a href="#cb518-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* On ajoute à la macro-variable le nom de la base */</span></span>
<span id="cb518-20"><a href="#cb518-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%let</span> nom_bases = <span class="kw">&amp;nom_bases.</span> Entree_<span class="kw">&amp;an.</span>;</span>
<span id="cb518-21"><a href="#cb518-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%end</span>;</span>
<span id="cb518-22"><a href="#cb518-22" aria-hidden="true" tabindex="-1"></a><span class="kw">%mend</span> Base_par_mois;</span>
<span id="cb518-23"><a href="#cb518-23" aria-hidden="true" tabindex="-1"></a>%Base_par_mois(debut = &amp;an_min., fin = &amp;an_max.);</span>
<span id="cb518-24"><a href="#cb518-24" aria-hidden="true" tabindex="-1"></a><span class="kw">%put</span> <span class="kw">&amp;nom_bases.</span>;</span>
<span id="cb518-25"><a href="#cb518-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb518-26"><a href="#cb518-26" aria-hidden="true" tabindex="-1"></a><span class="co">/* On va désormais empiler toutes les bases (concaténation par colonne) */</span></span>
<span id="cb518-27"><a href="#cb518-27" aria-hidden="true" tabindex="-1"></a><span class="co">/* L'instruction set utilisée de cette façon permet cet empilement */</span></span>
<span id="cb518-28"><a href="#cb518-28" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> concatene;</span>
<span id="cb518-29"><a href="#cb518-29" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> <span class="kw">&amp;nom_bases.</span>;</span>
<span id="cb518-30"><a href="#cb518-30" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-126-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-126-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb519"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb519-1"><a href="#cb519-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On va créer une base par année d'entrée</span></span>
<span id="cb519-2"><a href="#cb519-2" aria-hidden="true" tabindex="-1"></a>anMin <span class="ot">&lt;-</span> <span class="fu">min</span>(lubridate<span class="sc">::</span><span class="fu">year</span>(donnees_rbase<span class="sc">$</span>date_entree), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb519-3"><a href="#cb519-3" aria-hidden="true" tabindex="-1"></a>anMax <span class="ot">&lt;-</span> <span class="fu">max</span>(lubridate<span class="sc">::</span><span class="fu">year</span>(donnees_rbase<span class="sc">$</span>date_entree), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb519-4"><a href="#cb519-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> anMin<span class="sc">:</span>anMax) {</span>
<span id="cb519-5"><a href="#cb519-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># assign permet de faire passer une chaîne de caractères en variable R</span></span>
<span id="cb519-6"><a href="#cb519-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste</span>(<span class="st">"entree"</span>, i, <span class="at">sep =</span> <span class="st">"_"</span>), donnees_rbase[<span class="fu">which</span>(lubridate<span class="sc">::</span><span class="fu">year</span>(donnees_rbase<span class="sc">$</span>date_entree) <span class="sc">==</span> i), ])</span>
<span id="cb519-7"><a href="#cb519-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb519-8"><a href="#cb519-8" aria-hidden="true" tabindex="-1"></a><span class="co"># On va désormais empiler toutes les bases (concaténation par colonne)</span></span>
<span id="cb519-9"><a href="#cb519-9" aria-hidden="true" tabindex="-1"></a><span class="co"># do.call applique la fonction rbind à l'ensemble des bases issues du lapply</span></span>
<span id="cb519-10"><a href="#cb519-10" aria-hidden="true" tabindex="-1"></a><span class="co"># get permet de faire le chemin inverse de assign</span></span>
<span id="cb519-11"><a href="#cb519-11" aria-hidden="true" tabindex="-1"></a>concatene <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(<span class="fu">paste</span>(<span class="st">"entree"</span>, anMin<span class="sc">:</span>anMax, <span class="at">sep =</span> <span class="st">"_"</span>), get))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-126-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-126-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb520"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb520-1"><a href="#cb520-1" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : problème pour les entrées où la date est manquante</span></span>
<span id="cb520-2"><a href="#cb520-2" aria-hidden="true" tabindex="-1"></a><span class="co"># On va créer une base par année d'entrée</span></span>
<span id="cb520-3"><a href="#cb520-3" aria-hidden="true" tabindex="-1"></a>anMin <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">pull</span>(date_entree) <span class="sc">%&gt;%</span> lubridate<span class="sc">::</span><span class="fu">year</span>() <span class="sc">%&gt;%</span> <span class="fu">min</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb520-4"><a href="#cb520-4" aria-hidden="true" tabindex="-1"></a>anMax <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">pull</span>(date_entree) <span class="sc">%&gt;%</span> lubridate<span class="sc">::</span><span class="fu">year</span>() <span class="sc">%&gt;%</span> <span class="fu">max</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb520-5"><a href="#cb520-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> anMin<span class="sc">:</span>anMax) {</span>
<span id="cb520-6"><a href="#cb520-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># assign permet de faire passer une chaîne de caractères en variable R</span></span>
<span id="cb520-7"><a href="#cb520-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste</span>(<span class="st">"entree"</span>, i, <span class="at">sep =</span> <span class="st">"_"</span>),</span>
<span id="cb520-8"><a href="#cb520-8" aria-hidden="true" tabindex="-1"></a>         donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">filter</span>(lubridate<span class="sc">::</span><span class="fu">year</span>(date_entree) <span class="sc">==</span> <span class="fu">as.name</span>(i)))</span>
<span id="cb520-9"><a href="#cb520-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb520-10"><a href="#cb520-10" aria-hidden="true" tabindex="-1"></a><span class="co"># On va désormais empiler toutes les bases (concaténation par colonne)</span></span>
<span id="cb520-11"><a href="#cb520-11" aria-hidden="true" tabindex="-1"></a><span class="co"># purrr::reduce applique la fonction bind_rows à l'ensemble des bases issues du purrr::map</span></span>
<span id="cb520-12"><a href="#cb520-12" aria-hidden="true" tabindex="-1"></a><span class="co"># get permet de faire le chemin inverse de assign</span></span>
<span id="cb520-13"><a href="#cb520-13" aria-hidden="true" tabindex="-1"></a>concatene <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(<span class="fu">paste</span>(<span class="st">"entree"</span>, anMin<span class="sc">:</span>anMax, <span class="at">sep =</span> <span class="st">"_"</span>), get) <span class="sc">%&gt;%</span> </span>
<span id="cb520-14"><a href="#cb520-14" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">reduce</span>(bind_rows)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-126-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-126-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb521"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb521-1"><a href="#cb521-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On va créer une base par année d'entrée</span></span>
<span id="cb521-2"><a href="#cb521-2" aria-hidden="true" tabindex="-1"></a>anMin <span class="ot">&lt;-</span> <span class="fu">min</span>(lubridate<span class="sc">::</span><span class="fu">year</span>(donnees_datatable<span class="sc">$</span>date_entree), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb521-3"><a href="#cb521-3" aria-hidden="true" tabindex="-1"></a>anMax <span class="ot">&lt;-</span> <span class="fu">max</span>(lubridate<span class="sc">::</span><span class="fu">year</span>(donnees_datatable<span class="sc">$</span>date_entree), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb521-4"><a href="#cb521-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> anMin<span class="sc">:</span>anMax) {</span>
<span id="cb521-5"><a href="#cb521-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># assign permet de faire passer une chaîne de caractères en variable R</span></span>
<span id="cb521-6"><a href="#cb521-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste</span>(<span class="st">"entree"</span>, i, <span class="at">sep =</span> <span class="st">"_"</span>), donnees_datatable[lubridate<span class="sc">::</span><span class="fu">year</span>(donnees_datatable<span class="sc">$</span>date_entree) <span class="sc">==</span> i, ])</span>
<span id="cb521-7"><a href="#cb521-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb521-8"><a href="#cb521-8" aria-hidden="true" tabindex="-1"></a><span class="co"># On va désormais empiler toutes les bases (concaténation par colonne)</span></span>
<span id="cb521-9"><a href="#cb521-9" aria-hidden="true" tabindex="-1"></a><span class="co"># do.call applique la fonction rbind à l'ensemble des bases issues du lapply</span></span>
<span id="cb521-10"><a href="#cb521-10" aria-hidden="true" tabindex="-1"></a><span class="co"># get permet de faire le chemin inverse de assign</span></span>
<span id="cb521-11"><a href="#cb521-11" aria-hidden="true" tabindex="-1"></a>concatene <span class="ot">&lt;-</span> <span class="fu">rbindlist</span>(<span class="fu">lapply</span>(<span class="fu">paste</span>(<span class="st">"entree"</span>, anMin<span class="sc">:</span>anMax, <span class="at">sep =</span> <span class="st">"_"</span>), get))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-126-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-126-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="boucles-for-second-exemple" class="level2" data-number="17.4">
<h2 data-number="17.4" class="anchored" data-anchor-id="boucles-for-second-exemple"><span class="header-section-number">17.4</span> Boucles for (second exemple)</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-127-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-127-1" role="tab" aria-controls="tabset-127-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-127-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-127-2" role="tab" aria-controls="tabset-127-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-127-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-127-3" role="tab" aria-controls="tabset-127-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-127-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-127-4" role="tab" aria-controls="tabset-127-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-127-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-127-5" role="tab" aria-controls="tabset-127-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-127-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-127-1-tab">
<div class="sourceCode" id="cb522"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb522-1"><a href="#cb522-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* On recherche toutes les valeurs de CSP différentes et on les met dans une variable.</span></span>
<span id="cb522-2"><a href="#cb522-2" aria-hidden="true" tabindex="-1"></a><span class="co">   On appelle la proc SQL :</span></span>
<span id="cb522-3"><a href="#cb522-3" aria-hidden="true" tabindex="-1"></a><span class="co">   - utilisation du quit et non run à la fin</span></span>
<span id="cb522-4"><a href="#cb522-4" aria-hidden="true" tabindex="-1"></a><span class="co">   - on récupère toutes les valeurs différentes de CSP, séparés par un espace (separated by)</span></span>
<span id="cb522-5"><a href="#cb522-5" aria-hidden="true" tabindex="-1"></a><span class="co">   - s'il y a un espace dans les noms, on le remplace par _ </span></span>
<span id="cb522-6"><a href="#cb522-6" aria-hidden="true" tabindex="-1"></a><span class="co">   - on les met dans la macro-variable liste_csp</span></span>
<span id="cb522-7"><a href="#cb522-7" aria-hidden="true" tabindex="-1"></a><span class="co">   - on trier la liste par valeur de CSP */</span></span>
<span id="cb522-8"><a href="#cb522-8" aria-hidden="true" tabindex="-1"></a><span class="co">/* On crée une variable de CSP formaté sans les accents et les espaces */</span></span>
<span id="cb522-9"><a href="#cb522-9" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> donnees_sas;</span>
<span id="cb522-10"><a href="#cb522-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span> donnees_sas;</span>
<span id="cb522-11"><a href="#cb522-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* SAS ne pourra pas créer des bases de données avec des noms accentués */</span></span>
<span id="cb522-12"><a href="#cb522-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* On supprime dans le nom les lettres accentués. On le fait avec la fonction Translate */</span></span>
<span id="cb522-13"><a href="#cb522-13" aria-hidden="true" tabindex="-1"></a>  CSPF2 = <span class="fu">tranwrd</span>(strip(CSPF), <span class="st">" "</span>, <span class="st">"_"</span>);</span>
<span id="cb522-14"><a href="#cb522-14" aria-hidden="true" tabindex="-1"></a>  CSPF2 = <span class="fu">translate</span>(CSPF2, <span class="st">"eeeeaacio"</span>, <span class="st">"éèêëàâçîô"</span>);</span>
<span id="cb522-15"><a href="#cb522-15" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb522-16"><a href="#cb522-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb522-17"><a href="#cb522-17" aria-hidden="true" tabindex="-1"></a><span class="co">/* Boucles et macros en SAS */</span></span>
<span id="cb522-18"><a href="#cb522-18" aria-hidden="true" tabindex="-1"></a><span class="co">/* Les boucles ne peuvent être utilisées que dans le cadre de macros */</span></span>
<span id="cb522-19"><a href="#cb522-19" aria-hidden="true" tabindex="-1"></a><span class="co">/* Ouverture de la macro */</span></span>
<span id="cb522-20"><a href="#cb522-20" aria-hidden="true" tabindex="-1"></a><span class="kw">%macro</span> Boucles(base = donnees_sas, var = CSPF2);</span>
<span id="cb522-21"><a href="#cb522-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Les modalités de la variable */</span></span>
<span id="cb522-22"><a href="#cb522-22" aria-hidden="true" tabindex="-1"></a><span class="kw">  proc</span> sql noprint;<span class="kw">select</span> <span class="kw">distinct</span> <span class="kw">&amp;var.</span> <span class="kw">into</span> :liste separated <span class="kw">by</span> <span class="st">" "</span> <span class="kw">from</span> <span class="kw">&amp;base.</span> <span class="kw">order</span> <span class="kw">by</span> <span class="kw">&amp;var.</span>;<span class="kw">quit</span>;</span>
<span id="cb522-23"><a href="#cb522-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* On affiche la liste de ces modalités */</span></span>
<span id="cb522-24"><a href="#cb522-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%put</span> <span class="kw">&amp;liste.</span>;</span>
<span id="cb522-25"><a href="#cb522-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* %let permet à SAS d'affecter une valeur à une variable en dehors d'une manipulation de base de données */</span></span>
<span id="cb522-26"><a href="#cb522-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* %sysfunc indique à SAS qu'il doit utiliser la fonction countw dans le cadre d'une macro (pas important) */</span></span>
<span id="cb522-27"><a href="#cb522-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* countw est une fonction qui compte le nombre de mots (séparés par un espace) d'une chaîne de caractères */</span></span>
<span id="cb522-28"><a href="#cb522-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* =&gt; on compte le nombre de CSP différentes */</span></span>
<span id="cb522-29"><a href="#cb522-29" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%let</span> nb = <span class="kw">%sysfunc</span>(countw(<span class="kw">&amp;liste.</span>));</span>
<span id="cb522-30"><a href="#cb522-30" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%put</span> Nombre de modalités différentes : <span class="kw">&amp;nb.</span>;</span>
<span id="cb522-31"><a href="#cb522-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* On itère pour chaque CSP différente ... */</span></span>
<span id="cb522-32"><a href="#cb522-32" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%do</span> i = <span class="dv">1</span> <span class="kw">%to</span> <span class="kw">&amp;nb.</span>;</span>
<span id="cb522-33"><a href="#cb522-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* %scan : donne le i-ème mot de &amp;liste. (les mots sont séparés par un espace) */</span></span>
<span id="cb522-34"><a href="#cb522-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* =&gt; on récupère donc la CSP numéro i */</span></span>
<span id="cb522-35"><a href="#cb522-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%let</span> j = <span class="kw">%scan</span>(<span class="kw">&amp;liste.</span>, <span class="kw">&amp;i.</span>);</span>
<span id="cb522-36"><a href="#cb522-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%put</span> Variable : <span class="kw">&amp;j.</span>;</span>
<span id="cb522-37"><a href="#cb522-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* On crée une base avec seulement les individus de la CSP correspondante */</span></span>
<span id="cb522-38"><a href="#cb522-38" aria-hidden="true" tabindex="-1"></a><span class="kw">    data</span> <span class="kw">&amp;var.</span>;<span class="kw">set</span> donnees_sas;<span class="kw">if</span> <span class="kw">&amp;var.</span> = <span class="st">"&amp;j."</span><span class="kw">;run</span>;</span>
<span id="cb522-39"><a href="#cb522-39" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%end</span>;</span>
<span id="cb522-40"><a href="#cb522-40" aria-hidden="true" tabindex="-1"></a><span class="co">/* Fermeture de la macro */</span></span>
<span id="cb522-41"><a href="#cb522-41" aria-hidden="true" tabindex="-1"></a><span class="kw">%mend</span> Boucles;</span>
<span id="cb522-42"><a href="#cb522-42" aria-hidden="true" tabindex="-1"></a><span class="co">/* Lancement de la macro */</span></span>
<span id="cb522-43"><a href="#cb522-43" aria-hidden="true" tabindex="-1"></a>%Boucles(base = donnees_sas, var = CSPF2);</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-127-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-127-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb523"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb523-1"><a href="#cb523-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base par CSP</span></span>
<span id="cb523-2"><a href="#cb523-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">unique</span>(donnees_rbase<span class="sc">$</span>cspf)) {</span>
<span id="cb523-3"><a href="#cb523-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Met en minuscule et enlève les accents</span></span>
<span id="cb523-4"><a href="#cb523-4" aria-hidden="true" tabindex="-1"></a>  nomBase <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">chartr</span>(<span class="st">"éèêëàâçîô"</span>, <span class="st">"eeeeaacio"</span>, i))</span>
<span id="cb523-5"><a href="#cb523-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># assign permet de faire passer une chaîne de caractères en variable R</span></span>
<span id="cb523-6"><a href="#cb523-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(nomBase, donnees_rbase[<span class="fu">which</span>(donnees_rbase<span class="sc">$</span>cspf <span class="sc">==</span> i), ])</span>
<span id="cb523-7"><a href="#cb523-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-127-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-127-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb524"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb524-1"><a href="#cb524-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base par CSP</span></span>
<span id="cb524-2"><a href="#cb524-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> donnees_tidyverse <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(cspf) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()) {</span>
<span id="cb524-3"><a href="#cb524-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Met en minuscule et enlève les accents</span></span>
<span id="cb524-4"><a href="#cb524-4" aria-hidden="true" tabindex="-1"></a>  nomBase <span class="ot">&lt;-</span> <span class="fu">chartr</span>(<span class="st">"éèêëàâçîô"</span>, <span class="st">"eeeeaacio"</span>, i) <span class="sc">%&gt;%</span> <span class="fu">tolower</span>()</span>
<span id="cb524-5"><a href="#cb524-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># assign permet de faire passer une chaîne de caractères en variable R</span></span>
<span id="cb524-6"><a href="#cb524-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(nomBase, donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb524-7"><a href="#cb524-7" aria-hidden="true" tabindex="-1"></a>           <span class="fu">filter</span>(cspf <span class="sc">==</span> <span class="fu">as.name</span>(i)))</span>
<span id="cb524-8"><a href="#cb524-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-127-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-127-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb525"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb525-1"><a href="#cb525-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer une base pour chaque individu d'une certaine CSP</span></span>
<span id="cb525-2"><a href="#cb525-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">unique</span>(donnees_datatable<span class="sc">$</span>cspf)) {</span>
<span id="cb525-3"><a href="#cb525-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Met en minuscule et enlève les accents</span></span>
<span id="cb525-4"><a href="#cb525-4" aria-hidden="true" tabindex="-1"></a>  nomBase <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">chartr</span>(<span class="st">"éèêëàâçîô"</span>, <span class="st">"eeeeaacio"</span>, i))</span>
<span id="cb525-5"><a href="#cb525-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># assign permet de faire passer une chaîne de caractères en variable R</span></span>
<span id="cb525-6"><a href="#cb525-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(nomBase, donnees_datatable[donnees_datatable<span class="sc">$</span>cspf <span class="sc">==</span> i, ])</span>
<span id="cb525-7"><a href="#cb525-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-127-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-127-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="autres-transcriptions-de-fonctions-sas-vers-r" class="level2" data-number="17.5">
<h2 data-number="17.5" class="anchored" data-anchor-id="autres-transcriptions-de-fonctions-sas-vers-r"><span class="header-section-number">17.5</span> Autres transcriptions de fonctions SAS vers R</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-128-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-128-1" role="tab" aria-controls="tabset-128-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-128-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-128-2" role="tab" aria-controls="tabset-128-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-128-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-128-3" role="tab" aria-controls="tabset-128-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-128-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-128-4" role="tab" aria-controls="tabset-128-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-128-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-128-5" role="tab" aria-controls="tabset-128-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-128-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-128-1-tab">
<div class="sourceCode" id="cb526"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb526-1"><a href="#cb526-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* À FAIRE */</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-128-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-128-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb527"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb527-1"><a href="#cb527-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mesurer la durée d'exécution d'un programme</span></span>
<span id="cb527-2"><a href="#cb527-2" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(donnees_rbase <span class="ot">&lt;-</span> donnees_rbase[<span class="fu">order</span>(donnees_rbase<span class="sc">$</span>identifiant, donnees_rbase<span class="sc">$</span>date_entree, <span class="at">na.last =</span> <span class="cn">FALSE</span>), ])</span>
<span id="cb527-3"><a href="#cb527-3" aria-hidden="true" tabindex="-1"></a><span class="co"># En SAS : include("chemin")</span></span>
<span id="cb527-4"><a href="#cb527-4" aria-hidden="true" tabindex="-1"></a><span class="co"># En R : source("chemin", encoding = "utf-8", echo = TRUE, max.deparse.length = 1e3)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-128-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-128-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb528"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb528-1"><a href="#cb528-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mesurer la durée d'exécution d'un programme</span></span>
<span id="cb528-2"><a href="#cb528-2" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(donnees_tidyverse <span class="ot">&lt;-</span> donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb528-3"><a href="#cb528-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">arrange</span>(identifiant, date_entree))</span>
<span id="cb528-4"><a href="#cb528-4" aria-hidden="true" tabindex="-1"></a><span class="co"># En SAS : include("chemin")</span></span>
<span id="cb528-5"><a href="#cb528-5" aria-hidden="true" tabindex="-1"></a><span class="co"># En R : source("chemin", encoding = "utf-8", echo = TRUE, max.deparse.length = 1e3)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-128-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-128-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb529"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb529-1"><a href="#cb529-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mesurer la durée d'exécution d'un programme</span></span>
<span id="cb529-2"><a href="#cb529-2" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">setorder</span>(donnees_datatable, <span class="st">"identifiant"</span>, <span class="st">"date_entree"</span>, <span class="at">na.last =</span> <span class="cn">FALSE</span>))</span>
<span id="cb529-3"><a href="#cb529-3" aria-hidden="true" tabindex="-1"></a><span class="co"># En SAS : include("chemin")</span></span>
<span id="cb529-4"><a href="#cb529-4" aria-hidden="true" tabindex="-1"></a><span class="co"># En R : source("chemin", encoding = "utf-8", echo = TRUE, max.deparse.length = 1e3)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-128-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-128-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
</section>
<section id="débogage" class="level1" data-number="18">
<h1 data-number="18"><span class="header-section-number">18</span> Débogage</h1>
<section id="outils-daide-au-débogage" class="level2" data-number="18.1">
<h2 data-number="18.1" class="anchored" data-anchor-id="outils-daide-au-débogage"><span class="header-section-number">18.1</span> Outils d’aide au débogage</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-129-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-129-1" role="tab" aria-controls="tabset-129-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-129-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-129-2" role="tab" aria-controls="tabset-129-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-129-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-129-3" role="tab" aria-controls="tabset-129-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-129-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-129-4" role="tab" aria-controls="tabset-129-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-129-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-129-5" role="tab" aria-controls="tabset-129-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-129-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-129-1-tab">
<div class="sourceCode" id="cb530"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb530-1"><a href="#cb530-1" aria-hidden="true" tabindex="-1"></a><span class="kw">options</span> symbolgen mprint mlogic;</span>
<span id="cb530-2"><a href="#cb530-2" aria-hidden="true" tabindex="-1"></a><span class="kw">%macro</span> Debogage;</span>
<span id="cb530-3"><a href="#cb530-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%local</span> phrase i j;</span>
<span id="cb530-4"><a href="#cb530-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%let</span> phrase = Voici une phrase;</span>
<span id="cb530-5"><a href="#cb530-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%do</span> i = <span class="dv">1</span> <span class="kw">%to</span> <span class="kw">%sysfunc</span>(countw(<span class="kw">&amp;phrase.</span>));</span>
<span id="cb530-6"><a href="#cb530-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%let</span> j = <span class="kw">%scan</span>(<span class="kw">&amp;phrase.</span>, <span class="kw">&amp;i.</span>);</span>
<span id="cb530-7"><a href="#cb530-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">%put</span> Mot n°<span class="kw">&amp;i.</span> = <span class="kw">&amp;j.</span>;</span>
<span id="cb530-8"><a href="#cb530-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%end</span>;</span>
<span id="cb530-9"><a href="#cb530-9" aria-hidden="true" tabindex="-1"></a><span class="kw">%mend</span> Debogage;</span>
<span id="cb530-10"><a href="#cb530-10" aria-hidden="true" tabindex="-1"></a>%Debogage;</span>
<span id="cb530-11"><a href="#cb530-11" aria-hidden="true" tabindex="-1"></a><span class="kw">options</span> nosymbolgen nomprint nomlogic;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-129-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-129-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb531"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb531-1"><a href="#cb531-1" aria-hidden="true" tabindex="-1"></a><span class="co">#phrase &lt;- c("voici", "une", "phrase")</span></span>
<span id="cb531-2"><a href="#cb531-2" aria-hidden="true" tabindex="-1"></a><span class="co">#options(error=recover)</span></span>
<span id="cb531-3"><a href="#cb531-3" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in phrase) print(k)</span></span>
<span id="cb531-4"><a href="#cb531-4" aria-hidden="true" tabindex="-1"></a><span class="co">#options(error=NULL)</span></span>
<span id="cb531-5"><a href="#cb531-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-6"><a href="#cb531-6" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : autres outils</span></span>
<span id="cb531-7"><a href="#cb531-7" aria-hidden="true" tabindex="-1"></a><span class="co">#traceback()</span></span>
<span id="cb531-8"><a href="#cb531-8" aria-hidden="true" tabindex="-1"></a><span class="co">#browser()</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-129-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-129-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb532"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb532-1"><a href="#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : creuser</span></span>
<span id="cb532-2"><a href="#cb532-2" aria-hidden="true" tabindex="-1"></a><span class="co">#phrase &lt;- c("voici", "une", "phrase")</span></span>
<span id="cb532-3"><a href="#cb532-3" aria-hidden="true" tabindex="-1"></a><span class="co">#options(error=recover)</span></span>
<span id="cb532-4"><a href="#cb532-4" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in phrase) print(k)</span></span>
<span id="cb532-5"><a href="#cb532-5" aria-hidden="true" tabindex="-1"></a><span class="co">#options(error=NULL)</span></span>
<span id="cb532-6"><a href="#cb532-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-7"><a href="#cb532-7" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : autres outils</span></span>
<span id="cb532-8"><a href="#cb532-8" aria-hidden="true" tabindex="-1"></a><span class="co">#traceback()</span></span>
<span id="cb532-9"><a href="#cb532-9" aria-hidden="true" tabindex="-1"></a><span class="co">#browser()</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-129-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-129-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb533"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb533-1"><a href="#cb533-1" aria-hidden="true" tabindex="-1"></a><span class="co">#phrase &lt;- c("voici", "une", "phrase")</span></span>
<span id="cb533-2"><a href="#cb533-2" aria-hidden="true" tabindex="-1"></a><span class="co">#options(error=recover)</span></span>
<span id="cb533-3"><a href="#cb533-3" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in phrase) print(k)</span></span>
<span id="cb533-4"><a href="#cb533-4" aria-hidden="true" tabindex="-1"></a><span class="co">#options(error=NULL)</span></span>
<span id="cb533-5"><a href="#cb533-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb533-6"><a href="#cb533-6" aria-hidden="true" tabindex="-1"></a><span class="co"># À FAIRE : autres outils</span></span>
<span id="cb533-7"><a href="#cb533-7" aria-hidden="true" tabindex="-1"></a><span class="co">#traceback()</span></span>
<span id="cb533-8"><a href="#cb533-8" aria-hidden="true" tabindex="-1"></a><span class="co">#browser()</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-129-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-129-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
</section>
<section id="points-de-vigilance-en-sas" class="level1" data-number="19">
<h1 data-number="19"><span class="header-section-number">19</span> Points de vigilance en SAS</h1>
<section id="emploi-des-guillemets-et-double-guillemets" class="level2" data-number="19.1">
<h2 data-number="19.1" class="anchored" data-anchor-id="emploi-des-guillemets-et-double-guillemets"><span class="header-section-number">19.1</span> Emploi des guillemets et double guillemets</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-130-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-130-1" role="tab" aria-controls="tabset-130-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-130-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-130-2" role="tab" aria-controls="tabset-130-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-130-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-130-3" role="tab" aria-controls="tabset-130-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-130-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-130-4" role="tab" aria-controls="tabset-130-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-130-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-130-5" role="tab" aria-controls="tabset-130-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-130-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-130-1-tab">
<div class="sourceCode" id="cb534"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb534-1"><a href="#cb534-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Quelques points de vigilance en SAS (à ne connaître que si on est amené à modifier le programme SAS, pas utiles sinon) */</span></span>
<span id="cb534-2"><a href="#cb534-2" aria-hidden="true" tabindex="-1"></a><span class="co">/* Double guillemets pour les macro-variables */</span></span>
<span id="cb534-3"><a href="#cb534-3" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> a = Bonjour;</span>
<span id="cb534-4"><a href="#cb534-4" aria-hidden="true" tabindex="-1"></a><span class="kw">%put</span> <span class="st">'&amp;a.'</span>; <span class="co">/* Incorrect */</span></span>
<span id="cb534-5"><a href="#cb534-5" aria-hidden="true" tabindex="-1"></a><span class="kw">%put</span> <span class="st">"&amp;a."</span>; <span class="co">/* Correct */</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-130-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-130-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb535"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb535-1"><a href="#cb535-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sans objet en R</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-130-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-130-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb536"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb536-1"><a href="#cb536-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sans objet en R</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-130-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-130-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb537"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb537-1"><a href="#cb537-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sans objet en R</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-130-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-130-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="macro-variable-définie-avec-un-statut-global-avant-son-appel-dans-le-cadre-dun-statut-local" class="level2" data-number="19.2">
<h2 data-number="19.2" class="anchored" data-anchor-id="macro-variable-définie-avec-un-statut-global-avant-son-appel-dans-le-cadre-dun-statut-local"><span class="header-section-number">19.2</span> Macro-variable définie avec un statut global avant son appel dans le cadre d’un statut local</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-131-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-131-1" role="tab" aria-controls="tabset-131-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-131-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-131-2" role="tab" aria-controls="tabset-131-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-131-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-131-3" role="tab" aria-controls="tabset-131-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-131-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-131-4" role="tab" aria-controls="tabset-131-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-131-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-131-5" role="tab" aria-controls="tabset-131-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-131-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-131-1-tab">
<div class="sourceCode" id="cb538"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb538-1"><a href="#cb538-1" aria-hidden="true" tabindex="-1"></a><span class="kw">%macro</span> test;</span>
<span id="cb538-2"><a href="#cb538-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%let</span> reponse = oui;</span>
<span id="cb538-3"><a href="#cb538-3" aria-hidden="true" tabindex="-1"></a><span class="kw">%mend</span> test;</span>
<span id="cb538-4"><a href="#cb538-4" aria-hidden="true" tabindex="-1"></a>%test;</span>
<span id="cb538-5"><a href="#cb538-5" aria-hidden="true" tabindex="-1"></a><span class="co">/* 1. Erreur car &amp;reponse. n'est défini que dans le cas d'un environnement local */</span> </span>
<span id="cb538-6"><a href="#cb538-6" aria-hidden="true" tabindex="-1"></a><span class="kw">%put</span> <span class="kw">&amp;reponse.</span>;</span>
<span id="cb538-7"><a href="#cb538-7" aria-hidden="true" tabindex="-1"></a><span class="co">/* 2. Défini auparavant dans un environnement global, elle change de valeur à l'appel de la fonction */</span></span>
<span id="cb538-8"><a href="#cb538-8" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> reponse = non;</span>
<span id="cb538-9"><a href="#cb538-9" aria-hidden="true" tabindex="-1"></a><span class="kw">%put</span> Reponse : <span class="kw">&amp;reponse.</span>;</span>
<span id="cb538-10"><a href="#cb538-10" aria-hidden="true" tabindex="-1"></a>%test;</span>
<span id="cb538-11"><a href="#cb538-11" aria-hidden="true" tabindex="-1"></a><span class="kw">%put</span> Reponse après la macro : <span class="kw">&amp;reponse.</span>;</span>
<span id="cb538-12"><a href="#cb538-12" aria-hidden="true" tabindex="-1"></a><span class="co">/* 3. Problème corrigé, en imposant la variable à local dans la macro */</span></span>
<span id="cb538-13"><a href="#cb538-13" aria-hidden="true" tabindex="-1"></a><span class="kw">%macro</span> test2;</span>
<span id="cb538-14"><a href="#cb538-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%local</span> reponse;</span>
<span id="cb538-15"><a href="#cb538-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">%let</span> reponse = oui;</span>
<span id="cb538-16"><a href="#cb538-16" aria-hidden="true" tabindex="-1"></a><span class="kw">%mend</span> test2;</span>
<span id="cb538-17"><a href="#cb538-17" aria-hidden="true" tabindex="-1"></a><span class="kw">%let</span> reponse = non;</span>
<span id="cb538-18"><a href="#cb538-18" aria-hidden="true" tabindex="-1"></a><span class="kw">%put</span> Reponse : <span class="kw">&amp;reponse.</span>;</span>
<span id="cb538-19"><a href="#cb538-19" aria-hidden="true" tabindex="-1"></a>%test2;</span>
<span id="cb538-20"><a href="#cb538-20" aria-hidden="true" tabindex="-1"></a><span class="kw">%put</span> Année après la macro : <span class="kw">&amp;reponse.</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-131-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-131-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb539"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb539-1"><a href="#cb539-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sans objet en R</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-131-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-131-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb540"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb540-1"><a href="#cb540-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sans objet en R</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-131-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-131-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb541"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb541-1"><a href="#cb541-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sans objet en R</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-131-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-131-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
</section>
<section id="fin-du-programme" class="level1" data-number="20">
<h1 data-number="20"><span class="header-section-number">20</span> Fin du programme</h1>
<section id="taille-des-objets-en-mémoire" class="level2" data-number="20.1">
<h2 data-number="20.1" class="anchored" data-anchor-id="taille-des-objets-en-mémoire"><span class="header-section-number">20.1</span> Taille des objets en mémoire</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-132-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-132-1" role="tab" aria-controls="tabset-132-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-132-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-132-2" role="tab" aria-controls="tabset-132-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-132-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-132-3" role="tab" aria-controls="tabset-132-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-132-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-132-4" role="tab" aria-controls="tabset-132-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-132-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-132-5" role="tab" aria-controls="tabset-132-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-132-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-132-1-tab">
<div class="sourceCode" id="cb542"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb542-1"><a href="#cb542-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Taille d'une base de données */</span></span>
<span id="cb542-2"><a href="#cb542-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> sql;</span>
<span id="cb542-3"><a href="#cb542-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> <span class="kw">libname</span>, memname, filesize <span class="kw">format</span> = sizekmg., filesize <span class="kw">format</span> = sizek.</span>
<span id="cb542-4"><a href="#cb542-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> Dictionary.Tables</span>
<span id="cb542-5"><a href="#cb542-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">where</span> <span class="kw">libname</span> = <span class="st">"WORK"</span> <span class="kw">and</span> memname = <span class="fu">upcase</span>(<span class="st">"donnees_sas"</span>) <span class="kw">and</span> memtype = <span class="st">"DATA"</span>;</span>
<span id="cb542-6"><a href="#cb542-6" aria-hidden="true" tabindex="-1"></a><span class="kw">quit</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-132-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-132-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb543"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb543-1"><a href="#cb543-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Taille, en mémoire, d'une base (en Mb)</span></span>
<span id="cb543-2"><a href="#cb543-2" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(<span class="fu">object.size</span>(donnees_rbase), <span class="at">nsmall =</span> <span class="dv">3</span>, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">unit =</span> <span class="st">"Mb"</span>)</span>
<span id="cb543-3"><a href="#cb543-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb543-4"><a href="#cb543-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Taille des objets en mémoire, en Gb</span></span>
<span id="cb543-5"><a href="#cb543-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">sapply</span>(<span class="fu">ls</span>(), <span class="cf">function</span>(x){<span class="fu">object.size</span>(<span class="fu">get</span>(x))}), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">10</span><span class="sc">**</span><span class="dv">9</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-132-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-132-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb544"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb544-1"><a href="#cb544-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Taille, en mémoire, d'une base (en Mb)</span></span>
<span id="cb544-2"><a href="#cb544-2" aria-hidden="true" tabindex="-1"></a>donnees_tidyverse <span class="sc">%&gt;%</span> </span>
<span id="cb544-3"><a href="#cb544-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">object.size</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb544-4"><a href="#cb544-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">format</span>(<span class="at">nsmall =</span> <span class="dv">3</span>, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">unit =</span> <span class="st">"Mb"</span>)</span>
<span id="cb544-5"><a href="#cb544-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb544-6"><a href="#cb544-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Taille des objets en mémoire, en Gb</span></span>
<span id="cb544-7"><a href="#cb544-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">sapply</span>(<span class="fu">ls</span>(), <span class="cf">function</span>(x){<span class="fu">object.size</span>(<span class="fu">get</span>(x))}), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">10</span><span class="sc">**</span><span class="dv">9</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-132-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-132-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb545"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb545-1"><a href="#cb545-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Taille, en mémoire, d'une base (en Mb)</span></span>
<span id="cb545-2"><a href="#cb545-2" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(<span class="fu">object.size</span>(donnees_datatable), <span class="at">nsmall =</span> <span class="dv">3</span>, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">unit =</span> <span class="st">"Mb"</span>)</span>
<span id="cb545-3"><a href="#cb545-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb545-4"><a href="#cb545-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Taille des objets en mémoire, en Gb</span></span>
<span id="cb545-5"><a href="#cb545-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">sapply</span>(<span class="fu">ls</span>(), <span class="cf">function</span>(x){<span class="fu">object.size</span>(<span class="fu">get</span>(x))}), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">10</span><span class="sc">**</span><span class="dv">9</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-132-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-132-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="supprimer-des-bases" class="level2" data-number="20.2">
<h2 data-number="20.2" class="anchored" data-anchor-id="supprimer-des-bases"><span class="header-section-number">20.2</span> Supprimer des bases</h2>
<div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-133-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-133-1" role="tab" aria-controls="tabset-133-1" aria-selected="true"><code>SAS</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-133-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-133-2" role="tab" aria-controls="tabset-133-2" aria-selected="false"><code>R base</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-133-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-133-3" role="tab" aria-controls="tabset-133-3" aria-selected="false"><code>tidyverse</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-133-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-133-4" role="tab" aria-controls="tabset-133-4" aria-selected="false"><code>data.table</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-133-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-133-5" role="tab" aria-controls="tabset-133-5" aria-selected="false"><code>arrow/duckdb</code></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-133-1" class="unnumbered unlisted tab-pane active" role="tabpanel" aria-labelledby="tabset-133-1-tab">
<div class="sourceCode" id="cb546"><pre class="sourceCode sas code-with-copy"><code class="sourceCode sas"><span id="cb546-1"><a href="#cb546-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Supprimer une base */</span></span>
<span id="cb546-2"><a href="#cb546-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> datasets lib = work nolist;<span class="kw">delete</span> donnees_sas<span class="kw">;run</span>;</span>
<span id="cb546-3"><a href="#cb546-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb546-4"><a href="#cb546-4" aria-hidden="true" tabindex="-1"></a><span class="co">/* Supprimer toutes les bases dans la work */</span></span>
<span id="cb546-5"><a href="#cb546-5" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> datasets lib = work nolist kill<span class="kw">;run</span>;</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-133-2" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-133-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb547"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb547-1"><a href="#cb547-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Supprimer une base</span></span>
<span id="cb547-2"><a href="#cb547-2" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(donnees_rbase)</span></span>
<span id="cb547-3"><a href="#cb547-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb547-4"><a href="#cb547-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Supprimer toutes les bases et tous les objets de la mémoire vive</span></span>
<span id="cb547-5"><a href="#cb547-5" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(list = ls())</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-133-3" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-133-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb548"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb548-1"><a href="#cb548-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Supprimer une base</span></span>
<span id="cb548-2"><a href="#cb548-2" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(donnees_tidyverse)</span></span>
<span id="cb548-3"><a href="#cb548-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb548-4"><a href="#cb548-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Supprimer toutes les bases et tous les objets de la mémoire vive</span></span>
<span id="cb548-5"><a href="#cb548-5" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(list = ls())</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-133-4" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-133-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb549"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb549-1"><a href="#cb549-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Supprimer une base</span></span>
<span id="cb549-2"><a href="#cb549-2" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(donnees_datatable)</span></span>
<span id="cb549-3"><a href="#cb549-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb549-4"><a href="#cb549-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Supprimer toutes les bases et tous les objets de la mémoire vive</span></span>
<span id="cb549-5"><a href="#cb549-5" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(list = ls())</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-133-5" class="unnumbered unlisted tab-pane" role="tabpanel" aria-labelledby="tabset-133-5-tab">
<div class="cell">

</div>
</div>
</div>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Code source</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb550" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb550-1"><a href="#cb550-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb550-2"><a href="#cb550-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Aide-mémoire `SAS` - `R`"</span></span>
<span id="cb550-3"><a href="#cb550-3" aria-hidden="true" tabindex="-1"></a><span class="an">lang :</span><span class="co"> fr</span></span>
<span id="cb550-4"><a href="#cb550-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb550-5"><a href="#cb550-5" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: Nassab ABDALLAH</span></span>
<span id="cb550-6"><a href="#cb550-6" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliation: Dares/SCS, &lt;nassab.abdallah@travail.gouv.fr&gt;</span></span>
<span id="cb550-7"><a href="#cb550-7" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: Damien EUZENAT</span></span>
<span id="cb550-8"><a href="#cb550-8" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliation: Dares/DIP, &lt;damien.euzenat@travail.gouv.fr&gt;</span></span>
<span id="cb550-9"><a href="#cb550-9" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: Sébastien LI-THIAO-TE</span></span>
<span id="cb550-10"><a href="#cb550-10" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliation: Dares/DFA, &lt;sebastien.li-thiao-te@travail.gouv.fr&gt;</span></span>
<span id="cb550-11"><a href="#cb550-11" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb550-12"><a href="#cb550-12" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb550-13"><a href="#cb550-13" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb550-14"><a href="#cb550-14" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb550-15"><a href="#cb550-15" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-expand: 2</span></span>
<span id="cb550-16"><a href="#cb550-16" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb550-17"><a href="#cb550-17" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb550-18"><a href="#cb550-18" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb550-19"><a href="#cb550-19" aria-hidden="true" tabindex="-1"></a><span class="co">    smooth-scroll: true</span></span>
<span id="cb550-20"><a href="#cb550-20" aria-hidden="true" tabindex="-1"></a><span class="co">    embed-resources: true</span></span>
<span id="cb550-21"><a href="#cb550-21" aria-hidden="true" tabindex="-1"></a><span class="co">    link-external-icon: true</span></span>
<span id="cb550-22"><a href="#cb550-22" aria-hidden="true" tabindex="-1"></a><span class="co">    link-external-newwindow: true</span></span>
<span id="cb550-23"><a href="#cb550-23" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: full</span></span>
<span id="cb550-24"><a href="#cb550-24" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb550-25"><a href="#cb550-25" aria-hidden="true" tabindex="-1"></a><span class="co">    theme:</span></span>
<span id="cb550-26"><a href="#cb550-26" aria-hidden="true" tabindex="-1"></a><span class="co">      light: united</span></span>
<span id="cb550-27"><a href="#cb550-27" aria-hidden="true" tabindex="-1"></a><span class="co">      dark: darkly</span></span>
<span id="cb550-28"><a href="#cb550-28" aria-hidden="true" tabindex="-1"></a><span class="co"># format : native   </span></span>
<span id="cb550-29"><a href="#cb550-29" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> source</span></span>
<span id="cb550-30"><a href="#cb550-30" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb550-31"><a href="#cb550-31" aria-hidden="true" tabindex="-1"></a><span class="co">  eval: false</span></span>
<span id="cb550-32"><a href="#cb550-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-33"><a href="#cb550-33" aria-hidden="true" tabindex="-1"></a><span class="an">embed-resources:</span><span class="co"> true</span></span>
<span id="cb550-34"><a href="#cb550-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-35"><a href="#cb550-35" aria-hidden="true" tabindex="-1"></a><span class="an">syntax-definitions:</span><span class="co"> </span></span>
<span id="cb550-36"><a href="#cb550-36" aria-hidden="true" tabindex="-1"></a><span class="co">  - sas.xml</span></span>
<span id="cb550-37"><a href="#cb550-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-38"><a href="#cb550-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary for listings and search engines</span></span>
<span id="cb550-39"><a href="#cb550-39" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> |</span></span>
<span id="cb550-40"><a href="#cb550-40" aria-hidden="true" tabindex="-1"></a><span class="co">  Un aide-mémoire pour les statisticiens traduisant des codes standards en `SAS` et en `R`, suivant 4 environnements (`R-Base`, `Tidyverse`, `data.table`, `Arrow / DuckDb`).</span></span>
<span id="cb550-41"><a href="#cb550-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-42"><a href="#cb550-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Date published</span></span>
<span id="cb550-43"><a href="#cb550-43" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb550-44"><a href="#cb550-44" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> "05/24/2024"</span></span>
<span id="cb550-45"><a href="#cb550-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-46"><a href="#cb550-46" aria-hidden="true" tabindex="-1"></a><span class="an">output:</span></span>
<span id="cb550-47"><a href="#cb550-47" aria-hidden="true" tabindex="-1"></a><span class="co">  rmdformats::robobook:</span></span>
<span id="cb550-48"><a href="#cb550-48" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight: tango</span></span>
<span id="cb550-49"><a href="#cb550-49" aria-hidden="true" tabindex="-1"></a><span class="co">    number_sections: true</span></span>
<span id="cb550-50"><a href="#cb550-50" aria-hidden="true" tabindex="-1"></a><span class="co">  </span></span>
<span id="cb550-51"><a href="#cb550-51" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb550-52"><a href="#cb550-52" aria-hidden="true" tabindex="-1"></a><span class="co">  - SAS</span></span>
<span id="cb550-53"><a href="#cb550-53" aria-hidden="true" tabindex="-1"></a><span class="co">  - R</span></span>
<span id="cb550-54"><a href="#cb550-54" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb550-55"><a href="#cb550-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-56"><a href="#cb550-56" aria-hidden="true" tabindex="-1"></a>L'aide-mémoire a pour but de fournir des codes écrits en <span class="in">`SAS`</span> et d'en donner la traduction en <span class="in">`R`</span> de différentes manières possibles :</span>
<span id="cb550-57"><a href="#cb550-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-58"><a href="#cb550-58" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`base R`</span></span>
<span id="cb550-59"><a href="#cb550-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-60"><a href="#cb550-60" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`tidyverse`</span></span>
<span id="cb550-61"><a href="#cb550-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-62"><a href="#cb550-62" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`data.table`</span></span>
<span id="cb550-63"><a href="#cb550-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-64"><a href="#cb550-64" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`arrow/duckdb`</span></span>
<span id="cb550-65"><a href="#cb550-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-66"><a href="#cb550-66" aria-hidden="true" tabindex="-1"></a>Les codes traduits sont typiques de la production statistique ou la réalisation d'études descriptives.</span>
<span id="cb550-67"><a href="#cb550-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-68"><a href="#cb550-68" aria-hidden="true" tabindex="-1"></a>Ce document s'adresse notamment aux utilisateurs de <span class="in">`SAS`</span> qui veulent connaître la traduction du code <span class="in">`SAS`</span> en <span class="in">`R`</span>, aux utilisateurs de <span class="in">`R`</span> qui ont besoin de comprendre le code <span class="in">`SAS`</span>, ainsi qu'aux utilisateurs d'un environnement <span class="in">`R`</span> qui sont intéressés par la traduction dans un autre environnement <span class="in">`R`</span>.</span>
<span id="cb550-69"><a href="#cb550-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-70"><a href="#cb550-70" aria-hidden="true" tabindex="-1"></a>Il se veut complémentaire de la documentation en ligne en français Utilit'R, née à l'Insee (<span class="ot">&lt;https://www.book.utilitr.org/&gt;</span>). Le lecteur est invité à s'y référer pour obtenir des informations importantes sur l'utilisation de <span class="in">`R`</span> et qui ne sont pas discutées dans ce document, comme l'importation de données en <span class="in">`R`</span> (<span class="ot">&lt;https://www.book.utilitr.org/03_fiches_thematiques/fiche_import_fichiers_plats&gt;</span>). </span>
<span id="cb550-71"><a href="#cb550-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-72"><a href="#cb550-72" aria-hidden="true" tabindex="-1"></a>Enfin, si vous souhaitez collaborer à cet aide-mémoire ou nous faire part de votre avis, n'hésitez pas à nous contacter via nos adresses email.</span>
<span id="cb550-73"><a href="#cb550-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-74"><a href="#cb550-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-75"><a href="#cb550-75" aria-hidden="true" tabindex="-1"></a>{{&lt; include _Chapitre1.qmd &gt;}}</span>
<span id="cb550-76"><a href="#cb550-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-77"><a href="#cb550-77" aria-hidden="true" tabindex="-1"></a>{{&lt; include _Chapitre2.qmd &gt;}}</span>
<span id="cb550-78"><a href="#cb550-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-79"><a href="#cb550-79" aria-hidden="true" tabindex="-1"></a>{{&lt; include _Chapitre3.qmd &gt;}}</span>
<span id="cb550-80"><a href="#cb550-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-81"><a href="#cb550-81" aria-hidden="true" tabindex="-1"></a>{{&lt; include _Chapitre4.qmd &gt;}}</span>
<span id="cb550-82"><a href="#cb550-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-83"><a href="#cb550-83" aria-hidden="true" tabindex="-1"></a>{{&lt; include _Chapitre5.qmd &gt;}}</span>
<span id="cb550-84"><a href="#cb550-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-85"><a href="#cb550-85" aria-hidden="true" tabindex="-1"></a>{{&lt; include _Chapitre6.qmd &gt;}}</span>
<span id="cb550-86"><a href="#cb550-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-87"><a href="#cb550-87" aria-hidden="true" tabindex="-1"></a>{{&lt; include _Chapitre7.qmd &gt;}}</span>
<span id="cb550-88"><a href="#cb550-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-89"><a href="#cb550-89" aria-hidden="true" tabindex="-1"></a>{{&lt; include _Chapitre8.qmd &gt;}}</span>
<span id="cb550-90"><a href="#cb550-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-91"><a href="#cb550-91" aria-hidden="true" tabindex="-1"></a>{{&lt; include _Chapitre9.qmd &gt;}}</span>
<span id="cb550-92"><a href="#cb550-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-93"><a href="#cb550-93" aria-hidden="true" tabindex="-1"></a>{{&lt; include _Chapitre10.qmd &gt;}}</span>
<span id="cb550-94"><a href="#cb550-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-95"><a href="#cb550-95" aria-hidden="true" tabindex="-1"></a>{{&lt; include _Chapitre11.qmd &gt;}}</span>
<span id="cb550-96"><a href="#cb550-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-97"><a href="#cb550-97" aria-hidden="true" tabindex="-1"></a>{{&lt; include _Chapitre12.qmd &gt;}}</span>
<span id="cb550-98"><a href="#cb550-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-99"><a href="#cb550-99" aria-hidden="true" tabindex="-1"></a>{{&lt; include _Chapitre13.qmd &gt;}}</span>
<span id="cb550-100"><a href="#cb550-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-101"><a href="#cb550-101" aria-hidden="true" tabindex="-1"></a>{{&lt; include _Chapitre14.qmd &gt;}}</span>
<span id="cb550-102"><a href="#cb550-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-103"><a href="#cb550-103" aria-hidden="true" tabindex="-1"></a>{{&lt; include _Chapitre15.qmd &gt;}}</span>
<span id="cb550-104"><a href="#cb550-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-105"><a href="#cb550-105" aria-hidden="true" tabindex="-1"></a>{{&lt; include _Chapitre16.qmd &gt;}}</span>
<span id="cb550-106"><a href="#cb550-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-107"><a href="#cb550-107" aria-hidden="true" tabindex="-1"></a>{{&lt; include _Chapitre17.qmd &gt;}}</span>
<span id="cb550-108"><a href="#cb550-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-109"><a href="#cb550-109" aria-hidden="true" tabindex="-1"></a>{{&lt; include _Chapitre18.qmd &gt;}}</span>
<span id="cb550-110"><a href="#cb550-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-111"><a href="#cb550-111" aria-hidden="true" tabindex="-1"></a>{{&lt; include _Chapitre19.qmd &gt;}}</span>
<span id="cb550-112"><a href="#cb550-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-113"><a href="#cb550-113" aria-hidden="true" tabindex="-1"></a>{{&lt; include _Chapitre20.qmd &gt;}}</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-right">Ce site a été créé avec <a href="https://quarto.org/">Quarto</a></div>
  </div>
</footer>



<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>